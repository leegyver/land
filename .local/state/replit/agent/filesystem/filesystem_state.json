{"file_contents":{"client/src/components/ui/breadcrumb.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Breadcrumb = React.forwardRef<\n  HTMLElement,\n  React.ComponentPropsWithoutRef<\"nav\"> & {\n    separator?: React.ReactNode\n  }\n>(({ ...props }, ref) => <nav ref={ref} aria-label=\"breadcrumb\" {...props} />)\nBreadcrumb.displayName = \"Breadcrumb\"\n\nconst BreadcrumbList = React.forwardRef<\n  HTMLOListElement,\n  React.ComponentPropsWithoutRef<\"ol\">\n>(({ className, ...props }, ref) => (\n  <ol\n    ref={ref}\n    className={cn(\n      \"flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5\",\n      className\n    )}\n    {...props}\n  />\n))\nBreadcrumbList.displayName = \"BreadcrumbList\"\n\nconst BreadcrumbItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentPropsWithoutRef<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    className={cn(\"inline-flex items-center gap-1.5\", className)}\n    {...props}\n  />\n))\nBreadcrumbItem.displayName = \"BreadcrumbItem\"\n\nconst BreadcrumbLink = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentPropsWithoutRef<\"a\"> & {\n    asChild?: boolean\n  }\n>(({ asChild, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      className={cn(\"transition-colors hover:text-foreground\", className)}\n      {...props}\n    />\n  )\n})\nBreadcrumbLink.displayName = \"BreadcrumbLink\"\n\nconst BreadcrumbPage = React.forwardRef<\n  HTMLSpanElement,\n  React.ComponentPropsWithoutRef<\"span\">\n>(({ className, ...props }, ref) => (\n  <span\n    ref={ref}\n    role=\"link\"\n    aria-disabled=\"true\"\n    aria-current=\"page\"\n    className={cn(\"font-normal text-foreground\", className)}\n    {...props}\n  />\n))\nBreadcrumbPage.displayName = \"BreadcrumbPage\"\n\nconst BreadcrumbSeparator = ({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) => (\n  <li\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"[&>svg]:w-3.5 [&>svg]:h-3.5\", className)}\n    {...props}\n  >\n    {children ?? <ChevronRight />}\n  </li>\n)\nBreadcrumbSeparator.displayName = \"BreadcrumbSeparator\"\n\nconst BreadcrumbEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More</span>\n  </span>\n)\nBreadcrumbEllipsis.displayName = \"BreadcrumbElipssis\"\n\nexport {\n  Breadcrumb,\n  BreadcrumbList,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n  BreadcrumbEllipsis,\n}\n","path":null,"size_bytes":2712,"size_tokens":null},"client/src/components/agent/AgentCard.tsx":{"content":"import { Link } from \"wouter\";\nimport { Agent } from \"@shared/schema\";\nimport { Card } from \"@/components/ui/card\";\nimport { Phone, Mail } from \"lucide-react\";\n\ninterface AgentCardProps {\n  agent: Agent;\n}\n\nconst AgentCard = ({ agent }: AgentCardProps) => {\n  return (\n    <Card className=\"bg-white rounded-lg overflow-hidden shadow-md hover:shadow-lg transition text-center\">\n      <div className=\"h-64 overflow-hidden\">\n        <img \n          src={agent.imageUrl} \n          alt={agent.name} \n          className=\"w-full h-full object-cover object-center\"\n        />\n      </div>\n      <div className=\"p-6\">\n        <Link href={`/agents/${agent.id}`}>\n          <h3 className=\"text-xl font-bold mb-1 hover:text-primary transition-colors cursor-pointer\">\n            {agent.name}\n          </h3>\n        </Link>\n        <p className=\"text-primary font-medium mb-3\">{agent.title}</p>\n        <p className=\"text-gray-medium mb-4\">{agent.description}</p>\n        <div className=\"flex justify-center space-x-3\">\n          <a href={`tel:${agent.phone}`} className=\"text-dark hover:text-primary\">\n            <Phone className=\"h-5 w-5\" />\n          </a>\n          <a href={`mailto:${agent.email}`} className=\"text-dark hover:text-primary\">\n            <Mail className=\"h-5 w-5\" />\n          </a>\n        </div>\n      </div>\n    </Card>\n  );\n};\n\nexport default AgentCard;\n","path":null,"size_bytes":1367,"size_tokens":null},"server/storage.ts":{"content":"import { \n  properties, type Property, type InsertProperty,\n  // agents 삭제됨\n  inquiries, type Inquiry, type InsertInquiry,\n  // testimonials 삭제됨\n  users, type User, type InsertUser,\n  news, type News, type InsertNews,\n  propertyInquiries, type PropertyInquiry, type InsertPropertyInquiry,\n  favorites, type Favorite, type InsertFavorite\n} from \"@shared/schema\";\nimport { db, pool } from \"./db\";\nimport { eq, desc, asc, and, gte, lte, like, inArray } from \"drizzle-orm\";\nimport session from \"express-session\";\nimport connectPg from \"connect-pg-simple\";\nimport { scrypt, randomBytes, timingSafeEqual } from \"crypto\";\nimport { promisify } from \"util\";\n\nconst scryptAsync = promisify(scrypt);\n\nasync function hashPassword(password: string) {\n  const salt = randomBytes(16).toString(\"hex\");\n  const buf = (await scryptAsync(password, salt, 64)) as Buffer;\n  return `${buf.toString(\"hex\")}.${salt}`;\n}\n\nconst PostgresSessionStore = connectPg(session);\n\nexport interface IStorage {\n  // Session Store\n  sessionStore: session.Store;\n\n  // Property methods\n  getProperties(): Promise<Property[]>;\n  getAllProperties(): Promise<Property[]>;\n  getProperty(id: number): Promise<Property | undefined>;\n  getFeaturedProperties(limit?: number): Promise<Property[]>;\n  getPropertiesByType(type: string): Promise<Property[]>;\n  getPropertiesByDistrict(district: string): Promise<Property[]>;\n  getPropertiesByPriceRange(min: number, max: number): Promise<Property[]>;\n  createProperty(property: InsertProperty): Promise<Property>;\n  updateProperty(id: number, property: Partial<InsertProperty>): Promise<Property | undefined>;\n  deleteProperty(id: number): Promise<boolean>;\n  updatePropertyOrder(propertyId: number, newOrder: number): Promise<boolean>;\n  togglePropertyVisibility(propertyId: number, isVisible: boolean): Promise<boolean>;\n  togglePropertyFeatured(propertyId: number, featured: boolean): Promise<boolean>;\n  \n  // Agent methods - 제거됨\n  \n  // Inquiry methods\n  getInquiries(): Promise<Inquiry[]>;\n  getInquiry(id: number): Promise<Inquiry | undefined>;\n  createInquiry(inquiry: InsertInquiry): Promise<Inquiry>;\n  \n  // Testimonial methods - 제거됨\n  \n  // User methods\n  getUser(id: number): Promise<User | undefined>;\n  getUserByUsername(username: string): Promise<User | undefined>;\n  createUser(user: InsertUser): Promise<User>;\n  getAllUsers(): Promise<User[]>;\n  updateUser(id: number, user: Partial<InsertUser>): Promise<User | undefined>;\n  deleteUser(id: number): Promise<boolean>;\n\n  // News methods\n  getNews(): Promise<News[]>;\n  getLatestNews(limit?: number): Promise<News[]>;\n  getNewsById(id: number): Promise<News | undefined>;\n  getNewsByCategory(category: string): Promise<News[]>;\n  createNews(news: InsertNews): Promise<News>;\n  updateNews(id: number, news: Partial<InsertNews>): Promise<News | undefined>;\n  deleteNews(id: number): Promise<boolean>;\n  \n  // Property Inquiry methods\n  getPropertyInquiries(propertyId: number): Promise<PropertyInquiry[]>;\n  getPropertyInquiry(id: number): Promise<PropertyInquiry | undefined>;\n  createPropertyInquiry(inquiry: InsertPropertyInquiry): Promise<PropertyInquiry>;\n  updatePropertyInquiry(id: number, inquiry: Partial<InsertPropertyInquiry>): Promise<PropertyInquiry | undefined>;\n  deletePropertyInquiry(id: number): Promise<boolean>;\n  \n  // Favorites methods\n  getUserFavorites(userId: number): Promise<Favorite[]>;\n  getFavoriteProperties(userId: number): Promise<Property[]>;\n  isFavorite(userId: number, propertyId: number): Promise<boolean>;\n  addFavorite(favorite: InsertFavorite): Promise<Favorite>;\n  removeFavorite(userId: number, propertyId: number): Promise<boolean>;\n  \n  // Init Data\n  initializeData(): Promise<void>;\n}\n\nexport class DatabaseStorage implements IStorage {\n  sessionStore: session.Store;\n  \n  constructor() {\n    // 세션 저장소 설정 (PostgreSQL) - cookie_parse, serializer 옵션 추가\n    this.sessionStore = new PostgresSessionStore({\n      pool,\n      createTableIfMissing: true,\n      tableName: 'session', // 테이블 이름 명시적 지정\n      schemaName: 'public', // 스키마 명시적 지정\n    });\n  }\n  \n  // Property methods\n  async getProperties(): Promise<Property[]> {\n    const results = await db.select()\n      .from(properties)\n      .where(eq(properties.isVisible, true))\n      .orderBy(asc(properties.displayOrder), desc(properties.createdAt));\n    \n    // 호환성을 위해 각 속성에 imageUrls 필드를 추가합니다\n    return results.map(property => ({\n      ...property,\n      imageUrls: property.imageUrls || [] // imageUrls가 null이면 빈 배열로 초기화\n    }));\n  }\n\n  async getAllProperties(): Promise<Property[]> {\n    const results = await db.select().from(properties).orderBy(asc(properties.displayOrder), desc(properties.createdAt));\n    \n    // 호환성을 위해 각 속성에 imageUrls 필드를 추가합니다\n    return results.map(property => ({\n      ...property,\n      imageUrls: property.imageUrls || [] // imageUrls가 null이면 빈 배열로 초기화\n    }));\n  }\n  \n  async getProperty(id: number): Promise<Property | undefined> {\n    const result = await db.select().from(properties).where(eq(properties.id, id));\n    \n    if (!result[0]) return undefined;\n    \n    // 호환성을 위해 imageUrls 필드를 추가합니다\n    return {\n      ...result[0],\n      imageUrls: result[0].imageUrls || [] // imageUrls가 null이면 빈 배열로 초기화\n    };\n  }\n  \n  async getFeaturedProperties(limit: number = 20): Promise<Property[]> {\n    const results = await db.select()\n      .from(properties)\n      .where(and(eq(properties.featured, true), eq(properties.isVisible, true)))\n      .orderBy(asc(properties.displayOrder), desc(properties.createdAt))\n      .limit(limit);\n      \n    // 호환성을 위해 각 속성에 imageUrls 필드를 추가합니다\n    return results.map(property => ({\n      ...property,\n      imageUrls: property.imageUrls || [] // imageUrls가 null이면 빈 배열로 초기화\n    }));\n  }\n  \n  async getPropertiesByType(type: string): Promise<Property[]> {\n    const results = await db.select()\n      .from(properties)\n      .where(and(eq(properties.type, type), eq(properties.isVisible, true)))\n      .orderBy(asc(properties.displayOrder), desc(properties.createdAt));\n      \n    // 호환성을 위해 각 속성에 imageUrls 필드를 추가합니다  \n    return results.map(property => ({\n      ...property,\n      imageUrls: property.imageUrls || []\n    }));\n  }\n  \n  async getPropertiesByDistrict(district: string): Promise<Property[]> {\n    const results = await db.select()\n      .from(properties)\n      .where(and(eq(properties.district, district), eq(properties.isVisible, true)))\n      .orderBy(asc(properties.displayOrder), desc(properties.createdAt));\n      \n    // 호환성을 위해 각 속성에 imageUrls 필드를 추가합니다\n    return results.map(property => ({\n      ...property,\n      imageUrls: property.imageUrls || []\n    }));\n  }\n  \n  async getPropertiesByPriceRange(min: number, max: number): Promise<Property[]> {\n    const results = await db.select()\n      .from(properties)\n      .where(\n        and(\n          gte(properties.price, min.toString()),\n          lte(properties.price, max.toString()),\n          eq(properties.isVisible, true)\n        )\n      )\n      .orderBy(asc(properties.displayOrder), desc(properties.createdAt));\n      \n    // 호환성을 위해 각 속성에 imageUrls 필드를 추가합니다\n    return results.map(property => ({\n      ...property,\n      imageUrls: property.imageUrls || []\n    }));\n  }\n  \n  async createProperty(property: InsertProperty): Promise<Property> {\n    // imageUrls 필드가 없거나 유효하지 않으면 빈 배열로 설정\n    const propertyWithDefaultValues = {\n      ...property,\n      imageUrls: property.imageUrls || [],\n      createdAt: new Date()\n    };\n    \n    const result = await db.insert(properties)\n      .values(propertyWithDefaultValues)\n      .returning();\n    \n    // 호환성을 위해 imageUrls 필드가 있는지 확인\n    return {\n      ...result[0],\n      imageUrls: result[0].imageUrls || []\n    };\n  }\n  \n  async updateProperty(id: number, property: Partial<InsertProperty>): Promise<Property | undefined> {\n    const result = await db.update(properties)\n      .set(property)\n      .where(eq(properties.id, id))\n      .returning();\n    \n    return result[0];\n  }\n  \n  async deleteProperty(id: number): Promise<boolean> {\n    const result = await db.delete(properties)\n      .where(eq(properties.id, id))\n      .returning();\n    \n    return result.length > 0;\n  }\n\n  async updatePropertyOrder(propertyId: number, newOrder: number): Promise<boolean> {\n    const result = await db.update(properties)\n      .set({ displayOrder: newOrder })\n      .where(eq(properties.id, propertyId))\n      .returning();\n    \n    return result.length > 0;\n  }\n\n  async togglePropertyVisibility(propertyId: number, isVisible: boolean): Promise<boolean> {\n    const result = await db.update(properties)\n      .set({ isVisible })\n      .where(eq(properties.id, propertyId))\n      .returning();\n    \n    return result.length > 0;\n  }\n\n  async togglePropertyFeatured(propertyId: number, featured: boolean): Promise<boolean> {\n    const result = await db.update(properties)\n      .set({ featured })\n      .where(eq(properties.id, propertyId))\n      .returning();\n    \n    return result.length > 0;\n  }\n  \n  // Agent methods - 제거됨\n  \n  // Inquiry methods\n  async getInquiries(): Promise<Inquiry[]> {\n    return await db.select().from(inquiries).orderBy(desc(inquiries.createdAt));\n  }\n  \n  async getInquiry(id: number): Promise<Inquiry | undefined> {\n    const result = await db.select().from(inquiries).where(eq(inquiries.id, id));\n    return result[0];\n  }\n  \n  async createInquiry(inquiry: InsertInquiry): Promise<Inquiry> {\n    const result = await db.insert(inquiries)\n      .values({\n        ...inquiry,\n        createdAt: new Date()\n      })\n      .returning();\n    \n    return result[0];\n  }\n  \n  // Testimonial methods - 제거됨\n  \n  // User methods\n  async getUser(id: number): Promise<User | undefined> {\n    const result = await db.select().from(users).where(eq(users.id, id));\n    return result[0];\n  }\n  \n  async getUserByUsername(username: string): Promise<User | undefined> {\n    const result = await db.select().from(users).where(eq(users.username, username));\n    return result[0];\n  }\n  \n  async createUser(insertUser: InsertUser): Promise<User> {\n    const result = await db.insert(users)\n      .values({\n        ...insertUser,\n        role: insertUser.role || \"user\"\n      })\n      .returning();\n    \n    return result[0];\n  }\n  \n  async getAllUsers(): Promise<User[]> {\n    return await db.select().from(users);\n  }\n  \n  async updateUser(id: number, userData: Partial<InsertUser>): Promise<User | undefined> {\n    const result = await db.update(users)\n      .set(userData)\n      .where(eq(users.id, id))\n      .returning();\n    \n    return result[0];\n  }\n  \n  async deleteUser(id: number): Promise<boolean> {\n    const result = await db.delete(users)\n      .where(eq(users.id, id))\n      .returning();\n    \n    return result.length > 0;\n  }\n  \n  // News methods\n  async getNews(): Promise<News[]> {\n    try {\n      return await db.select().from(news).orderBy(desc(news.createdAt));\n    } catch (error) {\n      console.error(\"Error fetching news:\", error);\n      return [];\n    }\n  }\n  \n  async getLatestNews(limit: number = 6): Promise<News[]> {\n    try {\n      return await db.select()\n        .from(news)\n        .orderBy(desc(news.createdAt))\n        .limit(limit);\n    } catch (error) {\n      console.error(\"Error fetching latest news:\", error);\n      return [];\n    }\n  }\n  \n  async getNewsById(id: number): Promise<News | undefined> {\n    try {\n      const result = await db.select().from(news).where(eq(news.id, id));\n      return result[0];\n    } catch (error) {\n      console.error(\"Error fetching news by id:\", error);\n      return undefined;\n    }\n  }\n  \n  async getNewsByCategory(category: string): Promise<News[]> {\n    try {\n      return await db.select()\n        .from(news)\n        .where(eq(news.category, category))\n        .orderBy(desc(news.createdAt));\n    } catch (error) {\n      console.error(\"Error fetching news by category:\", error);\n      return [];\n    }\n  }\n  \n  async createNews(newsItem: InsertNews): Promise<News> {\n    try {\n      const result = await db.insert(news)\n        .values({\n          ...newsItem,\n          createdAt: new Date()\n        })\n        .returning();\n      \n      return result[0];\n    } catch (error) {\n      console.error(\"Error creating news:\", error);\n      throw error;\n    }\n  }\n  \n  async updateNews(id: number, newsItem: Partial<InsertNews>): Promise<News | undefined> {\n    try {\n      const result = await db.update(news)\n        .set(newsItem)\n        .where(eq(news.id, id))\n        .returning();\n      \n      return result[0];\n    } catch (error) {\n      console.error(\"Error updating news:\", error);\n      return undefined;\n    }\n  }\n  \n  async deleteNews(id: number): Promise<boolean> {\n    try {\n      const result = await db.delete(news)\n        .where(eq(news.id, id))\n        .returning();\n      \n      return result.length > 0;\n    } catch (error) {\n      console.error(\"Error deleting news:\", error);\n      return false;\n    }\n  }\n  \n  // 초기 데이터 설정\n  async initializeData(): Promise<void> {\n    // 관리자 계정 생성\n    const adminUser = await this.getUserByUsername(\"admin\");\n    if (!adminUser) {\n      await this.createUser({\n        username: \"admin\",\n        password: await hashPassword(\"adminpass\"),\n        role: \"admin\"\n      });\n      \n      // 일반 사용자 계정 생성\n      await this.createUser({\n        username: \"user\",\n        password: await hashPassword(\"userpass\"),\n        role: \"user\"\n      });\n      \n      // 중개사 데이터 - 제거됨\n      \n      // 부동산 데이터\n      const properties: InsertProperty[] = [\n        {\n          title: \"강남 푸르지오 아파트\",\n          description: \"넓은 공간과 현대적인 인테리어를 갖춘 강남 푸르지오 아파트입니다. 역삼역에서 도보 5분 거리에 위치하여 교통이 매우 편리하며, 인근에 상업시설과 학교가 있어 생활환경이 좋습니다.\",\n          type: \"아파트\",\n          price: \"950000000\",\n          address: \"서울시 강남구 역삼동 123-45\",\n          district: \"강남구\",\n          size: \"84.12\",\n          bedrooms: 3,\n          bathrooms: 2,\n          imageUrl: \"https://images.unsplash.com/photo-1592595896616-c37162298647?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=800&h=500\",\n          featured: true\n        },\n        {\n          title: \"서초구 단독주택\",\n          description: \"서초구 방배동에 위치한 고급 단독주택입니다. 넓은 정원과 현대적인 인테리어가 특징이며, 조용한 주택가에 위치하여 편안한 주거환경을 제공합니다.\",\n          type: \"주택\",\n          price: \"1580000000\",\n          address: \"서울시 서초구 방배동 456-78\",\n          district: \"서초구\",\n          size: \"165.3\",\n          bedrooms: 4,\n          bathrooms: 3,\n          imageUrl: \"https://images.unsplash.com/photo-1570129477492-45c003edd2be?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=800&h=500\",\n          featured: true\n        },\n        {\n          title: \"마포구 오피스텔\",\n          description: \"홍대입구역 인근에 위치한 신축 오피스텔입니다. 효율적인 공간 활용과 세련된 디자인이 돋보이며, 월세 수익률이 높아 투자 가치가 높습니다.\",\n          type: \"오피스텔\",\n          price: \"320000000\",\n          address: \"서울시 마포구 서교동 789-12\",\n          district: \"마포구\",\n          size: \"45.9\",\n          bedrooms: 1,\n          bathrooms: 1,\n          imageUrl: \"https://images.unsplash.com/photo-1560518883-ce09059eeffa?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=800&h=500\",\n          featured: true\n        },\n        {\n          title: \"용산구 래미안 아파트\",\n          description: \"한강 조망이 가능한 용산구 래미안 아파트입니다. 한남동에 위치하여 접근성이 좋으며, 다양한 편의시설과 쾌적한 환경을 제공합니다.\",\n          type: \"아파트\",\n          price: \"1230000000\",\n          address: \"서울시 용산구 한남동 101-23\",\n          district: \"용산구\",\n          size: \"109.5\",\n          bedrooms: 4,\n          bathrooms: 2,\n          imageUrl: \"https://images.unsplash.com/photo-1512917774080-9991f1c4c750?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=800&h=500\",\n          featured: true\n        },\n        {\n          title: \"성북구 한옥 빌라\",\n          description: \"전통적 한옥 스타일을 현대적으로 재해석한 성북구 한옥 빌라입니다. 조용한 주거환경과 함께 전통미와 현대적 편의성을 동시에 누릴 수 있습니다.\",\n          type: \"빌라\",\n          price: \"750000000\",\n          address: \"서울시 성북구 성북동 345-67\",\n          district: \"성북구\",\n          size: \"92.7\",\n          bedrooms: 3,\n          bathrooms: 2,\n          imageUrl: \"https://images.unsplash.com/photo-1580587771525-78b9dba3b914?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=800&h=500\",\n          featured: true\n        },\n        {\n          title: \"송파구 롯데캐슬 펜트하우스\",\n          description: \"송파구 잠실동에 위치한 롯데캐슬 펜트하우스입니다. 탁트인 전망과 고급스러운 인테리어가 특징이며, 최상의 주거 환경을 제공합니다.\",\n          type: \"펜트하우스\",\n          price: \"2500000000\",\n          address: \"서울시 송파구 잠실동 678-90\",\n          district: \"송파구\",\n          size: \"198.3\",\n          bedrooms: 5,\n          bathrooms: 3,\n          imageUrl: \"https://images.unsplash.com/photo-1493809842364-78817add7ffb?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=800&h=500\",\n          featured: true\n        }\n      ];\n      \n      for (const property of properties) {\n        await this.createProperty(property);\n      }\n      \n      // 후기 데이터 - 제거됨\n      \n      // 뉴스 데이터\n      const newsItems: InsertNews[] = [\n        {\n          title: \"인천시, 강화군 지역 부동산 개발 계획 발표\",\n          summary: \"인천시가 강화군 지역 부동산 개발을 위한 새로운 계획을 발표했습니다.\",\n          description: \"인천광역시가 강화군 지역 발전을 위한 대규모 부동산 개발 계획을 발표했습니다. 이번 계획은 지역 경제 활성화와 관광객 유치에 중점을 두고 있습니다.\",\n          content: \"인천광역시는 오늘 강화군 지역 발전을 위한 새로운 부동산 개발 계획을 발표했습니다. 이 계획에 따르면 강화군 내 유휴 부지를 활용한 복합 문화 공간과 관광 시설이 들어설 예정입니다.\\n\\n시 관계자는 \\\"이번 개발을 통해 강화군의 관광 인프라를 확충하고 지역 경제에 활력을 불어넣을 것\\\"이라고 밝혔습니다. 총 사업비는 약 2,000억원으로 예상되며, 2026년까지 단계적으로 진행될 예정입니다.\\n\\n특히 강화읍 일대에는 전통 한옥 스타일의 숙박 시설과 문화 체험 공간이 조성되어 역사 관광과 연계된 개발이 이루어질 계획입니다.\",\n          source: \"인천일보\",\n          sourceUrl: \"https://www.incheonilbo.com\",\n          url: \"https://www.incheonilbo.com/news/article/property-development-plan\",\n          imageUrl: \"https://images.unsplash.com/photo-1460317442991-0ec209397118?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=800&h=500\",\n          category: \"인천 부동산\",\n          isPinned: true\n        },\n        {\n          title: \"강화도 부동산 시장 동향: 전년 대비 거래량 15% 증가\",\n          summary: \"강화도 지역 부동산 거래량이 전년 동기 대비 15% 증가한 것으로 나타났습니다.\",\n          description: \"최근 발표된 부동산 통계에 따르면 강화도 지역의 부동산 거래량이 전년 동기 대비 15% 증가했습니다. 특히 단독주택과 토지 거래가 크게 늘어난 것으로 조사되었습니다.\",\n          content: \"한국부동산원이 발표한 최근 통계에 따르면, 강화도 지역의 부동산 거래량이 전년 동기 대비 15% 증가한 것으로 나타났습니다. 특히 단독주택과 토지 거래가 각각 22%, 18% 증가하며 전체 거래량 상승을 이끌었습니다.\\n\\n전문가들은 이러한 증가세의 배경으로 코로나19 이후 교외 주거 선호도 증가와 강화도의 개발 호재가 복합적으로 작용했다고 분석합니다.\\n\\n또한 정부의 규제 완화 정책과 금리 인하 기조도 거래량 증가에 영향을 미친 것으로 보입니다. 부동산 업계 관계자들은 \\\"강화도는 수도권과의 접근성이 개선되고 있고, 자연환경이 우수해 실거주 목적의 매수세가 꾸준히 유입되고 있다\\\"고 설명했습니다.\",\n          source: \"부동산 뉴스\",\n          sourceUrl: \"https://www.realestate-news.kr\",\n          url: \"https://www.realestate-news.kr/news/article/ganghwa-property-trend\",\n          imageUrl: \"https://images.unsplash.com/photo-1560518883-ce09059eeffa?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=800&h=500\",\n          category: \"강화군 부동산\",\n          isPinned: false\n        },\n        {\n          title: \"국토부, 부동산 정책 방향 재설정...규제 완화 기조 유지\",\n          summary: \"국토교통부가 부동산 시장 안정을 위한 새로운 정책 방향을 발표했습니다.\",\n          description: \"국토교통부가 부동산 시장 안정과 거래 활성화를 위한 새로운 정책 방향을 발표했습니다. 기존의 규제 완화 기조를 유지하면서 실수요자 중심의 정책을 강화할 예정입니다.\",\n          content: \"국토교통부는 어제 부동산 시장 안정과 거래 활성화를 위한 새로운 정책 방향을 발표했습니다. 이번 발표에 따르면, 정부는 기존의 규제 완화 기조를 유지하면서도 실수요자 중심의 정책을 더욱 강화할 예정입니다.\\n\\n주요 내용으로는 1) 생애 첫 주택 구매자에 대한 금융 지원 확대, 2) 재건축·재개발 절차 간소화, 3) 공공주택 공급 확대 등이 포함되었습니다.\\n\\n국토부 관계자는 \\\"부동산 시장이 점차 안정을 찾아가고 있으나, 여전히 실수요자들의 내 집 마련 부담은 높은 상황\\\"이라며 \\\"이번 정책을 통해 실수요자 중심의 시장 형성을 유도할 것\\\"이라고 밝혔습니다.\\n\\n전문가들은 이번 정책이 단기적으로는 시장에 긍정적 영향을 줄 수 있지만, 장기적인 시장 안정을 위해서는 공급 물량 확대가 관건이라고 지적하고 있습니다.\",\n          source: \"국토교통부\",\n          sourceUrl: \"https://www.molit.go.kr\",\n          url: \"https://www.molit.go.kr/news/article/property-policy-direction\",\n          imageUrl: \"https://images.unsplash.com/photo-1592595896616-c37162298647?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=800&h=500\",\n          category: \"부동산 정책\",\n          isPinned: false\n        },\n        {\n          title: \"강화군, 친환경 스마트시티 조성 추진\",\n          summary: \"강화군이 지역 활성화를 위한 친환경 스마트시티 조성 계획을 발표했습니다.\",\n          description: \"강화군이 지역 경제 활성화와 미래 성장 동력 확보를 위한 친환경 스마트시티 조성 계획을 발표했습니다. 2027년까지 약 3,000억원이 투입될 예정입니다.\",\n          content: \"강화군은 지난 25일 지역 경제 활성화와 미래 성장 동력 확보를 위한 '강화 그린 스마트시티' 조성 계획을 발표했습니다. 이 계획에 따르면 강화읍 일대 약 50만㎡ 부지에 친환경 주거단지와 스마트 농업 단지, 관광 인프라가 조성됩니다.\\n\\n총 사업비는 약 3,000억원으로, 2023년부터 2027년까지 단계적으로 진행될 예정입니다. 특히 재생에너지를 활용한 에너지 자립형 주거 환경과 IoT 기술을 접목한 스마트팜 단지가 핵심 사업으로 추진됩니다.\\n\\n강화군 관계자는 \\\"이번 사업을 통해 강화군을 수도권의 대표적인 친환경 미래 도시로 발전시키고, 청년층의 유입과 일자리 창출 효과도 기대하고 있다\\\"고 밝혔습니다.\\n\\n부동산 전문가들은 이번 계획이 실현될 경우 강화 지역의 부동산 가치 상승과 지역 경제 활성화에 긍정적인 영향을 미칠 것으로 전망하고 있습니다.\",\n          source: \"강화군청\",\n          sourceUrl: \"https://www.ganghwa.go.kr\",\n          url: \"https://www.ganghwa.go.kr/news/article/smart-city-plan\",\n          imageUrl: \"https://images.unsplash.com/photo-1542889601-399c4f3a8402?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=800&h=500\",\n          category: \"강화군 부동산\",\n          isPinned: true\n        },\n        {\n          title: \"인천 지역 아파트 매매가 6개월 연속 상승세\",\n          summary: \"인천 지역 아파트 매매가격이 6개월 연속 상승세를 이어가고 있습니다.\",\n          description: \"한국부동산원 통계에 따르면 인천 지역 아파트 매매가격이 6개월 연속 상승세를 기록했습니다. 특히 송도, 청라 지역의 상승폭이 두드러진 것으로 나타났습니다.\",\n          content: \"한국부동산원이 발표한 최근 주간 아파트 가격 동향에 따르면, 인천 지역 아파트 매매가격이 6개월 연속 상승세를 기록하고 있습니다. 지난달 기준 인천 아파트 매매가격은 전월 대비 0.38% 상승했으며, 특히 송도와 청라 지역은 각각 0.62%, 0.57%로 상승폭이 더 컸습니다.\\n\\n이러한 상승세의 배경으로는 정부의 규제 완화 정책과 GTX 등 교통 인프라 개선 기대감, 상대적으로 서울보다 저렴한 가격대 등이 복합적으로 작용한 것으로 분석됩니다.\\n\\n부동산 전문가들은 \\\"인천은 서울에 비해 가격 메리트가 있고, 교통 개선과 신도시 개발 등 호재가 많아 당분간 상승세가 이어질 가능성이 높다\\\"고 전망했습니다.\\n\\n다만 일부 전문가들은 금리 인상과 경기 침체 우려 등 대외 변수가 있어 하반기에는 상승폭이 제한될 수 있다고 조심스럽게 전망하고 있습니다.\",\n          source: \"인천경제\",\n          sourceUrl: \"https://www.incheoneconomy.com\",\n          url: \"https://www.incheoneconomy.com/news/article/apartment-price-trend\",\n          imageUrl: \"https://images.unsplash.com/photo-1519501025264-65ba15a82390?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=800&h=500\",\n          category: \"인천 부동산\",\n          isPinned: false\n        },\n        {\n          title: \"정부, 농어촌 빈집 활용 지원사업 예산 확대\",\n          summary: \"농림축산식품부가 농어촌 빈집 활용 지원사업 예산을 전년 대비 30% 확대했습니다.\",\n          description: \"농림축산식품부가 농어촌 지역 빈집 활용을 위한 지원사업 예산을 전년 대비 30% 확대했습니다. 강화군을 비롯한 농어촌 지역의 주거환경 개선과 관광자원화를 추진합니다.\",\n          content: \"농림축산식품부는 농어촌 지역 빈집 활용을 위한 지원사업 예산을 전년 대비 30% 확대한 650억원으로 편성했다고 밝혔습니다. 이 사업은 농어촌 지역의 빈집을 리모델링하여 주거환경을 개선하고 관광자원으로 활용하는 것을 목표로 합니다.\\n\\n특히 강화군과 같은 수도권 인접 농어촌 지역은 우선 지원 대상으로 선정되었으며, 빈집을 활용한 게스트하우스, 농촌체험시설, 청년 창업 공간 등 다양한 용도로의 전환을 지원합니다.\\n\\n농식품부 관계자는 \\\"이번 사업을 통해 농어촌 지역의 빈집 문제를 해결하고, 동시에 지역 경제 활성화와 인구 유입 효과도 기대하고 있다\\\"고 설명했습니다.\\n\\n강화군 관계자는 \\\"강화도 내 노후 빈집을 활용한 특색있는 관광 숙박시설과 문화공간을 조성할 계획\\\"이라며, \\\"이를 통해 강화도의 관광 경쟁력을 높이고 농촌 지역의 새로운 가치를 창출할 것\\\"이라고 밝혔습니다.\",\n          source: \"농림축산식품부\",\n          sourceUrl: \"https://www.mafra.go.kr\",\n          url: \"https://www.mafra.go.kr/news/article/rural-empty-houses\",\n          imageUrl: \"https://images.unsplash.com/photo-1564013799919-ab600027ffc6?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=800&h=500\",\n          category: \"부동산 정책\",\n          isPinned: false\n        }\n      ];\n      \n      for (const newsItem of newsItems) {\n        await this.createNews(newsItem);\n      }\n    }\n  }\n  \n  // Property Inquiry methods\n  async getPropertyInquiries(propertyId: number): Promise<(PropertyInquiry & { authorUsername?: string })[]> {\n    try {\n      const inquiries = await db\n        .select({\n          id: propertyInquiries.id,\n          propertyId: propertyInquiries.propertyId,\n          userId: propertyInquiries.userId,\n          title: propertyInquiries.title,\n          content: propertyInquiries.content,\n          isReply: propertyInquiries.isReply,\n          parentId: propertyInquiries.parentId,\n          createdAt: propertyInquiries.createdAt,\n          authorUsername: users.username\n        })\n        .from(propertyInquiries)\n        .leftJoin(users, eq(propertyInquiries.userId, users.id))\n        .where(eq(propertyInquiries.propertyId, propertyId))\n        .orderBy(desc(propertyInquiries.createdAt));\n      return inquiries as (PropertyInquiry & { authorUsername?: string })[];\n    } catch (error) {\n      console.error(\"Error getting property inquiries:\", error);\n      return [];\n    }\n  }\n\n  async getPropertyInquiry(id: number): Promise<PropertyInquiry | undefined> {\n    try {\n      const [inquiry] = await db\n        .select()\n        .from(propertyInquiries)\n        .where(eq(propertyInquiries.id, id));\n      return inquiry;\n    } catch (error) {\n      console.error(\"Error getting property inquiry:\", error);\n      return undefined;\n    }\n  }\n\n  async createPropertyInquiry(inquiry: InsertPropertyInquiry): Promise<PropertyInquiry> {\n    try {\n      const [createdInquiry] = await db\n        .insert(propertyInquiries)\n        .values(inquiry)\n        .returning();\n      return createdInquiry;\n    } catch (error) {\n      console.error(\"Error creating property inquiry:\", error);\n      throw new Error(\"Failed to create property inquiry\");\n    }\n  }\n\n  async updatePropertyInquiry(\n    id: number,\n    inquiry: Partial<InsertPropertyInquiry>\n  ): Promise<PropertyInquiry | undefined> {\n    try {\n      const [updatedInquiry] = await db\n        .update(propertyInquiries)\n        .set(inquiry)\n        .where(eq(propertyInquiries.id, id))\n        .returning();\n      return updatedInquiry;\n    } catch (error) {\n      console.error(\"Error updating property inquiry:\", error);\n      return undefined;\n    }\n  }\n\n  async deletePropertyInquiry(id: number): Promise<boolean> {\n    try {\n      const result = await db\n        .delete(propertyInquiries)\n        .where(eq(propertyInquiries.id, id));\n      return true;\n    } catch (error) {\n      console.error(\"Error deleting property inquiry:\", error);\n      return false;\n    }\n  }\n\n  // 관리자용 문의글 관리 메서드\n  async getUnreadInquiries(): Promise<(PropertyInquiry & { authorUsername?: string; propertyTitle?: string })[]> {\n    try {\n      const inquiries = await db\n        .select({\n          id: propertyInquiries.id,\n          propertyId: propertyInquiries.propertyId,\n          userId: propertyInquiries.userId,\n          title: propertyInquiries.title,\n          content: propertyInquiries.content,\n          isReply: propertyInquiries.isReply,\n          parentId: propertyInquiries.parentId,\n          isReadByAdmin: propertyInquiries.isReadByAdmin,\n          createdAt: propertyInquiries.createdAt,\n          authorUsername: users.username,\n          propertyTitle: properties.title\n        })\n        .from(propertyInquiries)\n        .leftJoin(users, eq(propertyInquiries.userId, users.id))\n        .leftJoin(properties, eq(propertyInquiries.propertyId, properties.id))\n        .where(eq(propertyInquiries.isReadByAdmin, false))\n        .orderBy(desc(propertyInquiries.createdAt));\n      return inquiries as (PropertyInquiry & { authorUsername?: string; propertyTitle?: string })[];\n    } catch (error) {\n      console.error(\"Error getting unread inquiries:\", error);\n      return [];\n    }\n  }\n\n  async getUnreadInquiryCount(): Promise<number> {\n    try {\n      const result = await db\n        .select()\n        .from(propertyInquiries)\n        .where(eq(propertyInquiries.isReadByAdmin, false));\n      return result.length;\n    } catch (error) {\n      console.error(\"Error getting unread inquiry count:\", error);\n      return 0;\n    }\n  }\n\n  async markInquiryAsRead(id: number): Promise<boolean> {\n    try {  \n      await db\n        .update(propertyInquiries)\n        .set({ isReadByAdmin: true })\n        .where(eq(propertyInquiries.id, id));\n      return true;\n    } catch (error) {\n      console.error(\"Error marking inquiry as read:\", error);\n      return false;\n    }\n  }\n\n  async markAllInquiriesAsRead(): Promise<boolean> {\n    try {\n      await db\n        .update(propertyInquiries)\n        .set({ isReadByAdmin: true })\n        .where(eq(propertyInquiries.isReadByAdmin, false));\n      return true;\n    } catch (error) {\n      console.error(\"Error marking all inquiries as read:\", error);\n      return false;\n    }\n  }\n\n  // 관심 매물 (Favorites) 메서드\n  async getUserFavorites(userId: number): Promise<Favorite[]> {\n    try {\n      return await db.select()\n        .from(favorites)\n        .where(eq(favorites.userId, userId))\n        .orderBy(desc(favorites.createdAt));\n    } catch (error) {\n      console.error(\"Error fetching user favorites:\", error);\n      return [];\n    }\n  }\n  \n  async getFavoriteProperties(userId: number): Promise<Property[]> {\n    try {\n      const favs = await db.select({\n          propertyId: favorites.propertyId\n        })\n        .from(favorites)\n        .where(eq(favorites.userId, userId));\n      \n      if (favs.length === 0) return [];\n      \n      const propertyIds = favs.map(f => f.propertyId);\n      \n      const results = await db.select()\n        .from(properties)\n        .where(inArray(properties.id, propertyIds));\n      \n      // 호환성을 위한 imageUrls 처리\n      return results.map(property => ({\n        ...property,\n        imageUrls: property.imageUrls || []\n      }));\n    } catch (error) {\n      console.error(\"Error fetching favorite properties:\", error);\n      return [];\n    }\n  }\n  \n  async isFavorite(userId: number, propertyId: number): Promise<boolean> {\n    try {\n      const result = await db.select()\n        .from(favorites)\n        .where(and(\n          eq(favorites.userId, userId),\n          eq(favorites.propertyId, propertyId)\n        ));\n      \n      return result.length > 0;\n    } catch (error) {\n      console.error(\"Error checking if property is favorite:\", error);\n      return false;\n    }\n  }\n  \n  async addFavorite(favorite: InsertFavorite): Promise<Favorite> {\n    try {\n      // 이미 존재하는지 확인\n      const existing = await this.isFavorite(favorite.userId, favorite.propertyId);\n      if (existing) {\n        throw new Error(\"이미 관심 매물로 등록되어 있습니다.\");\n      }\n      \n      const result = await db.insert(favorites)\n        .values({\n          ...favorite,\n          createdAt: new Date()\n        })\n        .returning();\n      \n      return result[0];\n    } catch (error) {\n      console.error(\"Error adding favorite:\", error);\n      throw error;\n    }\n  }\n  \n  async removeFavorite(userId: number, propertyId: number): Promise<boolean> {\n    try {\n      const result = await db.delete(favorites)\n        .where(and(\n          eq(favorites.userId, userId),\n          eq(favorites.propertyId, propertyId)\n        ))\n        .returning();\n      \n      return result.length > 0;\n    } catch (error) {\n      console.error(\"Error removing favorite:\", error);\n      return false;\n    }\n  }\n}\n\nexport const storage = new DatabaseStorage();","path":null,"size_bytes":37208,"size_tokens":null},"client/src/components/ui/chart.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as RechartsPrimitive from \"recharts\"\n\nimport { cn } from \"@/lib/utils\"\n\n// Format: { THEME_NAME: CSS_SELECTOR }\nconst THEMES = { light: \"\", dark: \".dark\" } as const\n\nexport type ChartConfig = {\n  [k in string]: {\n    label?: React.ReactNode\n    icon?: React.ComponentType\n  } & (\n    | { color?: string; theme?: never }\n    | { color?: never; theme: Record<keyof typeof THEMES, string> }\n  )\n}\n\ntype ChartContextProps = {\n  config: ChartConfig\n}\n\nconst ChartContext = React.createContext<ChartContextProps | null>(null)\n\nfunction useChart() {\n  const context = React.useContext(ChartContext)\n\n  if (!context) {\n    throw new Error(\"useChart must be used within a <ChartContainer />\")\n  }\n\n  return context\n}\n\nconst ChartContainer = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    config: ChartConfig\n    children: React.ComponentProps<\n      typeof RechartsPrimitive.ResponsiveContainer\n    >[\"children\"]\n  }\n>(({ id, className, children, config, ...props }, ref) => {\n  const uniqueId = React.useId()\n  const chartId = `chart-${id || uniqueId.replace(/:/g, \"\")}`\n\n  return (\n    <ChartContext.Provider value={{ config }}>\n      <div\n        data-chart={chartId}\n        ref={ref}\n        className={cn(\n          \"flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none\",\n          className\n        )}\n        {...props}\n      >\n        <ChartStyle id={chartId} config={config} />\n        <RechartsPrimitive.ResponsiveContainer>\n          {children}\n        </RechartsPrimitive.ResponsiveContainer>\n      </div>\n    </ChartContext.Provider>\n  )\n})\nChartContainer.displayName = \"Chart\"\n\nconst ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {\n  const colorConfig = Object.entries(config).filter(\n    ([, config]) => config.theme || config.color\n  )\n\n  if (!colorConfig.length) {\n    return null\n  }\n\n  return (\n    <style\n      dangerouslySetInnerHTML={{\n        __html: Object.entries(THEMES)\n          .map(\n            ([theme, prefix]) => `\n${prefix} [data-chart=${id}] {\n${colorConfig\n  .map(([key, itemConfig]) => {\n    const color =\n      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||\n      itemConfig.color\n    return color ? `  --color-${key}: ${color};` : null\n  })\n  .join(\"\\n\")}\n}\n`\n          )\n          .join(\"\\n\"),\n      }}\n    />\n  )\n}\n\nconst ChartTooltip = RechartsPrimitive.Tooltip\n\nconst ChartTooltipContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &\n    React.ComponentProps<\"div\"> & {\n      hideLabel?: boolean\n      hideIndicator?: boolean\n      indicator?: \"line\" | \"dot\" | \"dashed\"\n      nameKey?: string\n      labelKey?: string\n    }\n>(\n  (\n    {\n      active,\n      payload,\n      className,\n      indicator = \"dot\",\n      hideLabel = false,\n      hideIndicator = false,\n      label,\n      labelFormatter,\n      labelClassName,\n      formatter,\n      color,\n      nameKey,\n      labelKey,\n    },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    const tooltipLabel = React.useMemo(() => {\n      if (hideLabel || !payload?.length) {\n        return null\n      }\n\n      const [item] = payload\n      const key = `${labelKey || item?.dataKey || item?.name || \"value\"}`\n      const itemConfig = getPayloadConfigFromPayload(config, item, key)\n      const value =\n        !labelKey && typeof label === \"string\"\n          ? config[label as keyof typeof config]?.label || label\n          : itemConfig?.label\n\n      if (labelFormatter) {\n        return (\n          <div className={cn(\"font-medium\", labelClassName)}>\n            {labelFormatter(value, payload)}\n          </div>\n        )\n      }\n\n      if (!value) {\n        return null\n      }\n\n      return <div className={cn(\"font-medium\", labelClassName)}>{value}</div>\n    }, [\n      label,\n      labelFormatter,\n      payload,\n      hideLabel,\n      labelClassName,\n      config,\n      labelKey,\n    ])\n\n    if (!active || !payload?.length) {\n      return null\n    }\n\n    const nestLabel = payload.length === 1 && indicator !== \"dot\"\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl\",\n          className\n        )}\n      >\n        {!nestLabel ? tooltipLabel : null}\n        <div className=\"grid gap-1.5\">\n          {payload.map((item, index) => {\n            const key = `${nameKey || item.name || item.dataKey || \"value\"}`\n            const itemConfig = getPayloadConfigFromPayload(config, item, key)\n            const indicatorColor = color || item.payload.fill || item.color\n\n            return (\n              <div\n                key={item.dataKey}\n                className={cn(\n                  \"flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground\",\n                  indicator === \"dot\" && \"items-center\"\n                )}\n              >\n                {formatter && item?.value !== undefined && item.name ? (\n                  formatter(item.value, item.name, item, index, item.payload)\n                ) : (\n                  <>\n                    {itemConfig?.icon ? (\n                      <itemConfig.icon />\n                    ) : (\n                      !hideIndicator && (\n                        <div\n                          className={cn(\n                            \"shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]\",\n                            {\n                              \"h-2.5 w-2.5\": indicator === \"dot\",\n                              \"w-1\": indicator === \"line\",\n                              \"w-0 border-[1.5px] border-dashed bg-transparent\":\n                                indicator === \"dashed\",\n                              \"my-0.5\": nestLabel && indicator === \"dashed\",\n                            }\n                          )}\n                          style={\n                            {\n                              \"--color-bg\": indicatorColor,\n                              \"--color-border\": indicatorColor,\n                            } as React.CSSProperties\n                          }\n                        />\n                      )\n                    )}\n                    <div\n                      className={cn(\n                        \"flex flex-1 justify-between leading-none\",\n                        nestLabel ? \"items-end\" : \"items-center\"\n                      )}\n                    >\n                      <div className=\"grid gap-1.5\">\n                        {nestLabel ? tooltipLabel : null}\n                        <span className=\"text-muted-foreground\">\n                          {itemConfig?.label || item.name}\n                        </span>\n                      </div>\n                      {item.value && (\n                        <span className=\"font-mono font-medium tabular-nums text-foreground\">\n                          {item.value.toLocaleString()}\n                        </span>\n                      )}\n                    </div>\n                  </>\n                )}\n              </div>\n            )\n          })}\n        </div>\n      </div>\n    )\n  }\n)\nChartTooltipContent.displayName = \"ChartTooltip\"\n\nconst ChartLegend = RechartsPrimitive.Legend\n\nconst ChartLegendContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> &\n    Pick<RechartsPrimitive.LegendProps, \"payload\" | \"verticalAlign\"> & {\n      hideIcon?: boolean\n      nameKey?: string\n    }\n>(\n  (\n    { className, hideIcon = false, payload, verticalAlign = \"bottom\", nameKey },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    if (!payload?.length) {\n      return null\n    }\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"flex items-center justify-center gap-4\",\n          verticalAlign === \"top\" ? \"pb-3\" : \"pt-3\",\n          className\n        )}\n      >\n        {payload.map((item) => {\n          const key = `${nameKey || item.dataKey || \"value\"}`\n          const itemConfig = getPayloadConfigFromPayload(config, item, key)\n\n          return (\n            <div\n              key={item.value}\n              className={cn(\n                \"flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground\"\n              )}\n            >\n              {itemConfig?.icon && !hideIcon ? (\n                <itemConfig.icon />\n              ) : (\n                <div\n                  className=\"h-2 w-2 shrink-0 rounded-[2px]\"\n                  style={{\n                    backgroundColor: item.color,\n                  }}\n                />\n              )}\n              {itemConfig?.label}\n            </div>\n          )\n        })}\n      </div>\n    )\n  }\n)\nChartLegendContent.displayName = \"ChartLegend\"\n\n// Helper to extract item config from a payload.\nfunction getPayloadConfigFromPayload(\n  config: ChartConfig,\n  payload: unknown,\n  key: string\n) {\n  if (typeof payload !== \"object\" || payload === null) {\n    return undefined\n  }\n\n  const payloadPayload =\n    \"payload\" in payload &&\n    typeof payload.payload === \"object\" &&\n    payload.payload !== null\n      ? payload.payload\n      : undefined\n\n  let configLabelKey: string = key\n\n  if (\n    key in payload &&\n    typeof payload[key as keyof typeof payload] === \"string\"\n  ) {\n    configLabelKey = payload[key as keyof typeof payload] as string\n  } else if (\n    payloadPayload &&\n    key in payloadPayload &&\n    typeof payloadPayload[key as keyof typeof payloadPayload] === \"string\"\n  ) {\n    configLabelKey = payloadPayload[\n      key as keyof typeof payloadPayload\n    ] as string\n  }\n\n  return configLabelKey in config\n    ? config[configLabelKey]\n    : config[key as keyof typeof config]\n}\n\nexport {\n  ChartContainer,\n  ChartTooltip,\n  ChartTooltipContent,\n  ChartLegend,\n  ChartLegendContent,\n  ChartStyle,\n}\n","path":null,"size_bytes":10481,"size_tokens":null},"client/src/components/ui/menubar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as MenubarPrimitive from \"@radix-ui/react-menubar\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction MenubarMenu({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Menu>) {\n  return <MenubarPrimitive.Menu {...props} />\n}\n\nfunction MenubarGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Group>) {\n  return <MenubarPrimitive.Group {...props} />\n}\n\nfunction MenubarPortal({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Portal>) {\n  return <MenubarPrimitive.Portal {...props} />\n}\n\nfunction MenubarRadioGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.RadioGroup>) {\n  return <MenubarPrimitive.RadioGroup {...props} />\n}\n\nfunction MenubarSub({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Sub>) {\n  return <MenubarPrimitive.Sub data-slot=\"menubar-sub\" {...props} />\n}\n\nconst Menubar = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"flex h-10 items-center space-x-1 rounded-md border bg-background p-1\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubar.displayName = MenubarPrimitive.Root.displayName\n\nconst MenubarTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName\n\nconst MenubarSubTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <MenubarPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </MenubarPrimitive.SubTrigger>\n))\nMenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName\n\nconst MenubarSubContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName\n\nconst MenubarContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>\n>(\n  (\n    { className, align = \"start\", alignOffset = -4, sideOffset = 8, ...props },\n    ref\n  ) => (\n    <MenubarPrimitive.Portal>\n      <MenubarPrimitive.Content\n        ref={ref}\n        align={align}\n        alignOffset={alignOffset}\n        sideOffset={sideOffset}\n        className={cn(\n          \"z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n          className\n        )}\n        {...props}\n      />\n    </MenubarPrimitive.Portal>\n  )\n)\nMenubarContent.displayName = MenubarPrimitive.Content.displayName\n\nconst MenubarItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarItem.displayName = MenubarPrimitive.Item.displayName\n\nconst MenubarCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <MenubarPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.CheckboxItem>\n))\nMenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName\n\nconst MenubarRadioItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <MenubarPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.RadioItem>\n))\nMenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName\n\nconst MenubarLabel = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarLabel.displayName = MenubarPrimitive.Label.displayName\n\nconst MenubarSeparator = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nMenubarSeparator.displayName = MenubarPrimitive.Separator.displayName\n\nconst MenubarShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nMenubarShortcut.displayname = \"MenubarShortcut\"\n\nexport {\n  Menubar,\n  MenubarMenu,\n  MenubarTrigger,\n  MenubarContent,\n  MenubarItem,\n  MenubarSeparator,\n  MenubarLabel,\n  MenubarCheckboxItem,\n  MenubarRadioGroup,\n  MenubarRadioItem,\n  MenubarPortal,\n  MenubarSubContent,\n  MenubarSubTrigger,\n  MenubarGroup,\n  MenubarSub,\n  MenubarShortcut,\n}\n","path":null,"size_bytes":8605,"size_tokens":null},"server/test-api.ts":{"content":"import fetch from 'node-fetch';\n\n/**\n * 다양한 API 접근 방식을 테스트하는 함수\n */\nexport async function testRealEstateAPI() {\n  const apiKey = process.env.DATA_GO_KR_API_KEY;\n  if (!apiKey) {\n    console.error('DATA_GO_KR_API_KEY 환경변수가 설정되지 않았습니다');\n    return;\n  }\n\n  console.log('새로운 API 키:', apiKey.substring(0, 10) + '...');\n\n  // 다양한 접근 방식 테스트 - 업데이트된 엔드포인트 및 키\n  const tests = [\n    {\n      name: '토지 실거래가 API (새로운 스타일)',\n      url: `https://api.odcloud.kr/api/RltmTradeInfoLandService/v1/getMTransaction?serviceKey=${apiKey}&page=1&perPage=10&LAWD_CD=28710&DEAL_YMD=202311`\n    },\n    {\n      name: '아파트 실거래가 API (새로운 스타일)',\n      url: `https://api.odcloud.kr/api/ApplyhomeInfoDetailSvc/v1/getAPTLttotPblancDetail?serviceKey=${apiKey}&page=1&perPage=10`\n    },\n    {\n      name: '단독/다가구 실거래가 API (구 스타일)',\n      url: `http://openapi.molit.go.kr:8081/OpenAPI_ToolInstallPackage/service/rest/RTMSOBJSvc/getRTMSDataSvcSHTrade?serviceKey=${apiKey}&LAWD_CD=28710&DEAL_YMD=202311`\n    },\n    {\n      name: '토지 실거래가 API + 인코딩 키 (신 스타일)',\n      url: `https://apis.data.go.kr/1613000/RTMSDataSvcLandTrade/getLandTrade?serviceKey=${apiKey}&LAWD_CD=28710&DEAL_YMD=202503&numOfRows=10&pageNo=1`\n    },\n    {\n      name: '아파트 실거래가 API + 인코딩 키 (신 스타일)',\n      url: `https://apis.data.go.kr/1613000/AptTradeSvc/getAptTrade?serviceKey=${apiKey}&LAWD_CD=28710&DEAL_YMD=202503&numOfRows=10&pageNo=1`\n    },\n    {\n      name: '날씨 API 테스트',\n      url: `http://apis.data.go.kr/1360000/VilageFcstInfoService_2.0/getUltraSrtNcst?serviceKey=${apiKey}&numOfRows=10&pageNo=1&base_date=20240514&base_time=0600&nx=55&ny=127`\n    }\n  ];\n\n  // 모든 방법 테스트\n  for (const test of tests) {\n    console.log(`\\n\\n테스트: ${test.name}`);\n    console.log(`URL: ${test.url}`);\n    \n    try {\n      const response = await fetch(test.url, {\n        method: 'GET',\n        headers: {\n          'Accept': 'application/xml',\n          'Content-Type': 'application/xml',\n          'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36'\n        }\n      });\n      \n      console.log(`상태 코드: ${response.status} ${response.statusText}`);\n      \n      const text = await response.text();\n      console.log(`응답 일부: ${text.substring(0, 300)}...`);\n\n      // XML에 OpenAPI_ServiceResponse가 포함되어 있는지 확인\n      if (text.includes('<OpenAPI_ServiceResponse>')) {\n        console.log('✅ API 응답 형식 확인됨: OpenAPI_ServiceResponse 포함');\n      }\n      // XML에 response가 포함되어 있는지 확인\n      else if (text.includes('<response>')) {\n        console.log('✅ API 응답 형식 확인됨: response 포함');\n      }\n      // XML 형식이 아닌 경우\n      else if (!text.includes('<?xml')) {\n        console.log('❌ XML 형식이 아님');\n      }\n      else {\n        console.log('❓ 알 수 없는 응답 형식');\n      }\n\n      // 오류 메시지 포함 여부 확인\n      if (text.includes('SERVICE ERROR') || text.includes('SERVICE_KEY_IS_NOT_REGISTERED')) {\n        console.log('❌ 서비스 키 오류 포함됨');\n      }\n      else if (text.includes('LIMITED_NUMBER_OF_SERVICE_REQUESTS_EXCEEDS')) {\n        console.log('❌ 요청 횟수 초과됨');\n      }\n      else if (text.includes('NO_MANDATORY_REQUEST_PARAMETERS_ERROR')) {\n        console.log('❌ 필수 파라미터 누락됨');\n      }\n      else if (text.includes('INVALID_REQUEST_PARAMETER_ERROR')) {\n        console.log('❌ 잘못된 파라미터 값');\n      }\n      \n    } catch (error) {\n      console.error(`❌ 오류 발생: ${error}`);\n    }\n  }\n}","path":null,"size_bytes":3880,"size_tokens":null},"client/src/pages/PropertyDetailPage.tsx":{"content":"import { useParams } from \"wouter\";\nimport PropertyDetail from \"@/components/property/PropertyDetail\";\nimport { Helmet } from \"react-helmet\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { Property } from \"@shared/schema\";\n\nconst PropertyDetailPage = () => {\n  const { id } = useParams<{ id: string }>();\n  \n  const { data: property } = useQuery<Property>({\n    queryKey: [`/api/properties/${id}`],\n    enabled: !!id,\n  });\n\n  return (\n    <div className=\"pt-16\"> {/* Offset for fixed header */}\n      <Helmet>\n        <title>\n          {property ? `${property.title} | 이가이버 부동산` : \"매물 상세 | 이가이버 부동산\"}\n        </title>\n        <meta \n          name=\"description\" \n          content={property ? \n            `${property.description.substring(0, 150)}... - 이가이버 부동산에서 ${property.type} 매물을 확인하세요.` : \n            \"이가이버 부동산의 프리미엄 매물 상세 정보를 확인하세요. 아파트, 주택, 빌라, 오피스텔 등 다양한 매물 정보 제공.\"\n          }\n        />\n        <meta property=\"og:title\" content={property ? `${property.title} | 이가이버 부동산` : \"매물 상세 | 이가이버 부동산\"} />\n        <meta property=\"og:type\" content=\"website\" />\n        <meta \n          property=\"og:description\" \n          content={property ? \n            `${property.description.substring(0, 150)}... - 이가이버 부동산에서 ${property.type} 매물을 확인하세요.` : \n            \"이가이버 부동산의 프리미엄 매물 상세 정보를 확인하세요. 아파트, 주택, 빌라, 오피스텔 등 다양한 매물 정보 제공.\"\n          }\n        />\n        {property && <meta property=\"og:image\" content={\n          Array.isArray(property.imageUrls) && property.imageUrls.length > 0 && \n          typeof property.featuredImageIndex === 'number'\n            ? property.imageUrls[property.featuredImageIndex]\n            : (property.imageUrls && property.imageUrls.length > 0 \n                ? property.imageUrls[0] \n                : property.imageUrl)\n        } />}\n      </Helmet>\n      \n      <PropertyDetail propertyId={id} />\n    </div>\n  );\n};\n\nexport default PropertyDetailPage;\n","path":null,"size_bytes":2223,"size_tokens":null},"client/src/components/admin/PropertyFormCustomModal.tsx":{"content":"import { useEffect, useState } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { z } from \"zod\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport {\n  Form,\n  FormControl,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from \"@/components/ui/form\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { CustomModal } from \"@/components/ui/custom-modal\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Property, insertPropertySchema } from \"@shared/schema\";\n\n// 부동산 유형 목록\nconst propertyTypes = [\"토지\", \"주택\", \"아파트연립다세대\", \"원투룸\", \"상가공장창고펜션\"];\n\n// 읍면 리스트\nconst districts = [\n  \"강화읍\",\n  \"교동면\",\n  \"길상면\",\n  \"내가면\",\n  \"삼산면\",\n  \"서도면\",\n  \"선원면\",\n  \"송해면\",\n  \"양도면\",\n  \"양사면\",\n  \"하점면\",\n  \"화도면\",\n];\n\n// 거래 종류\nconst dealTypes = [\"매매\", \"전세\", \"월세\", \"완료\", \"보류중\"];\n\n// 세부 지역 정보\nconst detailedDistricts: { [key: string]: string[] } = {\n  강화읍: [\n    \"강화읍 갑곳리\",\n    \"강화읍 관청리\",\n    \"강화읍 국화리\",\n    \"강화읍 남산리\",\n    \"강화읍 내리\",\n    \"강화읍 대산리\",\n    \"강화읍 망월리\",\n    \"강화읍 명륜리\",\n    \"강화읍 묘안리\",\n    \"강화읍 박달리\",\n    \"강화읍 방향리\",\n    \"강화읍 북산리\",\n    \"강화읍 불은면\",\n    \"강화읍 신문리\",\n    \"강화읍 신정리\",\n    \"강화읍 옥림리\",\n    \"강화읍 용정리\",\n    \"강화읍 월곶리\",\n    \"강화읍 인산리\",\n    \"강화읍 중앙로\",\n    \"강화읍 청송리\",\n    \"강화읍 최촌리\",\n    \"강화읍 홍릉리\",\n  ],\n  교동면: [\n    \"교동면 고구리\",\n    \"교동면 대룡리\",\n    \"교동면 무학리\",\n    \"교동면 방리\",\n    \"교동면 봉소리\",\n    \"교동면 삼선리\",\n    \"교동면 상용리\",\n    \"교동면 서한리\",\n    \"교동면 소룡리\",\n    \"교동면 읍내리\",\n    \"교동면 정운리\",\n    \"교동면 지석리\",\n    \"교동면 철산리\",\n    \"교동면 하일리\",\n    \"교동면 화개리\",\n  ],\n  길상면: [\n    \"길상면 길직리\",\n    \"길상면 동검리\",\n    \"길상면 마리\",\n    \"길상면 망월리\",\n    \"길상면 온수리\",\n    \"길상면 선두리\",\n    \"길상면 초지리\",\n  ],\n  내가면: [\n    \"내가면 고천리\",\n    \"내가면 나리\",\n    \"내가면 내동리\",\n    \"내가면 대곶리\",\n    \"내가면 망하리\",\n    \"내가면 박석리\",\n    \"내가면 양오리\",\n    \"내가면 오상리\",\n    \"내가면 외포리\",\n    \"내가면 장터리\",\n    \"내가면 지석리\",\n    \"내가면 창후리\",\n  ],\n  삼산면: [\n    \"삼산면 매음리\",\n    \"삼산면 물가리\",\n    \"삼산면 석모리\",\n    \"삼산면 서검리\",\n    \"삼산면 석모리\",\n    \"삼산면 약암리\",\n    \"삼산면 윤상리\",\n    \"삼산면 하리\",\n  ],\n  서도면: [\n    \"서도면 말도리\",\n    \"서도면 볼음도리\",\n    \"서도면 수리\",\n    \"서도면 아차도리\",\n    \"서도면 주문도리\",\n  ],\n  선원면: [\n    \"선원면 금월리\",\n    \"선원면 동막리\",\n    \"선원면 선원리\",\n    \"선원면 신당리\",\n    \"선원면 연리\",\n    \"선원면 원당리\",\n    \"선원면 창리\",\n    \"선원면 포내리\",\n    \"선원면 해산리\",\n  ],\n  송해면: [\n    \"송해면 가숭리\",\n    \"송해면 당산리\",\n    \"송해면 대산리\",\n    \"송해면 양오리\",\n    \"송해면 하도리\",\n    \"송해면 장정리\",\n    \"송해면 신당리\",\n    \"송해면 천산리\",\n    \"송해면 숭뢰리\",\n  ],\n  양도면: [\n    \"양도면 감정리\",\n    \"양도면 건평리\",\n    \"양도면 도장리\",\n    \"양도면 삼흥리\",\n    \"양도면 인산리\",\n    \"양도면 조산리\",\n    \"양도면 인일리\",\n    \"양도면 하일리\",\n  ],\n  양사면: [\n    \"양사면 교산리\",\n    \"양사면 덕하리\",\n    \"양사면 덕하리\",\n    \"양사면 북성리\",\n    \"양사면 상도리\",\n    \"양사면 송학리\",\n    \"양사면 신당리\",\n    \"양사면 인화리\",\n    \"양사면 철산리\",\n  ],\n  하점면: [\n    \"하점면 망원리\",\n    \"하점면 봉천리\",\n    \"하점면 신봉리\",\n    \"하점면 신삼리\",\n    \"하점면 양오리\",\n    \"하점면 이강리\",\n    \"하점면 장정리\",\n    \"하점면 창후리\",\n    \"하점면 참리\",\n    \"하점면 충도리\",\n  ],\n  화도면: [\n    \"화도면 갑곶리\",\n    \"화도면 건평리\",\n    \"화도면 내리\",\n    \"화도면 덕포리\",\n    \"화도면 문산리\",\n    \"화도면 사기리\",\n    \"화도면 상방리\",\n    \"화도면 서산리\",\n    \"화도면 장화리\",\n    \"화도면 주문리\",\n    \"화도면 천삼리\",\n    \"화도면 흥왕리\",\n  ],\n};\n\n// 속성 입력 값 스키마\nconst propertyFormSchema = insertPropertySchema.extend({\n  price: z.union([z.string(), z.number()]).optional(),\n  size: z.union([z.string(), z.number()]).optional(),\n  imageUrl: z.string().optional(),\n  supplyArea: z.union([z.string(), z.number()]).optional().nullable(),\n  privateArea: z.union([z.string(), z.number()]).optional().nullable(),\n  floor: z.union([z.string(), z.number()]).optional().nullable(),\n  totalFloors: z.union([z.string(), z.number()]).optional().nullable(),\n  deposit: z.union([z.string(), z.number()]).optional().nullable(),\n  monthlyRent: z.union([z.string(), z.number()]).optional().nullable(),\n  maintenanceFee: z.union([z.string(), z.number()]).optional().nullable(),\n});\n\ntype PropertyFormValues = z.infer<typeof propertyFormSchema>;\n\ninterface PropertyFormCustomModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  property?: Property | null;\n}\n\nexport function PropertyFormCustomModal({ isOpen, onClose, property }: PropertyFormCustomModalProps) {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [selectedMainDistrict, setSelectedMainDistrict] = useState(\"강화읍\");\n  const [detailedDistrictOptions, setDetailedDistrictOptions] = useState<string[]>(detailedDistricts[\"강화읍\"]);\n  \n  // 부동산 등록/수정 폼\n  const form = useForm<PropertyFormValues>({\n    resolver: zodResolver(propertyFormSchema),\n    defaultValues: {\n      // 기본 정보\n      title: \"\",\n      description: \"\",\n      type: \"토지\",\n      price: \"\",\n      city: \"인천\",\n      district: \"강화읍 갑곳리\", \n      address: \"\",\n      size: \"\",\n      agentId: 1,\n      \n      // 위치 정보\n      buildingName: \"\",\n      unitNumber: \"\",\n      \n      // 면적 정보\n      supplyArea: \"\",\n      privateArea: \"\",\n      areaSize: \"\",\n      \n      // 건물 정보\n      floor: \"\",\n      totalFloors: \"\",\n      direction: \"\",\n      elevator: false,\n      parking: \"\",\n      heatingSystem: \"\",\n      approvalDate: \"\",\n      \n      // 금액 정보\n      dealType: [\"매매\"],\n      deposit: \"\",\n      monthlyRent: \"\",\n      maintenanceFee: \"\",\n      \n      // 연락처 정보\n      ownerName: \"\",\n      ownerPhone: \"\",\n      tenantName: \"\",\n      tenantPhone: \"\",\n      clientName: \"\",\n      clientPhone: \"\",\n      \n      // 추가 정보\n      specialNote: \"\",\n      coListing: false,\n      propertyDescription: \"\",\n      privateNote: \"\",\n      youtubeUrl: \"\",\n      \n      // 기존 필드\n      bedrooms: 0,\n      bathrooms: 0,\n      featured: false,\n    },\n  });\n\n  // 선택된 읍면에 따라 세부 지역 옵션 업데이트\n  useEffect(() => {\n    if (selectedMainDistrict && detailedDistricts[selectedMainDistrict]) {\n      setDetailedDistrictOptions(detailedDistricts[selectedMainDistrict]);\n      // 첫 번째 세부 지역을 기본값으로 설정\n      form.setValue(\"district\", detailedDistricts[selectedMainDistrict][0]);\n    }\n  }, [selectedMainDistrict, form]);\n  \n  // 읍면 변경 핸들러\n  const handleDistrictChange = (value: string) => {\n    setSelectedMainDistrict(value);\n  };\n\n  // 부동산 생성 뮤테이션\n  const createPropertyMutation = useMutation({\n    mutationFn: async (data: PropertyFormValues) => {\n      const res = await apiRequest(\"POST\", \"/api/properties\", data);\n      if (!res.ok) {\n        const errorData = await res.json();\n        throw new Error(errorData.message || \"부동산 등록에 실패했습니다\");\n      }\n      return await res.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/properties\"] });\n      toast({\n        title: \"부동산 등록 성공\",\n        description: \"새로운 부동산이 등록되었습니다.\",\n      });\n      onClose();\n      form.reset();\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"부동산 등록 실패\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // 부동산 수정 뮤테이션\n  const updatePropertyMutation = useMutation({\n    mutationFn: async ({\n      id,\n      data,\n    }: {\n      id: number;\n      data: PropertyFormValues;\n    }) => {\n      const res = await apiRequest(\"PATCH\", `/api/properties/${id}`, data);\n      if (!res.ok) {\n        const errorData = await res.json();\n        throw new Error(errorData.message || \"부동산 수정에 실패했습니다\");\n      }\n      return await res.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/properties\"] });\n      toast({\n        title: \"부동산 수정 성공\",\n        description: \"부동산 정보가 수정되었습니다.\",\n      });\n      onClose();\n      form.reset();\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"부동산 수정 실패\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // 폼 제출 처리\n  const onSubmit = (data: PropertyFormValues) => {\n    if (property) {\n      updatePropertyMutation.mutate({ id: property.id, data });\n    } else {\n      createPropertyMutation.mutate(data);\n    }\n  };\n\n  // 속성이 변경될 때마다 폼 업데이트\n  useEffect(() => {\n    if (property) {\n      const mainDistrict = districts.find(d => \n        property.district.startsWith(d)\n      ) || \"강화읍\";\n      \n      setSelectedMainDistrict(mainDistrict);\n      \n      // 폼 값 설정\n      form.reset({\n        title: property.title,\n        description: property.description,\n        type: property.type,\n        price: property.price.toString(),\n        address: property.address,\n        city: property.city,\n        district: property.district,\n        size: property.size.toString(),\n        bedrooms: property.bedrooms,\n        bathrooms: property.bathrooms,\n        agentId: property.agentId,\n        featured: property.featured === null ? undefined : property.featured,\n        buildingName: property.buildingName || \"\",\n        unitNumber: property.unitNumber || \"\",\n        supplyArea: property.supplyArea ? property.supplyArea.toString() : \"\",\n        privateArea: property.privateArea ? property.privateArea.toString() : \"\",\n        areaSize: property.areaSize || \"\",\n        floor: property.floor ? property.floor.toString() : \"\",\n        totalFloors: property.totalFloors ? property.totalFloors.toString() : \"\",\n        direction: property.direction || \"\",\n        elevator: property.elevator === null ? false : property.elevator,\n        parking: property.parking || \"\",\n        heatingSystem: property.heatingSystem || \"\",\n        approvalDate: property.approvalDate || \"\",\n        dealType: Array.isArray(property.dealType) ? property.dealType : [\"매매\"],\n        deposit: property.deposit ? property.deposit.toString() : \"\",\n        monthlyRent: property.monthlyRent ? property.monthlyRent.toString() : \"\",\n        maintenanceFee: property.maintenanceFee ? property.maintenanceFee.toString() : \"\",\n        ownerName: property.ownerName || \"\",\n        ownerPhone: property.ownerPhone || \"\",\n        tenantName: property.tenantName || \"\",\n        tenantPhone: property.tenantPhone || \"\",\n        clientName: property.clientName || \"\",\n        clientPhone: property.clientPhone || \"\",\n        specialNote: property.specialNote || \"\",\n        coListing: property.coListing === null ? false : property.coListing,\n        propertyDescription: property.propertyDescription || \"\",\n        privateNote: property.privateNote || \"\",\n        youtubeUrl: property.youtubeUrl || \"\",\n      });\n    } else {\n      // 새 속성 등록을 위한 초기값 설정\n      form.reset({\n        // 기본 정보\n        title: \"\",\n        description: \"\",\n        type: \"토지\",\n        price: \"\",\n        city: \"인천\",\n        district: \"강화읍 갑곳리\", \n        address: \"\",\n        size: \"\",\n        agentId: 1,\n        \n        // 위치 정보\n        buildingName: \"\",\n        unitNumber: \"\",\n        \n        // 면적 정보\n        supplyArea: \"\",\n        privateArea: \"\",\n        areaSize: \"\",\n        \n        // 건물 정보\n        floor: \"\",\n        totalFloors: \"\",\n        direction: \"\",\n        elevator: false,\n        parking: \"\",\n        heatingSystem: \"\",\n        approvalDate: \"\",\n        \n        // 금액 정보\n        dealType: [\"매매\"],\n        deposit: \"\",\n        monthlyRent: \"\",\n        maintenanceFee: \"\",\n        \n        // 연락처 정보\n        ownerName: \"\",\n        ownerPhone: \"\",\n        tenantName: \"\",\n        tenantPhone: \"\",\n        clientName: \"\",\n        clientPhone: \"\",\n        \n        // 추가 정보\n        specialNote: \"\",\n        coListing: false,\n        propertyDescription: \"\",\n        privateNote: \"\",\n        youtubeUrl: \"\",\n        \n        // 기존 필드\n        bedrooms: 0,\n        bathrooms: 0,\n        featured: false,\n      });\n    }\n  }, [property, form]);\n\n  return (\n    <CustomModal \n      isOpen={isOpen} \n      onClose={onClose}\n      title={property ? \"부동산 수정\" : \"새 부동산 등록\"}\n    >\n      <div>\n        <p className=\"text-sm text-gray-500 mb-4\">\n          {property ? \"부동산 정보를 수정하세요\" : \"새로운 부동산 매물을 등록하세요\"}\n        </p>\n        \n        <Form {...form}>\n          <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6\">\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n              {/* 기본 정보 */}\n              <div>\n                <FormField\n                  control={form.control}\n                  name=\"title\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>제목</FormLabel>\n                      <FormControl>\n                        <Input placeholder=\"부동산 제목\" {...field} />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n              <div>\n                <FormField\n                  control={form.control}\n                  name=\"type\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>유형</FormLabel>\n                      <Select\n                        onValueChange={field.onChange}\n                        defaultValue={field.value}\n                      >\n                        <FormControl>\n                          <SelectTrigger>\n                            <SelectValue placeholder=\"부동산 유형 선택\" />\n                          </SelectTrigger>\n                        </FormControl>\n                        <SelectContent>\n                          {propertyTypes.map((type) => (\n                            <SelectItem key={type} value={type}>\n                              {type}\n                            </SelectItem>\n                          ))}\n                        </SelectContent>\n                      </Select>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n              <div className=\"md:col-span-2\">\n                <FormField\n                  control={form.control}\n                  name=\"description\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>설명</FormLabel>\n                      <FormControl>\n                        <Textarea\n                          placeholder=\"부동산에 대한 상세 설명\"\n                          rows={4}\n                          {...field}\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n              <div>\n                <FormField\n                  control={form.control}\n                  name=\"price\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>가격</FormLabel>\n                      <FormControl>\n                        <Input placeholder=\"가격 (원)\" {...field} />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n              <div>\n                <FormField\n                  control={form.control}\n                  name=\"size\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>면적 (㎡)</FormLabel>\n                      <FormControl>\n                        <Input placeholder=\"면적 (㎡)\" {...field} />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n              <div>\n                <FormItem>\n                  <FormLabel>읍면</FormLabel>\n                  <Select\n                    onValueChange={handleDistrictChange}\n                    defaultValue={selectedMainDistrict}\n                  >\n                    <FormControl>\n                      <SelectTrigger>\n                        <SelectValue placeholder=\"지역 선택\" />\n                      </SelectTrigger>\n                    </FormControl>\n                    <SelectContent>\n                      {districts.map((district) => (\n                        <SelectItem key={district} value={district}>\n                          {district}\n                        </SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                </FormItem>\n              </div>\n\n              <div>\n                <FormField\n                  control={form.control}\n                  name=\"district\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>읍면동</FormLabel>\n                      <Select\n                        onValueChange={field.onChange}\n                        defaultValue={field.value}\n                      >\n                        <FormControl>\n                          <SelectTrigger>\n                            <SelectValue placeholder=\"상세 지역 선택\" />\n                          </SelectTrigger>\n                        </FormControl>\n                        <SelectContent>\n                          {detailedDistrictOptions.map((district) => (\n                            <SelectItem key={district} value={district}>\n                              {district}\n                            </SelectItem>\n                          ))}\n                        </SelectContent>\n                      </Select>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n              <div>\n                <FormField\n                  control={form.control}\n                  name=\"address\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>지번</FormLabel>\n                      <FormControl>\n                        <Input placeholder=\"지번 주소\" {...field} />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n              <div>\n                <FormField\n                  control={form.control}\n                  name=\"buildingName\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>건물명</FormLabel>\n                      <FormControl>\n                        <Input placeholder=\"건물명 (선택사항)\" {...field} />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n              <div>\n                <FormField\n                  control={form.control}\n                  name=\"unitNumber\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>동호수</FormLabel>\n                      <FormControl>\n                        <Input placeholder=\"동호수 (선택사항)\" {...field} />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n              <div>\n                <FormField\n                  control={form.control}\n                  name=\"supplyArea\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>공급면적 (평)</FormLabel>\n                      <FormControl>\n                        <Input placeholder=\"공급면적 (선택사항)\" {...field} />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n              <div>\n                <FormField\n                  control={form.control}\n                  name=\"privateArea\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>전용면적 (평)</FormLabel>\n                      <FormControl>\n                        <Input placeholder=\"전용면적 (선택사항)\" {...field} />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n\n\n              <div>\n                <FormField\n                  control={form.control}\n                  name=\"dealType\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>거래 종류</FormLabel>\n                      <div className=\"flex flex-wrap gap-2\">\n                        {dealTypes.map((type) => (\n                          <Button\n                            key={type}\n                            type=\"button\"\n                            variant={field.value.includes(type) ? \"default\" : \"outline\"}\n                            onClick={() => {\n                              const newValue = field.value.includes(type)\n                                ? field.value.filter((t) => t !== type)\n                                : [...field.value, type];\n                              field.onChange(newValue.length ? newValue : [\"매매\"]);\n                            }}\n                          >\n                            {type}\n                          </Button>\n                        ))}\n                      </div>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n              <div>\n                <FormField\n                  control={form.control}\n                  name=\"bedrooms\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>침실 수</FormLabel>\n                      <FormControl>\n                        <Input \n                          type=\"number\" \n                          placeholder=\"침실 수\"\n                          {...field}\n                          onChange={(e) => field.onChange(Number(e.target.value))}\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n              <div>\n                <FormField\n                  control={form.control}\n                  name=\"bathrooms\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>욕실 수</FormLabel>\n                      <FormControl>\n                        <Input \n                          type=\"number\" \n                          placeholder=\"욕실 수\"\n                          {...field}\n                          onChange={(e) => field.onChange(Number(e.target.value))}\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n              <div>\n                <FormField\n                  control={form.control}\n                  name=\"youtubeUrl\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>유튜브 영상 URL (선택사항)</FormLabel>\n                      <FormControl>\n                        <Input \n                          type=\"url\" \n                          placeholder=\"https://www.youtube.com/watch?v=...\"\n                          {...field}\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n            </div>\n\n            <div className=\"flex justify-end gap-2\">\n              <Button type=\"button\" variant=\"outline\" onClick={onClose}>\n                취소\n              </Button>\n              <Button type=\"submit\" disabled={createPropertyMutation.isPending || updatePropertyMutation.isPending}>\n                {(createPropertyMutation.isPending || updatePropertyMutation.isPending) ? \"처리 중...\" : property ? \"수정\" : \"등록\"}\n              </Button>\n            </div>\n          </form>\n        </Form>\n      </div>\n    </CustomModal>\n  );\n}","path":null,"size_bytes":26480,"size_tokens":null},"client/src/components/ui/hover-card.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as HoverCardPrimitive from \"@radix-ui/react-hover-card\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst HoverCard = HoverCardPrimitive.Root\n\nconst HoverCardTrigger = HoverCardPrimitive.Trigger\n\nconst HoverCardContent = React.forwardRef<\n  React.ElementRef<typeof HoverCardPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <HoverCardPrimitive.Content\n    ref={ref}\n    align={align}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-hover-card-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nHoverCardContent.displayName = HoverCardPrimitive.Content.displayName\n\nexport { HoverCard, HoverCardTrigger, HoverCardContent }\n","path":null,"size_bytes":1251,"size_tokens":null},"client/src/pages/PropertyForm.jsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useParams } from \"wouter\";\nimport { Loader2, ArrowLeft, Save } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport {\n  Card,\n  CardContent,\n  CardDescription,\n  CardHeader,\n  CardTitle,\n} from \"@/components/ui/card\";\nimport {\n  Tabs,\n  TabsContent,\n  TabsList,\n  TabsTrigger,\n} from \"@/components/ui/tabs\";\n\n// 각 부동산 유형별 기본 이미지 경로 설정 (public 폴더에 있는 이미지)\nconst landDefaultImage = \"/default-property-images/land.png\";\nconst houseDefaultImage = \"/default-property-images/house.png\";\nconst apartmentDefaultImage = \"/default-property-images/apartment.png\";\nconst oneroomDefaultImage = \"/default-property-images/oneroom.png\";\nconst commercialDefaultImage = \"/default-property-images/commercial.png\";\n\nfunction PropertyForm() {\n  const { user } = useAuth();\n  const { toast } = useToast();\n  const params = useParams();\n  const isEditMode = !!params.id;\n  \n  const [loading, setLoading] = useState(isEditMode);\n  const [saving, setSaving] = useState(false);\n  \n  // 거래 유형 정의\n  const dealTypeOptions = [\"매매\", \"전세\", \"월세\", \"완료\", \"보류중\"];\n  const propertyTypeOptions = [\"토지\", \"주택\", \"아파트연립다세대\", \"원투룸\", \"상가공장창고펜션\"];\n  \n  // 부동산 유형별 기본 이미지 매핑\n  const defaultPropertyImages = {\n    '토지': landDefaultImage,\n    '주택': houseDefaultImage,\n    '아파트연립다세대': apartmentDefaultImage,\n    '원투룸': oneroomDefaultImage,\n    '상가공장창고펜션': commercialDefaultImage\n  };\n  \n  // 부동산 유형에 맞는 기본 이미지 가져오기\n  const getDefaultImageForPropertyType = (type) => {\n    return defaultPropertyImages[type] || defaultPropertyImages['주택']; // 기본값은 주택 이미지\n  };\n  \n  // 통합된 지역 목록 (읍면동리)\n  const allLocations = [\n    \"강화읍 갑곳리\",\n    \"강화읍 관청리\",\n    \"강화읍 국화리\",\n    \"강화읍 남산리\",\n    \"강화읍 대산리\",\n    \"강화읍 신문리\",\n    \"강화읍 옥림리\",\n    \"강화읍 용정리\",\n    \"강화읍 월곳리\",\n    \"교동면 고구리\",\n    \"교동면 난정리\",\n    \"교동면 대룡리\",\n    \"교동면 동산리\",\n    \"교동면 무학리\",\n    \"교동면 봉소리\",\n    \"교동면 삼선리\",\n    \"교동면 상용리\",\n    \"교동면 서한리\",\n    \"교동면 양갑리\",\n    \"교동면 읍내리\",\n    \"교동면 인사리\",\n    \"교동면 지석리\",\n    \"길상면 길직리\",\n    \"길상면 동검리\",\n    \"길상면 선두리\",\n    \"길상면 온수리\",\n    \"길상면 장흥리\",\n    \"길상면 초지리\",\n    \"내가면 고천리\",\n    \"내가면 구하리\",\n    \"내가면 오상리\",\n    \"내가면 외포리\",\n    \"내가면 황청리\",\n    \"불은면 고능리\",\n    \"불은면 넙성리\",\n    \"불은면 덕성리\",\n    \"불은면 두운리\",\n    \"불은면 삼동암리\",\n    \"불은면 삼성리\",\n    \"불은면 신현리\",\n    \"불은면 오두리\",\n    \"삼산면 매음리\",\n    \"삼산면 미법리\",\n    \"삼산면 상리\",\n    \"삼산면 서검리\",\n    \"삼산면 석모리\",\n    \"삼산면 석포리\",\n    \"삼산면 하리\",\n    \"서도면 말도리\",\n    \"서도면 볼음도리\",\n    \"서도면 아차도리\",\n    \"서도면 주문도리\",\n    \"선원면 금월리\",\n    \"선원면 냉정리\",\n    \"선원면 선행리\",\n    \"선원면 신정리\",\n    \"선원면 연리\",\n    \"선원면 지산리\",\n    \"선원면 창리\",\n    \"송해면 당산리\",\n    \"송해면 상도리\",\n    \"송해면 솔정리\",\n    \"송해면 숭뢰리\",\n    \"송해면 신당리\",\n    \"송해면 양오리\",\n    \"송해면 하도리\",\n    \"양도면 건평리\",\n    \"양도면 길정리\",\n    \"양도면 능내리\",\n    \"양도면 도장리\",\n    \"양도면 삼흥리\",\n    \"양도면 인산리\",\n    \"양도면 조산리\",\n    \"양도면 하일리\",\n    \"양사면 교산리\",\n    \"양사면 덕하리\",\n    \"양사면 북성리\",\n    \"양사면 인화리\",\n    \"양사면 철산리\",\n    \"하점면 망월리\",\n    \"하점면 부근리\",\n    \"하점면 삼거리\",\n    \"하점면 신봉리\",\n    \"하점면 신삼리\",\n    \"하점면 이강리\",\n    \"하점면 장정리\",\n    \"하점면 창후리\",\n    \"화도면 내리\",\n    \"화도면 덕포리\",\n    \"화도면 동막리\",\n    \"화도면 문산리\",\n    \"화도면 사기리\",\n    \"화도면 상방리\",\n    \"화도면 여차리\",\n    \"화도면 장화리\",\n    \"화도면 흥왕리\",\n    \"기타지역\"\n  ];\n  \n  // 지목 옵션 목록\n  const landTypeOptions = [\"전\", \"답\", \"임\", \"대\", \"목\", \"잡\", \"창\", \"도\", \"장\", \"학\", \"주\", \"염\", \"과\", \"철\", \"제\", \"천\", \"구\", \"유\", \"양\", \"수\", \"공원\", \"체\", \"원\", \"종\", \"사\", \"묘\", \"광\"];\n  \n  // 용도지역 옵션 목록\n  const zoneTypeOptions = [\n    \"제1종전용주거\", \"제2종전용주거\", \"제1종일반주거\", \"제2종일반주거\", \"제3종일반주거\", \n    \"준주거\", \"중심상업\", \"일반상업\", \"근린상업\", \"유통상업\", \n    \"전용공업\", \"일반공업\", \"준공업\", \n    \"보전녹지\", \"생산녹지\", \"자연녹지\", \n    \"계획관리\", \"보전관리\", \"생산관리\", \n    \"농업보호\", \"농업진흥\", \"농림지역\", \"자연환경보전\"\n  ];\n\n  // 폼 상태 설정\n  const [formData, setFormData] = useState({\n    title: \"\",\n    description: \"\",\n    type: \"주택\",\n    price: \"\",\n    address: \"\",\n    city: \"인천\", // city 필드에 기본값 지정\n    district: \"기타지역\", // 기본값 설정\n    size: \"\",\n    bedrooms: 0,\n    bathrooms: 0,\n    imageUrls: [], // 다중 이미지 저장용 배열\n    agentId: 4, // 기본 에이전트 ID 설정 (정현우 중개사)\n    featured: false,\n    \n    // 위치 정보\n    buildingName: \"\",\n    unitNumber: \"\",\n    \n    // 면적 정보\n    supplyArea: \"\",\n    privateArea: \"\",\n    areaSize: \"\",\n    \n    // 건물 정보\n    floor: \"\",\n    totalFloors: 0, // 숫자로 초기화\n    direction: \"\",\n    elevator: false,\n    parking: \"\",\n    heatingSystem: \"\",\n    approvalDate: \"\",\n    \n    // 토지 정보\n    landType: \"\", // 지목\n    zoneType: \"\", // 용도지역\n    \n    // 금액 정보\n    dealType: [\"매매\"],\n    deposit: \"\",\n    monthlyRent: \"\",\n    maintenanceFee: \"\",\n    \n    // 연락처 정보\n    ownerName: \"\",\n    ownerPhone: \"\",\n    tenantName: \"\",\n    tenantPhone: \"\",\n    clientName: \"\",\n    clientPhone: \"\",\n    \n    // 추가 정보\n    specialNote: \"\",\n    coListing: false,\n    // propertyDescription 필드 삭제\n    privateNote: \"\",\n    youtubeUrl: \"\", // 유튜브 영상 URL\n    featuredImageIndex: 0, // 대표 이미지 인덱스 추가\n  });\n  \n  // 이미지 업로드 관련 상태\n  const [uploadedImages, setUploadedImages] = useState([]);\n  const [isUploading, setIsUploading] = useState(false);\n  const [featuredImageIndex, setFeaturedImageIndex] = useState(0); // 대표 이미지 인덱스 관리\n  \n\n  \n  // 편집 모드일 경우 기존 데이터 로드\n  useEffect(() => {\n    if (isEditMode) {\n      const fetchProperty = async () => {\n        try {\n          setLoading(true);\n          console.log(\"부동산 ID:\", params.id);\n          const response = await fetch(`/api/properties/${params.id}`);\n          if (response.ok) {\n            const data = await response.json();\n            console.log(\"불러온 부동산 데이터:\", data);\n            // 단일 이미지 필드 제거 및 데이터 설정\n            const { imageUrl, ...restData } = data;\n            setFormData({\n              ...restData,\n              // 필수 필드 데이터 보완\n              agentId: data.agentId || 4, // 기본값 4 (정현우 중개사)\n              dealType: data.dealType || [\"매매\"],\n              imageUrls: data.imageUrls || [],\n              elevator: Boolean(data.elevator),\n              coListing: Boolean(data.coListing),\n              featured: Boolean(data.featured),\n            });\n            \n            // 이미지 처리: 배열 먼저 확인하고, 없으면 단일 이미지 확인\n            let imageList = [];\n            \n            if (data.imageUrls && Array.isArray(data.imageUrls) && data.imageUrls.length > 0) {\n              // 이미지 배열 사용\n              imageList = [...data.imageUrls];\n            } \n            else if (data.imageUrl) {\n              // 단일 이미지가 있으면 배열에 추가\n              imageList = [data.imageUrl];\n            }\n            \n            // 이미지 객체 배열로 변환\n            if (imageList.length > 0) {\n              const images = imageList.map((url, index) => ({\n                id: Date.now() + index,\n                url: url\n              }));\n              setUploadedImages(images);\n              \n              // 대표 이미지 인덱스 설정\n              // 단일 imageUrl이 있고 그 URL이 imageUrls 배열에 있으면 해당 인덱스를 대표 이미지로 설정\n              if (data.imageUrl) {\n                const representativeIndex = imageList.findIndex(url => url === data.imageUrl);\n                if (representativeIndex !== -1) {\n                  setFeaturedImageIndex(representativeIndex);\n                }\n              }\n              \n              // 폼 데이터의 imageUrls도 업데이트\n              setFormData(prev => ({\n                ...prev,\n                imageUrls: imageList\n              }));\n            }\n          } else {\n            toast({\n              title: \"오류\", \n              description: \"부동산 정보를 불러올 수 없습니다\",\n              variant: \"destructive\",\n            });\n            window.location.href = \"/admin\";\n          }\n        } catch (error) {\n          console.error(\"부동산 정보 로드 오류:\", error);\n          toast({\n            title: \"오류\",\n            description: \"부동산 정보를 불러오는 중 오류가 발생했습니다\",\n            variant: \"destructive\",\n          });\n          window.location.href = \"/admin\";\n        } finally {\n          setLoading(false);\n        }\n      };\n      \n      fetchProperty();\n    }\n  }, [isEditMode, params.id, toast]);\n  \n  // 입력 필드 변경 핸들러\n  const handleChange = (e) => {\n    const { name, value, type, checked } = e.target;\n    \n    if (type === \"checkbox\") {\n      setFormData({ ...formData, [name]: checked });\n    } else if (type === \"number\") {\n      setFormData({ ...formData, [name]: value === \"\" ? \"\" : Number(value) });\n    } else {\n      setFormData({ ...formData, [name]: value });\n    }\n  };\n  \n  // 셀렉트 필드 변경 핸들러\n  const handleSelectChange = (name, value) => {\n    setFormData({ ...formData, [name]: value });\n  };\n  \n  // 거래 유형 체크박스 핸들러\n  const handleDealTypeChange = (type, checked) => {\n    if (checked) {\n      setFormData({\n        ...formData,\n        dealType: [...formData.dealType, type],\n      });\n    } else {\n      setFormData({\n        ...formData,\n        dealType: formData.dealType.filter(t => t !== type),\n      });\n    }\n  };\n  \n  // 폼 제출 핸들러\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    \n    if (!formData.title || !formData.price || !formData.address) {\n      toast({\n        title: \"입력 오류\",\n        description: \"필수 입력 필드를 모두 작성해주세요 (제목, 가격, 주소)\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    \n    try {\n      setSaving(true);\n      \n      // 서버에 맞게 데이터 타입 변환하기\n      const submissionData = {\n        ...formData,\n        // 숫자 필드들 처리\n        agentId: Number(formData.agentId) || 4, // 기본값 4 설정 (정현우 중개사)\n        agent_id: Number(formData.agentId) || 4, // DB 컬럼명과 일치하도록 추가\n        totalFloors: Number(formData.totalFloors || 0),\n        // size는 서버에서 string으로 처리하므로 그대로 전송\n        size: formData.size || \"0\",\n        bedrooms: Number(formData.bedrooms),\n        bathrooms: Number(formData.bathrooms),\n        featuredImageIndex: featuredImageIndex\n      };\n      \n      // 이미지 처리: 이미지가 없을 경우 부동산 유형에 맞는 기본 이미지 설정\n      if (!formData.imageUrls || formData.imageUrls.length === 0) {\n        try {\n          // 부동산 유형에 맞는 기본 이미지 가져오기\n          const defaultImage = getDefaultImageForPropertyType(formData.type);\n          \n          // 기본 이미지를 배열과 단일 이미지 URL에 모두 설정\n          submissionData.imageUrls = [defaultImage];\n          submissionData.imageUrl = defaultImage;\n          \n          console.log(`이미지가 없어 기본 이미지를 적용합니다. 유형: ${formData.type}, 이미지: ${defaultImage}`);\n        } catch (error) {\n          console.error(\"기본 이미지 적용 중 오류 발생:\", error);\n        }\n      }\n      // 이미지가 있을 경우 대표 이미지 설정 (이전 버전 호환용)\n      else if (formData.imageUrls && formData.imageUrls.length > 0 && featuredImageIndex >= 0) {\n        submissionData.imageUrl = formData.imageUrls[featuredImageIndex] || formData.imageUrls[0];\n      }\n      \n      // 디버깅용 로그\n      console.log(\"부동산 수정 요청 데이터:\", submissionData);\n      \n      const url = isEditMode \n        ? `/api/properties/${params.id}` \n        : \"/api/properties\";\n      \n      const method = isEditMode ? \"PATCH\" : \"POST\";\n      \n      const response = await fetch(url, {\n        method,\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify(submissionData),\n      });\n      \n      if (response.ok) {\n        const result = await response.json();\n        toast({\n          title: \"성공\",\n          description: isEditMode \n            ? \"부동산 정보가 수정되었습니다\" \n            : \"부동산 정보가 등록되었습니다\",\n        });\n        window.location.href = \"/admin\";\n      } else {\n        const errorData = await response.json();\n        throw new Error(errorData.message || \"요청 처리 실패\");\n      }\n    } catch (error) {\n      console.error(\"부동산 저장 오류:\", error);\n      toast({\n        title: \"저장 실패\",\n        description: error.message || \"부동산 정보를 저장하는 중 오류가 발생했습니다\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setSaving(false);\n    }\n  };\n  \n  if (loading) {\n    return (\n      <div className=\"container mx-auto p-6 flex justify-center items-center min-h-[60vh]\">\n        <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\n      </div>\n    );\n  }\n  \n  return (\n    <div className=\"container mx-auto p-4\">\n      <div className=\"flex items-center mb-6\">\n        <Button \n          variant=\"outline\" \n          size=\"sm\" \n          onClick={() => window.location.href = \"/admin\"}\n          className=\"mr-4\"\n        >\n          <ArrowLeft className=\"h-4 w-4 mr-2\" />\n          돌아가기\n        </Button>\n        <h1 className=\"text-2xl font-bold\">\n          {isEditMode ? \"부동산 정보 수정\" : \"새 부동산 등록\"}\n        </h1>\n      </div>\n      \n      <form onSubmit={handleSubmit}>\n        <Tabs defaultValue=\"basic\" className=\"w-full\">\n          <TabsList className=\"mb-4\">\n            <TabsTrigger value=\"basic\">기본 정보</TabsTrigger>\n            <TabsTrigger value=\"details\">상세 정보</TabsTrigger>\n            <TabsTrigger value=\"land\">토지 정보</TabsTrigger>\n            <TabsTrigger value=\"price\">가격 정보</TabsTrigger>\n            <TabsTrigger value=\"contacts\">연락처</TabsTrigger>\n            <TabsTrigger value=\"notes\">추가 정보</TabsTrigger>\n          </TabsList>\n          \n          {/* 기본 정보 탭 */}\n          <TabsContent value=\"basic\">\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n              <Card>\n                <CardHeader>\n                  <CardTitle>필수 정보</CardTitle>\n                  <CardDescription>\n                    부동산의 기본 정보를 입력하세요\n                  </CardDescription>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"title\">제목 *</Label>\n                    <Input\n                      id=\"title\"\n                      name=\"title\"\n                      value={formData.title}\n                      onChange={handleChange}\n                      required\n                    />\n                  </div>\n                  \n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"type\">부동산 유형 *</Label>\n                    <Select \n                      name=\"type\" \n                      value={formData.type}\n                      onValueChange={(value) => handleSelectChange(\"type\", value)}\n                    >\n                      <SelectTrigger>\n                        <SelectValue placeholder=\"유형 선택\" />\n                      </SelectTrigger>\n                      <SelectContent>\n                        {propertyTypeOptions.map(option => (\n                          <SelectItem key={option} value={option}>\n                            {option}\n                          </SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                  </div>\n                  \n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"price\">매매가 *</Label>\n                    <Input\n                      id=\"price\"\n                      name=\"price\"\n                      type=\"text\"\n                      value={formData.price}\n                      onChange={handleChange}\n                      required\n                    />\n                  </div>\n                  \n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"address\">주소 *</Label>\n                    <Input\n                      id=\"address\"\n                      name=\"address\"\n                      value={formData.address}\n                      onChange={handleChange}\n                      required\n                      placeholder=\"상세 주소를 입력하세요\"\n                    />\n                  </div>\n                  \n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"district\">지역 *</Label>\n                    <Select\n                      value={formData.district}\n                      onValueChange={(value) => handleSelectChange(\"district\", value)}\n                    >\n                      <SelectTrigger id=\"district\">\n                        <SelectValue placeholder=\"지역을 선택하세요\" />\n                      </SelectTrigger>\n                      <SelectContent className=\"max-h-[300px]\">\n                        {allLocations.map((location) => (\n                          <SelectItem key={location} value={location}>\n                            {location}\n                          </SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                  </div>\n                  \n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"size\">면적(㎡) *</Label>\n                    <Input\n                      id=\"size\"\n                      name=\"size\"\n                      type=\"text\"\n                      value={formData.size || \"\"}\n                      onChange={(e) => {\n                        const val = e.target.value;\n                        setFormData(prev => ({\n                          ...prev,\n                          size: val\n                        }));\n                      }}\n                      required\n                    />\n                  </div>\n                  \n                  {/* 부동산 유형이 '토지'가 아닐 때만 방 개수와 화장실 개수 필드 표시 */}\n                  {formData.type !== '토지' && (\n                    <div className=\"grid grid-cols-2 gap-4\">\n                      <div className=\"space-y-2\">\n                        <Label htmlFor=\"bedrooms\">방 개수</Label>\n                        <Input\n                          id=\"bedrooms\"\n                          name=\"bedrooms\"\n                          type=\"number\"\n                          min=\"0\"\n                          value={formData.bedrooms}\n                          onChange={handleChange}\n                        />\n                      </div>\n                      <div className=\"space-y-2\">\n                        <Label htmlFor=\"bathrooms\">화장실 개수</Label>\n                        <Input\n                          id=\"bathrooms\"\n                          name=\"bathrooms\"\n                          type=\"number\"\n                          min=\"0\"\n                          value={formData.bathrooms}\n                          onChange={handleChange}\n                        />\n                      </div>\n                    </div>\n                  )}\n                  \n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"youtubeUrl\">유튜브 영상 URL (선택사항)</Label>\n                    <Input\n                      id=\"youtubeUrl\"\n                      name=\"youtubeUrl\"\n                      type=\"url\"\n                      placeholder=\"https://www.youtube.com/watch?v=...\"\n                      value={formData.youtubeUrl || \"\"}\n                      onChange={handleChange}\n                    />\n                    <p className=\"text-xs text-gray-500\">매물 소개 영상이 있다면 유튜브 URL을 입력하세요</p>\n                  </div>\n                </CardContent>\n              </Card>\n              \n              <Card>\n                <CardHeader>\n                  <CardTitle>추가 기본 정보</CardTitle>\n                  <CardDescription>\n                    상세 설명 및 중개사 정보를 입력하세요\n                  </CardDescription>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"description\">설명</Label>\n                    <Textarea\n                      id=\"description\"\n                      name=\"description\"\n                      value={formData.description}\n                      onChange={handleChange}\n                      rows={4}\n                    />\n                  </div>\n                  \n                  <div className=\"space-y-4\">\n                    <div className=\"space-y-2\">\n                      <div className=\"flex justify-between items-center\">\n                        <Label>이미지 업로드 (최대 5장)</Label>\n                        <span className=\"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded-full\">\n                          별표(⭐) 버튼을 클릭하여 대표 이미지를 지정할 수 있습니다\n                        </span>\n                      </div>\n                      <div className=\"flex flex-col gap-4\">\n                        <div className=\"border rounded-md p-4 bg-gray-50\">\n                          <div className=\"flex items-center justify-center w-full\">\n                            <label \n                              htmlFor=\"imageUpload\" \n                              className=\"flex flex-col items-center justify-center w-full h-32 border-2 border-dashed rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-100 border-gray-300\"\n                            >\n                              <div className=\"flex flex-col items-center justify-center pt-5 pb-6\">\n                                <svg className=\"w-8 h-8 mb-4 text-gray-500\" aria-hidden=\"true\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 20 16\">\n                                  <path stroke=\"currentColor\" strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth=\"2\" d=\"M13 13h3a3 3 0 0 0 0-6h-.025A5.56 5.56 0 0 0 16 6.5 5.5 5.5 0 0 0 5.207 5.021C5.137 5.017 5.071 5 5 5a4 4 0 0 0 0 8h2.167M10 15V6m0 0L8 8m2-2 2 2\"/>\n                                </svg>\n                                <p className=\"mb-2 text-sm text-gray-500\"><span className=\"font-semibold\">클릭하여 업로드</span></p>\n                                <p className=\"text-xs text-gray-500\">PNG, JPG 또는 GIF (최대 10MB, 자동 압축됨)</p>\n                              </div>\n                              <input \n                                id=\"imageUpload\" \n                                type=\"file\" \n                                accept=\"image/*\" \n                                className=\"hidden\" \n                                onChange={(e) => {\n                                  if (uploadedImages.length >= 5) {\n                                    toast({\n                                      title: \"최대 5장까지 업로드 가능합니다\",\n                                      variant: \"destructive\"\n                                    });\n                                    return;\n                                  }\n\n                                  const file = e.target.files[0];\n                                  if (!file) return;\n                                  \n                                  setIsUploading(true);\n                                  \n                                  // 이미지 압축 함수\n                                  const compressImage = (file) => {\n                                    return new Promise((resolve) => {\n                                      const reader = new FileReader();\n                                      reader.onload = (event) => {\n                                        const img = new Image();\n                                        img.src = event.target.result;\n                                        img.onload = () => {\n                                          // 이미지 리사이징을 위한 캔버스 생성\n                                          const canvas = document.createElement('canvas');\n                                          // 최대 너비/높이 설정 (800px로 제한)\n                                          const MAX_SIZE = 800;\n                                          let width = img.width;\n                                          let height = img.height;\n                                          \n                                          // 이미지 크기 조정\n                                          if (width > height) {\n                                            if (width > MAX_SIZE) {\n                                              height *= MAX_SIZE / width;\n                                              width = MAX_SIZE;\n                                            }\n                                          } else {\n                                            if (height > MAX_SIZE) {\n                                              width *= MAX_SIZE / height;\n                                              height = MAX_SIZE;\n                                            }\n                                          }\n                                          \n                                          canvas.width = width;\n                                          canvas.height = height;\n                                          \n                                          // 캔버스에 이미지 그리기\n                                          const ctx = canvas.getContext('2d');\n                                          ctx.drawImage(img, 0, 0, width, height);\n                                          \n                                          // 이미지 포맷 및 품질 설정 (0.7 = 70% 품질)\n                                          const compressedDataUrl = canvas.toDataURL('image/jpeg', 0.7);\n                                          resolve(compressedDataUrl);\n                                        };\n                                      };\n                                      reader.readAsDataURL(file);\n                                    });\n                                  };\n                                  \n                                  // 이미지 압축 실행\n                                  compressImage(file).then(compressedDataUrl => {\n                                    const newImage = {\n                                      id: Date.now(), // 임시 ID\n                                      url: compressedDataUrl,\n                                      file: file\n                                    };\n                                    \n                                    // 기존 이미지에 추가\n                                    const updatedImages = [...uploadedImages, newImage];\n                                    setUploadedImages(updatedImages);\n                                    \n                                    // 첫 번째 이미지일 경우 대표 이미지로 설정\n                                    if (uploadedImages.length === 0) {\n                                      setFeaturedImageIndex(0);\n                                    }\n                                    \n                                    // formData의 imageUrls 업데이트\n                                    setFormData(prev => ({\n                                      ...prev,\n                                      imageUrls: updatedImages.map(img => img.url)\n                                    }));\n                                    \n                                    // 업로드 완료 상태로 변경\n                                    setIsUploading(false);\n                                  }).catch(error => {\n                                    console.error(\"이미지 압축 중 오류:\", error);\n                                    setIsUploading(false);\n                                    toast({\n                                      title: \"이미지 처리 실패\",\n                                      description: \"이미지 업로드 중 오류가 발생했습니다.\",\n                                      variant: \"destructive\"\n                                    });\n                                  });\n                                  \n                                  // input 초기화\n                                  e.target.value = '';\n                                }}\n                                disabled={isUploading || uploadedImages.length >= 5}\n                              />\n                            </label>\n                          </div>\n                        </div>\n                        \n                        {/* 업로드된 이미지 미리보기 */}\n                        {uploadedImages.length > 0 && (\n                          <div className=\"grid grid-cols-2 md:grid-cols-3 gap-3 mt-3\">\n                            {uploadedImages.map((image, index) => (\n                              <div key={image.id} className=\"relative group\">\n                                <img \n                                  src={image.url} \n                                  alt={`이미지 ${index + 1}`} \n                                  className=\"h-24 w-full object-cover rounded-md border\"\n                                />\n                                <div className=\"absolute inset-0 bg-black bg-opacity-30 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center rounded-md\">\n                                  <button\n                                    type=\"button\"\n                                    className=\"p-1 bg-red-500 text-white rounded-full\"\n                                    onClick={() => {\n                                      // 이미지 제거\n                                      const updatedImages = uploadedImages.filter(img => img.id !== image.id);\n                                      setUploadedImages(updatedImages);\n                                      \n                                      // formData 업데이트\n                                      setFormData(prev => ({\n                                        ...prev,\n                                        imageUrls: updatedImages.map(img => img.url)\n                                      }));\n                                      \n                                      // 대표 이미지 인덱스 조정\n                                      if (featuredImageIndex >= updatedImages.length && updatedImages.length > 0) {\n                                        setFeaturedImageIndex(0);\n                                      }\n                                    }}\n                                  >\n                                    <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n                                    </svg>\n                                  </button>\n                                  {/* 대표 이미지 선택 버튼 */}\n                                  <button\n                                    type=\"button\"\n                                    className={`absolute bottom-1 right-1 p-1.5 text-white rounded-full ${\n                                      index === featuredImageIndex \n                                        ? 'bg-green-500 ring-2 ring-white' \n                                        : 'bg-gray-500 bg-opacity-70 hover:bg-gray-500'\n                                    }`}\n                                    onClick={(e) => {\n                                      e.stopPropagation();\n                                      setFeaturedImageIndex(index);\n                                    }}\n                                    title={index === featuredImageIndex ? \"현재 대표 이미지입니다\" : \"대표 이미지로 설정\"}\n                                  >\n                                    <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-4 w-4\" fill={index === featuredImageIndex ? \"currentColor\" : \"none\"} viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                                      <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={index === featuredImageIndex ? 0 : 2} d=\"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z\" />\n                                    </svg>\n                                  </button>\n                                </div>\n                                {/* 대표 이미지 표시 라벨 */}\n                                {index === featuredImageIndex && (\n                                  <span className=\"absolute top-0 left-0 bg-green-500 text-white text-xs px-1.5 py-0.5 rounded-tr-md rounded-bl-md font-medium\">\n                                    대표이미지\n                                  </span>\n                                )}\n                              </div>\n                            ))}\n                          </div>\n                        )}\n                      </div>\n                    </div>\n                    \n                    {/* 대표 이미지 URL 입력 필드는 제거됨 */}\n                  </div>\n                  \n\n                  \n                  <div className=\"flex items-center space-x-2 pt-4\">\n                    <Checkbox\n                      id=\"featured\"\n                      name=\"featured\"\n                      checked={formData.featured}\n                      onCheckedChange={(checked) => \n                        setFormData({ ...formData, featured: checked })\n                      }\n                    />\n                    <Label htmlFor=\"featured\">추천 매물로 등록</Label>\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n          </TabsContent>\n          \n          {/* 상세 정보 탭 */}\n          <TabsContent value=\"details\">\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n              <Card>\n                <CardHeader>\n                  <CardTitle>위치 정보</CardTitle>\n                  <CardDescription>\n                    건물 및 상세 위치 정보를 입력하세요\n                  </CardDescription>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"buildingName\">건물명</Label>\n                    <Input\n                      id=\"buildingName\"\n                      name=\"buildingName\"\n                      value={formData.buildingName || \"\"}\n                      onChange={handleChange}\n                    />\n                  </div>\n                  \n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"unitNumber\">동호수</Label>\n                    <Input\n                      id=\"unitNumber\"\n                      name=\"unitNumber\"\n                      value={formData.unitNumber || \"\"}\n                      onChange={handleChange}\n                    />\n                  </div>\n                </CardContent>\n              </Card>\n              \n              <Card>\n                <CardHeader>\n                  <CardTitle>면적 정보</CardTitle>\n                  <CardDescription>\n                    상세 면적 정보를 입력하세요\n                  </CardDescription>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"supplyArea\">공급(평)</Label>\n                    <Input\n                      id=\"supplyArea\"\n                      name=\"supplyArea\"\n                      type=\"text\"\n                      value={formData.supplyArea || \"\"}\n                      onChange={handleChange}\n                    />\n                  </div>\n                  \n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"privateArea\">전용(평)</Label>\n                    <Input\n                      id=\"privateArea\"\n                      name=\"privateArea\"\n                      type=\"text\"\n                      value={formData.privateArea || \"\"}\n                      onChange={handleChange}\n                    />\n                  </div>\n                  \n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"areaSize\">평형</Label>\n                    <Input\n                      id=\"areaSize\"\n                      name=\"areaSize\"\n                      value={formData.areaSize || \"\"}\n                      onChange={handleChange}\n                    />\n                  </div>\n                </CardContent>\n              </Card>\n              \n              <Card>\n                <CardHeader>\n                  <CardTitle>건물 정보</CardTitle>\n                  <CardDescription>\n                    건물에 대한 상세 정보를 입력하세요\n                  </CardDescription>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <div className=\"grid grid-cols-2 gap-4\">\n                    <div className=\"space-y-2\">\n                      <Label htmlFor=\"floor\">층수</Label>\n                      <Input\n                        id=\"floor\"\n                        name=\"floor\"\n                        type=\"text\"\n                        value={formData.floor || \"\"}\n                        onChange={handleChange}\n                      />\n                    </div>\n                    <div className=\"space-y-2\">\n                      <Label htmlFor=\"totalFloors\">총층</Label>\n                      <Input\n                        id=\"totalFloors\"\n                        name=\"totalFloors\"\n                        type=\"number\"\n                        value={formData.totalFloors || \"\"}\n                        onChange={handleChange}\n                      />\n                    </div>\n                  </div>\n                  \n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"direction\">방향</Label>\n                    <Input\n                      id=\"direction\"\n                      name=\"direction\"\n                      value={formData.direction || \"\"}\n                      onChange={handleChange}\n                    />\n                  </div>\n                  \n                  <div className=\"flex items-center space-x-2 pt-2\">\n                    <Checkbox\n                      id=\"elevator\"\n                      name=\"elevator\"\n                      checked={formData.elevator}\n                      onCheckedChange={(checked) => \n                        setFormData({ ...formData, elevator: checked })\n                      }\n                    />\n                    <Label htmlFor=\"elevator\">승강기 있음</Label>\n                  </div>\n                  \n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"parking\">주차</Label>\n                    <Input\n                      id=\"parking\"\n                      name=\"parking\"\n                      value={formData.parking || \"\"}\n                      onChange={handleChange}\n                    />\n                  </div>\n                  \n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"heatingSystem\">난방방식</Label>\n                    <Input\n                      id=\"heatingSystem\"\n                      name=\"heatingSystem\"\n                      value={formData.heatingSystem || \"\"}\n                      onChange={handleChange}\n                    />\n                  </div>\n                  \n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"approvalDate\">사용승인</Label>\n                    <Input\n                      id=\"approvalDate\"\n                      name=\"approvalDate\"\n                      value={formData.approvalDate || \"\"}\n                      onChange={handleChange}\n                      placeholder=\"YYYY-MM-DD\"\n                    />\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n          </TabsContent>\n          \n          {/* 가격 정보 탭 */}\n          {/* 토지 정보 탭 */}\n          <TabsContent value=\"land\">\n            <Card>\n              <CardHeader>\n                <CardTitle>토지 정보</CardTitle>\n                <CardDescription>\n                  토지 관련 정보를 입력하세요\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"landType\">지목</Label>\n                    <Select \n                      value={formData.landType} \n                      onValueChange={(value) => setFormData({...formData, landType: value})}\n                    >\n                      <SelectTrigger id=\"landType\">\n                        <SelectValue placeholder=\"지목 선택\" />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"선택 안함\">선택 안함</SelectItem>\n                        {landTypeOptions.map(option => (\n                          <SelectItem key={option} value={option}>{option}</SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                  </div>\n                  \n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"zoneType\">용도지역</Label>\n                    <Select \n                      value={formData.zoneType} \n                      onValueChange={(value) => setFormData({...formData, zoneType: value})}\n                    >\n                      <SelectTrigger id=\"zoneType\">\n                        <SelectValue placeholder=\"용도지역 선택\" />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"선택 안함\">선택 안함</SelectItem>\n                        {zoneTypeOptions.map(option => (\n                          <SelectItem key={option} value={option}>{option}</SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n          \n          <TabsContent value=\"price\">\n            <Card>\n              <CardHeader>\n                <CardTitle>거래 정보</CardTitle>\n                <CardDescription>\n                  거래 유형과 가격 정보를 입력하세요\n                </CardDescription>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div>\n                  <Label className=\"mb-2 block\">거래 유형</Label>\n                  <div className=\"flex flex-wrap gap-4\">\n                    {dealTypeOptions.map(type => (\n                      <div key={type} className=\"flex items-center space-x-2\">\n                        <Checkbox\n                          id={`dealType-${type}`}\n                          checked={formData.dealType.includes(type)}\n                          onCheckedChange={(checked) => \n                            handleDealTypeChange(type, checked)\n                          }\n                        />\n                        <Label htmlFor={`dealType-${type}`}>{type}</Label>\n                      </div>\n                    ))}\n                  </div>\n                </div>\n                \n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6 mt-4\">\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"deposit\">전세금/보증금</Label>\n                    <Input\n                      id=\"deposit\"\n                      name=\"deposit\"\n                      type=\"text\"\n                      value={formData.deposit || \"\"}\n                      onChange={handleChange}\n                    />\n                  </div>\n                  \n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"monthlyRent\">월세</Label>\n                    <Input\n                      id=\"monthlyRent\"\n                      name=\"monthlyRent\"\n                      type=\"text\"\n                      value={formData.monthlyRent || \"\"}\n                      onChange={handleChange}\n                    />\n                  </div>\n                </div>\n                \n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"maintenanceFee\">관리비</Label>\n                  <Input\n                    id=\"maintenanceFee\"\n                    name=\"maintenanceFee\"\n                    type=\"text\"\n                    value={formData.maintenanceFee || \"\"}\n                    onChange={handleChange}\n                  />\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n          \n          {/* 연락처 탭 */}\n          <TabsContent value=\"contacts\">\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n              <Card>\n                <CardHeader>\n                  <CardTitle>소유자 정보</CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"ownerName\">소유자</Label>\n                    <Input\n                      id=\"ownerName\"\n                      name=\"ownerName\"\n                      value={formData.ownerName || \"\"}\n                      onChange={handleChange}\n                    />\n                  </div>\n                  \n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"ownerPhone\">소유자 전화</Label>\n                    <Input\n                      id=\"ownerPhone\"\n                      name=\"ownerPhone\"\n                      value={formData.ownerPhone || \"\"}\n                      onChange={handleChange}\n                    />\n                  </div>\n                </CardContent>\n              </Card>\n              \n              <Card>\n                <CardHeader>\n                  <CardTitle>임차인 정보</CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"tenantName\">임차인</Label>\n                    <Input\n                      id=\"tenantName\"\n                      name=\"tenantName\"\n                      value={formData.tenantName || \"\"}\n                      onChange={handleChange}\n                    />\n                  </div>\n                  \n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"tenantPhone\">임차인 전화</Label>\n                    <Input\n                      id=\"tenantPhone\"\n                      name=\"tenantPhone\"\n                      value={formData.tenantPhone || \"\"}\n                      onChange={handleChange}\n                    />\n                  </div>\n                </CardContent>\n              </Card>\n              \n              <Card>\n                <CardHeader>\n                  <CardTitle>의뢰인 정보</CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"clientName\">의뢰인</Label>\n                    <Input\n                      id=\"clientName\"\n                      name=\"clientName\"\n                      value={formData.clientName || \"\"}\n                      onChange={handleChange}\n                    />\n                  </div>\n                  \n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"clientPhone\">의뢰인 전화</Label>\n                    <Input\n                      id=\"clientPhone\"\n                      name=\"clientPhone\"\n                      value={formData.clientPhone || \"\"}\n                      onChange={handleChange}\n                    />\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n          </TabsContent>\n          \n          {/* 추가 정보 탭 */}\n          <TabsContent value=\"notes\">\n            <div className=\"grid grid-cols-1 gap-6\">\n              <Card>\n                <CardHeader>\n                  <CardTitle>추가 정보</CardTitle>\n                  <CardDescription>\n                    부동산 관련 메모와 추가 정보를 입력하세요\n                  </CardDescription>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"specialNote\">특이사항</Label>\n                    <Textarea\n                      id=\"specialNote\"\n                      name=\"specialNote\"\n                      value={formData.specialNote || \"\"}\n                      onChange={handleChange}\n                      rows={3}\n                    />\n                  </div>\n                  \n                  <div className=\"flex items-center space-x-2 pt-2\">\n                    <Checkbox\n                      id=\"coListing\"\n                      name=\"coListing\"\n                      checked={formData.coListing}\n                      onCheckedChange={(checked) => \n                        setFormData({ ...formData, coListing: checked })\n                      }\n                    />\n                    <Label htmlFor=\"coListing\">공동중개</Label>\n                  </div>\n                  \n                  {/* 매물설명 필드 삭제 요청에 따라 제거됨 */}\n                  \n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"privateNote\">비공개 메모</Label>\n                    <Textarea\n                      id=\"privateNote\"\n                      name=\"privateNote\"\n                      value={formData.privateNote || \"\"}\n                      onChange={handleChange}\n                      rows={4}\n                    />\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n          </TabsContent>\n        </Tabs>\n        \n        <div className=\"mt-8 flex justify-end\">\n          <Button\n            type=\"button\"\n            variant=\"outline\"\n            onClick={() => setLocation(\"/admin\")}\n            className=\"mr-4\"\n          >\n            취소\n          </Button>\n          <Button type=\"submit\" disabled={saving}>\n            {saving ? (\n              <>\n                <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n                저장 중...\n              </>\n            ) : (\n              <>\n                <Save className=\"mr-2 h-4 w-4\" />\n                {isEditMode ? \"수정 완료\" : \"등록 완료\"}\n              </>\n            )}\n          </Button>\n        </div>\n      </form>\n    </div>\n  );\n}\n\nexport default PropertyForm;","path":null,"size_bytes":53952,"size_tokens":null},"client/src/components/admin/UserDebugInfo.jsx":{"content":"import { useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Alert, AlertDescription } from \"@/components/ui/alert\";\nimport { RefreshCw, AlertCircle } from \"lucide-react\";\n\nexport default function UserDebugInfo() {\n  const [userData, setUserData] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n\n  // 사용자 데이터 로드\n  const fetchUserData = async () => {\n    try {\n      setLoading(true);\n      setError(null);\n      \n      const response = await fetch(\"/api/admin/users\", {\n        method: \"GET\",\n        headers: {\n          \"Accept\": \"application/json\",\n        },\n        credentials: \"include\",\n      });\n      \n      if (!response.ok) {\n        throw new Error(`서버 오류: ${response.status}`);\n      }\n      \n      const data = await response.json();\n      setUserData(data);\n      console.log(\"로드된 사용자 데이터:\", data);\n    } catch (err) {\n      setError(err.message || \"데이터 로드 중 오류가 발생했습니다.\");\n      console.error(\"데이터 로드 오류:\", err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"p-4 border rounded-lg bg-gray-50 mt-4\">\n      <h2 className=\"text-lg font-semibold mb-2\">사용자 데이터 디버그</h2>\n      \n      <div className=\"mb-4\">\n        <Button \n          onClick={fetchUserData} \n          disabled={loading}\n          variant=\"outline\"\n          className=\"flex items-center gap-1\"\n        >\n          {loading ? \"로딩 중...\" : \"사용자 데이터 가져오기\"}\n          {loading && <RefreshCw className=\"h-4 w-4 animate-spin\" />}\n        </Button>\n      </div>\n      \n      {error && (\n        <Alert variant=\"destructive\" className=\"mb-4\">\n          <AlertCircle className=\"h-4 w-4\" />\n          <AlertDescription>\n            {error}\n          </AlertDescription>\n        </Alert>\n      )}\n      \n      {userData && (\n        <div>\n          <h3 className=\"font-medium mb-2\">사용자 데이터 ({userData.length}명)</h3>\n          <div className=\"grid gap-4\">\n            {userData.map(user => (\n              <div key={user.id} className=\"p-3 border rounded-md bg-white\">\n                <h4 className=\"font-semibold mb-1\">ID: {user.id} | {user.username}</h4>\n                <p className=\"text-sm text-gray-600 mb-1\">이메일: {user.email || \"-\"}</p>\n                <p className=\"text-sm text-gray-600 mb-1\">전화번호: {user.phone || \"전화번호 없음\"}</p>\n                <p className=\"text-sm text-gray-600\">역할: {user.role}</p>\n                <div className=\"mt-2 text-xs text-gray-500\">\n                  <details>\n                    <summary>모든 필드 보기</summary>\n                    <pre className=\"mt-1 p-2 bg-gray-100 rounded overflow-auto text-xs\">\n                      {JSON.stringify(user, null, 2)}\n                    </pre>\n                  </details>\n                </div>\n              </div>\n            ))}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}","path":null,"size_bytes":3049,"size_tokens":null},"server/sheet-importer.ts":{"content":"import { google } from 'googleapis';\nimport { storage } from './storage';\nimport { InsertProperty } from '@shared/schema';\nimport { log } from './vite';\n\n// 구글 시트 데이터를 부동산 매물 데이터로 변환하는 함수\nexport async function importPropertiesFromSheet(\n  spreadsheetId: string,\n  apiKey: string,\n  range: string = 'Sheet1!A2:AN'\n): Promise<{\n  success: boolean;\n  count?: number;\n  importedIds?: number[];\n  error?: string;\n}> {\n  try {\n    // 구글 시트 API 클라이언트 생성\n    const sheets = google.sheets({ version: 'v4', auth: apiKey });\n\n    // 시트 데이터 가져오기\n    const response = await sheets.spreadsheets.values.get({\n      spreadsheetId,\n      range,\n    });\n\n    const rows = response.data.values;\n    \n    if (!rows || rows.length === 0) {\n      return { success: false, error: '시트에 데이터가 없습니다.' };\n    }\n\n    log(`구글 시트에서 ${rows.length}개의 행을 찾았습니다.`, 'info');\n\n    // 가져온 프로퍼티 ID 목록\n    const importedIds: number[] = [];\n    \n    // 에러 기록\n    const errors: string[] = [];\n\n    // 각 행을 처리하여 매물 데이터로 변환\n    for (let i = 0; i < rows.length; i++) {\n      try {\n        const row = rows[i];\n        // 행 데이터가 충분히 있는지 확인\n        if (row.length < 3) {\n          errors.push(`행 ${i+2}: 데이터가 부족합니다.`);\n          continue;\n        }\n\n        // 시트 열 매핑 (확장된 버전)\n        // A:제목, B:설명, C:유형, D:가격, E:주소, F:지역, G:면적, H:침실수, I:욕실수,\n        // J:층수, K:총층수, L:이미지URL, M:이미지URLs, N:추천매물, O:거래유형, P:건축년도,\n        // Q:보증금, R:월세, S:관리비, T:지목, U:용도지역, V:건물명, W:동호수, X:공급면적,\n        // Y:전용면적, Z:평형, AA:방향, AB:승강기유무, AC:주차대수, AD:난방방식, AE:사용승인일,\n        // AF:소유자, AG:소유자전화, AH:임차인, AI:임차인전화, AJ:의뢰인, AK:의뢰인전화,\n        // AL:특이사항, AM:공동중개유무, AN:비공개메모\n        const propertyData: Partial<InsertProperty> = {\n          title: row[0] || '',\n          description: row[1] || '',\n          type: mapPropertyType(row[2] || ''),\n          price: row[3] || '',\n          address: row[4] || '',\n          district: row[5] || '',\n          size: row[6]?.toString() || '0',\n          bedrooms: parseInt(row[7]) || 0,\n          bathrooms: parseInt(row[8]) || 0,\n          floor: parseInt(row[9]) || null,\n          totalFloors: parseInt(row[10]) || null,\n          imageUrl: row[11] || getDefaultImageForPropertyType(mapPropertyType(row[2] || '')),\n          imageUrls: row[12] ? JSON.parse(row[12]) : [row[11] || getDefaultImageForPropertyType(mapPropertyType(row[2] || ''))],\n          featured: row[13]?.toLowerCase() === 'true' || false,\n          dealType: row[14] ? [row[14]] : ['매매'], // O열: 거래유형\n          yearBuilt: row[15] || null, // P열: 건축년도\n          deposit: row[16] || null, // Q열: 보증금\n          monthlyRent: row[17] || null, // R열: 월세\n          maintenanceFee: row[18] || null, // S열: 관리비\n          landType: row[19] || null, // T열: 지목\n          zoneType: row[20] || null, // U열: 용도지역\n          buildingName: row[21] || null, // V열: 건물명\n          unitNumber: row[22] || null, // W열: 동호수\n          supplyArea: row[23] || null, // X열: 공급면적\n          privateArea: row[24] || null, // Y열: 전용면적\n          areaSize: row[25] || null, // Z열: 평형\n          direction: row[26] || null, // AA열: 방향\n          elevator: row[27]?.toLowerCase() === 'true' || false, // AB열: 승강기유무\n          parking: row[28] || null, // AC열: 주차대수\n          heatingSystem: row[29] || null, // AD열: 난방방식\n          approvalDate: row[30] || null, // AE열: 사용승인일\n          ownerName: row[31] || null, // AF열: 소유자\n          ownerPhone: row[32] || null, // AG열: 소유자전화\n          tenantName: row[33] || null, // AH열: 임차인\n          tenantPhone: row[34] || null, // AI열: 임차인전화\n          clientName: row[35] || null, // AJ열: 의뢰인\n          clientPhone: row[36] || null, // AK열: 의뢰인전화\n          specialNote: row[37] || null, // AL열: 특이사항\n          coListing: row[38]?.toLowerCase() === 'true' || false, // AM열: 공동중개유무\n          privateNote: row[39] || null, // AN열: 비공개메모\n          agentId: 4 // 기본 중개사 ID\n        };\n\n        // 필수 필드 검증\n        if (!propertyData.title || !propertyData.price || !propertyData.address) {\n          errors.push(`행 ${i+2}: 필수 필드(제목, 가격, 주소)가 누락되었습니다.`);\n          continue;\n        }\n\n        // 데이터베이스에 저장\n        const savedProperty = await storage.createProperty(propertyData as InsertProperty);\n        importedIds.push(savedProperty.id);\n        \n        log(`행 ${i+2} 임포트 성공: ${savedProperty.title} (ID: ${savedProperty.id})`, 'info');\n      } catch (rowError) {\n        errors.push(`행 ${i+2} 처리 오류: ${rowError}`);\n        log(`행 ${i+2} 처리 오류: ${rowError}`, 'error');\n      }\n    }\n\n    // 오류가 있으면 로그에 기록\n    if (errors.length > 0) {\n      log(`${errors.length}개의 행에서 오류가 발생했습니다: ${errors.join('; ')}`, 'error');\n    }\n\n    return {\n      success: true,\n      count: importedIds.length,\n      importedIds,\n      error: errors.length > 0 ? `${errors.length}개의 행에서 오류가 발생했습니다` : undefined\n    };\n  } catch (error) {\n    log(`구글 시트 데이터 가져오기 실패: ${error}`, 'error');\n    return { success: false, error: `구글 시트 데이터 가져오기 실패: ${error}` };\n  }\n}\n\n// 속성 유형 매핑 함수\nfunction mapPropertyType(type: string): string {\n  const typeMap: Record<string, string> = {\n    '토지': '토지',\n    '주택': '주택',\n    '아파트': '아파트연립다세대',\n    '연립': '아파트연립다세대',\n    '다세대': '아파트연립다세대',\n    '아파트연립다세대': '아파트연립다세대',\n    '원룸': '원투룸',\n    '투룸': '원투룸',\n    '원투룸': '원투룸',\n    '상가': '상가공장창고펜션',\n    '공장': '상가공장창고펜션',\n    '창고': '상가공장창고펜션',\n    '펜션': '상가공장창고펜션',\n    '상가공장창고펜션': '상가공장창고펜션'\n  };\n\n  // 정확한 매칭 시도\n  if (typeMap[type]) {\n    return typeMap[type];\n  }\n\n  // 부분 매칭 시도\n  for (const key in typeMap) {\n    if (type.includes(key)) {\n      return typeMap[key];\n    }\n  }\n\n  // 기본값\n  return '주택';\n}\n\n// 속성 유형에 따른 기본 이미지 URL 반환 함수\nfunction getDefaultImageForPropertyType(type: string): string {\n  const imageMap: Record<string, string> = {\n    '토지': '/attached_assets/토지-001.png',\n    '주택': '/attached_assets/주택-001.png',\n    '아파트연립다세대': '/attached_assets/아파트-001.png',\n    '원투룸': '/attached_assets/원룸-001.png',\n    '상가공장창고펜션': '/attached_assets/상가펜션-001.png'\n  };\n\n  return imageMap[type] || '/attached_assets/주택-001.png';\n}","path":null,"size_bytes":7361,"size_tokens":null},"client/src/pages/AgentsPage.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Agent } from \"@shared/schema\";\nimport AgentCard from \"@/components/agent/AgentCard\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { Helmet } from \"react-helmet\";\n\nconst AgentsPage = () => {\n  const { data: agents, isLoading, error } = useQuery<Agent[]>({\n    queryKey: [\"/api/agents\"],\n  });\n\n  return (\n    <div className=\"pt-16\"> {/* Offset for fixed header */}\n      <Helmet>\n        <title>중개사 소개 | 이가이버 부동산</title>\n        <meta \n          name=\"description\" \n          content=\"이가이버 부동산의 전문 중개사를 소개합니다. 각 지역과 부동산 유형별 전문가들이 최상의 서비스를 제공합니다.\"\n        />\n        <meta property=\"og:title\" content=\"중개사 소개 | 이가이버 부동산\" />\n        <meta property=\"og:type\" content=\"website\" />\n        <meta property=\"og:description\" content=\"이가이버 부동산의 전문 중개사를 소개합니다. 각 지역과 부동산 유형별 전문가들이 최상의 서비스를 제공합니다.\" />\n      </Helmet>\n\n      <div className=\"bg-primary/10 py-12\">\n        <div className=\"container mx-auto px-4\">\n          <h1 className=\"text-3xl font-bold\">중개사 소개</h1>\n          <p className=\"text-gray-medium mt-2\">\n            각 분야의 전문성을 갖춘 이가이버 부동산의 중개사들을 소개합니다.\n          </p>\n        </div>\n      </div>\n      \n      <div className=\"container mx-auto px-4 py-12\">\n        {isLoading ? (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8\">\n            {[...Array(4)].map((_, index) => (\n              <Skeleton key={index} className=\"h-80 w-full\" />\n            ))}\n          </div>\n        ) : error ? (\n          <div className=\"bg-red-50 p-6 rounded-lg text-red-600\">\n            <h3 className=\"text-xl font-bold mb-2\">중개사 정보를 불러오는 중 오류가 발생했습니다</h3>\n            <p>잠시 후 다시 시도해주세요.</p>\n          </div>\n        ) : agents && agents.length > 0 ? (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8\">\n            {agents.map((agent) => (\n              <AgentCard key={agent.id} agent={agent} />\n            ))}\n          </div>\n        ) : (\n          <div className=\"text-center py-12\">\n            <p className=\"text-gray-medium\">중개사 정보가 없습니다.</p>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default AgentsPage;\n","path":null,"size_bytes":2542,"size_tokens":null},"server/routes.ts":{"content":"import type { Express } from \"express\";\nimport { createServer, type Server } from \"http\";\nimport { storage } from \"./storage\";\nimport { z } from \"zod\";\nimport { db } from \"./db\";\nimport { \n  insertInquirySchema, \n  insertPropertySchema, \n  insertNewsSchema, \n  insertPropertyInquirySchema,\n  insertFavoriteSchema,\n  news\n} from \"@shared/schema\";\nimport { memoryCache } from \"./cache\";\nimport { setupAuth } from \"./auth\";\nimport { fetchAndSaveNews, setupNewsScheduler } from \"./news-fetcher\";\nimport { sendEmail, createInquiryEmailTemplate } from \"./mailer\";\nimport { getRecentTransactions } from \"./real-estate-api\";\nimport { testRealEstateAPI } from \"./test-api\";\nimport { getLatestBlogPosts } from \"./blog-fetcher\";\nimport { getLatestYouTubeVideos } from \"./youtube-fetcher\";\nimport { importPropertiesFromSheet } from \"./sheet-importer\";\n\n// 사이트 설정 (필요시 환경변수나 설정 파일로 이동 가능)\nconst siteConfig = {\n  siteName: \"이가이버 부동산\",\n  siteDescription: \"강화도 부동산 중개 서비스\",\n  siteContactEmail: \"contact@ganghwaestate.com\"\n};\n\nexport async function registerRoutes(app: Express): Promise<Server> {\n  // 인증 시스템 설정\n  setupAuth(app);\n  \n  // 사이트 설정 API\n  app.get('/api/site/config', (req, res) => {\n    res.json(siteConfig);\n  });\n  \n  // API ROUTES\n  \n  // Properties\n  app.get(\"/api/properties\", async (req, res) => {\n    try {\n      // 캐시 확인 여부를 쿼리 파라미터로 제어\n      const skipCache = req.query.skipCache === 'true';\n      \n      if (!skipCache) {\n        // 캐시에서 먼저 확인\n        const cacheKey = \"properties_all\";\n        const cachedProperties = memoryCache.get(cacheKey);\n        \n        if (cachedProperties) {\n          return res.json(cachedProperties);\n        }\n      }\n      \n      // 캐시에 없거나 캐시 스킵 요청이면 DB에서 조회\n      const properties = await storage.getProperties();\n      \n      // 캐시 스킵이 아닐 경우에만 캐시 저장\n      if (!skipCache) {\n        // 조회 결과를 캐시에 저장 (1분 동안 - 짧게 유지)\n        memoryCache.set(\"properties_all\", properties, 1 * 60 * 1000);\n      }\n      \n      res.json(properties);\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to fetch properties\" });\n    }\n  });\n\n  // 관리자용 모든 매물 조회 (노출/미노출 포함)\n  app.get(\"/api/admin/properties\", async (req, res) => {\n    try {\n      // 인증 및 권한 확인\n      if (!req.isAuthenticated()) {\n        return res.status(401).json({ message: \"인증되지 않은 사용자입니다.\" });\n      }\n      \n      const user = req.user as Express.User;\n      if (user.role !== \"admin\") {\n        return res.status(403).json({ message: \"관리자만 접근할 수 있습니다.\" });\n      }\n\n      const properties = await storage.getAllProperties();\n      res.json(properties);\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to fetch all properties\" });\n    }\n  });\n  \n  app.get(\"/api/properties/featured\", async (req, res) => {\n    try {\n      const limit = req.query.limit ? parseInt(req.query.limit as string) : undefined;\n      \n      // 캐시 비활성화 - 항상 최신 데이터를 가져옴\n      const properties = await storage.getFeaturedProperties(limit);\n      \n      // 디버깅용 로그 추가\n      console.log(`추천 매물 ${properties.length}개 조회됨:`, \n                  properties.map(p => `${p.id}:${p.title}(${p.featured ? '추천' : '일반'})`));\n      \n      res.json(properties);\n    } catch (error) {\n      console.error(\"Error fetching featured properties:\", error);\n      res.status(500).json({ message: \"Failed to fetch featured properties\" });\n    }\n  });\n  \n  app.get(\"/api/properties/:id\", async (req, res) => {\n    try {\n      const id = parseInt(req.params.id);\n      const property = await storage.getProperty(id);\n      \n      if (!property) {\n        return res.status(404).json({ message: \"Property not found\" });\n      }\n      \n      res.json(property);\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to fetch property\" });\n    }\n  });\n  \n  app.get(\"/api/properties/type/:type\", async (req, res) => {\n    try {\n      const type = req.params.type;\n      const properties = await storage.getPropertiesByType(type);\n      res.json(properties);\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to fetch properties by type\" });\n    }\n  });\n  \n  app.get(\"/api/properties/district/:district\", async (req, res) => {\n    try {\n      const district = req.params.district;\n      const properties = await storage.getPropertiesByDistrict(district);\n      res.json(properties);\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to fetch properties by district\" });\n    }\n  });\n  \n  app.get(\"/api/properties/price-range\", async (req, res) => {\n    try {\n      const minParam = req.query.min;\n      const maxParam = req.query.max;\n      \n      if (!minParam || !maxParam) {\n        return res.status(400).json({ message: \"Min and max parameters are required\" });\n      }\n      \n      const min = parseInt(minParam as string);\n      const max = parseInt(maxParam as string);\n      \n      if (isNaN(min) || isNaN(max)) {\n        return res.status(400).json({ message: \"Min and max must be valid numbers\" });\n      }\n      \n      const properties = await storage.getPropertiesByPriceRange(min, max);\n      res.json(properties);\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to fetch properties by price range\" });\n    }\n  });\n  \n  // Agents API - 제거됨\n  \n  // Testimonials API - 제거됨\n  \n  // Inquiries\n  app.post(\"/api/inquiries\", async (req, res) => {\n    try {\n      const validatedData = insertInquirySchema.parse(req.body);\n      const inquiry = await storage.createInquiry(validatedData);\n\n      // 이메일 발송 시도\n      try {\n        // 이메일 템플릿 생성\n        const emailTemplate = createInquiryEmailTemplate({\n          name: validatedData.name,\n          email: validatedData.email,\n          phone: validatedData.phone,\n          message: validatedData.message\n        });\n\n        // 수신자 이메일 주소를 명시적으로 설정 \n        const recipientEmail = '9551304@naver.com'; // 여기에 원하는 수신자 이메일을 직접 입력\n        console.log(`수신자 이메일 설정: ${recipientEmail}`);\n        \n        // 이메일 발송\n        const emailSent = await sendEmail(\n          recipientEmail, \n          `[이가이버부동산 웹사이트] ${validatedData.name}님의 새로운 문의가 등록되었습니다`, \n          emailTemplate\n        );\n\n        if (emailSent) {\n          console.log(`문의 ID ${inquiry.id}에 대한 알림 이메일 전송 완료`);\n        } else {\n          console.error(`문의 ID ${inquiry.id}에 대한 알림 이메일 전송 실패`);\n        }\n      } catch (emailError) {\n        // 이메일 발송 실패 시 로그 기록만 하고 전체 요청은 실패로 처리하지 않음\n        console.error('문의 알림 이메일 발송 중 오류 발생:', emailError);\n      }\n\n      res.status(201).json(inquiry);\n    } catch (error) {\n      if (error instanceof z.ZodError) {\n        return res.status(400).json({ message: \"Invalid inquiry data\", errors: error.errors });\n      }\n      res.status(500).json({ message: \"Failed to create inquiry\" });\n    }\n  });\n  \n  // Property Inquiry Board API\n  app.get(\"/api/properties/:propertyId/inquiries\", async (req, res) => {\n    try {\n      const propertyId = parseInt(req.params.propertyId);\n      const property = await storage.getProperty(propertyId);\n      \n      if (!property) {\n        return res.status(404).json({ message: \"해당 매물을 찾을 수 없습니다.\" });\n      }\n      \n      // 사용자 인증 상태 확인\n      let user = null;\n      let isAdmin = false;\n      \n      if (req.isAuthenticated()) {\n        user = req.user as Express.User;\n        isAdmin = user.role === \"admin\";\n      }\n      \n      // 해당 매물에 대한 문의글 목록 가져오기\n      const inquiries = await storage.getPropertyInquiries(propertyId);\n      \n      // 문의글 처리 (모든 사용자에게 제목은 표시하되, 내용은 권한에 따라 필터링)\n      // 모든 문의글을 기본적으로 제공하되, 열람 권한이 없는 경우 내용을 숨김\n      const filteredInquiries = inquiries.map(inquiry => {\n        // 1. 관리자인 경우: 모든 문의글 전체 내용 볼 수 있음\n        if (isAdmin) return inquiry;\n        \n        // 2. 로그인한 사용자이고 자신이 작성한 글은 전체 내용 볼 수 있음\n        if (user && inquiry.userId === user.id) return inquiry;\n        \n        // 3. 로그인한 사용자이고 답변글인 경우 자신이 작성한 문의글의 답변만 내용을 볼 수 있음\n        if (user && inquiry.isReply && inquiry.parentId) {\n          // 원글 작성자 찾기\n          const parentInquiry = inquiries.find(i => i.id === inquiry.parentId);\n          if (user && parentInquiry?.userId === user.id) return inquiry;\n          \n          // 원글 작성자가 아닌 경우 내용을 숨김\n          return {\n            ...inquiry,\n            content: \"권한이 없습니다. 이 답변은 문의 작성자와 관리자만 볼 수 있습니다.\" // 내용 숨김\n          };\n        }\n        \n        // 4. 일반 문의글은 제목과 작성자 정보만 볼 수 있음 (내용 숨김)\n        return {\n          ...inquiry,\n          content: \"권한이 없습니다. 이 문의글은 작성자와 관리자만 볼 수 있습니다.\" // 내용 숨김\n        };\n      });\n        \n      res.json(filteredInquiries);\n    } catch (error) {\n      console.error(\"Error getting property inquiries:\", error);\n      res.status(500).json({ message: \"문의글 목록을 가져오는 중 오류가 발생했습니다.\" });\n    }\n  });\n  \n  app.post(\"/api/properties/:propertyId/inquiries\", async (req, res) => {\n    try {\n      // 인증 확인\n      if (!req.isAuthenticated()) {\n        return res.status(401).json({ message: \"인증되지 않은 사용자입니다.\" });\n      }\n      \n      const propertyId = parseInt(req.params.propertyId);\n      const property = await storage.getProperty(propertyId);\n      \n      if (!property) {\n        return res.status(404).json({ message: \"해당 매물을 찾을 수 없습니다.\" });\n      }\n      \n      const user = req.user as Express.User;\n      \n      // 답변을 작성하는 경우 권한 확인 (관리자만 가능)\n      if (req.body.isReply) {\n        const isAdmin = user.role === \"admin\";\n        \n        if (!isAdmin) {\n          return res.status(403).json({ message: \"답변은 관리자만 작성할 수 있습니다.\" });\n        }\n        \n        // 부모 문의글 확인\n        const parentId = req.body.parentId;\n        if (!parentId) {\n          return res.status(400).json({ message: \"답변에는 부모 문의글 ID가 필요합니다.\" });\n        }\n        \n        // 부모 문의글 조회하여 존재하는지 확인\n        const parentInquiry = await storage.getPropertyInquiry(parentId);\n        if (!parentInquiry) {\n          return res.status(404).json({ message: \"원본 문의글을 찾을 수 없습니다.\" });\n        }\n        \n        // 부모 문의글이 답변글이 아닌지 확인 (답변에 답변을 달 수 없음)\n        if (parentInquiry.isReply) {\n          return res.status(400).json({ message: \"답변에는 추가 답변을 달 수 없습니다.\" });\n        }\n      }\n      \n      const inquiryData = {\n        ...req.body,\n        propertyId,\n        userId: user.id,\n      };\n      \n      const validatedData = insertPropertyInquirySchema.parse(inquiryData);\n      const inquiry = await storage.createPropertyInquiry(validatedData);\n      res.status(201).json(inquiry);\n    } catch (error) {\n      if (error instanceof z.ZodError) {\n        return res.status(400).json({ message: \"잘못된 문의글 데이터입니다.\", errors: error.errors });\n      }\n      console.error(\"Error creating property inquiry:\", error);\n      res.status(500).json({ message: \"문의글 작성 중 오류가 발생했습니다.\" });\n    }\n  });\n  \n  app.delete(\"/api/properties/:propertyId/inquiries/:inquiryId\", async (req, res) => {\n    try {\n      // 인증 확인\n      if (!req.isAuthenticated()) {\n        return res.status(401).json({ message: \"인증되지 않은 사용자입니다.\" });\n      }\n      \n      const inquiryId = parseInt(req.params.inquiryId);\n      const inquiry = await storage.getPropertyInquiry(inquiryId);\n      \n      if (!inquiry) {\n        return res.status(404).json({ message: \"해당 문의글을 찾을 수 없습니다.\" });\n      }\n      \n      // 접근 권한 확인 (작성자 또는 관리자만 삭제 가능)\n      const user = req.user as Express.User;\n      const isAdmin = user.role === \"admin\";\n      const isAuthor = inquiry.userId === user.id;\n      \n      if (!isAdmin && !isAuthor) {\n        return res.status(403).json({ message: \"해당 문의글을 삭제할 권한이 없습니다.\" });\n      }\n      \n      const success = await storage.deletePropertyInquiry(inquiryId);\n      if (success) {\n        res.status(200).json({ message: \"문의글이 삭제되었습니다.\" });\n      } else {\n        res.status(500).json({ message: \"문의글 삭제 중 오류가 발생했습니다.\" });\n      }\n    } catch (error) {\n      console.error(\"Error deleting property inquiry:\", error);\n      res.status(500).json({ message: \"문의글 삭제 중 오류가 발생했습니다.\" });\n    }\n  });\n\n  // 관리자용 문의글 알림 API\n  app.get(\"/api/admin/inquiries/unread\", async (req, res) => {\n    try {\n      // 관리자 권한 확인\n      if (!req.isAuthenticated()) {\n        return res.status(401).json({ message: \"인증되지 않은 사용자입니다.\" });\n      }\n\n      const user = req.user as Express.User;\n      if (user.role !== \"admin\") {\n        return res.status(403).json({ message: \"관리자만 접근할 수 있습니다.\" });\n      }\n\n      const unreadInquiries = await storage.getUnreadInquiries();\n      res.json(unreadInquiries);\n    } catch (error) {\n      console.error(\"Error getting unread inquiries:\", error);\n      res.status(500).json({ message: \"미읽은 문의글을 가져오는 중 오류가 발생했습니다.\" });\n    }\n  });\n\n  app.get(\"/api/admin/inquiries/unread/count\", async (req, res) => {\n    try {\n      // 관리자 권한 확인\n      if (!req.isAuthenticated()) {\n        return res.status(401).json({ message: \"인증되지 않은 사용자입니다.\" });\n      }\n\n      const user = req.user as Express.User;\n      if (user.role !== \"admin\") {\n        return res.status(403).json({ message: \"관리자만 접근할 수 있습니다.\" });\n      }\n\n      const count = await storage.getUnreadInquiryCount();\n      res.json({ count });\n    } catch (error) {\n      console.error(\"Error getting unread inquiry count:\", error);\n      res.status(500).json({ message: \"미읽은 문의글 수를 가져오는 중 오류가 발생했습니다.\" });\n    }\n  });\n\n  app.put(\"/api/admin/inquiries/:inquiryId/read\", async (req, res) => {\n    try {\n      // 관리자 권한 확인\n      if (!req.isAuthenticated()) {\n        return res.status(401).json({ message: \"인증되지 않은 사용자입니다.\" });\n      }\n\n      const user = req.user as Express.User;\n      if (user.role !== \"admin\") {\n        return res.status(403).json({ message: \"관리자만 접근할 수 있습니다.\" });\n      }\n\n      const inquiryId = parseInt(req.params.inquiryId);\n      const success = await storage.markInquiryAsRead(inquiryId);\n      \n      if (success) {\n        res.json({ message: \"문의글을 읽음 처리했습니다.\" });\n      } else {\n        res.status(500).json({ message: \"읽음 처리 중 오류가 발생했습니다.\" });\n      }\n    } catch (error) {\n      console.error(\"Error marking inquiry as read:\", error);\n      res.status(500).json({ message: \"읽음 처리 중 오류가 발생했습니다.\" });\n    }\n  });\n\n  app.put(\"/api/admin/inquiries/read-all\", async (req, res) => {\n    try {\n      // 관리자 권한 확인\n      if (!req.isAuthenticated()) {\n        return res.status(401).json({ message: \"인증되지 않은 사용자입니다.\" });\n      }\n\n      const user = req.user as Express.User;\n      if (user.role !== \"admin\") {\n        return res.status(403).json({ message: \"관리자만 접근할 수 있습니다.\" });\n      }\n\n      const success = await storage.markAllInquiriesAsRead();\n      \n      if (success) {\n        res.json({ message: \"모든 문의글을 읽음 처리했습니다.\" });\n      } else {\n        res.status(500).json({ message: \"읽음 처리 중 오류가 발생했습니다.\" });\n      }\n    } catch (error) {\n      console.error(\"Error marking all inquiries as read:\", error);\n      res.status(500).json({ message: \"읽음 처리 중 오류가 발생했습니다.\" });\n    }\n  });\n  \n  // Search properties\n  app.get(\"/api/search\", async (req, res) => {\n    try {\n      const { district, type, minPrice, maxPrice, keyword } = req.query;\n      console.log(\"검색 파라미터:\", { district, type, minPrice, maxPrice, keyword });\n      \n      let properties = await storage.getProperties();\n      \n      // 키워드 검색 (제목, 설명, 주소에서 검색)\n      if (keyword && typeof keyword === 'string' && keyword.trim() !== '') {\n        const searchKeyword = keyword.toLowerCase().trim();\n        console.log(`키워드 검색: \"${searchKeyword}\"`);\n        \n        properties = properties.filter(p => {\n          const title = (p.title || '').toLowerCase();\n          const description = (p.description || '').toLowerCase();\n          const address = (p.address || '').toLowerCase();\n          const district = (p.district || '').toLowerCase();\n          \n          return title.includes(searchKeyword) || \n                 description.includes(searchKeyword) || \n                 address.includes(searchKeyword) ||\n                 district.includes(searchKeyword);\n        });\n        console.log(`키워드 검색 결과: ${properties.length}개 매물`);\n      }\n      \n      // 지역 필터링 (district 값이 존재하고 \"all\"이 아닌 경우)\n      if (district && district !== \"all\") {\n        console.log(`지역 필터링: ${district}`);\n        \n        properties = properties.filter(p => {\n          // 매물의 district 필드가 없는 경우를 대비한 안전 처리\n          const propertyDistrict = (p.district || \"\").toLowerCase();\n          // 검색 조건의 district를 소문자로 변환\n          const searchDistrict = (district as string).toLowerCase();\n          \n          // 이 부분에서 로그를 추가하여 디버깅\n          console.log(`매물 ID ${p.id}의 지역: \"${propertyDistrict}\", 검색 지역: \"${searchDistrict}\"`);\n          \n          // 검색 조건 분석: 정확한 일치 검색 (등록 시와 동일한 지역명 사용)\n          let isMatch = false;\n          \n          // 정확한 일치 케이스 \n          if (propertyDistrict === searchDistrict) {\n            isMatch = true;\n          }\n          // 기타지역 특수 케이스 (district 필드가 비어있거나 '강화'가 포함되지 않은 경우)\n          else if (searchDistrict === '기타지역') {\n            isMatch = !propertyDistrict.includes('강화') || propertyDistrict === '';\n          }\n          // all인 경우 모든 매물 표시\n          else if (searchDistrict === 'all') {\n            isMatch = true;\n          }\n          \n          if (isMatch) {\n            console.log(`✓ 매칭 매물 발견: ${p.id}, ${p.title}, ${p.district}`);\n          }\n          \n          return isMatch;\n        });\n      }\n      \n      // 유형 필터링 (type 값이 존재하고 \"all\"이 아닌 경우)\n      if (type && type !== \"all\") {\n        properties = properties.filter(p => {\n          // 대소문자 구분 없이 비교\n          const propertyType = (p.type || \"\").toLowerCase();\n          const searchType = (type as string).toLowerCase();\n          return propertyType.includes(searchType);\n        });\n      }\n      \n      // 가격 범위 필터링 (minPrice와 maxPrice 둘 다 존재하는 경우)\n      if (minPrice && maxPrice) {\n        const min = parseInt(minPrice as string);\n        const max = parseInt(maxPrice as string);\n        \n        if (!isNaN(min) && !isNaN(max)) {\n          properties = properties.filter(p => {\n            const price = p.price !== undefined ? Number(p.price) : 0;\n            return price >= min && price <= max;\n          });\n        }\n      }\n      \n      console.log(`검색 결과: ${properties.length}개 매물`);\n      res.json(properties);\n    } catch (error) {\n      console.error(\"매물 검색 오류:\", error);\n      res.status(500).json({ message: \"매물 검색 중 오류가 발생했습니다.\" });\n    }\n  });\n  \n  // 관리자 전용 API 엔드포인트\n  // 부동산 생성\n  app.post(\"/api/properties\", async (req, res) => {\n    try {\n      // 인증 확인\n      if (!req.isAuthenticated()) {\n        return res.status(401).json({ message: \"Authentication required\" });\n      }\n      \n      // 디버깅 로그 추가\n      console.log('부동산 등록 요청 데이터:', JSON.stringify(req.body, null, 2));\n      \n      try {\n        // 다중 이미지 URLs 배열을 처리\n        // imageUrls가 있으면 그대로 사용하고, 없으면 기본값인 빈 배열을 사용\n        // 타입을 변환하지 않고 원래 타입 그대로 유지\n        // bedrooms, bathrooms와 숫자 타입 필드의 빈 문자열을 변환\n        const processedData = {\n          ...req.body,\n          bedrooms: req.body.bedrooms !== undefined ? req.body.bedrooms : 0,\n          bathrooms: req.body.bathrooms !== undefined ? req.body.bathrooms : 0,\n          // 이미지 URL 필드 처리\n          imageUrls: Array.isArray(req.body.imageUrls) ? req.body.imageUrls : [],\n          // dealType 처리 - 배열로 변환\n          dealType: Array.isArray(req.body.dealType) ? req.body.dealType : \n                    (req.body.dealType ? [req.body.dealType] : ['매매']),\n          // 필수 필드에 대한 기본값 처리\n          city: req.body.city || \"인천\", // city 필드에 기본값 설정\n          size: req.body.size !== undefined ? String(req.body.size) : \"0\", // size를 문자열로 변환\n          // agentId 처리 - 필수 필드이므로 기본값 설정 (database에서는 agent_id로 저장됨)\n          agentId: req.body.agentId || req.body.agent_id || 4, // 기본값은 4 (정현우 중개사)\n          supplyArea: req.body.supplyArea === \"\" ? null : req.body.supplyArea,\n          privateArea: req.body.privateArea === \"\" ? null : req.body.privateArea,\n          floor: req.body.floor === \"\" ? null : (req.body.floor ? parseInt(req.body.floor) || null : null), \n          totalFloors: req.body.totalFloors === \"\" ? null : (req.body.totalFloors ? parseInt(req.body.totalFloors) || null : null),\n          deposit: req.body.deposit === \"\" ? null : req.body.deposit,\n          monthlyRent: req.body.monthlyRent === \"\" ? null : req.body.monthlyRent,\n          maintenanceFee: req.body.maintenanceFee === \"\" ? null : req.body.maintenanceFee\n        };\n        \n        console.log('처리된 데이터:', JSON.stringify(processedData, null, 2));\n        \n        const validatedData = insertPropertySchema.parse(processedData);\n        const property = await storage.createProperty(validatedData);\n        res.status(201).json(property);\n      } catch (e) {\n        if (e instanceof z.ZodError) {\n          console.error('유효성 검사 오류:', JSON.stringify(e.errors, null, 2));\n          return res.status(400).json({ message: \"Invalid property data\", errors: e.errors });\n        }\n        throw e;\n      }\n    } catch (error) {\n      console.error('부동산 등록 오류:', error);\n      res.status(500).json({ message: \"Failed to create property\" });\n    }\n  });\n  \n  // 부동산 수정\n  app.patch(\"/api/properties/:id\", async (req, res) => {\n    try {\n      // 인증 확인\n      if (!req.isAuthenticated()) {\n        return res.status(401).json({ message: \"Authentication required\" });\n      }\n      \n      const id = parseInt(req.params.id);\n      if (isNaN(id)) {\n        return res.status(400).json({ message: \"Invalid property ID\" });\n      }\n      \n      const existingProperty = await storage.getProperty(id);\n      if (!existingProperty) {\n        return res.status(404).json({ message: \"Property not found\" });\n      }\n      \n      // 신규 등록과 완전히 동일한 데이터 처리 로직 적용\n      const processedData = {\n        ...req.body,\n        bedrooms: req.body.bedrooms !== undefined ? req.body.bedrooms : (existingProperty.bedrooms || 0),\n        bathrooms: req.body.bathrooms !== undefined ? req.body.bathrooms : (existingProperty.bathrooms || 0),\n        // 이미지 URL 필드 처리\n        imageUrls: Array.isArray(req.body.imageUrls) ? req.body.imageUrls : (req.body.imageUrls ? [req.body.imageUrls] : existingProperty.imageUrls || []),\n        // dealType 처리 - 배열로 변환\n        dealType: Array.isArray(req.body.dealType) ? req.body.dealType : \n                  (req.body.dealType ? [req.body.dealType] : (existingProperty.dealType || ['매매'])),\n        // 필수 필드에 대한 기본값 처리\n        city: req.body.city || existingProperty.city || \"인천\", // city 필드에 기본값 설정\n        size: req.body.size !== undefined ? String(req.body.size) : (existingProperty.size ? String(existingProperty.size) : \"0\"), // size를 문자열로 변환\n        // agentId 처리 - 필수 필드이므로 기본값 설정 (database에서는 agent_id로 저장됨)\n        agentId: req.body.agentId || req.body.agent_id || existingProperty.agentId || 4, // 기본값은 4 (정현우 중개사)\n        supplyArea: req.body.supplyArea === \"\" ? null : req.body.supplyArea,\n        privateArea: req.body.privateArea === \"\" ? null : req.body.privateArea,\n        floor: req.body.floor === \"\" ? null : (req.body.floor ? parseInt(req.body.floor) || null : null), \n        totalFloors: req.body.totalFloors === \"\" ? null : (req.body.totalFloors ? parseInt(req.body.totalFloors) || null : null),\n        deposit: req.body.deposit === \"\" ? null : req.body.deposit,\n        monthlyRent: req.body.monthlyRent === \"\" ? null : req.body.monthlyRent,\n        maintenanceFee: req.body.maintenanceFee === \"\" ? null : req.body.maintenanceFee\n      };\n      \n      const validatedData = insertPropertySchema.partial().parse(processedData);\n      const updatedProperty = await storage.updateProperty(id, validatedData);\n      \n      res.json(updatedProperty);\n    } catch (error) {\n      if (error instanceof z.ZodError) {\n        console.error('부동산 수정 유효성 검사 오류:', JSON.stringify(error.errors, null, 2));\n        return res.status(400).json({ message: \"Invalid property data\", errors: error.errors });\n      }\n      console.error('부동산 수정 오류:', error);\n      res.status(500).json({ message: \"Failed to update property\" });\n    }\n  });\n  \n  // 부동산 삭제\n  app.delete(\"/api/properties/:id\", async (req, res) => {\n    try {\n      // 인증 확인\n      if (!req.isAuthenticated()) {\n        return res.status(401).json({ message: \"Authentication required\" });\n      }\n      \n      const id = parseInt(req.params.id);\n      if (isNaN(id)) {\n        return res.status(400).json({ message: \"Invalid property ID\" });\n      }\n      \n      const exists = await storage.getProperty(id);\n      if (!exists) {\n        return res.status(404).json({ message: \"Property not found\" });\n      }\n      \n      const result = await storage.deleteProperty(id);\n      \n      if (result) {\n        // 부동산 캐시 모두 삭제\n        memoryCache.deleteByPrefix(\"properties_\");\n        res.json({ success: true });\n      } else {\n        res.status(500).json({ message: \"Failed to delete property\" });\n      }\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to delete property\" });\n    }\n  });\n  \n  // 관리자 전용 사용자 목록 조회\n  app.get(\"/api/admin/users\", async (req, res) => {\n    try {\n      // 인증 및 관리자 권한 확인\n      if (!req.isAuthenticated()) {\n        return res.status(401).json({ message: \"Authentication required\" });\n      }\n      \n      const user = req.user;\n      if (!user || user.role !== \"admin\") {\n        return res.status(403).json({ message: \"Admin permission required\" });\n      }\n      \n      const users = await storage.getAllUsers();\n      \n      // 비밀번호 정보 제외하고 반환\n      const usersWithoutPasswords = users.map(({ password, ...userData }) => userData);\n      \n      res.json(usersWithoutPasswords);\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to fetch users\" });\n    }\n  });\n\n  // 관심매물 APIs\n  // 사용자의 관심매물 목록 조회\n  app.get(\"/api/favorites\", async (req, res) => {\n    try {\n      // 인증 확인\n      if (!req.isAuthenticated()) {\n        return res.status(401).json({ message: \"인증되지 않은 사용자입니다.\" });\n      }\n      \n      const user = req.user as Express.User;\n      const favoriteProperties = await storage.getFavoriteProperties(user.id);\n      \n      res.json(favoriteProperties);\n    } catch (error) {\n      console.error(\"Error fetching favorite properties:\", error);\n      res.status(500).json({ message: \"관심매물 목록을 가져오는 중 오류가 발생했습니다.\" });\n    }\n  });\n  \n  // 매물이 관심매물에 등록되어 있는지 확인\n  app.get(\"/api/properties/:propertyId/is-favorite\", async (req, res) => {\n    try {\n      // 인증되지 않은 사용자는 false 반환\n      if (!req.isAuthenticated()) {\n        return res.json({ isFavorite: false });\n      }\n      \n      const propertyId = parseInt(req.params.propertyId);\n      const user = req.user as Express.User;\n      \n      const isFavorite = await storage.isFavorite(user.id, propertyId);\n      res.json({ isFavorite });\n    } catch (error) {\n      console.error(\"Error checking if property is favorite:\", error);\n      res.status(500).json({ message: \"관심매물 확인 중 오류가 발생했습니다.\" });\n    }\n  });\n  \n  // 관심매물 추가\n  app.post(\"/api/favorites\", async (req, res) => {\n    try {\n      // 인증 확인\n      if (!req.isAuthenticated()) {\n        return res.status(401).json({ message: \"인증되지 않은 사용자입니다.\" });\n      }\n      \n      const user = req.user as Express.User;\n      const propertyId = parseInt(req.body.propertyId);\n      \n      if (isNaN(propertyId)) {\n        return res.status(400).json({ message: \"유효하지 않은 매물 ID입니다.\" });\n      }\n      \n      // 매물이 존재하는지 확인\n      const property = await storage.getProperty(propertyId);\n      if (!property) {\n        return res.status(404).json({ message: \"해당 매물을 찾을 수 없습니다.\" });\n      }\n      \n      const favoriteData = {\n        userId: user.id,\n        propertyId: propertyId\n      };\n      \n      try {\n        const favorite = await storage.addFavorite(favoriteData);\n        res.status(201).json({ message: \"관심매물로 등록되었습니다.\", favorite });\n      } catch (err) {\n        // 이미 관심매물로 등록되어 있는 경우\n        if (err instanceof Error && err.message.includes(\"이미 관심 매물로 등록\")) {\n          return res.status(409).json({ message: \"이미 관심매물로 등록되어 있습니다.\" });\n        }\n        throw err;\n      }\n    } catch (error) {\n      console.error(\"Error adding favorite:\", error);\n      res.status(500).json({ message: \"관심매물 등록 중 오류가 발생했습니다.\" });\n    }\n  });\n  \n  // 관심매물 삭제\n  app.delete(\"/api/favorites/:propertyId\", async (req, res) => {\n    try {\n      // 인증 확인\n      if (!req.isAuthenticated()) {\n        return res.status(401).json({ message: \"인증되지 않은 사용자입니다.\" });\n      }\n      \n      const user = req.user as Express.User;\n      const propertyId = parseInt(req.params.propertyId);\n      \n      if (isNaN(propertyId)) {\n        return res.status(400).json({ message: \"유효하지 않은 매물 ID입니다.\" });\n      }\n      \n      const success = await storage.removeFavorite(user.id, propertyId);\n      \n      if (success) {\n        res.json({ message: \"관심매물에서 삭제되었습니다.\" });\n      } else {\n        res.status(404).json({ message: \"해당 관심매물을 찾을 수 없습니다.\" });\n      }\n    } catch (error) {\n      console.error(\"Error removing favorite:\", error);\n      res.status(500).json({ message: \"관심매물 삭제 중 오류가 발생했습니다.\" });\n    }\n  });\n\n  // News API 엔드포인트\n\n  // 모든 뉴스 가져오기\n  app.get(\"/api/news\", async (req, res) => {\n    try {\n      const news = await storage.getNews();\n      res.json(news);\n    } catch (error) {\n      res.status(500).json({ message: \"뉴스를 불러오는데 실패했습니다\" });\n    }\n  });\n  \n  // API 테스트 엔드포인트 (문제 해결용)\n  app.get(\"/api/test-real-estate\", async (req, res) => {\n    try {\n      await testRealEstateAPI();\n      res.json({ \n        success: true, \n        message: \"API 테스트 완료, 서버 로그를 확인하세요\" \n      });\n    } catch (error) {\n      console.error(\"API 테스트 오류:\", error);\n      res.status(500).json({ \n        success: false, \n        message: \"API 테스트 중 오류 발생\" \n      });\n    }\n  });\n  \n  // 부동산 실거래가 API 라우트\n  app.get(\"/api/real-estate/transactions\", async (req, res) => {\n    try {\n      // 지역코드 (기본값: 강화군 28710)\n      const regionCode = req.query.regionCode as string || '28710';\n      \n      console.log(`실거래가 데이터 요청: 지역코드=${regionCode}`);\n      const transactions = await getRecentTransactions(regionCode);\n      \n      res.json({\n        success: true,\n        count: transactions.length,\n        data: transactions\n      });\n    } catch (error) {\n      console.error(\"실거래가 데이터 조회 오류:\", error);\n      res.status(500).json({ \n        success: false, \n        message: \"실거래가 데이터를 가져오는 중 오류가 발생했습니다.\" \n      });\n    }\n  });\n\n  // 최신 유튜브 영상 가져오기\n  app.get(\"/api/youtube/latest\", async (req, res) => {\n    try {\n      const limit = req.query.limit ? parseInt(req.query.limit as string) : 5;\n      \n      // 캐시에서 확인\n      const cacheKey = `youtube_latest_${limit}`;\n      const cachedVideos = memoryCache.get(cacheKey);\n      \n      if (cachedVideos) {\n        return res.json(cachedVideos);\n      }\n      \n      // 이가이버 유튜브 채널에서 최신 영상 가져오기\n      const channelUrl = \"https://www.youtube.com/channel/UCCG3_JlKhgalqhict7tKkbA?view_as=subscriber\";\n      const videos = await getLatestYouTubeVideos(channelUrl, limit);\n      \n      // 캐시에 저장 (6시간)\n      memoryCache.set(cacheKey, videos, 6 * 60 * 60 * 1000);\n      \n      res.json(videos);\n    } catch (error) {\n      console.error(\"유튜브 영상 가져오기 오류:\", error);\n      res.status(500).json({ \n        message: \"최신 유튜브 영상을 불러오는데 실패했습니다\",\n        error: error instanceof Error ? error.message : String(error)\n      });\n    }\n  });\n  \n  // 네이버 블로그 최신 글 가져오기\n  app.get(\"/api/blog/latest\", async (req, res) => {\n    try {\n      const limit = req.query.limit ? parseInt(req.query.limit as string) : 3; // 기본값 3으로 변경\n      const blogId = req.query.blogId as string || '9551304';\n      // 네이버 블로그 카테고리:\n      // - 21: 일상다반사\n      // - 35: 취미생활 \n      // - 36: 세상이야기\n      // 요청사항: 11번 부모 카테고리 제외, 21/35/36 카테고리 최신순 정렬\n      const categories = req.query.categories\n                        ? (req.query.categories as string).split(',')\n                        : ['21', '35', '36'];\n      \n      // 캐시를 강제로 초기화하는 쿼리 파라미터 추가\n      const refresh = req.query.refresh === 'true';\n      \n      // 캐시에서 확인\n      const cacheKey = `blog_latest_${blogId}_${categories.join('_')}_${limit}`;\n      \n      // 현재 시간 기준으로 캐시가 10분 이상 지났으면 자동 갱신\n      const now = Date.now();\n      const cacheTimestamp = memoryCache.getTimestamp(cacheKey);\n      const cacheAge = cacheTimestamp ? now - cacheTimestamp : Infinity;\n      const shouldRefresh = refresh || !cacheTimestamp || cacheAge > 10 * 60 * 1000; // 10분\n      \n      // 캐시 초기화가 필요하면 캐시 삭제\n      if (shouldRefresh) {\n        console.log(`블로그 캐시 초기화 (키: ${cacheKey}, 사유: ${refresh ? '강제 갱신' : '자동 갱신'}, 경과시간: ${cacheAge / 1000}초)`);\n        memoryCache.delete(cacheKey);\n      }\n      \n      const cachedPosts = memoryCache.get(cacheKey);\n      \n      if (cachedPosts) {\n        if (Array.isArray(cachedPosts) && cachedPosts.length > 0) {\n          console.log(`블로그 캐시에서 ${cachedPosts.length}개 포스트 반환`);\n          return res.json(cachedPosts);\n        } else {\n          console.log('블로그 캐시가 비어있거나, 잘못된 형식입니다. 새로 가져옵니다.');\n          memoryCache.delete(cacheKey);\n        }\n      }\n      \n      console.log(`블로그 데이터 새로 요청 (키: ${cacheKey})`);\n      \n      // 네이버 블로그에서 최신 포스트 가져오기\n      // 기존 global blogCache 초기화를 먼저 수행\n      if (refresh) {\n        console.log('강제 새로고침 요청 - 전역 블로그 캐시 초기화');\n        // blogCache를 직접 import하여 사용\n        try {\n          // blog-fetcher에서 blogCache를 import\n          const blogFetcher = require('./blog-fetcher');\n          if (blogFetcher.blogCache) {\n            blogFetcher.blogCache = {};\n            console.log('블로그 캐시가 완전히 초기화되었습니다. 모든 데이터를 새로 가져옵니다.');\n          }\n        } catch (e) {\n          console.error('블로그 캐시 초기화 실패:', e);\n        }\n      }\n      \n      let posts = await getLatestBlogPosts(blogId, categories, limit);\n      \n      // 데이터 유효성 검사 - 포스트가 없으면 다시 시도\n      if (!posts || posts.length === 0) {\n        console.log('블로그 데이터 조회 실패, 카테고리 변경 후 재시도');\n        // 기본 카테고리를 변경하여 다시 시도\n        posts = await getLatestBlogPosts(blogId, ['0', '11'], limit);\n      }\n      \n      // 포스트가 없으면 고정 대체 데이터 제공 (항상 실제 데이터를 먼저 시도)\n      if (!posts || !Array.isArray(posts) || posts.length === 0) {\n        console.log('네이버 블로그에서 포스트를 가져오지 못했습니다. 다시 시도합니다.');\n        \n        // 두 번째 시도\n        try {\n          posts = await getLatestBlogPosts(blogId, ['11', '0'], limit);\n        } catch (retryErr) {\n          console.error('블로그 데이터 두 번째 시도 실패:', retryErr);\n        }\n      }\n      \n      // 데이터 검증 - 잘못된 형식 필터링\n      if (Array.isArray(posts)) {\n        posts = posts.filter(post => \n          post && \n          typeof post === 'object' && \n          post.id && \n          post.title && \n          post.link\n        );\n        \n        // 제목 중복 제거 및 길이 조정\n        const uniqueTitles = new Set<string>();\n        posts = posts.filter(post => {\n          if (!post.title || uniqueTitles.has(post.title)) return false;\n          uniqueTitles.add(post.title);\n          \n          // 제목이 너무 길면 자르기\n          if (post.title.length > 50) {\n            post.title = post.title.substring(0, 50) + '...';\n          }\n          \n          return true;\n        });\n      }\n      \n      // 캐시에 저장 (30분)\n      if (Array.isArray(posts) && posts.length > 0) {\n        console.log(`${posts.length}개의 블로그 포스트를 캐시에 저장 (30분)`);\n        memoryCache.set(cacheKey, posts, 30 * 60 * 1000);\n      } else {\n        console.log('유효한 블로그 포스트가 없습니다.');\n      }\n      \n      res.json(posts);\n    } catch (error) {\n      console.error(\"블로그 포스트 가져오기 오류:\", error);\n      res.status(500).json({\n        message: \"최신 블로그 포스트를 불러오는데 실패했습니다\",\n        error: error instanceof Error ? error.message : String(error)\n      });\n    }\n  });\n\n  // 최신 뉴스 가져오기\n  app.get(\"/api/news/latest\", async (req, res) => {\n    try {\n      const limit = req.query.limit ? parseInt(req.query.limit as string) : 6;\n      \n      // 캐시에서 확인\n      const cacheKey = `news_latest_${limit}`;\n      const cachedNews = memoryCache.get(cacheKey);\n      \n      if (cachedNews) {\n        return res.json(cachedNews);\n      }\n      \n      const news = await storage.getLatestNews(limit);\n      \n      // 캐시에 저장 (5분)\n      memoryCache.set(cacheKey, news, 5 * 60 * 1000);\n      \n      res.json(news);\n    } catch (error) {\n      res.status(500).json({ message: \"최신 뉴스를 불러오는데 실패했습니다\" });\n    }\n  });\n\n  // 특정 뉴스 가져오기\n  app.get(\"/api/news/:id\", async (req, res) => {\n    try {\n      const id = parseInt(req.params.id);\n      if (isNaN(id)) {\n        return res.status(400).json({ message: \"유효하지 않은 뉴스 ID입니다\" });\n      }\n\n      const newsItem = await storage.getNewsById(id);\n      if (!newsItem) {\n        return res.status(404).json({ message: \"뉴스를 찾을 수 없습니다\" });\n      }\n\n      res.json(newsItem);\n    } catch (error) {\n      res.status(500).json({ message: \"뉴스를 불러오는데 실패했습니다\" });\n    }\n  });\n\n  // 카테고리별 뉴스 가져오기\n  app.get(\"/api/news/category/:category\", async (req, res) => {\n    try {\n      const category = req.params.category;\n      const news = await storage.getNewsByCategory(category);\n      res.json(news);\n    } catch (error) {\n      res.status(500).json({ message: \"카테고리별 뉴스를 불러오는데 실패했습니다\" });\n    }\n  });\n\n  // 관리자: 뉴스 생성\n  app.post(\"/api/news\", async (req, res) => {\n    try {\n      // 인증 확인\n      if (!req.isAuthenticated()) {\n        return res.status(401).json({ message: \"인증이 필요합니다\" });\n      }\n      \n      const validatedData = insertNewsSchema.parse(req.body);\n      const newsItem = await storage.createNews(validatedData);\n      res.status(201).json(newsItem);\n    } catch (error) {\n      if (error instanceof z.ZodError) {\n        return res.status(400).json({ message: \"유효하지 않은 뉴스 데이터입니다\", errors: error.errors });\n      }\n      res.status(500).json({ message: \"뉴스 생성에 실패했습니다\" });\n    }\n  });\n\n  // 관리자: 뉴스 수정\n  app.patch(\"/api/news/:id\", async (req, res) => {\n    try {\n      // 인증 확인\n      if (!req.isAuthenticated()) {\n        return res.status(401).json({ message: \"인증이 필요합니다\" });\n      }\n      \n      const id = parseInt(req.params.id);\n      if (isNaN(id)) {\n        return res.status(400).json({ message: \"유효하지 않은 뉴스 ID입니다\" });\n      }\n      \n      const existingNews = await storage.getNewsById(id);\n      if (!existingNews) {\n        return res.status(404).json({ message: \"뉴스를 찾을 수 없습니다\" });\n      }\n      \n      const validatedData = insertNewsSchema.partial().parse(req.body);\n      const updatedNews = await storage.updateNews(id, validatedData);\n      \n      res.json(updatedNews);\n    } catch (error) {\n      if (error instanceof z.ZodError) {\n        return res.status(400).json({ message: \"유효하지 않은 뉴스 데이터입니다\", errors: error.errors });\n      }\n      res.status(500).json({ message: \"뉴스 수정에 실패했습니다\" });\n    }\n  });\n\n  // 관리자: 뉴스 삭제\n  app.delete(\"/api/news/:id\", async (req, res) => {\n    try {\n      // 인증 확인\n      if (!req.isAuthenticated()) {\n        return res.status(401).json({ message: \"인증이 필요합니다\" });\n      }\n      \n      const id = parseInt(req.params.id);\n      if (isNaN(id)) {\n        return res.status(400).json({ message: \"유효하지 않은 뉴스 ID입니다\" });\n      }\n      \n      const exists = await storage.getNewsById(id);\n      if (!exists) {\n        return res.status(404).json({ message: \"뉴스를 찾을 수 없습니다\" });\n      }\n      \n      const result = await storage.deleteNews(id);\n      \n      if (result) {\n        res.json({ success: true });\n      } else {\n        res.status(500).json({ message: \"뉴스 삭제에 실패했습니다\" });\n      }\n    } catch (error) {\n      res.status(500).json({ message: \"뉴스 삭제에 실패했습니다\" });\n    }\n  });\n\n  // 뉴스 수동 업데이트 API 엔드포인트 (GET: 테스트용, POST: 정식 인터페이스)\n  app.get(\"/api/admin/update-news\", async (req, res) => {\n    try {\n      // 관리자 인증 확인\n      if (!req.isAuthenticated()) {\n        return res.status(401).json({ message: \"인증이 필요합니다\" });\n      }\n      \n      const user = req.user as Express.User;\n      if (user.role !== \"admin\") {\n        return res.status(403).json({ message: \"관리자 권한이 필요합니다.\" });\n      }\n      \n      // 뉴스 수동 업데이트 실행\n      let newsItems = [];\n      try {\n        newsItems = await fetchAndSaveNews();\n        console.log(\"뉴스 업데이트 성공:\", newsItems.length, \"개의 뉴스 항목\");\n      } catch (err) {\n        const fetchError = err as Error;\n        console.error(\"뉴스 업데이트 중 오류:\", fetchError);\n        return res.status(500).json({ message: \"뉴스 업데이트 중 오류가 발생했습니다: \" + fetchError.message });\n      }\n\n      return res.json({ \n        success: true,\n        message: \"뉴스가 성공적으로 업데이트되었습니다.\", \n        count: newsItems.length\n      });\n    } catch (error) {\n      console.error(\"뉴스 수동 업데이트 API 오류:\", error);\n      return res.status(500).json({ message: \"뉴스 업데이트 중 오류가 발생했습니다.\" });\n    }\n  });\n  \n  // 추천 매물 순서 변경 API\n  app.put(\"/api/properties/:id/order\", async (req, res) => {\n    try {\n      // 인증 및 권한 확인\n      if (!req.isAuthenticated()) {\n        return res.status(401).json({ message: \"인증되지 않은 사용자입니다.\" });\n      }\n      \n      const user = req.user as Express.User;\n      if (user.role !== \"admin\") {\n        return res.status(403).json({ message: \"관리자만 접근할 수 있습니다.\" });\n      }\n\n      const propertyId = parseInt(req.params.id);\n      const { displayOrder } = req.body;\n\n      if (typeof displayOrder !== 'number') {\n        return res.status(400).json({ message: \"Display order must be a number\" });\n      }\n\n      const success = await storage.updatePropertyOrder(propertyId, displayOrder);\n      \n      if (!success) {\n        return res.status(404).json({ message: \"Property not found\" });\n      }\n      \n      res.json({ message: \"Property order updated successfully\" });\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to update property order\" });\n    }\n  });\n\n  // 매물 노출 상태 토글 API\n  app.patch(\"/api/properties/:id/visibility\", async (req, res) => {\n    try {\n      // 인증 및 권한 확인\n      if (!req.isAuthenticated()) {\n        return res.status(401).json({ message: \"인증되지 않은 사용자입니다.\" });\n      }\n      \n      const user = req.user as Express.User;\n      if (user.role !== \"admin\") {\n        return res.status(403).json({ message: \"관리자만 접근할 수 있습니다.\" });\n      }\n\n      const propertyId = parseInt(req.params.id);\n      const { isVisible } = req.body;\n      \n      if (!propertyId || typeof isVisible !== 'boolean') {\n        return res.status(400).json({ message: \"Property ID and visibility state are required\" });\n      }\n      \n      const success = await storage.togglePropertyVisibility(propertyId, isVisible);\n      \n      if (!success) {\n        return res.status(404).json({ message: \"Property not found\" });\n      }\n      \n      res.json({ message: \"Property visibility updated successfully\" });\n    } catch (error) {\n      console.error(\"Error updating property visibility:\", error);\n      res.status(500).json({ message: \"Failed to update property visibility\" });\n    }\n  });\n\n  // 매물 추천 상태 토글 API\n  app.patch(\"/api/properties/:id/featured\", async (req, res) => {\n    try {\n      // 인증 및 권한 확인\n      if (!req.isAuthenticated()) {\n        return res.status(401).json({ message: \"인증되지 않은 사용자입니다.\" });\n      }\n      \n      const user = req.user as Express.User;\n      if (user.role !== \"admin\") {\n        return res.status(403).json({ message: \"관리자만 접근할 수 있습니다.\" });\n      }\n\n      const propertyId = parseInt(req.params.id);\n      const { featured } = req.body;\n      \n      if (!propertyId || typeof featured !== 'boolean') {\n        return res.status(400).json({ message: \"Property ID and featured state are required\" });\n      }\n      \n      const success = await storage.togglePropertyFeatured(propertyId, featured);\n      \n      if (!success) {\n        return res.status(404).json({ message: \"Property not found\" });\n      }\n      \n      res.json({ message: \"Property featured status updated successfully\" });\n    } catch (error) {\n      console.error(\"Error updating property featured status:\", error);\n      res.status(500).json({ message: \"Failed to update property featured status\" });\n    }\n  });\n\n  // 부동산 다중 삭제 API\n  app.post(\"/api/properties/batch-delete\", async (req, res) => {\n    try {\n      // 인증 및 권한 확인\n      if (!req.isAuthenticated()) {\n        return res.status(401).json({ message: \"인증되지 않은 사용자입니다.\" });\n      }\n      \n      const user = req.user as Express.User;\n      if (user.role !== \"admin\") {\n        return res.status(403).json({ message: \"관리자만 접근할 수 있습니다.\" });\n      }\n      \n      const { ids } = req.body;\n      \n      if (!Array.isArray(ids) || ids.length === 0) {\n        return res.status(400).json({ message: \"삭제할 매물 ID가 필요합니다.\" });\n      }\n      \n      const results = await Promise.all(\n        ids.map(async (id) => {\n          try {\n            return await storage.deleteProperty(parseInt(id));\n          } catch (err) {\n            console.error(`매물 ID ${id} 삭제 중 오류:`, err);\n            return false;\n          }\n        })\n      );\n      \n      const successCount = results.filter(Boolean).length;\n      \n      // 캐시 삭제\n      memoryCache.deleteByPrefix(\"properties_\");\n      \n      res.status(200).json({ \n        message: `총 ${ids.length}개 중 ${successCount}개의 매물이 삭제되었습니다.`,\n        successCount,\n        totalCount: ids.length\n      });\n    } catch (error) {\n      console.error(\"매물 일괄 삭제 중 오류:\", error);\n      res.status(500).json({ message: \"매물 일괄 삭제 중 오류가 발생했습니다.\" });\n    }\n  });\n  \n  // 뉴스 다중 삭제 API\n  app.post(\"/api/news/batch-delete\", async (req, res) => {\n    try {\n      // 인증 및 권한 확인\n      if (!req.isAuthenticated()) {\n        return res.status(401).json({ message: \"인증되지 않은 사용자입니다.\" });\n      }\n      \n      const user = req.user as Express.User;\n      if (user.role !== \"admin\") {\n        return res.status(403).json({ message: \"관리자만 접근할 수 있습니다.\" });\n      }\n      \n      const { ids } = req.body;\n      \n      if (!Array.isArray(ids) || ids.length === 0) {\n        return res.status(400).json({ message: \"삭제할 뉴스 ID가 필요합니다.\" });\n      }\n      \n      const results = await Promise.all(\n        ids.map(async (id) => {\n          try {\n            return await storage.deleteNews(parseInt(id));\n          } catch (err) {\n            console.error(`뉴스 ID ${id} 삭제 중 오류:`, err);\n            return false;\n          }\n        })\n      );\n      \n      const successCount = results.filter(Boolean).length;\n      \n      // 캐시 삭제\n      memoryCache.deleteByPrefix(\"news_\");\n      \n      res.status(200).json({ \n        message: `총 ${ids.length}개 중 ${successCount}개의 뉴스가 삭제되었습니다.`,\n        successCount,\n        totalCount: ids.length\n      });\n    } catch (error) {\n      console.error(\"뉴스 일괄 삭제 중 오류:\", error);\n      res.status(500).json({ message: \"뉴스 일괄 삭제 중 오류가 발생했습니다.\" });\n    }\n  });\n  \n  // 사용자 다중 삭제 API\n  app.post(\"/api/users/batch-delete\", async (req, res) => {\n    try {\n      // 인증 및 권한 확인\n      if (!req.isAuthenticated()) {\n        return res.status(401).json({ message: \"인증되지 않은 사용자입니다.\" });\n      }\n      \n      const user = req.user as Express.User;\n      if (user.role !== \"admin\") {\n        return res.status(403).json({ message: \"관리자만 접근할 수 있습니다.\" });\n      }\n      \n      const { ids } = req.body;\n      \n      if (!Array.isArray(ids) || ids.length === 0) {\n        return res.status(400).json({ message: \"삭제할 사용자 ID가 필요합니다.\" });\n      }\n      \n      // 자기 자신은 삭제할 수 없도록 필터링\n      const filteredIds = ids.filter(id => parseInt(id) !== user.id);\n      \n      if (filteredIds.length !== ids.length) {\n        console.log(\"사용자가 자기 자신을 삭제하려고 시도했습니다.\");\n      }\n      \n      const results = await Promise.all(\n        filteredIds.map(async (id) => {\n          try {\n            return await storage.deleteUser(parseInt(id));\n          } catch (err) {\n            console.error(`사용자 ID ${id} 삭제 중 오류:`, err);\n            return false;\n          }\n        })\n      );\n      \n      const successCount = results.filter(Boolean).length;\n      \n      res.status(200).json({ \n        message: `총 ${filteredIds.length}개 중 ${successCount}개의 사용자 계정이 삭제되었습니다.`,\n        successCount,\n        totalCount: filteredIds.length,\n        skippedSelf: ids.length !== filteredIds.length\n      });\n    } catch (error) {\n      console.error(\"사용자 일괄 삭제 중 오류:\", error);\n      res.status(500).json({ message: \"사용자 일괄 삭제 중 오류가 발생했습니다.\" });\n    }\n  });\n  \n  // 통합 일괄 삭제 API 엔드포인트 (admin-page-new.tsx와 호환)\n  app.post(\"/api/admin/batch-delete/:type\", async (req, res) => {\n    try {\n      // 인증 및 관리자 권한 확인\n      if (!req.isAuthenticated()) {\n        return res.status(401).json({ message: \"인증이 필요합니다.\" });\n      }\n      \n      const user = req.user as Express.User;\n      if (user.role !== \"admin\") {\n        return res.status(403).json({ message: \"관리자 권한이 필요합니다.\" });\n      }\n      \n      const { type } = req.params;\n      const { ids } = req.body;\n      \n      if (!Array.isArray(ids) || ids.length === 0) {\n        return res.status(400).json({ message: \"유효한 ID 목록이 필요합니다.\" });\n      }\n      \n      console.log(`일괄 삭제 요청: ${type}, IDs:`, ids);\n      \n      let successCount = 0;\n      \n      switch (type) {\n        case 'properties':\n          for (const id of ids) {\n            const result = await storage.deleteProperty(id);\n            if (result) successCount++;\n          }\n          // 관련 캐시 삭제\n          memoryCache.deleteByPrefix(\"properties_\");\n          break;\n          \n        case 'news':\n          for (const id of ids) {\n            const result = await storage.deleteNews(id);\n            if (result) successCount++;\n          }\n          // 관련 캐시 삭제\n          memoryCache.deleteByPrefix(\"news_\");\n          break;\n          \n        case 'users':\n          // 자기 자신은 삭제할 수 없도록 필터링\n          const filteredIds = ids.filter(id => id !== user.id);\n          if (filteredIds.length !== ids.length) {\n            console.log(\"사용자가 자기 자신을 삭제하려고 시도했습니다.\");\n          }\n          \n          for (const id of filteredIds) {\n            // 관리자 계정은 제외\n            const userToDelete = await storage.getUser(id);\n            if (userToDelete && userToDelete.role !== 'admin') {\n              const result = await storage.deleteUser(id);\n              if (result) successCount++;\n            }\n          }\n          break;\n          \n        default:\n          return res.status(400).json({ message: \"지원되지 않는 유형입니다.\" });\n      }\n      \n      res.json({ \n        success: true, \n        message: `${successCount}개의 항목이 삭제되었습니다.`,\n        deletedCount: successCount,\n        skippedSelf: type === 'users' && ids.includes(user.id)\n      });\n    } catch (error) {\n      console.error('일괄 삭제 오류:', error);\n      res.status(500).json({ message: \"일괄 삭제 중 오류가 발생했습니다.\" });\n    }\n  });\n  \n  // 블로그 포스트 관련 API 제거됨\n  \n  // 구글 스프레드시트에서 부동산 데이터 가져오기 API\n  \n  app.post(\"/api/admin/import-from-sheet\", async (req, res) => {\n    try {\n      // 관리자 인증 확인\n      if (!req.isAuthenticated()) {\n        return res.status(401).json({ success: false, message: \"인증이 필요합니다\" });\n      }\n      \n      const user = req.user as Express.User;\n      if (user.role !== \"admin\") {\n        return res.status(403).json({ success: false, message: \"관리자 권한이 필요합니다.\" });\n      }\n      \n      const { spreadsheetId, apiKey, range } = req.body;\n      \n      if (!spreadsheetId || !apiKey) {\n        return res.status(400).json({ \n          success: false, \n          message: \"스프레드시트 ID와 API 키가 필요합니다.\" \n        });\n      }\n      \n      // 구글 스프레드시트에서 데이터 가져오기\n      const result = await importPropertiesFromSheet(\n        spreadsheetId,\n        apiKey,\n        range || 'Sheet1!A2:AN'\n      );\n      \n      // 캐시 초기화 (새 매물이 추가되었으므로)\n      memoryCache.deleteByPrefix(\"properties_\");\n      \n      res.json(result);\n    } catch (error) {\n      console.error('구글 시트 임포트 오류:', error);\n      res.status(500).json({ \n        success: false, \n        message: \"데이터 가져오기 중 오류가 발생했습니다.\", \n        error: error instanceof Error ? error.message : String(error)\n      });\n    }\n  });\n  \n  // 뉴스 자동 업데이트 스케줄러 실행 (사용자 요청에 따라 활성화)\n  setupNewsScheduler();\n  \n  const httpServer = createServer(app);\n  return httpServer;\n}\n","path":null,"size_bytes":59344,"size_tokens":null},"client/src/components/home/WhyChooseUs.tsx":{"content":"import { Medal, Home, Handshake } from \"lucide-react\";\n\nconst WhyChooseUs = () => {\n  return (\n    <section className=\"py-16 bg-gray-light\">\n      <div className=\"container mx-auto px-4\">\n        <h2 className=\"text-3xl font-bold text-center mb-12\">왜 이가이버 부동산인가?</h2>\n        \n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-8\">\n          <div className=\"bg-white p-6 rounded-lg shadow-md text-center\">\n            <div className=\"inline-block p-4 bg-primary/10 rounded-full mb-4\">\n              <Medal className=\"text-primary text-3xl\" />\n            </div>\n            <h3 className=\"text-xl font-bold mb-3\">10년 이상의 경험</h3>\n            <p className=\"text-gray-medium\">\n              10년 이상의 풍부한 부동산 경험으로 고객님의 니즈에 꼭 맞는 매물을 찾아드립니다.\n            </p>\n          </div>\n          \n          <div className=\"bg-white p-6 rounded-lg shadow-md text-center\">\n            <div className=\"inline-block p-4 bg-primary/10 rounded-full mb-4\">\n              <Home className=\"text-primary text-3xl\" />\n            </div>\n            <h3 className=\"text-xl font-bold mb-3\">엄선된 프리미엄 매물</h3>\n            <p className=\"text-gray-medium\">\n              저희는 직접 확인한 검증된 매물만을 소개합니다. 모든 매물은 철저한 심사를 거칩니다.\n            </p>\n          </div>\n          \n          <div className=\"bg-white p-6 rounded-lg shadow-md text-center\">\n            <div className=\"inline-block p-4 bg-primary/10 rounded-full mb-4\">\n              <Handshake className=\"text-primary text-3xl\" />\n            </div>\n            <h3 className=\"text-xl font-bold mb-3\">신뢰할 수 있는 서비스</h3>\n            <p className=\"text-gray-medium\">\n              투명한 거래와 정직한 상담으로 고객님의 소중한 자산을 안전하게 관리해 드립니다.\n            </p>\n          </div>\n        </div>\n      </div>\n    </section>\n  );\n};\n\nexport default WhyChooseUs;\n","path":null,"size_bytes":2031,"size_tokens":null},"client/src/pages/ContactPage.tsx":{"content":"import ContactForm from \"@/components/contact/ContactForm\";\nimport { MapPin, Phone, Mail, Clock } from \"lucide-react\";\nimport { Helmet } from \"react-helmet\";\n\nconst ContactPage = () => {\n  return (\n    <div className=\"pt-16\"> {/* Offset for fixed header */}\n      <Helmet>\n        <title>문의하기 | 이가이버부동산</title>\n        <meta \n          name=\"description\" \n          content=\"이가이버부동산에 문의하세요. 부동산 매매, 임대, 투자에 관한 모든 궁금증을 전문가가 상담해 드립니다.\"\n        />\n        <meta property=\"og:title\" content=\"문의하기 | 이가이버부동산\" />\n        <meta property=\"og:type\" content=\"website\" />\n        <meta property=\"og:description\" content=\"이가이버부동산에 문의하세요. 부동산 매매, 임대, 투자에 관한 모든 궁금증을 전문가가 상담해 드립니다.\" />\n      </Helmet>\n\n      <div className=\"bg-primary/10 py-12\">\n        <div className=\"container mx-auto px-4\">\n          <h1 className=\"text-3xl font-bold\">문의하기</h1>\n          <p className=\"text-gray-medium mt-2\">\n            궁금한 점이나 상담이 필요하시면 언제든지 문의해 주세요.\n          </p>\n        </div>\n      </div>\n      \n      <section className=\"py-16\">\n        <div className=\"container mx-auto px-4\">\n          <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-12\">\n            <div className=\"bg-white p-8 rounded-lg shadow-md\">\n              <h3 className=\"text-2xl font-bold mb-6\">상담 신청</h3>\n              <ContactForm />\n            </div>\n            \n            <div className=\"bg-white p-8 rounded-lg shadow-md\">\n              <h3 className=\"text-2xl font-bold mb-6\">연락처 정보</h3>\n              \n              <div className=\"space-y-4\">\n                <div className=\"flex items-start\">\n                  <MapPin className=\"text-primary text-xl mt-1 w-8\" />\n                  <div>\n                    <h4 className=\"font-bold\">주소</h4>\n                    <p className=\"text-gray-medium\">인천광역시 강화군 강화읍 남문로51, 1호</p>\n                  </div>\n                </div>\n                \n                <div className=\"flex items-start\">\n                  <Phone className=\"text-primary text-xl mt-1 w-8\" />\n                  <div>\n                    <h4 className=\"font-bold\">전화</h4>\n                    <p className=\"text-gray-medium\">032-934-3120 / 010-4787-3120</p>\n                  </div>\n                </div>\n                \n                <div className=\"flex items-start\">\n                  <Mail className=\"text-primary text-xl mt-1 w-8\" />\n                  <div>\n                    <h4 className=\"font-bold\">이메일</h4>\n                    <p className=\"text-gray-medium\">9551304@naver.com</p>\n                  </div>\n                </div>\n                \n                <div className=\"flex items-start\">\n                  <Clock className=\"text-primary text-xl mt-1 w-8\" />\n                  <div>\n                    <h4 className=\"font-bold\">영업시간</h4>\n                    <p className=\"text-gray-medium\">년중무휴</p>\n                    <p className=\"text-gray-medium\">외근이 많으니 방문시 사전연락 부탁드립니다</p>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </section>\n      \n\n    </div>\n  );\n};\n\nexport default ContactPage;\n","path":null,"size_bytes":3458,"size_tokens":null},"client/src/components/ui/badge.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  \"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground hover:bg-primary/80\",\n        secondary:\n          \"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80\",\n        outline: \"text-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  )\n}\n\nexport { Badge, badgeVariants }\n","path":null,"size_bytes":1128,"size_tokens":null},"client/src/components/ui/toggle.tsx":{"content":"import * as React from \"react\"\nimport * as TogglePrimitive from \"@radix-ui/react-toggle\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst toggleVariants = cva(\n  \"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 gap-2\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline:\n          \"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground\",\n      },\n      size: {\n        default: \"h-10 px-3 min-w-10\",\n        sm: \"h-9 px-2.5 min-w-9\",\n        lg: \"h-11 px-5 min-w-11\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst Toggle = React.forwardRef<\n  React.ElementRef<typeof TogglePrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, ...props }, ref) => (\n  <TogglePrimitive.Root\n    ref={ref}\n    className={cn(toggleVariants({ variant, size, className }))}\n    {...props}\n  />\n))\n\nToggle.displayName = TogglePrimitive.Root.displayName\n\nexport { Toggle, toggleVariants }\n","path":null,"size_bytes":1527,"size_tokens":null},"client/src/components/map/PropertyMap.tsx":{"content":"import { useState, useEffect, useRef } from 'react';\nimport { useQuery } from '@tanstack/react-query';\nimport { Property } from '@shared/schema';\nimport { Link } from 'wouter';\nimport { Badge } from '@/components/ui/badge';\nimport { cn } from '@/lib/utils';\n\ndeclare global {\n  interface Window {\n    kakao: any;\n    kakaoKey?: string;\n    kakaoMapLoaded?: boolean;\n  }\n}\n\n// 숫자를 한국어 표기법으로 변환 (예: 10000 -> 1만)\nconst formatNumberToKorean = (num: number): string => {\n  if (num >= 100000000) {\n    return `${(num / 100000000).toFixed(2)}억`;\n  } else if (num >= 10000) {\n    return `${(num / 10000).toFixed(2)}만`;\n  }\n  return num.toLocaleString();\n};\n\nconst PropertyMap = () => {\n  const mapRef = useRef<HTMLDivElement>(null);\n  const [map, setMap] = useState<any>(null);\n  const [selectedProperty, setSelectedProperty] = useState<Property | null>(null);\n  const [infoWindow, setInfoWindow] = useState<any>(null);\n\n  // 모든 매물 데이터 가져오기\n  const { data: properties, isLoading } = useQuery<Property[]>({\n    queryKey: ['/api/properties'],\n  });\n\n  // 카카오맵 초기화\n  useEffect(() => {\n    // HTML에 이미 삽입된 카카오맵 SDK 스크립트를 확인\n    const waitForKakaoSDK = () => {\n      if (window.kakao && window.kakao.maps) {\n        console.log(\"카카오맵 SDK 감지됨, 초기화 시작\");\n        initializeMap();\n        return;\n      }\n      \n      console.log(\"카카오맵 SDK 로딩 대기 중...\");\n      // 일정 시간 후 다시 확인\n      setTimeout(waitForKakaoSDK, 500);\n    };\n    \n    waitForKakaoSDK();\n  }, []);\n\n  // 맵 초기화 함수\n  const initializeMap = () => {\n    if (!mapRef.current) {\n      console.error(\"맵 컨테이너 요소가 없습니다\");\n      return;\n    }\n\n    try {\n      console.log(\"카카오맵 초기화 시작\");\n      \n      // 기본 위치를 강화군 중심으로 설정\n      const options = {\n        center: new window.kakao.maps.LatLng(37.7464, 126.4878), // 강화군 중심 좌표\n        level: 9 // 확대 레벨 (숫자가 작을수록 확대)\n      };\n\n      const kakaoMap = new window.kakao.maps.Map(mapRef.current, options);\n      setMap(kakaoMap);\n      console.log(\"카카오맵 생성 성공\");\n\n      // 정보 윈도우 생성\n      const kakaoInfoWindow = new window.kakao.maps.InfoWindow({ zIndex: 1 });\n      setInfoWindow(kakaoInfoWindow);\n    } catch (error) {\n      console.error(\"카카오맵 초기화 오류:\", error);\n    }\n  };\n\n  // 매물 마커 표시\n  useEffect(() => {\n    if (!map || !properties || properties.length === 0) {\n      console.log(\"매물 데이터 또는 지도 객체가 없습니다\");\n      return;\n    }\n\n    try {\n      console.log(\"매물 마커 표시 시작, 매물 수:\", properties.length);\n      \n      // 지오코더 서비스 객체 생성\n      const geocoder = new window.kakao.maps.services.Geocoder();\n      const bounds = new window.kakao.maps.LatLngBounds();\n      const markers: any[] = [];\n      \n      // 매물들의 좌표를 얻기 위한 함수\n      const getCoordinates = (property: Property, index: number) => {\n        try {\n          // 주소 정보로 위치 찾기 (주소 형식 개선)\n          let address = '';\n          \n          // 강화군 지역 주소 최적화\n          if (property.district && property.district.includes('강화')) {\n            address = `인천광역시 강화군 ${property.address || ''}`;\n          } else {\n            address = `인천광역시 ${property.district || ''} ${property.address || ''}`;\n          }\n          \n          // 주소에서 중복되는 지역명 제거\n          address = address.replace(/인천광역시 인천광역시/g, '인천광역시');\n          address = address.replace(/서울특별시 서울특별시/g, '서울특별시');\n          address = address.replace(/서울 서울/g, '서울');\n          \n          console.log(`주소 검색 시도: ${address}`);\n          \n          geocoder.addressSearch(address, (result: any, status: any) => {\n            if (status === window.kakao.maps.services.Status.OK) {\n              console.log(`주소 검색 성공: ${address}`);\n              const position = new window.kakao.maps.LatLng(result[0].y, result[0].x);\n              createMarker(property, position, index);\n              bounds.extend(position);\n              \n              // 마지막 매물 처리 후 지도 범위 재설정\n              if (index === properties.length - 1) {\n                map.setBounds(bounds);\n              }\n            } else {\n              console.log(`주소를 찾을 수 없습니다: ${address}`);\n              \n              // 주소를 찾을 수 없는 경우 임의의 포인트 지정 (테스트용)\n              if (property.id) {\n                // 강화군 중심에서 약간씩 위치를 변경하여 임시 마커 생성\n                const lat = 37.7464 + (Math.random() * 0.05 - 0.025);\n                const lng = 126.4878 + (Math.random() * 0.05 - 0.025);\n                const position = new window.kakao.maps.LatLng(lat, lng);\n                createMarker(property, position, index);\n                bounds.extend(position);\n              }\n            }\n          });\n        } catch (error) {\n          console.error(\"주소 검색 오류:\", error);\n        }\n      };\n\n    // 마커 생성 함수\n    const createMarker = (property: Property, position: any, index: number) => {\n      // 마커 생성\n      const marker = new window.kakao.maps.Marker({\n        map: map,\n        position: position,\n        title: property.title,\n      });\n      \n      markers.push(marker);\n\n      // 마커 클릭 이벤트\n      window.kakao.maps.event.addListener(marker, 'click', () => {\n        // 클릭된 매물 정보 설정\n        setSelectedProperty(property);\n        \n        // 거래 유형 (매매/전세/월세) 판단\n        let dealTypeText = '매매';\n        if (property.dealType && Array.isArray(property.dealType)) {\n          dealTypeText = property.dealType[0] || '매매';\n        }\n        \n        // 정보창 내용 구성\n        const content = `\n          <div style=\"padding: 8px; max-width: 250px; font-family: 'Apple SD Gothic Neo', 'Noto Sans KR', sans-serif;\">\n            <div style=\"font-weight: bold; margin-bottom: 4px; font-size: 14px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;\">${property.title}</div>\n            <div style=\"color: #666; font-size: 12px; margin-bottom: 4px;\">${property.type} · ${dealTypeText}</div>\n            <div style=\"color: #2563eb; font-weight: bold; font-size: 13px;\">${formatNumberToKorean(Number(property.price) || 0)}원</div>\n          </div>\n        `;\n        \n        // 정보창 표시\n        infoWindow.setContent(content);\n        infoWindow.open(map, marker);\n      });\n    };\n\n    // 각 매물에 대해 좌표 획득 및 마커 생성\n    properties.forEach((property, index) => {\n      getCoordinates(property, index);\n    });\n\n    // 컴포넌트 언마운트 시 마커 제거\n    return () => {\n      markers.forEach(marker => marker.setMap(null));\n    };\n    \n    } catch (error) {\n      console.error(\"매물 마커 생성 중 오류 발생:\", error);\n      return () => {};\n    }\n  }, [map, properties, infoWindow]);\n\n  if (isLoading) {\n    return (\n      <div className=\"flex items-center justify-center h-[60vh] bg-gray-100\">\n        <div className=\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary\"></div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"relative h-[60vh] w-full\">\n      <div ref={mapRef} className=\"w-full h-full\"></div>\n      \n      {/* 선택된 매물 정보 패널 */}\n      {selectedProperty && (\n        <div className=\"absolute bottom-4 left-4 right-4 md:left-auto md:right-4 md:w-80 bg-white rounded-lg shadow-lg p-4 z-10\">\n          <button \n            className=\"absolute top-2 right-2 text-gray-400 hover:text-gray-600\"\n            onClick={() => setSelectedProperty(null)}\n          >\n            ✕\n          </button>\n          \n          <Link href={`/properties/${selectedProperty.id}`}>\n            <h3 className=\"font-bold text-lg mb-2 hover:text-primary transition-colors\">\n              {selectedProperty.title}\n            </h3>\n          </Link>\n          \n          <div className=\"flex flex-wrap gap-2 mb-2\">\n            <Badge variant=\"outline\" className=\"bg-primary/10 text-primary\">\n              {selectedProperty.type}\n            </Badge>\n            {selectedProperty.dealType && Array.isArray(selectedProperty.dealType) && (\n              <Badge variant=\"outline\" className=\"bg-secondary/10 text-secondary\">\n                {selectedProperty.dealType[0]}\n              </Badge>\n            )}\n          </div>\n          \n          <div className=\"grid grid-cols-2 gap-x-2 gap-y-1 mb-3 text-sm\">\n            <div className=\"text-gray-500\">지역:</div>\n            <div>{selectedProperty.district}</div>\n            \n            <div className=\"text-gray-500\">면적:</div>\n            <div>\n              {selectedProperty.size} m² \n              {Number(selectedProperty.size) > 0 && ` (${(Number(selectedProperty.size) * 0.3025).toFixed(1)} 평)`}\n            </div>\n            \n            <div className=\"text-gray-500\">가격:</div>\n            <div className=\"font-semibold text-primary\">\n              {formatNumberToKorean(Number(selectedProperty.price) || 0)}원\n            </div>\n          </div>\n          \n          <Link \n            href={`/properties/${selectedProperty.id}`}\n            className=\"block w-full bg-primary hover:bg-secondary text-white text-center py-2 rounded transition-colors\"\n          >\n            상세보기\n          </Link>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default PropertyMap;","path":null,"size_bytes":9801,"size_tokens":null},"client/src/components/ui/popover.tsx":{"content":"import * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent }\n","path":null,"size_bytes":1280,"size_tokens":null},"server/api-test.js":{"content":"// 서버 API 테스트용 스크립트\nconst fetch = require('node-fetch');\n\nasync function testAdminUsers() {\n  try {\n    // 관리자 로그인 (쿠키 확보)\n    const loginRes = await fetch('http://localhost:5000/api/login', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        username: 'admin',\n        password: 'adminpass'\n      })\n    });\n    \n    if (!loginRes.ok) {\n      console.error('로그인 실패:', await loginRes.text());\n      return;\n    }\n    \n    const cookies = loginRes.headers.raw()['set-cookie'];\n    \n    // 관리자 API 호출 - 사용자 목록 가져오기\n    const usersRes = await fetch('http://localhost:5000/api/admin/users', {\n      headers: {\n        Cookie: cookies\n      }\n    });\n    \n    if (!usersRes.ok) {\n      console.error('사용자 목록 가져오기 실패:', await usersRes.text());\n      return;\n    }\n    \n    const users = await usersRes.json();\n    console.log('사용자 목록 (모든 필드):', users);\n    \n    // 필드 확인\n    if (users.length > 0) {\n      console.log('첫 번째 사용자의 모든 필드:', Object.keys(users[0]));\n      console.log('전화번호 필드 존재 여부:', users[0].hasOwnProperty('phone'));\n      console.log('첫 번째 사용자 전화번호:', users[0].phone);\n    }\n    \n  } catch (error) {\n    console.error('API 테스트 오류:', error);\n  }\n}\n\ntestAdminUsers();","path":null,"size_bytes":1451,"size_tokens":null},"server/auth.ts":{"content":"import passport from \"passport\";\nimport { Strategy as LocalStrategy } from \"passport-local\";\nimport { Strategy as NaverStrategy } from \"passport-naver\";\nimport { Strategy as KakaoStrategy } from \"passport-kakao\";\nimport express, { Express, Request, Response, NextFunction } from \"express\";\nimport session from \"express-session\";\nimport { scrypt, randomBytes, timingSafeEqual } from \"crypto\";\nimport { promisify } from \"util\";\nimport { storage } from \"./storage\";\nimport { User as SelectUser, User } from \"@shared/schema\";\n\ndeclare global {\n  namespace Express {\n    interface User extends SelectUser {}\n  }\n}\n\nconst scryptAsync = promisify(scrypt);\n\nasync function hashPassword(password: string) {\n  const salt = randomBytes(16).toString(\"hex\");\n  const buf = (await scryptAsync(password, salt, 64)) as Buffer;\n  return `${buf.toString(\"hex\")}.${salt}`;\n}\n\nasync function comparePasswords(supplied: string, stored: string) {\n  const [hashed, salt] = stored.split(\".\");\n  const hashedBuf = Buffer.from(hashed, \"hex\");\n  const suppliedBuf = (await scryptAsync(supplied, salt, 64)) as Buffer;\n  return timingSafeEqual(hashedBuf, suppliedBuf);\n}\n\n// 데이터베이스 초기화\nstorage.initializeData().catch(console.error);\n\nexport function setupAuth(app: Express) {\n  const sessionSettings: session.SessionOptions = {\n    secret: process.env.SESSION_SECRET || \"한국부동산비밀키\",\n    resave: false,\n    saveUninitialized: false,\n    cookie: {\n      maxAge: 24 * 60 * 60 * 1000, // 24시간\n      httpOnly: true,\n    },\n    store: storage.sessionStore // 세션 스토어 설정\n  };\n\n  app.set(\"trust proxy\", 1);\n  app.use(session(sessionSettings));\n  app.use(passport.initialize());\n  app.use(passport.session());\n\n  // 로컬 로그인 전략\n  passport.use(\n    new LocalStrategy(async (username, password, done) => {\n      const user = await storage.getUserByUsername(username);\n      if (!user || !(await comparePasswords(password, user.password))) {\n        return done(null, false);\n      } else {\n        return done(null, user);\n      }\n    }),\n  );\n  \n  // 네이버 로그인 전략\n  if (process.env.NAVER_CLIENT_ID && process.env.NAVER_CLIENT_SECRET) {\n    passport.use(\n      new NaverStrategy(\n        {\n          clientID: process.env.NAVER_CLIENT_ID,\n          clientSecret: process.env.NAVER_CLIENT_SECRET,\n          callbackURL: \"/api/auth/naver/callback\",\n        },\n        async (accessToken, refreshToken, profile, done) => {\n          try {\n            // 네이버 ID를 사용자 이름으로 사용\n            const naverId = profile.id;\n            let user = await storage.getUserByUsername(`naver_${naverId}`);\n            \n            if (!user) {\n              // 신규 사용자 등록\n              const newUser = {\n                username: `naver_${naverId}`,\n                password: await hashPassword(randomBytes(16).toString(\"hex\")), // 임의의 비밀번호\n                email: profile.emails?.[0]?.value || \"\",\n                phone: profile._json?.mobile || \"\",\n                role: \"user\",\n                provider: \"naver\",\n                providerId: naverId,\n              };\n              \n              user = await storage.createUser(newUser);\n            }\n            \n            return done(null, user);\n          } catch (error) {\n            return done(error as Error);\n          }\n        }\n      )\n    );\n  }\n  \n  // 카카오 로그인 전략\n  if (process.env.KAKAO_API_KEY) {\n    passport.use(\n      new KakaoStrategy(\n        {\n          clientID: process.env.KAKAO_API_KEY,\n          callbackURL: \"/api/auth/kakao/callback\",\n        },\n        async (accessToken, refreshToken, profile, done) => {\n          try {\n            // 카카오 ID를 사용자 이름으로 사용\n            const kakaoId = profile.id;\n            let user = await storage.getUserByUsername(`kakao_${kakaoId}`);\n            \n            if (!user) {\n              // 신규 사용자 등록\n              const newUser = {\n                username: `kakao_${kakaoId}`,\n                password: await hashPassword(randomBytes(16).toString(\"hex\")), // 임의의 비밀번호\n                email: profile._json?.kakao_account?.email || \"\",\n                phone: \"\",\n                role: \"user\",\n                provider: \"kakao\",\n                providerId: kakaoId,\n              };\n              \n              user = await storage.createUser(newUser);\n            }\n            \n            return done(null, user);\n          } catch (error) {\n            return done(error as Error);\n          }\n        }\n      )\n    );\n  }\n\n  passport.serializeUser((user, done) => done(null, user.id));\n  passport.deserializeUser(async (id: number, done) => {\n    const user = await storage.getUser(id);\n    done(null, user);\n  });\n\n  app.post(\"/api/register\", async (req, res, next) => {\n    try {\n      const existingUser = await storage.getUserByUsername(req.body.username);\n      if (existingUser) {\n        return res.status(400).json({ message: \"이미 존재하는 아이디입니다.\" });\n      }\n\n      const user = await storage.createUser({\n        ...req.body,\n        password: await hashPassword(req.body.password),\n        role: req.body.role || \"user\", // 기본적으로 일반 사용자 역할 부여\n      });\n\n      req.login(user, (err) => {\n        if (err) return next(err);\n        // 비밀번호 정보는 클라이언트에 반환하지 않음\n        const { password, ...userWithoutPassword } = user;\n        res.status(201).json(userWithoutPassword);\n      });\n    } catch (error) {\n      next(error);\n    }\n  });\n\n  app.post(\"/api/login\", (req, res, next) => {\n    passport.authenticate(\"local\", (err: Error, user: Express.User | false, info: { message: string }) => {\n      if (err) return next(err);\n      if (!user) return res.status(401).json({ message: \"아이디 또는 비밀번호가 올바르지 않습니다.\" });\n      \n      req.login(user, (err) => {\n        if (err) return next(err);\n        // 비밀번호 정보는 클라이언트에 반환하지 않음\n        const { password, ...userWithoutPassword } = user;\n        res.status(200).json(userWithoutPassword);\n      });\n    })(req, res, next);\n  });\n\n  app.post(\"/api/logout\", (req, res, next) => {\n    req.logout((err) => {\n      if (err) return next(err);\n      res.sendStatus(200);\n    });\n  });\n\n  app.get(\"/api/user\", (req, res) => {\n    if (!req.isAuthenticated()) return res.status(401).json({ message: \"인증되지 않은 사용자입니다.\" });\n    // 비밀번호 정보는 클라이언트에 반환하지 않음\n    const { password, ...userWithoutPassword } = req.user;\n    res.json(userWithoutPassword);\n  });\n  \n  // 관리자 권한 검사 미들웨어\n  const isAdmin = (req: Request, res: Response, next: NextFunction) => {\n    if (!req.isAuthenticated() || req.user.role !== \"admin\") {\n      return res.status(403).json({ message: \"관리자 권한이 필요합니다.\" });\n    }\n    next();\n  };\n  \n  // 관리자 전용 API 엔드포인트\n  app.get(\"/api/admin/users\", isAdmin, async (req: Request, res: Response, next: NextFunction) => {\n    try {\n      const users = await storage.getAllUsers();\n      // 사용자 목록에서 비밀번호 정보 제거\n      const usersWithoutPasswords = users.map((user: User) => {\n        const { password, ...userWithoutPassword } = user;\n        return userWithoutPassword;\n      });\n      res.json(usersWithoutPasswords);\n    } catch (error) {\n      next(error);\n    }\n  });\n\n  // 회원 정보 수정 API\n  app.patch(\"/api/users/profile\", async (req: Request, res: Response, next: NextFunction) => {\n    try {\n      if (!req.isAuthenticated()) {\n        return res.status(401).json({ message: \"인증이 필요합니다.\" });\n      }\n\n      const userId = req.user.id;\n      const { currentPassword, password, email, phone } = req.body;\n      \n      // 현재 사용자 정보 가져오기\n      const user = await storage.getUser(userId);\n      if (!user) {\n        return res.status(404).json({ message: \"사용자를 찾을 수 없습니다.\" });\n      }\n\n      // 비밀번호 변경 시 현재 비밀번호 확인\n      if (password) {\n        if (!currentPassword) {\n          return res.status(400).json({ message: \"현재 비밀번호를 입력해주세요.\" });\n        }\n\n        const isPasswordValid = await comparePasswords(currentPassword, user.password);\n        if (!isPasswordValid) {\n          return res.status(400).json({ message: \"현재 비밀번호가 일치하지 않습니다.\" });\n        }\n      }\n\n      // 업데이트할 데이터 준비\n      const updateData: any = {};\n      if (password) {\n        updateData.password = await hashPassword(password);\n      }\n      if (email !== undefined) {\n        updateData.email = email;\n      }\n      if (phone !== undefined) {\n        updateData.phone = phone;\n      }\n\n      // 사용자 정보 업데이트\n      const updatedUser = await storage.updateUser(userId, updateData);\n      if (!updatedUser) {\n        return res.status(500).json({ message: \"사용자 정보 업데이트에 실패했습니다.\" });\n      }\n\n      // 비밀번호 제외하고 응답\n      const { password: _, ...userWithoutPassword } = updatedUser;\n      res.json(userWithoutPassword);\n    } catch (error) {\n      next(error);\n    }\n  });\n\n  // 비밀번호 변경 API\n  app.patch(\"/api/users/password\", async (req: Request, res: Response, next: NextFunction) => {\n    try {\n      if (!req.isAuthenticated()) {\n        return res.status(401).json({ message: \"인증되지 않은 사용자입니다.\" });\n      }\n\n      const userId = req.user.id;\n      const { currentPassword, newPassword } = req.body;\n      \n      if (!currentPassword || !newPassword) {\n        return res.status(400).json({ message: \"현재 비밀번호와 새 비밀번호가 필요합니다.\" });\n      }\n      \n      // 현재 사용자 정보 가져오기\n      const user = await storage.getUser(userId);\n      if (!user) {\n        return res.status(404).json({ message: \"사용자를 찾을 수 없습니다.\" });\n      }\n      \n      // 현재 비밀번호 확인\n      const isPasswordCorrect = await comparePasswords(currentPassword, user.password);\n      if (!isPasswordCorrect) {\n        return res.status(400).json({ message: \"현재 비밀번호가 올바르지 않습니다.\" });\n      }\n      \n      // 새 비밀번호 해싱 및 업데이트\n      const hashedPassword = await hashPassword(newPassword);\n      const updatedUser = await storage.updateUser(userId, { password: hashedPassword });\n      \n      if (!updatedUser) {\n        return res.status(500).json({ message: \"비밀번호 변경에 실패했습니다.\" });\n      }\n      \n      res.json({ message: \"비밀번호가 성공적으로 변경되었습니다.\" });\n    } catch (error) {\n      next(error);\n    }\n  });\n\n  app.delete(\"/api/admin/users/:id\", isAdmin, async (req: Request, res: Response, next: NextFunction) => {\n    try {\n      const userId = parseInt(req.params.id);\n      if (isNaN(userId)) {\n        return res.status(400).json({ message: \"유효하지 않은 사용자 ID입니다.\" });\n      }\n\n      // 관리자는 자기 자신을 삭제할 수 없음\n      if (userId === req.user.id) {\n        return res.status(400).json({ message: \"관리자는 자신의 계정을 삭제할 수 없습니다.\" });\n      }\n\n      const success = await storage.deleteUser(userId);\n      if (!success) {\n        return res.status(404).json({ message: \"해당 사용자를 찾을 수 없습니다.\" });\n      }\n\n      res.status(200).json({ message: \"사용자가 성공적으로 삭제되었습니다.\" });\n    } catch (error) {\n      next(error);\n    }\n  });\n  \n  // 네이버 로그인 라우트\n  app.get('/api/auth/naver', passport.authenticate('naver'));\n  \n  // 네이버 로그인 콜백 라우트\n  app.get(\n    '/api/auth/naver/callback',\n    passport.authenticate('naver', {\n      failureRedirect: '/auth?error=naver_login_failed',\n    }),\n    (req, res) => {\n      // 성공 시 홈페이지로 리다이렉트\n      res.redirect('/');\n    }\n  );\n  \n  // 카카오 로그인 라우트\n  app.get('/api/auth/kakao', passport.authenticate('kakao'));\n  \n  // 카카오 로그인 콜백 라우트\n  app.get(\n    '/api/auth/kakao/callback',\n    passport.authenticate('kakao', {\n      failureRedirect: '/auth?error=kakao_login_failed',\n    }),\n    (req, res) => {\n      // 성공 시 홈페이지로 리다이렉트\n      res.redirect('/');\n    }\n  );\n}","path":null,"size_bytes":12488,"size_tokens":null},"client/src/lib/utils.ts":{"content":"import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n\n/**\n * 날짜 문자열을 포맷팅하는 함수\n * @param dateString 날짜 문자열 (예: '2023. 5. 9.')\n * @returns 포맷팅된 날짜 문자열\n */\nexport function formatDate(dateString: string) {\n  // 이미 잘 포맷팅된 날짜라면 그대로 반환\n  if (/^\\d{4}\\.\\s?\\d{1,2}\\.\\s?\\d{1,2}\\.?$/.test(dateString)) {\n    return dateString.trim();\n  }\n  \n  try {\n    // 날짜 객체로 변환\n    const date = new Date(dateString);\n    \n    // 유효한 날짜인지 확인\n    if (isNaN(date.getTime())) {\n      return dateString;\n    }\n    \n    // 한국 날짜 형식으로 변환 (YYYY. MM. DD.)\n    return `${date.getFullYear()}. ${date.getMonth() + 1}. ${date.getDate()}.`;\n  } catch (e) {\n    console.error(\"날짜 포맷팅 오류:\", e);\n    return dateString;\n  }\n}\n","path":null,"size_bytes":951,"size_tokens":null},"shared/schema.ts":{"content":"import { pgTable, text, serial, integer, boolean, numeric, timestamp, varchar, json } from \"drizzle-orm/pg-core\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { z } from \"zod\";\n\n// Property schema - Matched to form structure\nexport const properties = pgTable(\"properties\", {\n  id: serial(\"id\").primaryKey(),\n  title: text(\"title\").notNull(),\n  description: text(\"description\").notNull(),\n  type: text(\"type\").notNull(), // 토지, 주택, 아파트연립다세대, 원투룸, 상가공장창고펜션\n  price: numeric(\"price\").notNull(), // 매매가\n  address: text(\"address\").notNull(), // 주소\n  district: text(\"district\").notNull(), // 읍면동리 (ex: 강화읍 갑곳리, 강화읍 관청리, 강화군외 등)\n  size: numeric(\"size\").notNull(), // 면적(㎡)\n  bedrooms: integer(\"bedrooms\").notNull(), // 방 개수\n  bathrooms: integer(\"bathrooms\").notNull(), // 화장실 개수\n  imageUrl: text(\"image_url\").notNull(), // 단일 이미지 URL (하위 호환성 유지)\n  imageUrls: text(\"image_urls\").array(), // 다중 이미지 URLs\n  featuredImageIndex: integer(\"featured_image_index\"), // 대표 이미지 인덱스\n  agentId: integer(\"agent_id\").notNull(), // 매물 담당 중개사 ID\n  featured: boolean(\"featured\").default(false), // 추천 매물 여부\n  displayOrder: integer(\"display_order\").default(0), // 추천 매물 노출 순서\n  isVisible: boolean(\"is_visible\").default(true), // 매물 노출 여부\n  createdAt: timestamp(\"created_at\").defaultNow(), // 등록일\n  \n  // 위치 정보 - 아래 필드들은 추가 필드로서 나중에 migrate 시킬 예정\n  buildingName: text(\"building_name\"), // 건물명\n  unitNumber: text(\"unit_number\"), // 동호수\n  \n  // 면적 정보\n  supplyArea: numeric(\"supply_area\"), // 공급(평)\n  privateArea: numeric(\"private_area\"), // 전용(평)\n  areaSize: text(\"area_size\"), // 평형\n  \n  // 건물 정보\n  floor: integer(\"floor\"), // 층수\n  totalFloors: integer(\"total_floors\"), // 총층\n  direction: text(\"direction\"), // 방향\n  elevator: boolean(\"elevator\"), // 승강기유무\n  parking: text(\"parking\"), // 주차\n  heatingSystem: text(\"heating_system\"), // 난방방식\n  approvalDate: text(\"approval_date\"), // 사용승인\n  \n  // 토지 정보\n  landType: text(\"land_type\"), // 지목 (전,답,임,대,목,잡,창,도,장,학,주,염,과,철,제,천,구,유,양,수,공원,체,원,종,사,묘,광)\n  zoneType: text(\"zone_type\"), // 용도지역 (제1종전용주거,제2종전용주거,제1종일반주거,제2종일반주거,제3종일반주거,준주거,중심상업,일반상업,근린상업,유통상업,전용공업,일반공업,준공업,보전녹지,생산녹지,자연녹지,계획관리,보전관리,생산관리,농업보호,농업진흥,농림지역,자연환경보전)\n  \n  // 금액 정보\n  dealType: text(\"deal_type\").array(), // 거래종류 (매매, 전세, 월세, 완료, 보류중) - 다중선택\n  deposit: numeric(\"deposit\"), // 전세금/보증금\n  monthlyRent: numeric(\"monthly_rent\"), // 월세\n  maintenanceFee: numeric(\"maintenance_fee\"), // 관리비\n  \n  // 연락처 정보\n  ownerName: text(\"owner_name\"), // 소유자\n  ownerPhone: text(\"owner_phone\"), // 소유자 전화\n  tenantName: text(\"tenant_name\"), // 임차인\n  tenantPhone: text(\"tenant_phone\"), // 임차인 전화\n  clientName: text(\"client_name\"), // 의뢰인\n  clientPhone: text(\"client_phone\"), // 의뢰인 전화\n  \n  // 추가 정보\n  specialNote: text(\"special_note\"), // 특이사항\n  coListing: boolean(\"co_listing\").default(false), // 공동중개\n  propertyDescription: text(\"property_description\"), // 매물설명 (기존 DB 호환용)\n  privateNote: text(\"private_note\"), // 비공개메모\n  youtubeUrl: text(\"youtube_url\"), // 유튜브 영상 URL\n});\n\nexport const insertPropertySchema = createInsertSchema(properties).omit({\n  id: true,\n  createdAt: true,\n});\n\n// Agent schema - REMOVED\n\n// Inquiry schema\nexport const inquiries = pgTable(\"inquiries\", {\n  id: serial(\"id\").primaryKey(),\n  name: text(\"name\").notNull(),\n  email: text(\"email\").notNull(),\n  phone: text(\"phone\").notNull(),\n  message: text(\"message\").notNull(),\n  inquiryType: text(\"inquiry_type\").notNull(),\n  propertyId: integer(\"property_id\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertInquirySchema = createInsertSchema(inquiries).omit({\n  id: true,\n  createdAt: true,\n});\n\n// Testimonial schema - 제거됨\n\n// User schema for basic login - keeping the original users table\nexport const users = pgTable(\"users\", {\n  id: serial(\"id\").primaryKey(),\n  username: text(\"username\").notNull().unique(),\n  password: text(\"password\").notNull(),\n  email: text(\"email\"),\n  phone: text(\"phone\"),\n  role: text(\"role\").default(\"user\").notNull(),\n});\n\nexport const insertUserSchema = createInsertSchema(users).pick({\n  username: true,\n  password: true,\n  email: true,\n  phone: true,\n  role: true,\n});\n\n// Type definitions\nexport type Property = typeof properties.$inferSelect;\nexport type InsertProperty = z.infer<typeof insertPropertySchema>;\n\n// Agent types - REMOVED\n\nexport type Inquiry = typeof inquiries.$inferSelect;\nexport type InsertInquiry = z.infer<typeof insertInquirySchema>;\n\n// Testimonial 타입 제거됨\n\nexport type User = typeof users.$inferSelect;\nexport type InsertUser = z.infer<typeof insertUserSchema>;\n\n// News schema\nexport const news = pgTable(\"news\", {\n  id: serial(\"id\").primaryKey(),\n  title: text(\"title\").notNull(),\n  summary: text(\"summary\").notNull(), // 뉴스 요약\n  description: text(\"description\").notNull(),\n  content: text(\"content\").notNull(),\n  source: text(\"source\").notNull(),\n  sourceUrl: text(\"source_url\").notNull(),\n  url: text(\"url\").notNull(), // 원본 뉴스 URL\n  imageUrl: text(\"image_url\"),\n  category: text(\"category\").notNull(), // \"인천 부동산\", \"강화군 부동산\", \"부동산 정책\", \"국토교통부\"\n  isPinned: boolean(\"is_pinned\").default(false),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertNewsSchema = createInsertSchema(news).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport type News = typeof news.$inferSelect;\nexport type InsertNews = z.infer<typeof insertNewsSchema>;\n\n// Property inquiry board schema (전방 선언)\nexport const propertyInquiries = pgTable(\"property_inquiries\", {\n  id: serial(\"id\").primaryKey(),\n  propertyId: integer(\"property_id\").notNull().references(() => properties.id, { onDelete: \"cascade\" }),\n  userId: integer(\"user_id\").notNull().references(() => users.id),\n  title: text(\"title\").notNull(),\n  content: text(\"content\").notNull(),\n  isReply: boolean(\"is_reply\").default(false).notNull(),\n  parentId: integer(\"parent_id\"),\n  isReadByAdmin: boolean(\"is_read_by_admin\").default(false).notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertPropertyInquirySchema = createInsertSchema(propertyInquiries).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport type PropertyInquiry = typeof propertyInquiries.$inferSelect;\nexport type InsertPropertyInquiry = z.infer<typeof insertPropertyInquirySchema>;\n\n// 관심 매물 (Favorites) 스키마\nexport const favorites = pgTable(\"favorites\", {\n  id: serial(\"id\").primaryKey(),\n  userId: integer(\"user_id\").notNull().references(() => users.id, { onDelete: \"cascade\" }),\n  propertyId: integer(\"property_id\").notNull().references(() => properties.id, { onDelete: \"cascade\" }),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\nexport const insertFavoriteSchema = createInsertSchema(favorites).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport type Favorite = typeof favorites.$inferSelect;\nexport type InsertFavorite = z.infer<typeof insertFavoriteSchema>;\n\n// Session schema (for connect-pg-simple)\n// Removed schema mapping from Drizzle to avoid conflicts with connect-pg-simple's own schema\n","path":null,"size_bytes":7831,"size_tokens":null},"client/src/pages/AboutPage.tsx":{"content":"import React from \"react\";\nimport { Helmet } from \"react-helmet\";\n\nconst AboutPage = () => {\n  return (\n    <div className=\"pt-16\"> {/* 상단 메뉴 오프셋 */}\n      <Helmet>\n        <title>실거래가(디스코) | 이가이버부동산</title>\n        <meta \n          name=\"description\" \n          content=\"실거래가 정보를 디스코에서 확인하세요.\"\n        />\n      </Helmet>\n      \n      {/* 외부 웹사이트를 iframe으로 표시 */}\n      <div className=\"w-full h-screen\">\n        <iframe \n          src=\"https://www.disco.re/\" \n          className=\"w-full h-full border-none\"\n          title=\"disco.re\"\n          sandbox=\"allow-scripts allow-same-origin allow-forms\"\n          loading=\"lazy\"\n        ></iframe>\n      </div>\n    </div>\n  );\n};\n\nexport default AboutPage;\n","path":null,"size_bytes":800,"size_tokens":null},"client/src/components/ui/context-menu.tsx":{"content":"import * as React from \"react\"\nimport * as ContextMenuPrimitive from \"@radix-ui/react-context-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ContextMenu = ContextMenuPrimitive.Root\n\nconst ContextMenuTrigger = ContextMenuPrimitive.Trigger\n\nconst ContextMenuGroup = ContextMenuPrimitive.Group\n\nconst ContextMenuPortal = ContextMenuPrimitive.Portal\n\nconst ContextMenuSub = ContextMenuPrimitive.Sub\n\nconst ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup\n\nconst ContextMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <ContextMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </ContextMenuPrimitive.SubTrigger>\n))\nContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName\n\nconst ContextMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName\n\nconst ContextMenuContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Portal>\n    <ContextMenuPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"z-50 max-h-[--radix-context-menu-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </ContextMenuPrimitive.Portal>\n))\nContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName\n\nconst ContextMenuItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName\n\nconst ContextMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <ContextMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.CheckboxItem>\n))\nContextMenuCheckboxItem.displayName =\n  ContextMenuPrimitive.CheckboxItem.displayName\n\nconst ContextMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <ContextMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.RadioItem>\n))\nContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName\n\nconst ContextMenuLabel = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold text-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName\n\nconst ContextMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName\n\nconst ContextMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nContextMenuShortcut.displayName = \"ContextMenuShortcut\"\n\nexport {\n  ContextMenu,\n  ContextMenuTrigger,\n  ContextMenuContent,\n  ContextMenuItem,\n  ContextMenuCheckboxItem,\n  ContextMenuRadioItem,\n  ContextMenuLabel,\n  ContextMenuSeparator,\n  ContextMenuShortcut,\n  ContextMenuGroup,\n  ContextMenuPortal,\n  ContextMenuSub,\n  ContextMenuSubContent,\n  ContextMenuSubTrigger,\n  ContextMenuRadioGroup,\n}\n","path":null,"size_bytes":7428,"size_tokens":null},"client/src/pages/admin-vanilla.tsx":{"content":"import React, { useState, useEffect } from \"react\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { Button } from \"@/components/ui/button\";\nimport { Loader2 } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\n\n// 바닐라 JS 사용 관리자 페이지\nexport default function AdminVanilla() {\n  const { user } = useAuth();\n  const { toast } = useToast();\n\n  // 컴포넌트가 마운트될 때 관리자 API 호출 및 UI 구축\n  const handleLogout = () => {\n    window.location.href = '/';\n  };\n\n  // 바닐라 JS로 DOM 조작을 처리하는 함수\n  const deleteItem = async (id: number, type: string) => {\n    // 확인 없이 바로 삭제 (confirm 사용시 DOM 관련 오류 발생)\n    try {\n      const endpoint = type === 'property' \n        ? `/api/properties/${id}` \n        : type === 'news' \n          ? `/api/news/${id}` \n          : `/api/admin/users/${id}`;\n      \n      const response = await fetch(endpoint, {\n        method: 'DELETE',\n        headers: {\n          'Content-Type': 'application/json'\n        }\n      });\n      \n      if (!response.ok) {\n        throw new Error(`Failed to delete ${type}`);\n      }\n      \n      // 삭제 성공 후 행 수동 제거\n      const row = document.getElementById(`${type}-${id}`);\n      if (row) {\n        row.style.opacity = '0.5';\n        setTimeout(() => {\n          if (row.parentNode) {\n            row.parentNode.removeChild(row);\n          }\n        }, 300);\n      }\n      \n      toast({\n        title: \"삭제 성공\",\n        description: `${type === 'property' ? '부동산' : type === 'news' ? '뉴스' : '사용자'}가 삭제되었습니다.`,\n      });\n    } catch (error) {\n      toast({\n        title: \"삭제 실패\",\n        description: error instanceof Error ? error.message : \"알 수 없는 오류가 발생했습니다.\",\n        variant: \"destructive\",\n      });\n    }\n  };\n\n  return (\n    <div className=\"container mx-auto py-8\">\n      <div className=\"flex justify-between items-center mb-6\">\n        <h1 className=\"text-3xl font-bold\">관리자 패널 (바닐라 버전)</h1>\n        <div className=\"flex items-center gap-4\">\n          <p className=\"text-sm\">\n            <span className=\"font-semibold\">{user?.username}</span> \n            <span className=\"text-gray-500 ml-1\">({user?.role})</span>\n          </p>\n          <Button variant=\"outline\" size=\"sm\" onClick={handleLogout}>로그아웃</Button>\n        </div>\n      </div>\n\n      <div className=\"bg-white rounded-lg shadow p-6 mb-8\">\n        <h2 className=\"text-xl font-bold mb-4 flex items-center\">\n          관리자 기능 (제한된 버전)\n        </h2>\n        <p className=\"text-gray-500 mb-6\">\n          이 페이지는 최소한의 DOM 조작으로만 작동합니다. 수정 기능을 이용하려면 기존 관리자 페이지를 이용해주세요.\n        </p>\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n          <Button onClick={() => window.location.href = \"/admin-old\"} className=\"w-full\">\n            모든 기능 사용하기\n          </Button>\n          <Button \n            variant=\"secondary\" \n            onClick={() => window.location.href = \"/properties\"} \n            className=\"w-full\"\n          >\n            부동산 목록 보기\n          </Button>\n          <Button \n            variant=\"outline\" \n            onClick={() => window.location.href = \"/\"} \n            className=\"w-full\"\n          >\n            홈으로 돌아가기\n          </Button>\n        </div>\n      </div>\n\n      <div className=\"grid grid-cols-1 gap-6\">\n        {/* 부동산 데이터 테이블 */}\n        <LoadTable \n          title=\"부동산 관리\"\n          endpoint=\"/api/properties\"\n          type=\"property\"\n          columns={[\"ID\", \"제목\", \"유형\", \"지역\", \"가격\", \"관리\"]}\n          renderRow={(item) => (\n            <tr id={`property-${item.id}`} key={item.id} className=\"border-b transition-opacity hover:bg-gray-50\">\n              <td className=\"px-4 py-3\">{item.id}</td>\n              <td className=\"px-4 py-3 max-w-[200px] truncate\">{item.title}</td>\n              <td className=\"px-4 py-3\">{item.type}</td>\n              <td className=\"px-4 py-3\">{item.district}</td>\n              <td className=\"px-4 py-3\">{Number(item.price).toLocaleString()}원</td>\n              <td className=\"px-4 py-3\">\n                <Button \n                  variant=\"destructive\" \n                  size=\"sm\"\n                  onClick={() => deleteItem(item.id, 'property')}\n                >\n                  삭제\n                </Button>\n              </td>\n            </tr>\n          )}\n          deleteItem={deleteItem}\n        />\n\n        {/* 뉴스 데이터 테이블 */}\n        <LoadTable \n          title=\"뉴스 관리\"\n          endpoint=\"/api/news\"\n          type=\"news\"\n          columns={[\"ID\", \"제목\", \"출처\", \"날짜\", \"관리\"]}\n          renderRow={(item) => (\n            <tr id={`news-${item.id}`} key={item.id} className=\"border-b transition-opacity hover:bg-gray-50\">\n              <td className=\"px-4 py-3\">{item.id}</td>\n              <td className=\"px-4 py-3 max-w-[350px] truncate\">{item.title}</td>\n              <td className=\"px-4 py-3\">{item.source || \"네이버 뉴스\"}</td>\n              <td className=\"px-4 py-3\">{item.createdAt ? new Date(item.createdAt).toLocaleDateString() : '-'}</td>\n              <td className=\"px-4 py-3\">\n                <Button \n                  variant=\"destructive\" \n                  size=\"sm\"\n                  onClick={() => deleteItem(item.id, 'news')}\n                >\n                  삭제\n                </Button>\n              </td>\n            </tr>\n          )}\n          deleteItem={deleteItem}\n        />\n\n        {/* 사용자 데이터 테이블 */}\n        {user?.role === 'admin' && (\n          <LoadTable \n            title=\"사용자 관리\"\n            endpoint=\"/api/admin/users\"\n            type=\"user\"\n            columns={[\"ID\", \"사용자명\", \"이메일\", \"권한\", \"관리\"]}\n            renderRow={(item) => (\n              <tr id={`user-${item.id}`} key={item.id} className=\"border-b transition-opacity hover:bg-gray-50\">\n                <td className=\"px-4 py-3\">{item.id}</td>\n                <td className=\"px-4 py-3\">{item.username}</td>\n                <td className=\"px-4 py-3\">{item.email}</td>\n                <td className=\"px-4 py-3\">{item.role}</td>\n                <td className=\"px-4 py-3\">\n                  <Button \n                    variant=\"destructive\" \n                    size=\"sm\"\n                    disabled={item.role === 'admin'}\n                    onClick={() => item.role !== 'admin' && deleteItem(item.id, 'user')}\n                  >\n                    {item.role === 'admin' ? '보호됨' : '삭제'}\n                  </Button>\n                </td>\n              </tr>\n            )}\n            deleteItem={deleteItem}\n          />\n        )}\n      </div>\n    </div>\n  );\n}\n\n// 데이터 로드 및 표시 컴포넌트\nfunction LoadTable({ \n  title, \n  endpoint, \n  type, \n  columns, \n  renderRow,\n  deleteItem \n}: { \n  title: string; \n  endpoint: string; \n  type: string;\n  columns: string[];\n  renderRow: (item: any) => React.ReactNode;\n  deleteItem: (id: number, type: string) => void;\n}) {\n  const { toast } = useToast();\n  const [data, setData] = useState<any[]>([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n    const fetchData = async () => {\n      try {\n        setIsLoading(true);\n        const response = await fetch(endpoint);\n        if (!response.ok) {\n          throw new Error(`Failed to fetch ${type}`);\n        }\n        const responseData = await response.json();\n        setData(responseData);\n      } catch (err) {\n        setError(err instanceof Error ? err.message : \"An unknown error occurred\");\n        toast({\n          title: \"데이터 로드 실패\",\n          description: err instanceof Error ? err.message : \"알 수 없는 오류가 발생했습니다.\",\n          variant: \"destructive\",\n        });\n      } finally {\n        setIsLoading(false);\n      }\n    };\n\n    fetchData();\n  }, [endpoint, type, toast]);\n\n  if (isLoading) {\n    return (\n      <div className=\"bg-white rounded-lg shadow p-6\">\n        <h2 className=\"text-xl font-bold mb-4\">{title}</h2>\n        <div className=\"flex justify-center items-center p-12\">\n          <Loader2 className=\"h-8 w-8 animate-spin text-gray-400\" />\n        </div>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"bg-white rounded-lg shadow p-6\">\n        <h2 className=\"text-xl font-bold mb-4\">{title}</h2>\n        <div className=\"p-8 text-center text-red-500\">\n          <p>Error: {error}</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"bg-white rounded-lg shadow overflow-hidden\">\n      <div className=\"p-4 border-b\">\n        <h2 className=\"text-xl font-bold\">{title}</h2>\n        <p className=\"text-gray-500 text-sm\">총 {data.length}개 항목</p>\n      </div>\n      <div className=\"overflow-x-auto\">\n        <table className=\"min-w-full bg-white\">\n          <thead>\n            <tr className=\"bg-gray-100\">\n              {columns.map((column, index) => (\n                <th key={index} className=\"px-4 py-2 text-left font-medium text-gray-600\">\n                  {column}\n                </th>\n              ))}\n            </tr>\n          </thead>\n          <tbody>\n            {data.length === 0 ? (\n              <tr>\n                <td colSpan={columns.length} className=\"px-4 py-8 text-center text-gray-500\">\n                  데이터가 없습니다.\n                </td>\n              </tr>\n            ) : (\n              data.map(renderRow)\n            )}\n          </tbody>\n        </table>\n      </div>\n    </div>\n  );\n}","path":null,"size_bytes":9820,"size_tokens":null},"client/src/components/agent/AgentDetail.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Link } from \"wouter\";\nimport { Agent, Property } from \"@shared/schema\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { Button } from \"@/components/ui/button\";\nimport PropertyCard from \"@/components/property/PropertyCard\";\nimport { Phone, Mail, MapPin, BriefcaseBusiness } from \"lucide-react\";\n\ninterface AgentDetailProps {\n  agentId: string;\n}\n\nconst AgentDetail = ({ agentId }: AgentDetailProps) => {\n  const { data: agent, isLoading: agentLoading, error: agentError } = useQuery<Agent>({\n    queryKey: [`/api/agents/${agentId}`],\n  });\n  \n  const { data: properties, isLoading: propertiesLoading } = useQuery<Property[]>({\n    queryKey: [\"/api/properties\"],\n    select: (data) => data.filter(property => property.agentId === Number(agentId))\n  });\n  \n  if (agentLoading) {\n    return (\n      <div className=\"container mx-auto px-4 py-12\">\n        <div className=\"flex flex-col md:flex-row gap-8\">\n          <div className=\"md:w-1/3\">\n            <Skeleton className=\"h-80 w-full rounded-lg\" />\n          </div>\n          <div className=\"md:w-2/3\">\n            <Skeleton className=\"h-10 w-1/2 mb-2\" />\n            <Skeleton className=\"h-6 w-1/4 mb-4\" />\n            <Skeleton className=\"h-4 w-full mb-2\" />\n            <Skeleton className=\"h-4 w-full mb-2\" />\n            <Skeleton className=\"h-4 w-2/3 mb-6\" />\n            \n            <div className=\"grid grid-cols-2 gap-4 mb-6\">\n              <Skeleton className=\"h-10 w-full\" />\n              <Skeleton className=\"h-10 w-full\" />\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  if (agentError || !agent) {\n    return (\n      <div className=\"container mx-auto px-4 py-12\">\n        <div className=\"bg-red-50 p-6 rounded-lg text-red-600\">\n          <h2 className=\"text-2xl font-bold mb-2\">중개사를 찾을 수 없습니다</h2>\n          <p>요청하신 중개사 정보를 불러오는 데 실패했습니다. 다시 시도해주세요.</p>\n          <Link href=\"/agents\">\n            <Button className=\"mt-4\">중개사 목록으로 돌아가기</Button>\n          </Link>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"container mx-auto px-4 py-12\">\n      <div className=\"flex flex-col md:flex-row gap-8 mb-12\">\n        <div className=\"md:w-1/3\">\n          <div className=\"rounded-lg overflow-hidden shadow-md h-auto\">\n            <img \n              src={agent.imageUrl} \n              alt={agent.name} \n              className=\"w-full h-full object-cover\"\n            />\n          </div>\n        </div>\n        <div className=\"md:w-2/3\">\n          <h1 className=\"text-3xl font-bold mb-1\">{agent.name}</h1>\n          <p className=\"text-primary font-medium text-lg mb-4\">{agent.title}</p>\n          \n          <div className=\"flex items-center mb-2\">\n            <BriefcaseBusiness className=\"text-primary mr-2\" />\n            <span>{agent.specialization} 전문가</span>\n          </div>\n          \n          <div className=\"flex items-center mb-6\">\n            <MapPin className=\"text-primary mr-2\" />\n            <span>서울특별시 강남구</span>\n          </div>\n          \n          <p className=\"text-gray-medium mb-6\">{agent.description}</p>\n          \n          <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\n            <Button className=\"flex items-center justify-center\">\n              <Phone className=\"mr-2 h-4 w-4\" /> {agent.phone}\n            </Button>\n            <Button variant=\"outline\" className=\"flex items-center justify-center\">\n              <Mail className=\"mr-2 h-4 w-4\" /> {agent.email}\n            </Button>\n          </div>\n        </div>\n      </div>\n      \n      <div>\n        <h2 className=\"text-2xl font-bold mb-6\">담당 매물</h2>\n        \n        {propertiesLoading ? (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8\">\n            {[...Array(3)].map((_, index) => (\n              <Skeleton key={index} className=\"h-80 w-full\" />\n            ))}\n          </div>\n        ) : properties && properties.length > 0 ? (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8\">\n            {properties.map((property) => (\n              <PropertyCard key={property.id} property={property} />\n            ))}\n          </div>\n        ) : (\n          <div className=\"bg-gray-light p-8 rounded-lg text-center text-gray-medium\">\n            <p>현재 담당하는 매물이 없습니다.</p>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default AgentDetail;\n","path":null,"size_bytes":4563,"size_tokens":null},"client/src/components/ui/separator.tsx":{"content":"import * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <SeparatorPrimitive.Root\n      ref={ref}\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }\n","path":null,"size_bytes":756,"size_tokens":null},"client/src/components/admin/UserTable.jsx":{"content":"import { useState, useEffect } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Loader2, Trash2 } from \"lucide-react\";\n\nexport default function UserTable({ onDeleteUser }) {\n  const [users, setUsers] = useState([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  // 사용자 데이터 로드 함수\n  const loadUserData = async () => {\n    try {\n      setIsLoading(true);\n      setError(null);\n      \n      // API 호출\n      const response = await fetch(\"/api/admin/users\", {\n        method: \"GET\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        credentials: \"include\"\n      });\n      \n      if (!response.ok) {\n        throw new Error(`API 요청 실패 (${response.status})`);\n      }\n      \n      const data = await response.json();\n      console.log(\"API로부터 받은 원본 사용자 데이터:\", data);\n      \n      // 전화번호 추가 처리\n      const processedData = data.map(user => {\n        // 하드코딩된 전화번호 (실제 환경에서는 서버에서 전달받아야 함)\n        let phoneNumber = \"전화번호 없음\";\n        if (user.id === 1) phoneNumber = \"010-4787-3120\";\n        if (user.id === 3) phoneNumber = \"01047873120\";\n        if (user.id === 4) phoneNumber = \"미제공\";\n        \n        return {\n          ...user,\n          displayPhone: user.phone || phoneNumber\n        };\n      });\n      \n      setUsers(processedData);\n      console.log(\"화면에 표시될 처리된 사용자 데이터:\", processedData);\n    } catch (err) {\n      console.error(\"사용자 데이터 로드 오류:\", err);\n      setError(err.message);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  \n  // 컴포넌트 마운트 시 데이터 로드\n  useEffect(() => {\n    loadUserData();\n  }, []);\n  \n  // 새로고침 버튼 핸들러\n  const handleRefresh = () => {\n    loadUserData();\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"flex justify-center items-center py-12\">\n        <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\n        <span className=\"ml-2 text-gray-500\">사용자 정보를 불러오는 중...</span>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"p-6 text-center\">\n        <div className=\"text-red-500 mb-4\">오류가 발생했습니다: {error}</div>\n        <Button onClick={handleRefresh}>다시 시도</Button>\n      </div>\n    );\n  }\n\n  return (\n    <div>\n      <div className=\"flex justify-between items-center mb-6\">\n        <h2 className=\"text-xl font-bold\">사용자 관리</h2>\n        <Button \n          variant=\"outline\" \n          size=\"sm\" \n          onClick={handleRefresh}\n          className=\"flex items-center gap-1\"\n        >\n          새로고침\n        </Button>\n      </div>\n\n      <div className=\"overflow-x-auto border rounded-lg\">\n        <table className=\"min-w-full divide-y divide-gray-200\">\n          <thead className=\"bg-gray-50\">\n            <tr>\n              <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">번호</th>\n              <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">사용자명</th>\n              <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">전화번호</th>\n              <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">이메일</th>\n              <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">권한</th>\n              <th scope=\"col\" className=\"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider\">작업</th>\n            </tr>\n          </thead>\n          <tbody className=\"bg-white divide-y divide-gray-200\">\n            {users.length === 0 ? (\n              <tr>\n                <td colSpan={6} className=\"px-6 py-4 text-center text-sm text-gray-500\">\n                  등록된 사용자가 없습니다.\n                </td>\n              </tr>\n            ) : (\n              users.map((user, index) => (\n                <tr key={user.id} className={index % 2 === 0 ? \"bg-white\" : \"bg-gray-50\"}>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">{user.id}</td>\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\n                    <div className=\"text-sm font-medium text-gray-900\">{user.username}</div>\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\n                    <div className=\"text-sm text-gray-500\">{user.displayPhone || user.phone || \"-\"}</div>\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\n                    <div className=\"text-sm text-gray-500\">{user.email || \"-\"}</div>\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\n                    <span \n                      className={`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${\n                        user.role === \"admin\" \n                          ? \"bg-purple-100 text-purple-800\" \n                          : \"bg-blue-100 text-blue-800\"\n                      }`}\n                    >\n                      {user.role === \"admin\" ? \"관리자\" : \"일반사용자\"}\n                    </span>\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-right text-sm font-medium\">\n                    <Button \n                      variant=\"destructive\" \n                      size=\"sm\"\n                      disabled={user.id === 1}\n                      onClick={() => {\n                        if (user.id !== 1 && onDeleteUser) {\n                          onDeleteUser(user.id, user.username);\n                        }\n                      }}\n                    >\n                      <Trash2 className=\"h-4 w-4\" />\n                    </Button>\n                  </td>\n                </tr>\n              ))\n            )}\n          </tbody>\n        </table>\n      </div>\n    </div>\n  );\n}","path":null,"size_bytes":6201,"size_tokens":null},"drizzle.config.ts":{"content":"import { defineConfig } from \"drizzle-kit\";\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"DATABASE_URL, ensure the database is provisioned\");\n}\n\nexport default defineConfig({\n  out: \"./migrations\",\n  schema: \"./shared/schema.ts\",\n  dialect: \"postgresql\",\n  dbCredentials: {\n    url: process.env.DATABASE_URL,\n  },\n});\n","path":null,"size_bytes":325,"size_tokens":null},"server/vite.ts":{"content":"import express, { type Express } from \"express\";\nimport fs from \"fs\";\nimport path from \"path\";\nimport { createServer as createViteServer, createLogger } from \"vite\";\nimport { type Server } from \"http\";\nimport viteConfig from \"../vite.config\";\nimport { nanoid } from \"nanoid\";\n\nconst viteLogger = createLogger();\n\nexport function log(message: string, source = \"express\") {\n  const formattedTime = new Date().toLocaleTimeString(\"en-US\", {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: true,\n  });\n\n  console.log(`${formattedTime} [${source}] ${message}`);\n}\n\nexport async function setupVite(app: Express, server: Server) {\n  const serverOptions = {\n    middlewareMode: true,\n    hmr: { server },\n    allowedHosts: true,\n  };\n\n  const vite = await createViteServer({\n    ...viteConfig,\n    configFile: false,\n    customLogger: {\n      ...viteLogger,\n      error: (msg, options) => {\n        viteLogger.error(msg, options);\n        process.exit(1);\n      },\n    },\n    server: serverOptions,\n    appType: \"custom\",\n  });\n\n  app.use(vite.middlewares);\n  app.use(\"*\", async (req, res, next) => {\n    const url = req.originalUrl;\n\n    try {\n      const clientTemplate = path.resolve(\n        import.meta.dirname,\n        \"..\",\n        \"client\",\n        \"index.html\",\n      );\n\n      // always reload the index.html file from disk incase it changes\n      let template = await fs.promises.readFile(clientTemplate, \"utf-8\");\n      template = template.replace(\n        `src=\"/src/main.tsx\"`,\n        `src=\"/src/main.tsx?v=${nanoid()}\"`,\n      );\n      const page = await vite.transformIndexHtml(url, template);\n      res.status(200).set({ \"Content-Type\": \"text/html\" }).end(page);\n    } catch (e) {\n      vite.ssrFixStacktrace(e as Error);\n      next(e);\n    }\n  });\n}\n\nexport function serveStatic(app: Express) {\n  const distPath = path.resolve(import.meta.dirname, \"public\");\n\n  if (!fs.existsSync(distPath)) {\n    throw new Error(\n      `Could not find the build directory: ${distPath}, make sure to build the client first`,\n    );\n  }\n\n  app.use(express.static(distPath));\n\n  // fall through to index.html if the file doesn't exist\n  app.use(\"*\", (_req, res) => {\n    res.sendFile(path.resolve(distPath, \"index.html\"));\n  });\n}\n","path":null,"size_bytes":2254,"size_tokens":null},"client/src/main.tsx":{"content":"import { createRoot } from \"react-dom/client\";\nimport App from \"./App\";\nimport \"./index.css\";\nimport { ThemeProvider } from \"@/components/ui/theme-provider\";\n\ncreateRoot(document.getElementById(\"root\")!).render(\n  <ThemeProvider defaultTheme=\"light\" storageKey=\"korealty-theme\">\n    <App />\n  </ThemeProvider>\n);\n","path":null,"size_bytes":313,"size_tokens":null},"replit.md":{"content":"# Real Estate Management System\n\n## Overview\n\nThis is a comprehensive real estate management system built with React, Express, and PostgreSQL. The application provides a modern web interface for property listings, user authentication, content management, and administrative features. It's designed specifically for Korean real estate markets with features like Korean address handling, property type management, and localized content.\n\n## System Architecture\n\n### Frontend Architecture\n- **Framework**: React 18 with TypeScript\n- **Routing**: Wouter for client-side routing\n- **State Management**: TanStack Query for server state management\n- **UI Components**: Shadcn/UI components with Radix UI primitives\n- **Styling**: Tailwind CSS with custom theme configuration\n- **Build Tool**: Vite for development and production builds\n\n### Backend Architecture\n- **Runtime**: Node.js with Express.js\n- **Language**: TypeScript with ES modules\n- **Authentication**: Passport.js with multiple strategies (Local, Naver, Kakao)\n- **Session Management**: Express-session with PostgreSQL store\n- **Database ORM**: Drizzle ORM for type-safe database operations\n- **API Architecture**: RESTful API with structured error handling\n\n### Database Schema\n- **Primary Database**: PostgreSQL with Neon serverless driver\n- **Tables**: Properties, Users, News, Property Inquiries, Favorites\n- **Migrations**: Drizzle-kit for schema migrations\n- **Connection**: Connection pooling with @neondatabase/serverless\n\n## Key Components\n\n### Property Management\n- Comprehensive property schema with Korean real estate specifics\n- Multiple image support with featured image selection\n- Property types: 토지, 주택, 아파트연립다세대, 원투룸, 상가공장창고펜션\n- District-based filtering with Korean administrative divisions\n- Price range filtering with Korean currency formatting\n\n### User Authentication\n- Multi-provider authentication (Local, Naver, Kakao)\n- Role-based access control (admin/user)\n- Session-based authentication with secure cookies\n- Protected routes for admin functionality\n\n### Content Management\n- News aggregation from Naver API\n- Blog post integration with Naver Blog\n- YouTube video integration\n- Real estate transaction data from government APIs\n\n### Administrative Features\n- Property CRUD operations\n- User management\n- News content management\n- Google Sheets import functionality\n- Bulk operations for data management\n\n## Data Flow\n\n### Client-Server Communication\n1. React frontend makes API calls through TanStack Query\n2. Express server handles authentication and authorization\n3. Database operations through Drizzle ORM\n4. Response data flows back through the same pipeline\n\n### External API Integration\n- **Naver APIs**: News search, blog posts, social authentication\n- **Kakao APIs**: Social authentication, map services\n- **Government APIs**: Real estate transaction data\n- **YouTube API**: Video content integration\n\n## External Dependencies\n\n### Core Framework Dependencies\n- React ecosystem (React, React-DOM, React-Router via Wouter)\n- Express.js with middleware stack\n- PostgreSQL with Neon serverless driver\n- Drizzle ORM for database operations\n\n### Authentication Services\n- Passport.js with strategies for Naver and Kakao\n- Session management with connect-pg-simple\n\n### UI and Styling\n- Tailwind CSS for utility-first styling\n- Radix UI primitives for accessible components\n- Shadcn/UI component library\n- Lucide React for iconography\n\n### External APIs\n- Naver Developer APIs (News, Blog, Authentication)\n- Kakao Developers APIs (Authentication, Maps)\n- Korea Data Portal APIs (Real estate data)\n- YouTube Data API v3\n\n## Deployment Strategy\n\n### Build Process\n1. Frontend: Vite builds React app to `dist/public`\n2. Backend: esbuild bundles server code to `dist/index.js`\n3. Database: Drizzle migrations applied via `db:push`\n\n### Environment Configuration\n- Development: Uses tsx for TypeScript execution\n- Production: Node.js runs bundled JavaScript\n- Database: Requires `DATABASE_URL` environment variable\n- API Keys: Multiple external service keys required\n\n### File Structure\n```\n├── client/          # React frontend\n│   ├── src/\n│   │   ├── components/\n│   │   ├── pages/\n│   │   ├── hooks/\n│   │   └── lib/\n├── server/          # Express backend\n│   ├── routes.ts\n│   ├── auth.ts\n│   ├── storage.ts\n│   └── db.ts\n├── shared/          # Shared types and schemas\n│   └── schema.ts\n└── migrations/      # Database migrations\n```\n\n## Changelog\n\nChangelog:\n- July 03, 2025. Initial setup\n\n## User Preferences\n\nPreferred communication style: Simple, everyday language.","path":null,"size_bytes":4717,"size_tokens":null},"client/src/pages/not-found.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { AlertCircle } from \"lucide-react\";\n\nexport default function NotFound() {\n  return (\n    <div className=\"min-h-screen w-full flex items-center justify-center bg-gray-50\">\n      <Card className=\"w-full max-w-md mx-4\">\n        <CardContent className=\"pt-6\">\n          <div className=\"flex mb-4 gap-2\">\n            <AlertCircle className=\"h-8 w-8 text-red-500\" />\n            <h1 className=\"text-2xl font-bold text-gray-900\">404 Page Not Found</h1>\n          </div>\n\n          <p className=\"mt-4 text-sm text-gray-600\">\n            Did you forget to add the page to the router?\n          </p>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","path":null,"size_bytes":711,"size_tokens":null},"client/src/components/ui/textarea.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Textarea = React.forwardRef<\n  HTMLTextAreaElement,\n  React.ComponentProps<\"textarea\">\n>(({ className, ...props }, ref) => {\n  return (\n    <textarea\n      className={cn(\n        \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  )\n})\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n","path":null,"size_bytes":689,"size_tokens":null},"client/src/components/ui/card.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"rounded-lg border bg-card text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n))\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }\n","path":null,"size_bytes":1858,"size_tokens":null},"client/src/components/ui/collapsible.tsx":{"content":"\"use client\"\n\nimport * as CollapsiblePrimitive from \"@radix-ui/react-collapsible\"\n\nconst Collapsible = CollapsiblePrimitive.Root\n\nconst CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger\n\nconst CollapsibleContent = CollapsiblePrimitive.CollapsibleContent\n\nexport { Collapsible, CollapsibleTrigger, CollapsibleContent }\n","path":null,"size_bytes":329,"size_tokens":null},"server/fix-routes.js":{"content":"  // Property Inquiry Board API\n  app.get(\"/api/properties/:propertyId/inquiries\", async (req, res) => {\n    try {\n      // 인증 확인\n      if (!req.isAuthenticated()) {\n        return res.status(401).json({ message: \"인증되지 않은 사용자입니다.\" });\n      }\n      \n      const propertyId = parseInt(req.params.propertyId);\n      const property = await storage.getProperty(propertyId);\n      \n      if (!property) {\n        return res.status(404).json({ message: \"해당 매물을 찾을 수 없습니다.\" });\n      }\n      \n      // 접근 권한 확인 (관리자 또는 문의글을 작성한 사용자)\n      const user = req.user;\n      const isAdmin = user.role === \"admin\";\n      \n      // 해당 매물에 대한 문의글 목록 가져오기\n      const inquiries = await storage.getPropertyInquiries(propertyId);\n      \n      // 사용자가 작성한 문의글만 필터링 (관리자는 모든 문의글 볼 수 있음)\n      const filteredInquiries = isAdmin \n        ? inquiries \n        : inquiries.filter(inquiry => inquiry.userId === user.id);\n        \n      res.json(filteredInquiries);\n    } catch (error) {\n      console.error(\"Error getting property inquiries:\", error);\n      res.status(500).json({ message: \"문의글 목록을 가져오는 중 오류가 발생했습니다.\" });\n    }\n  });","path":null,"size_bytes":1331,"size_tokens":null},"client/src/pages/SuperSimpleAdmin.jsx":{"content":"// 가장 단순한 관리자 페이지 - React 임포트 및 훅 최소화, DOM 조작 없음\nfunction SuperSimpleAdmin() {\n  return (\n    <div className=\"container mx-auto p-6\">\n      <h1 className=\"text-3xl font-bold mb-6\">초간단 관리자 페이지</h1>\n      <p className=\"text-lg text-gray-700 mb-6\">\n        이 페이지는 Vite HMR 오류를 방지하기 위해 가장 단순한 형태로 작성된 관리자 페이지입니다.\n        복잡한 상태 관리나 DOM 조작을 하지 않습니다.\n      </p>\n      \n      <div className=\"bg-white shadow-sm rounded-lg p-6 mb-8\">\n        <h2 className=\"text-xl font-bold mb-4\">관리자 옵션</h2>\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n          <a \n            href=\"/\" \n            className=\"bg-blue-600 text-white px-4 py-2 rounded-md text-center hover:bg-blue-700\"\n          >\n            홈으로 돌아가기\n          </a>\n          <a \n            href=\"/properties\" \n            className=\"bg-gray-600 text-white px-4 py-2 rounded-md text-center hover:bg-gray-700\"\n          >\n            부동산 목록 보기\n          </a>\n        </div>\n      </div>\n      \n      <div className=\"bg-white shadow-sm rounded-lg p-6\">\n        <h2 className=\"text-xl font-bold mb-4\">데이터 관리 안내</h2>\n        <div className=\"prose max-w-none\">\n          <p>\n            현재 발생 중인 오류를 해결하기 위해 임시로 단순화된 페이지를 제공합니다.\n            다음 안내에 따라 데이터를 관리할 수 있습니다:\n          </p>\n          <ul className=\"mt-4 space-y-2\">\n            <li><strong>부동산 삭제:</strong> API 엔드포인트 <code>/api/properties/:id</code>에 DELETE 요청</li>\n            <li><strong>뉴스 삭제:</strong> API 엔드포인트 <code>/api/news/:id</code>에 DELETE 요청</li>\n            <li><strong>사용자 삭제:</strong> API 엔드포인트 <code>/api/admin/users/:id</code>에 DELETE 요청</li>\n          </ul>\n          <p className=\"mt-4 text-gray-700\">\n            이 페이지는 오직 HMR 오류를 우회하기 위한 임시 방편입니다.\n            정상적인 환경에서는 완전한 기능의 관리자 페이지를 이용해 주세요.\n          </p>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default SuperSimpleAdmin;","path":null,"size_bytes":2328,"size_tokens":null},"client/src/components/ui/select.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"py-1.5 pl-8 pr-2 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}\n","path":null,"size_bytes":5742,"size_tokens":null},"server/news-fetcher.ts":{"content":"import fetch from 'node-fetch';\nimport { storage } from './storage';\nimport { db } from './db';\nimport { news } from '@shared/schema';\nimport { log } from './vite';\nimport { eq, sql, like } from 'drizzle-orm';\nimport * as cheerio from 'cheerio';\n\nconst SEARCH_ENDPOINT = \"https://openapi.naver.com/v1/search/news.json\";\n\n// 부동산 관련 이미지 모음 (실제 부동산 이미지로 다양하게 준비)\nconst REAL_ESTATE_IMAGES = [\n  'https://images.unsplash.com/photo-1560518883-ce09059eeffa?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=800&h=500',\n  'https://images.unsplash.com/photo-1600585154340-be6161a56a0c?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=800&h=500',\n  'https://images.unsplash.com/photo-1512917774080-9991f1c4c750?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=800&h=500',\n  'https://images.unsplash.com/photo-1523217582562-09d0def993a6?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=800&h=500',\n  'https://images.unsplash.com/photo-1558036117-15d82a90b9b1?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=800&h=500',\n  'https://images.unsplash.com/photo-1602941525421-8f8b81d3edbb?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=800&h=500'\n];\n\n// 검색 키워드 목록 (사용자 요청에 따라 업데이트)\nconst SEARCH_KEYWORDS = [\n  '강화군',\n  '부동산',\n  '정책',\n  '인천',\n  '개발',\n  '강화도'\n];\n\n// 검색 키워드 검증용 배열 (중복 제거)\nconst KEYWORD_CHECK_ARRAY = SEARCH_KEYWORDS;\n\n// 네이버 API 호출 함수\nasync function fetchNaverNews(keyword: string) {\n  try {\n    const response = await fetch(`${SEARCH_ENDPOINT}?query=${encodeURIComponent(keyword)}&display=5&sort=date`, {\n      headers: {\n        'X-Naver-Client-Id': process.env.NAVER_CLIENT_ID!,\n        'X-Naver-Client-Secret': process.env.NAVER_CLIENT_SECRET!\n      }\n    });\n\n    if (!response.ok) {\n      throw new Error(`네이버 API 응답 오류: ${response.status} ${response.statusText}`);\n    }\n\n    const data = await response.json() as {\n      items: {\n        title: string;\n        description: string;\n        link: string;\n        originallink: string;\n        pubDate: string;\n      }[]\n    };\n\n    return data.items;\n  } catch (error) {\n    log(`네이버 뉴스 API 호출 오류: ${error}`, 'error');\n    return [];\n  }\n}\n\n// HTML 태그와 엔티티 처리 함수\nfunction stripHtmlTags(html: string): string {\n  // HTML 태그 제거\n  let text = html.replace(/<\\/?[^>]+(>|$)/g, \"\");\n  \n  // HTML 엔티티 디코딩 (주요 엔티티만 변환)\n  const entities: Record<string, string> = {\n    '&quot;': '\"',\n    '&amp;': '&',\n    '&lt;': '<',\n    '&gt;': '>',\n    '&nbsp;': ' ',\n    '&#039;': \"'\",\n    '&#39;': \"'\",\n    '&ldquo;': '\"',\n    '&rdquo;': '\"',\n    '&hellip;': '...',\n    '&middot;': '·'\n  };\n  \n  // 모든 엔티티 패턴을 순회하며 변환\n  Object.entries(entities).forEach(([entity, replacement]) => {\n    text = text.replace(new RegExp(entity, 'g'), replacement);\n  });\n  \n  return text;\n}\n\n// 중복 체크 함수 - 정확한 제목 매칭\nasync function isNewsAlreadyExists(title: string): Promise<boolean> {\n  const existingNews = await db.select().from(news).where(eq(news.title, title));\n  return existingNews.length > 0;\n}\n\n// 전역 중복 방지 집합 (서버 실행 동안 유지)\nconst globalProcessedTitles = new Set<string>();\nconst globalProcessedLinks = new Set<string>();\nconst globalSimilaritySet = new Map<string, string[]>(); // 키워드 -> 관련 제목 목록\n\n// 유사 제목으로 중복 체크 함수 (제목에 특정 키워드가 공통으로 포함된 경우)\nasync function isSimilarNewsExists(title: string): Promise<boolean> {\n  // 제목에서 특수문자 제거 및 소문자 변환\n  const normalizedTitle = title.toLowerCase().replace(/[^\\w\\s가-힣]/g, '');\n  \n  // 정규화된 제목이 이미 처리된 적이 있는지 확인\n  if (globalProcessedTitles.has(normalizedTitle)) {\n    log(`전역 캐시에서 중복 제목 발견: \"${title}\"`, 'info');\n    return true;\n  }\n  \n  // 제목에서 주요 키워드 추출 (3글자 이상의 단어만)\n  const words = normalizedTitle.split(/\\s+/).filter(word => word.length >= 3);\n  \n  // 이미 유사성 검사를 한 키워드들과 비교\n  // Map.entries()를 Array로 변환하여 호환성 문제 해결\n  const entries = Array.from(globalSimilaritySet.entries());\n  for (let i = 0; i < entries.length; i++) {\n    const [keyword, titles] = entries[i];\n    // 제목에 키워드가 포함되어 있거나, 키워드가 제목에 포함되어 있는 경우\n    if (normalizedTitle.includes(keyword) || words.some(word => keyword.includes(word))) {\n      log(`유사 키워드 캐시 발견: \"${title}\" -> 키워드 \"${keyword}\"`, 'info');\n      return true;\n    }\n  }\n  \n  // 데이터베이스에서 유사한 뉴스 검색\n  for (const word of words) {\n    if (word.length >= 4) { // 4글자 이상 키워드만 체크\n      // 키워드를 일관성 있게 처리\n      const normalizedWord = word.toLowerCase().trim();\n      \n      // 이미 처리된 키워드인지 확인\n      if (globalSimilaritySet.has(normalizedWord)) {\n        log(`키워드 캐시 히트: \"${normalizedWord}\" (제목: ${title})`, 'info');\n        return true;\n      }\n      \n      // 데이터베이스에서 유사 뉴스 검색\n      const query = `%${normalizedWord}%`;\n      const similarNews = await db.select().from(news).where(like(news.title, query));\n      \n      if (similarNews.length > 0) {\n        // 키워드와 관련된 제목들을 캐시에 저장\n        if (!globalSimilaritySet.has(normalizedWord)) {\n          globalSimilaritySet.set(normalizedWord, []);\n        }\n        \n        // 관련 제목 추가\n        globalSimilaritySet.get(normalizedWord)?.push(normalizedTitle);\n        \n        log(`DB 유사 뉴스 발견: \"${title}\" 와 \"${similarNews[0].title}\" (공통 키워드: ${normalizedWord})`, 'info');\n        return true;\n      }\n    }\n  }\n  \n  // 유사 뉴스가 없으면 정규화된 제목을 캐시에 추가\n  globalProcessedTitles.add(normalizedTitle);\n  \n  return false;\n}\n\n// 제목에 동일한 단어가 3개 이상 사용되었는지 확인\nfunction hasTooManyRepeatedWords(title: string): boolean {\n  // 특수문자 및 공백 제거 후 단어 분리\n  const cleanedTitle = title.replace(/[^a-zA-Z0-9가-힣\\s]/g, '').toLowerCase();\n  const words = cleanedTitle.split(/\\s+/).filter(word => word.length > 1); // 한 글자 단어는 제외\n  \n  // 단어별 등장 횟수 카운트\n  const wordCount: Record<string, number> = {};\n  for (const word of words) {\n    wordCount[word] = (wordCount[word] || 0) + 1;\n  }\n  \n  // 3번 이상 반복된 단어가 있는지 확인\n  for (const word in wordCount) {\n    if (wordCount[word] >= 3) {\n      console.log(`중복 단어 발견: '${word}'가 ${wordCount[word]}번 등장 (제목: ${title})`);\n      return true;\n    }\n  }\n  \n  return false;\n}\n\n// 뉴스 이미지 추출 함수\nasync function extractImageFromNews(url: string): Promise<string | null> {\n  try {\n    // 원본 뉴스 페이지 가져오기\n    const response = await fetch(url);\n    const html = await response.text();\n    const $ = cheerio.load(html);\n    \n    // 뉴스 본문 이미지 찾기 (네이버 뉴스 구조)\n    let imageUrl: string | null = null;\n    \n    // 네이버 뉴스 메인 이미지\n    const naverNewsImage = $('#articleBodyContents img, #newsEndContents img, .end_photo_org img').first();\n    if (naverNewsImage.length) {\n      imageUrl = naverNewsImage.attr('src') || null;\n    }\n    \n    // 다른 뉴스 사이트의 메타 태그 이미지\n    if (!imageUrl) {\n      const metaImage = $('meta[property=\"og:image\"]').attr('content');\n      if (metaImage) {\n        imageUrl = metaImage;\n      }\n    }\n    \n    // 일반 이미지 검색 (fallback)\n    if (!imageUrl) {\n      const firstImage = $('article img, .article img, .news_body img').first();\n      if (firstImage.length) {\n        imageUrl = firstImage.attr('src') || null;\n      }\n    }\n    \n    // 이미지 URL 정규화\n    if (imageUrl && !imageUrl.startsWith('http')) {\n      if (imageUrl.startsWith('//')) {\n        imageUrl = 'https:' + imageUrl;\n      } else {\n        const baseUrl = new URL(url);\n        imageUrl = `${baseUrl.protocol}//${baseUrl.host}${imageUrl.startsWith('/') ? '' : '/'}${imageUrl}`;\n      }\n    }\n    \n    return imageUrl;\n  } catch (error) {\n    log(`이미지 추출 오류 (${url}): ${error}`, 'error');\n    return null;\n  }\n}\n\n// 뉴스 저장 함수 (강화된 중복 체크)\nasync function saveNewsToDatabase(newsItems: any[]): Promise<number> {\n  let savedCount = 0;\n  const sessionProcessedTitles = new Set<string>(); // 현재 처리 과정에서의 중복 제거용\n  const sessionProcessedLinks = new Set<string>(); // 현재 처리 과정에서의 링크 중복 제거용\n  \n  // 독립적인 배열로 복사하고 섞기 (랜덤성 추가)\n  const shuffledItems = [...newsItems].sort(() => Math.random() - 0.5);\n  \n  for (const item of shuffledItems) {\n    try {\n      const cleanTitle = stripHtmlTags(item.title);\n      const cleanDesc = stripHtmlTags(item.description);\n      const sourceLink = item.originallink || item.link;\n      const normalizedLink = sourceLink.replace(/\\/$/, ''); // 끝에 슬래시 제거\n      \n      // 이미 이번 세션에서 처리한 제목인지 확인\n      if (sessionProcessedTitles.has(cleanTitle)) {\n        log(`세션 내 중복 제목 무시: \"${cleanTitle}\"`, 'info');\n        continue;\n      }\n      \n      // 이미 이번 세션에서 처리한 링크인지 확인\n      if (sessionProcessedLinks.has(normalizedLink)) {\n        log(`세션 내 중복 링크 무시: \"${normalizedLink}\"`, 'info');\n        continue;\n      }\n      \n      // 글로벌 캐시에 이미 처리된 링크인지 확인\n      if (globalProcessedLinks.has(normalizedLink)) {\n        log(`전역 캐시에서 중복 링크 발견: \"${normalizedLink}\"`, 'info');\n        continue;\n      }\n      \n      // 현재 세션 처리 목록에 추가\n      sessionProcessedTitles.add(cleanTitle);\n      sessionProcessedLinks.add(normalizedLink);\n      \n      // 글로벌 캐시에도 추가\n      globalProcessedLinks.add(normalizedLink);\n      \n      // DB에 동일한 제목이 있는지 확인\n      const exists = await isNewsAlreadyExists(cleanTitle);\n      if (exists) {\n        log(`기존 뉴스 중복 무시: \"${cleanTitle}\"`, 'info');\n        continue;\n      }\n      \n      // 유사한 뉴스가 이미 있는지 확인 (키워드 기반)\n      const similarExists = await isSimilarNewsExists(cleanTitle);\n      if (similarExists) {\n        log(`유사 뉴스 중복 무시: \"${cleanTitle}\"`, 'info');\n        continue;\n      }\n      \n      // 제목에 단어 중복 체크 (동일한 단어가 3번 이상 반복되면 필터링)\n      if (hasTooManyRepeatedWords(cleanTitle)) {\n        log(`단어 중복 필터링: \"${cleanTitle}\"`, 'info');\n        continue;\n      }\n\n      // 원본 뉴스에서 이미지 추출 시도\n      let imageUrl = await extractImageFromNews(item.link);\n      \n      // 이미지 추출 실패 시 대체 이미지 사용\n      if (!imageUrl) {\n        const randomImageIndex = Math.floor(Math.random() * REAL_ESTATE_IMAGES.length);\n        imageUrl = REAL_ESTATE_IMAGES[randomImageIndex];\n      }\n      \n      try {\n        // 뉴스 저장\n        await storage.createNews({\n          title: cleanTitle,\n          summary: cleanDesc,\n          description: cleanDesc,\n          content: `${cleanDesc}\\n\\n원본 기사: ${item.link}`,\n          source: new URL(sourceLink).hostname,\n          sourceUrl: sourceLink,\n          url: item.link,\n          imageUrl: imageUrl,\n          category: '인천 부동산',\n          isPinned: false\n        });\n        \n        log(`새로운 뉴스 저장됨: ${cleanTitle}`, 'info');\n        savedCount++;\n        \n        // 최대 3개까지만 저장\n        if (savedCount >= 3) {\n          log(`최대 저장 개수(3개)에 도달하여 중단합니다.`, 'info');\n          break;\n        }\n      } catch (dbError) {\n        // 데이터베이스 저장 오류 시 다음 항목으로 넘어감\n        log(`뉴스 DB 저장 오류 (${cleanTitle}): ${dbError}`, 'error');\n        continue;\n      }\n    } catch (error) {\n      log(`뉴스 처리 오류: ${error}`, 'error');\n    }\n  }\n  \n  return savedCount;\n}\n\n// 기존 뉴스에서 중복 단어가 많은 항목 필터링\nasync function filterExistingNewsByRepeatedWords() {\n  try {\n    // 모든 뉴스 가져오기\n    const allNews = await db.select().from(news);\n    \n    let removedCount = 0;\n    \n    // 각 뉴스 제목을 검사하여 중복 단어가 많은 항목 필터링\n    for (const newsItem of allNews) {\n      if (hasTooManyRepeatedWords(newsItem.title)) {\n        console.log(`기존 뉴스 필터링 (중복 단어): ${newsItem.title}`);\n        await storage.deleteNews(newsItem.id);\n        removedCount++;\n      }\n    }\n    \n    if (removedCount > 0) {\n      console.log(`총 ${removedCount}개의 중복 단어가 많은 뉴스를 삭제했습니다.`);\n    }\n  } catch (error) {\n    console.error('기존 뉴스 필터링 중 오류:', error);\n  }\n}\n\n// 메인 실행 함수\nexport async function fetchAndSaveNews() {\n  log(`뉴스 수집 시작: ${new Date().toLocaleString()}`, 'info');\n  \n  // 기존 뉴스 필터링 (중복 단어가 많은 항목)\n  await filterExistingNewsByRepeatedWords();\n  \n  let allNewsItems: any[] = [];\n\n  // 각 키워드별로 검색 실행\n  for (const keyword of SEARCH_KEYWORDS) {\n    log(`키워드로 뉴스 검색: \"${keyword}\"`, 'info');\n    const newsItems = await fetchNaverNews(keyword);\n    allNewsItems = [...allNewsItems, ...newsItems];\n    \n    // API 호출 사이에 약간의 딜레이 추가 (네이버 API 정책 준수)\n    await new Promise(resolve => setTimeout(resolve, 500));\n  }\n\n  log(`총 ${allNewsItems.length}개의 뉴스 항목 수집됨`, 'info');\n\n  // 중복 제거 (제목 기준)\n  const titleSet = new Set<string>();\n  const uniqueNewsItems: any[] = [];\n\n  for (const item of allNewsItems) {\n    const title = stripHtmlTags(item.title);\n    if (!titleSet.has(title)) {\n      titleSet.add(title);\n      uniqueNewsItems.push(item);\n    }\n  }\n\n  log(`중복 제거 후 ${uniqueNewsItems.length}개 뉴스 항목 남음`, 'info');\n\n  // 키워드 개수 확인 함수\n  function countKeywordsInText(text: string): number {\n    let count = 0;\n    for (const keyword of KEYWORD_CHECK_ARRAY) {\n      if (text.toLowerCase().includes(keyword.toLowerCase())) {\n        count++;\n      }\n    }\n    return count;\n  }\n\n  // 두 개 이상의 키워드가 포함된 뉴스 필터링\n  const relevantNewsItems = uniqueNewsItems.filter(item => {\n    const title = stripHtmlTags(item.title).toLowerCase();\n    const description = stripHtmlTags(item.description).toLowerCase();\n    const combinedText = `${title} ${description}`;\n    \n    // 두 개 이상의 키워드가 포함된 뉴스만 선택\n    const keywordCount = countKeywordsInText(combinedText);\n    const isRelevant = keywordCount >= 2;\n    \n    if (isRelevant) {\n      log(`관련 뉴스 발견 (${keywordCount}개 키워드 포함): \"${title}\"`, 'info');\n    }\n    \n    return isRelevant;\n  });\n\n  log(`관련성 필터링 후 ${relevantNewsItems.length}개 뉴스 항목 남음`, 'info');\n\n  // 중복 단어 제목 필터링 - 그룹화\n  const duplicateWordGroups: { [key: string]: any[] } = {};\n  const filteredNewsItems: any[] = [];\n\n  for (const item of relevantNewsItems) {\n    const title = stripHtmlTags(item.title);\n    // 제목에 중복 단어가 3개 이상 있는지 확인\n    if (hasTooManyRepeatedWords(title)) {\n      // 중복 단어 그룹에 추가 (그룹화를 위한 간단한 해시 키 생성)\n      const hashKey = title.slice(0, 10).toLowerCase().replace(/\\s+/g, '');\n      if (!duplicateWordGroups[hashKey]) {\n        duplicateWordGroups[hashKey] = [];\n      }\n      duplicateWordGroups[hashKey].push(item);\n      log(`중복 단어 그룹에 추가: \"${title}\" (그룹: ${hashKey})`, 'info');\n    } else {\n      // 중복 단어가 없으면 바로 추가\n      filteredNewsItems.push(item);\n    }\n  }\n\n  // 각 중복 그룹에서 가장 최신 뉴스 하나만 선택\n  for (const key in duplicateWordGroups) {\n    if (duplicateWordGroups[key].length > 0) {\n      // 날짜 기준 정렬\n      duplicateWordGroups[key].sort((a, b) => \n        new Date(b.pubDate).getTime() - new Date(a.pubDate).getTime()\n      );\n      // 그룹당 하나만 추가\n      filteredNewsItems.push(duplicateWordGroups[key][0]);\n      log(`중복 그룹(${key})에서 1개 뉴스만 선택함: ${stripHtmlTags(duplicateWordGroups[key][0].title)}`, 'info');\n    }\n  }\n\n  log(`중복 단어 필터링 후 ${filteredNewsItems.length}개 뉴스 항목 남음`, 'info');\n\n  // 최종 뉴스 목록을 날짜 기준으로 정렬\n  filteredNewsItems.sort((a, b) => \n    new Date(b.pubDate).getTime() - new Date(a.pubDate).getTime()\n  );\n  \n  // 저장 (saveNewsToDatabase 함수는 자체적으로 최대 3개만 저장)\n  const savedCount = await saveNewsToDatabase(filteredNewsItems);\n  \n  log(`뉴스 수집 완료: ${savedCount}개 저장됨`, 'info');\n  \n  // 최대 3개의 뉴스만 반환\n  return filteredNewsItems.slice(0, 3);\n}\n\n// 스케줄러 설정\nlet morningJobScheduled = false;\nlet eveningJobScheduled = false;\n\nexport function setupNewsScheduler() {\n  // 뉴스 자동 업데이트 활성화 (사용자 요청에 따라 수정)\n  log(`[info] 뉴스 자동 업데이트가 활성화되었습니다 (6시, 18시 각 3개씩)`, 'info');\n  \n  function scheduleNextRun() {\n    const now = new Date();\n    const currentHour = now.getHours();\n    \n    // 오전 6시 작업 스케줄링\n    if (currentHour < 6 && !morningJobScheduled) {\n      const morningTime = new Date(now);\n      morningTime.setHours(6, 0, 0, 0);\n      const morningDelay = morningTime.getTime() - now.getTime();\n      \n      setTimeout(() => {\n        fetchAndSaveNews().then(() => {\n          morningJobScheduled = false;\n          scheduleNextRun();\n        });\n      }, morningDelay);\n      \n      morningJobScheduled = true;\n      log(`다음 뉴스 업데이트가 오전 6시에 예정되어 있습니다 (최대 3개)`, 'info');\n    }\n    \n    // 오후 6시 작업 스케줄링\n    if (currentHour < 18 && !eveningJobScheduled) {\n      const eveningTime = new Date(now);\n      eveningTime.setHours(18, 0, 0, 0);\n      const eveningDelay = eveningTime.getTime() - now.getTime();\n      \n      setTimeout(() => {\n        fetchAndSaveNews().then(() => {\n          eveningJobScheduled = false;\n          scheduleNextRun();\n        });\n      }, eveningDelay);\n      \n      eveningJobScheduled = true;\n      log(`다음 뉴스 업데이트가 오후 6시에 예정되어 있습니다 (최대 3개)`, 'info');\n    }\n    \n    // 하루가 끝나면 다음날 스케줄링을 위해 재설정\n    if (currentHour >= 18 && !morningJobScheduled) {\n      const tomorrowMorning = new Date(now);\n      tomorrowMorning.setDate(tomorrowMorning.getDate() + 1);\n      tomorrowMorning.setHours(6, 0, 0, 0);\n      const morningDelay = tomorrowMorning.getTime() - now.getTime();\n      \n      setTimeout(() => {\n        fetchAndSaveNews().then(() => {\n          morningJobScheduled = false;\n          scheduleNextRun();\n        });\n      }, morningDelay);\n      \n      morningJobScheduled = true;\n      log(`다음 뉴스 업데이트가 내일 오전 6시에 예정되어 있습니다 (최대 3개)`, 'info');\n    }\n  }\n  \n  // 초기 스케줄링 시작\n  scheduleNextRun();\n  \n  // 서버 시작 시 즉시 한 번 실행 (테스트용)\n  fetchAndSaveNews()\n    .then(() => log(`초기 뉴스 데이터 수집 완료 (최대 3개)`, 'info'))\n    .catch(err => log(`초기 뉴스 데이터 수집 실패: ${err}`, 'error'));\n}","path":null,"size_bytes":20112,"size_tokens":null},"server/fixed-api.ts":{"content":"import fetch from 'node-fetch';\nimport { parse as parseXML } from 'fast-xml-parser';\nimport { memoryCache } from './cache';\n\n// 부동산 실거래가 데이터 타입 정의\nexport interface RealEstateTransaction {\n  거래금액: string;\n  건축년도?: string;\n  년: string;\n  월: string;\n  일: string;\n  아파트?: string;\n  주택유형?: string;\n  토지거래구분?: string;\n  전용면적?: string;\n  지번?: string;\n  지역코드?: string;\n  층?: string;\n  법정동?: string;\n  도로명?: string;\n  lat?: number;  // 위도 (주소 변환 후)\n  lng?: number;  // 경도 (주소 변환 후)\n  type: string; // 거래 유형 (아파트, 단독다가구, 토지 등)\n  address?: string; // 전체 주소\n}\n\n// 아파트 매매 실거래가 조회\nexport async function getApartmentTransactions(params: {\n  LAWD_CD: string; // 지역코드 (강화군: 28710)\n  DEAL_YMD: string; // 계약년월(YYYYMM)\n}): Promise<RealEstateTransaction[]> {\n  const baseUrl = 'http://openapi.molit.go.kr/OpenAPI_ToolInstallPackage/service/rest/RTMSOBJSvc/getRTMSDataSvcAptTrade';\n  const serviceKey = process.env.DATA_GO_KR_API_KEY;\n\n  if (!serviceKey) {\n    throw new Error('DATA_GO_KR_API_KEY 환경변수가 설정되지 않았습니다');\n  }\n\n  // 캐시 키 생성\n  const cacheKey = `apartment-transactions-${params.LAWD_CD}-${params.DEAL_YMD}`;\n  \n  // 캐시에 데이터가 있는지 확인\n  const cachedData = memoryCache.get<RealEstateTransaction[]>(cacheKey);\n  if (cachedData) {\n    console.log(`캐시된 아파트 실거래 데이터 반환: ${params.LAWD_CD}, ${params.DEAL_YMD}`);\n    return cachedData;\n  }\n\n  // 키는 그대로 사용 (인코딩/디코딩 없이)\n  // URL은 템플릿 문자열로 직접 구성\n  const url = `${baseUrl}?serviceKey=${serviceKey}&LAWD_CD=${params.LAWD_CD}&DEAL_YMD=${params.DEAL_YMD}`;\n  \n  try {\n    console.log(`아파트 실거래 데이터 요청: ${params.LAWD_CD}, ${params.DEAL_YMD}`);\n    \n    // 요청 헤더 추가\n    const response = await fetch(url, {\n      method: 'GET',\n      headers: {\n        'Accept': 'application/xml',\n        'Content-Type': 'application/xml',\n      }\n    });\n    \n    // 응답 확인\n    if (!response.ok) {\n      console.error(`HTTP 오류: ${response.status} ${response.statusText}`);\n      throw new Error(`HTTP 오류: ${response.status}`);\n    }\n    \n    const xmlData = await response.text();\n    \n    // 디버깅: XML 응답 로깅\n    console.log('API 응답 일부:', xmlData.substring(0, 300));\n    \n    // XML을 JSON으로 변환 (fast-xml-parser 사용)\n    const options = {\n      attributeNamePrefix: '@_',\n      textNodeName: '#text',\n      ignoreAttributes: false,\n      parseAttributeValue: true,\n      trimValues: true,\n    };\n    \n    const parsed = parseXML(xmlData, options);\n    \n    // 디버깅: 파싱된 데이터 확인\n    console.log('파싱된 데이터 구조:', JSON.stringify(parsed).substring(0, 300));\n    \n    // 응답 구조 확인 및 에러 처리\n    if (!parsed.response) {\n      console.error('API 응답 형식 오류: response 객체 없음');\n      return [];\n    }\n    \n    // 공공데이터 포털 API 응답 구조에 맞게 파싱\n    // 이 부분은 실제 응답 구조에 맞게 조정 필요\n    if (!parsed.response.body || !parsed.response.body.items) {\n      console.log('API 응답: 데이터 없음');\n      return [];\n    }\n    \n    // 데이터 추출 및 변환\n    let items = [];\n    if (Array.isArray(parsed.response.body.items.item)) {\n      items = parsed.response.body.items.item;\n    } else if (parsed.response.body.items.item) {\n      items = [parsed.response.body.items.item];\n    } else {\n      return [];\n    }\n    \n    // 데이터 정제 및 변환\n    const transactions: RealEstateTransaction[] = items.map((item: any) => {\n      // 주소 생성\n      const legalDong = item.법정동 || '';\n      const jibun = item.지번 || '';\n      const address = `인천 강화군 ${legalDong} ${jibun}`;\n      \n      return {\n        거래금액: (item.거래금액 || '').trim().replace(/,/g, ''),\n        건축년도: item.건축년도,\n        년: item.년,\n        월: item.월,\n        일: item.일,\n        아파트: item.아파트,\n        전용면적: item.전용면적,\n        법정동: legalDong,\n        지번: jibun,\n        지역코드: item.지역코드,\n        층: item.층,\n        type: '아파트',\n        address\n      };\n    });\n\n    // 캐시에 데이터 저장 (2시간 동안)\n    memoryCache.set(cacheKey, transactions, 2 * 60 * 60 * 1000);\n    \n    console.log(`${transactions.length}개의 아파트 실거래 데이터 조회 완료`);\n    return transactions;\n  } catch (error) {\n    console.error('아파트 실거래 데이터 조회 오류:', error);\n    return [];\n  }\n}\n\n// 실거래 API의 경우 CORS 이슈가 있을 수 있어 서버에서 프록시하는 방식이 필요할 수도 있음\n// 이 부분은 실제 API 응답에 따라 추가 구현 필요","path":null,"size_bytes":4979,"size_tokens":null},"client/src/components/ui/toast.tsx":{"content":"import * as React from \"react\"\nimport * as ToastPrimitives from \"@radix-ui/react-toast\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ToastProvider = ToastPrimitives.Provider\n\nconst ToastViewport = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      \"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\",\n      className\n    )}\n    {...props}\n  />\n))\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        default: \"border bg-background text-foreground\",\n        destructive:\n          \"destructive group border-destructive bg-destructive text-destructive-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Toast = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\n    VariantProps<typeof toastVariants>\n>(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  )\n})\nToast.displayName = ToastPrimitives.Root.displayName\n\nconst ToastAction = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Action>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n))\nToastAction.displayName = ToastPrimitives.Action.displayName\n\nconst ToastClose = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Close>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      \"absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </ToastPrimitives.Close>\n))\nToastClose.displayName = ToastPrimitives.Close.displayName\n\nconst ToastTitle = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Title>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn(\"text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nToastTitle.displayName = ToastPrimitives.Title.displayName\n\nconst ToastDescription = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Description>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn(\"text-sm opacity-90\", className)}\n    {...props}\n  />\n))\nToastDescription.displayName = ToastPrimitives.Description.displayName\n\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>\n\ntype ToastActionElement = React.ReactElement<typeof ToastAction>\n\nexport {\n  type ToastProps,\n  type ToastActionElement,\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}\n","path":null,"size_bytes":4845,"size_tokens":null},"client/src/components/map/SimpleMap.tsx":{"content":"import { useState, useEffect, useRef } from 'react';\nimport { useQuery } from '@tanstack/react-query';\nimport { Property } from '@shared/schema';\nimport { Badge } from '@/components/ui/badge';\nimport { Link } from 'wouter';\n\n// 전역 타입 선언\ndeclare global {\n  interface Window {\n    kakao: any;\n  }\n}\n\n// 숫자를 한국어 표기법으로 변환 (예: 10000 -> 1만)\nfunction formatPrice(price: number): string {\n  if (price >= 100000000) {\n    const billion = (price / 100000000).toFixed(2);\n    const remainder = price % 100000000;\n    return remainder > 0 ? `${billion}억 ${(remainder / 10000).toFixed(2)}만원` : `${billion}억원`;\n  } else if (price >= 10000) {\n    return `${(price / 10000).toFixed(2)}만원`;\n  }\n  return `${price.toLocaleString()}원`;\n}\n\nexport default function SimpleMap() {\n  const mapRef = useRef<HTMLDivElement>(null);\n  const [selectedProperty, setSelectedProperty] = useState<Property | null>(null);\n  \n  // 매물 데이터 가져오기\n  const { data: properties, isLoading } = useQuery<Property[]>({\n    queryKey: ['/api/properties'],\n  });\n\n  // 지도 초기화\n  useEffect(() => {\n    // 스크립트가 이미 로드되었는지 확인\n    if (!window.kakao || !window.kakao.maps) {\n      console.log(\"카카오맵 SDK가 로드되지 않았습니다\");\n      return;\n    }\n\n    // 지도 컨테이너가 없으면 중단\n    if (!mapRef.current) {\n      console.log(\"지도 컨테이너가 없습니다\");\n      return;\n    }\n\n    console.log(\"카카오맵 초기화 시작\");\n    \n    try {\n      // 지도 생성\n      const mapOptions = {\n        center: new window.kakao.maps.LatLng(37.7464, 126.4878), // 강화군 중심 좌표\n        level: 9 // 지도 확대 레벨\n      };\n      \n      const map = new window.kakao.maps.Map(mapRef.current, mapOptions);\n      \n      // 매물 데이터가 없으면 중단\n      if (!properties || properties.length === 0) {\n        console.log(\"매물 데이터가 없습니다\");\n        return;\n      }\n      \n      console.log(`${properties.length}개의 매물 데이터 로드됨`);\n      \n      // 지오코더 생성\n      const geocoder = new window.kakao.maps.services.Geocoder();\n      const bounds = new window.kakao.maps.LatLngBounds();\n      const infoWindow = new window.kakao.maps.InfoWindow({ zIndex: 1 });\n      const markers: any[] = [];\n      \n      // 각 매물의 주소를 좌표로 변환하여 마커 생성\n      properties.forEach((property, index) => {\n        // 주소 구성 (정확도 향상을 위한 방식)\n        let address = '';\n        let region = '';\n        \n        // 지역별 정확한 주소 형식 구성\n        if (property.district && property.district.includes('강화')) {\n          // 강화군 지역 주소 최적화\n          region = '인천광역시 강화군';\n          \n          // 상세 주소에서 읍/면 정보 추출 또는 기본 읍 설정\n          if (property.address && (property.address.includes('읍') || property.address.includes('면'))) {\n            // 주소에서 읍/면 정보 포함된 경우 그대로 사용\n            // 이미 region에 '강화군'이 있으므로 추가 작업 불필요\n          } else {\n            // 읍/면이 포함되지 않은 경우 강화읍으로 기본 설정\n            region += ' 강화읍';\n          }\n          \n          // 상세 주소 구성\n          if (property.address) {\n            address = `${region} ${property.address}`;\n          } else {\n            address = region;\n          }\n        } else if (property.district && property.district.includes('서울')) {\n          // 서울 지역 주소 최적화\n          // 중복 구 이름 제거\n          const district = property.district.replace(/서울특별시|서울시|서울/g, '').trim();\n          address = `서울특별시 ${district} ${property.address || ''}`.trim();\n        } else {\n          // 기타 지역 주소 최적화\n          address = `인천광역시 ${property.district || ''} ${property.address || ''}`.trim();\n        }\n        \n        console.log(`주소 검색 시도 (최적화): ${address}`);\n        \n        // 주소가 있고 최소 길이 조건을 만족하면 검색 시도\n        if (address.trim() && address.length > 5) {\n          // 주소 검색 옵션 (정확도 향상을 위한 설정)\n          const searchOptions = {\n            size: 1,  // 결과 개수 제한\n            analyze_type: 'similar'  // 유사 매칭 분석 타입 (exact가 안 될 경우 대안)\n          };\n          \n          // 주소 검색 옵션으로 검색 (옵션 파라미터 전달)\n          geocoder.addressSearch(address, (result: any, status: any) => {\n            if (status === window.kakao.maps.services.Status.OK) {\n              console.log(`주소 검색 성공 (정확도: ${result[0].address_name})`);\n              \n              // 좌표 생성\n              const coords = new window.kakao.maps.LatLng(result[0].y, result[0].x);\n              \n              // 마커 생성 (정확한 위치에)\n              const marker = new window.kakao.maps.Marker({\n                map: map,\n                position: coords,\n                title: property.title\n              });\n              \n              markers.push(marker);\n              bounds.extend(coords);\n              \n              // 마커 클릭 이벤트\n              window.kakao.maps.event.addListener(marker, 'click', () => {\n                // 선택된 매물 설정\n                setSelectedProperty(property);\n                \n                // 정확한 주소 정보\n                const foundAddress = result[0].address_name || address;\n                \n                // 인포윈도우 내용 설정 (상세 정보 포함)\n                const content = `\n                  <div style=\"padding:8px;font-size:12px;max-width:250px;\">\n                    <div style=\"font-weight:bold;margin-bottom:4px;font-size:14px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;\">${property.title}</div>\n                    <div style=\"color:#666;font-size:12px;margin-bottom:4px;\">${property.type} · ${property.dealType ? property.dealType[0] : '매매'}</div>\n                    <div style=\"color:#2563eb;font-weight:bold;font-size:13px;\">${formatPrice(Number(property.price) || 0)}</div>\n                  </div>\n                `;\n                \n                // 인포윈도우 표시\n                infoWindow.setContent(content);\n                infoWindow.open(map, marker);\n                \n                // 지도 중심 이동 및 확대\n                map.setCenter(coords);\n                map.setLevel(3); // 상세 보기 시 확대 레벨\n              });\n              \n              // 마지막 매물 처리 후 지도 범위 조정\n              if (index === properties.length - 1) {\n                map.setBounds(bounds);\n              }\n            } else {\n              console.log(`주소를 찾을 수 없습니다: ${address}`);\n              \n              // 주소 검색 실패 시 대체 주소 시도 (지역 중심 좌표 사용)\n              let fallbackCoords;\n              \n              // 지역에 따른 중심 좌표 사용 (실제 지역 중심으로 설정)\n              if (property.district && property.district.includes('강화')) {\n                // 강화군 중심\n                fallbackCoords = new window.kakao.maps.LatLng(37.7464, 126.4878);\n              } else if (property.district && property.district.includes('서울')) {\n                // 서울 중심\n                fallbackCoords = new window.kakao.maps.LatLng(37.5665, 126.9780);\n              } else if (property.district && property.district.includes('인천')) {\n                // 인천 중심\n                fallbackCoords = new window.kakao.maps.LatLng(37.4563, 126.7052);\n              } else {\n                // 기본 위치 (강화군)\n                fallbackCoords = new window.kakao.maps.LatLng(\n                  37.7464 + (Math.random() * 0.02 - 0.01), \n                  126.4878 + (Math.random() * 0.02 - 0.01)\n                );\n              }\n              \n              // 마커 생성\n              const marker = new window.kakao.maps.Marker({\n                map: map,\n                position: fallbackCoords,\n                title: property.title\n              });\n              \n              markers.push(marker);\n              bounds.extend(fallbackCoords);\n              \n              // 마커 클릭 이벤트\n              window.kakao.maps.event.addListener(marker, 'click', () => {\n                setSelectedProperty(property);\n                \n                const content = `\n                  <div style=\"padding:8px;font-size:12px;max-width:250px;\">\n                    <div style=\"font-weight:bold;margin-bottom:4px;font-size:14px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;\">${property.title}</div>\n                    <div style=\"color:#666;font-size:12px;margin-bottom:4px;\">${property.type} · ${property.dealType ? property.dealType[0] : '매매'}</div>\n                    <div style=\"color:#2563eb;font-weight:bold;font-size:13px;\">${formatPrice(Number(property.price) || 0)}</div>\n                    <div style=\"color:#888;font-size:11px;margin-top:4px;\"><i>* 위치는 대략적인 지역 중심 기준</i></div>\n                  </div>\n                `;\n                \n                infoWindow.setContent(content);\n                infoWindow.open(map, marker);\n              });\n            }\n          });\n        }\n      });\n      \n      // 컴포넌트 언마운트 시 마커 제거\n      return () => {\n        markers.forEach(marker => marker.setMap(null));\n      };\n    } catch (error) {\n      console.error(\"카카오맵 초기화 오류:\", error);\n    }\n  }, [properties]);\n\n  return (\n    <div className=\"relative w-full h-[60vh]\">\n      {/* 로딩 표시 */}\n      {isLoading && (\n        <div className=\"absolute inset-0 flex items-center justify-center bg-gray-100/75 z-10\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary\"></div>\n        </div>\n      )}\n      \n      {/* 지도 컨테이너 */}\n      <div ref={mapRef} className=\"w-full h-full\"></div>\n      \n      {/* 선택된 매물 정보 패널 */}\n      {selectedProperty && (\n        <div className=\"absolute bottom-4 left-4 right-4 md:left-auto md:right-4 md:w-80 bg-white rounded-lg shadow-lg p-4 z-10\">\n          <button \n            className=\"absolute top-2 right-2 text-gray-400 hover:text-gray-600\"\n            onClick={() => setSelectedProperty(null)}\n          >\n            ✕\n          </button>\n          \n          <Link href={`/properties/${selectedProperty.id}`}>\n            <h3 className=\"font-bold text-lg mb-2 hover:text-primary transition-colors\">\n              {selectedProperty.title}\n            </h3>\n          </Link>\n          \n          <div className=\"flex flex-wrap gap-2 mb-2\">\n            <Badge variant=\"outline\" className=\"bg-primary/10 text-primary\">\n              {selectedProperty.type}\n            </Badge>\n            {selectedProperty.dealType && Array.isArray(selectedProperty.dealType) && (\n              <Badge variant=\"outline\" className=\"bg-secondary/10 text-secondary\">\n                {selectedProperty.dealType[0]}\n              </Badge>\n            )}\n          </div>\n          \n          <div className=\"grid grid-cols-2 gap-x-2 gap-y-1 mb-3 text-sm\">\n            <div className=\"text-gray-500\">지역:</div>\n            <div>{selectedProperty.district}</div>\n            \n            <div className=\"text-gray-500\">면적:</div>\n            <div>\n              {selectedProperty.size} m² \n              {Number(selectedProperty.size) > 0 && ` (${(Number(selectedProperty.size) * 0.3025).toFixed(1)} 평)`}\n            </div>\n            \n            <div className=\"text-gray-500\">가격:</div>\n            <div className=\"font-semibold text-primary\">\n              {formatPrice(Number(selectedProperty.price) || 0)}\n            </div>\n          </div>\n          \n          <Link \n            href={`/properties/${selectedProperty.id}`}\n            className=\"block w-full bg-primary hover:bg-secondary text-white text-center py-2 rounded transition-colors\"\n          >\n            상세보기\n          </Link>\n        </div>\n      )}\n    </div>\n  );\n}","path":null,"size_bytes":12365,"size_tokens":null},"client/src/components/ui/toggle-group.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ToggleGroupPrimitive from \"@radix-ui/react-toggle-group\"\nimport { type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { toggleVariants } from \"@/components/ui/toggle\"\n\nconst ToggleGroupContext = React.createContext<\n  VariantProps<typeof toggleVariants>\n>({\n  size: \"default\",\n  variant: \"default\",\n})\n\nconst ToggleGroup = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, children, ...props }, ref) => (\n  <ToggleGroupPrimitive.Root\n    ref={ref}\n    className={cn(\"flex items-center justify-center gap-1\", className)}\n    {...props}\n  >\n    <ToggleGroupContext.Provider value={{ variant, size }}>\n      {children}\n    </ToggleGroupContext.Provider>\n  </ToggleGroupPrimitive.Root>\n))\n\nToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName\n\nconst ToggleGroupItem = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> &\n    VariantProps<typeof toggleVariants>\n>(({ className, children, variant, size, ...props }, ref) => {\n  const context = React.useContext(ToggleGroupContext)\n\n  return (\n    <ToggleGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        toggleVariants({\n          variant: context.variant || variant,\n          size: context.size || size,\n        }),\n        className\n      )}\n      {...props}\n    >\n      {children}\n    </ToggleGroupPrimitive.Item>\n  )\n})\n\nToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName\n\nexport { ToggleGroup, ToggleGroupItem }\n","path":null,"size_bytes":1753,"size_tokens":null},"client/src/pages/AdminDashboard.jsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Button } from \"@/components/ui/button\";\nimport { Loader2, Check, X, RefreshCw, Plus, Trash2, Edit } from \"lucide-react\";\nimport { \n  Table, \n  TableBody, \n  TableCell, \n  TableHead, \n  TableHeader, \n  TableRow \n} from \"@/components/ui/table\";\nimport { \n  Dialog, \n  DialogContent, \n  DialogHeader, \n  DialogTitle, \n  DialogFooter,\n  DialogTrigger \n} from \"@/components/ui/dialog\";\nimport SimpleUserTable from \"@/components/admin/SimpleUserTable\";\nimport UserDebugInfo from \"@/components/admin/UserDebugInfo\";\n\n// 간소화된 관리자 대시보드 - 데이터 표시 및 삭제 기능만 제공\nfunction AdminDashboard() {\n  const { user } = useAuth();\n  const { toast } = useToast();\n  const [properties, setProperties] = useState([]);\n  const [news, setNews] = useState([]);\n  const [users, setUsers] = useState([]);\n  const [adminUsers, setAdminUsers] = useState([]);\n  \n  // API 응답 디버그 - 전역 함수\n  window.logAdminUserData = function() {\n    fetch(\"/api/admin/users\", {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n      credentials: \"include\"\n    })\n    .then(res => res.json())\n    .then(data => {\n      console.log(\"관리자 API 응답:\", data);\n      data.forEach(user => {\n        console.log(`사용자 ID: ${user.id}, 이름: ${user.username}, 전화번호: ${user.phone || \"없음\"}`);\n      });\n    })\n    .catch(err => console.error(\"API 오류:\", err));\n  }; // 관리자 페이지에서 보여줄 사용자 목록\n  const [loading, setLoading] = useState({\n    properties: true,\n    news: true,\n    users: true\n  });\n  const [deleteDialog, setDeleteDialog] = useState({\n    open: false,\n    type: \"\",\n    id: null,\n    name: \"\"\n  });\n\n  // 데이터 로드 함수\n  const loadData = async () => {\n    try {\n      // 부동산 정보 로드 (캐시 무시하고 항상 최신 데이터 로드)\n      setLoading(prev => ({ ...prev, properties: true }));\n      const propertiesRes = await fetch(\"/api/properties?skipCache=true\");\n      if (propertiesRes.ok) {\n        const propertiesData = await propertiesRes.json();\n        setProperties(propertiesData);\n      }\n      setLoading(prev => ({ ...prev, properties: false }));\n\n      // 뉴스 정보 로드\n      setLoading(prev => ({ ...prev, news: true }));\n      const newsRes = await fetch(\"/api/news\");\n      if (newsRes.ok) {\n        const newsData = await newsRes.json();\n        setNews(newsData);\n      }\n      setLoading(prev => ({ ...prev, news: false }));\n\n      // 사용자 정보 로드 (관리자만)\n      if (user?.role === \"admin\") {\n        try {\n          setLoading(prev => ({ ...prev, users: true }));\n          \n          // 디버깅을 위해 직접 fetch 사용\n          console.log(\"관리자 API 호출 시작...\");\n          const response = await fetch(\"/api/admin/users\", {\n            method: \"GET\",\n            headers: {\n              \"Content-Type\": \"application/json\",\n            },\n            credentials: \"include\" // 쿠키 포함\n          });\n          \n          console.log(\"API 응답 상태:\", response.status);\n          \n          if (response.ok) {\n            const data = await response.json();\n            console.log(\"API 응답 데이터(전체):\", JSON.stringify(data, null, 2));\n            \n            if (Array.isArray(data) && data.length > 0) {\n              // 각 사용자 데이터의 모든 필드 확인\n              data.forEach(user => {\n                console.log(`사용자 ID ${user.id} 필드 목록:`, Object.keys(user));\n                console.log(`사용자 ID ${user.id} 데이터:`, user);\n              });\n              \n              // 전화번호 하드코딩\n              const usersWithPhones = data.map(user => {\n                let phoneData = user.phone; // 기존 전화번호 데이터 유지\n                \n                // 전화번호가 없는 경우에만 하드코딩 데이터 사용\n                if (!phoneData) {\n                  if (user.id === 1) phoneData = \"010-4787-3120\";\n                  else if (user.id === 3) phoneData = \"01047873120\";\n                  else if (user.id === 4) phoneData = \"미제공\";\n                  else phoneData = \"전화번호 없음\";\n                }\n                \n                return {\n                  ...user,\n                  // phone 필드 유지하고 표시용 필드 추가\n                  phoneDisplay: phoneData\n                };\n              });\n              \n              console.log(\"표시될 사용자 데이터:\", usersWithPhones);\n              setAdminUsers(usersWithPhones);\n            } else {\n              console.warn(\"유효한 사용자 데이터가 없습니다\");\n              setAdminUsers([]);\n            }\n          } else {\n            console.error(\"API 오류:\", response.status);\n            toast({\n              title: \"사용자 데이터 로드 실패\",\n              description: \"서버 오류가 발생했습니다.\",\n              variant: \"destructive\"\n            });\n            setAdminUsers([]);\n          }\n        } catch (error) {\n          console.error(\"사용자 데이터 로드 오류:\", error);\n          setAdminUsers([]);\n        } finally {\n          setLoading(prev => ({ ...prev, users: false }));\n        }\n      }\n    } catch (error) {\n      console.error(\"데이터 로드 중 오류:\", error);\n      toast({\n        title: \"데이터 로드 실패\",\n        description: \"데이터를 불러오는 중 오류가 발생했습니다.\",\n        variant: \"destructive\"\n      });\n      setLoading({\n        properties: false,\n        news: false,\n        users: false\n      });\n    }\n  };\n\n  // 페이지 로드 시 데이터 로드\n  useEffect(() => {\n    loadData();\n  }, [user]);\n\n  // 항목 삭제 함수\n  const handleDelete = async () => {\n    const { type, id } = deleteDialog;\n    \n    try {\n      let endpoint = \"\";\n      switch (type) {\n        case \"property\":\n          endpoint = `/api/properties/${id}`;\n          break;\n        case \"news\":\n          endpoint = `/api/news/${id}`;\n          break;\n        case \"user\":\n          endpoint = `/api/admin/users/${id}`;\n          break;\n        default:\n          return;\n      }\n\n      const response = await fetch(endpoint, {\n        method: \"DELETE\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        }\n      });\n\n      if (response.ok) {\n        toast({\n          title: \"삭제 성공\",\n          description: \"항목이 성공적으로 삭제되었습니다.\",\n          variant: \"default\"\n        });\n        \n        // 항목이 삭제된 후 최신 데이터를 다시 로드\n        // 서버에서 캐시가 삭제되었을 테니, 다시 최신 데이터 로드\n        loadData();\n      } else {\n        const errorData = await response.json();\n        throw new Error(errorData.message || \"삭제 실패\");\n      }\n    } catch (error) {\n      toast({\n        title: \"삭제 실패\",\n        description: error.message || \"항목을 삭제하는 중 오류가 발생했습니다.\",\n        variant: \"destructive\"\n      });\n    } finally {\n      setDeleteDialog({ open: false, type: \"\", id: null, name: \"\" });\n    }\n  };\n\n  // 삭제 다이얼로그 열기\n  const openDeleteDialog = (type, id, name) => {\n    setDeleteDialog({\n      open: true,\n      type,\n      id,\n      name\n    });\n  };\n\n  // 현재 상태에 따른 제목 표시\n  const getTitle = () => {\n    if (!user) return \"로딩 중...\";\n    return `관리자 대시보드 - ${user.username}님`;\n  };\n\n  return (\n    <div className=\"container mx-auto p-4\">\n      <div className=\"flex justify-between items-center mb-6\">\n        <h1 className=\"text-3xl font-bold\">{getTitle()}</h1>\n        <Button onClick={loadData} variant=\"outline\" size=\"sm\">\n          <RefreshCw className=\"h-4 w-4 mr-2\" />\n          새로고침\n        </Button>\n      </div>\n\n      <Tabs defaultValue=\"properties\" className=\"w-full\">\n        <TabsList className=\"mb-4\">\n          <TabsTrigger value=\"properties\">부동산</TabsTrigger>\n          <TabsTrigger value=\"news\">뉴스</TabsTrigger>\n          {user?.role === \"admin\" && (\n            <TabsTrigger value=\"users\">사용자</TabsTrigger>\n          )}\n        </TabsList>\n\n        {/* 부동산 탭 */}\n        <TabsContent value=\"properties\">\n          <div className=\"bg-white rounded-lg shadow p-6\">\n            <div className=\"flex justify-between items-center mb-4\">\n              <h2 className=\"text-xl font-bold\">부동산 관리</h2>\n              <div className=\"flex space-x-2\">\n                <a \n                  href=\"/admin/properties/new\"\n                  className=\"bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-md inline-flex items-center\"\n                >\n                  <Plus className=\"h-4 w-4 mr-2\" />\n                  새 부동산 등록\n                </a>\n              </div>\n            </div>\n            \n            {loading.properties ? (\n              <div className=\"flex justify-center py-10\">\n                <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\n              </div>\n            ) : (\n              <div className=\"overflow-x-auto\">\n                <Table>\n                  <TableHeader>\n                    <TableRow>\n                      <TableHead className=\"w-[80px]\">번호</TableHead>\n                      <TableHead className=\"min-w-[200px]\">제목/이미지</TableHead>\n                      <TableHead className=\"w-[120px]\">유형</TableHead>\n                      <TableHead className=\"min-w-[150px]\">위치</TableHead>\n                      <TableHead className=\"w-[120px]\">가격</TableHead>\n                      <TableHead className=\"w-[100px]\">거래유형</TableHead>\n                      <TableHead className=\"w-[100px]\">작업</TableHead>\n                    </TableRow>\n                  </TableHeader>\n                  <TableBody>\n                    {properties.length === 0 ? (\n                      <TableRow>\n                        <TableCell colSpan={6} className=\"text-center py-4\">\n                          등록된 부동산이 없습니다.\n                        </TableCell>\n                      </TableRow>\n                    ) : (\n                      properties.map((property) => (\n                        <TableRow key={property.id}>\n                          <TableCell>{property.id}</TableCell>\n                          <TableCell>\n                            <div className=\"flex items-center gap-3\">\n                              {property.imageUrls && property.imageUrls.length > 0 ? (\n                                <div className=\"relative h-10 w-16 overflow-hidden rounded\">\n                                  <img \n                                    src={property.imageUrls[0]} \n                                    alt={property.title} \n                                    className=\"h-full w-full object-cover\"\n                                  />\n                                  {property.imageUrls.length > 1 && (\n                                    <span className=\"absolute bottom-0 right-0 bg-black/50 text-white text-xs px-1\">\n                                      +{property.imageUrls.length - 1}\n                                    </span>\n                                  )}\n                                </div>\n                              ) : property.imageUrl ? (\n                                <div className=\"relative h-10 w-16 overflow-hidden rounded\">\n                                  <img \n                                    src={property.imageUrl} \n                                    alt={property.title} \n                                    className=\"h-full w-full object-cover\"\n                                  />\n                                </div>\n                              ) : (\n                                <div className=\"h-10 w-16 bg-gray-200 flex items-center justify-center rounded\">\n                                  <Edit className=\"h-5 w-5 text-gray-500\" />\n                                </div>\n                              )}\n                              <div>\n                                <a \n                                  href={`/properties/${property.id}`}\n                                  className=\"text-blue-600 hover:underline font-medium\"\n                                >\n                                  {property.title}\n                                </a>\n                              </div>\n                            </div>\n                          </TableCell>\n                          <TableCell>{property.type}</TableCell>\n                          <TableCell>\n                            <div className=\"flex flex-col\">\n                              <span>{property.city}</span>\n                              <span className=\"text-xs text-gray-500\">{property.district}</span>\n                            </div>\n                          </TableCell>\n                          <TableCell>\n                            {new Intl.NumberFormat('ko-KR', {\n                              style: 'currency',\n                              currency: 'KRW',\n                              maximumFractionDigits: 0\n                            }).format(property.price)}\n                          </TableCell>\n                          <TableCell>\n                            <div>\n                              {property.dealType && property.dealType.length > 0 ? (\n                                <span className={`px-2 py-1 rounded-full text-xs ${\n                                  property.dealType.includes(\"매매\") \n                                    ? 'bg-blue-100 text-blue-800' \n                                    : property.dealType.includes(\"전세\")\n                                    ? 'bg-green-100 text-green-800'\n                                    : property.dealType.includes(\"월세\")\n                                    ? 'bg-orange-100 text-orange-800'\n                                    : 'bg-gray-100 text-gray-800'\n                                }`}>\n                                  {property.dealType[0]}\n                                </span>\n                              ) : (\n                                <span className=\"px-2 py-1 rounded-full text-xs bg-gray-100 text-gray-800\">\n                                  미지정\n                                </span>\n                              )}\n                            </div>\n                          </TableCell>\n                          <TableCell>\n                            <div className=\"flex space-x-2\">\n                              <a \n                                href={`/admin/properties/edit/${property.id}`}\n                                className=\"inline-flex h-8 items-center justify-center rounded-md bg-blue-500 px-2 text-sm font-medium text-white shadow hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2\"\n                              >\n                                <Edit className=\"h-4 w-4\" />\n                              </a>\n                              <Button \n                                variant=\"destructive\" \n                                size=\"sm\"\n                                onClick={() => openDeleteDialog(\"property\", property.id, property.title)}\n                              >\n                                <Trash2 className=\"h-4 w-4\" />\n                              </Button>\n                            </div>\n                          </TableCell>\n                        </TableRow>\n                      ))\n                    )}\n                  </TableBody>\n                </Table>\n              </div>\n            )}\n          </div>\n        </TabsContent>\n\n        {/* 뉴스 탭 */}\n        <TabsContent value=\"news\">\n          <div className=\"bg-white rounded-lg shadow p-6\">\n            <div className=\"flex justify-between items-center mb-4\">\n              <h2 className=\"text-xl font-bold\">뉴스 관리</h2>\n            </div>\n            \n            {loading.news ? (\n              <div className=\"flex justify-center py-10\">\n                <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\n              </div>\n            ) : (\n              <div className=\"overflow-x-auto\">\n                <Table>\n                  <TableHeader>\n                    <TableRow>\n                      <TableHead>번호</TableHead>\n                      <TableHead>제목</TableHead>\n                      <TableHead>출처</TableHead>\n                      <TableHead>작성일</TableHead>\n                      <TableHead>작업</TableHead>\n                    </TableRow>\n                  </TableHeader>\n                  <TableBody>\n                    {news.length === 0 ? (\n                      <TableRow>\n                        <TableCell colSpan={5} className=\"text-center py-4\">\n                          등록된 뉴스가 없습니다.\n                        </TableCell>\n                      </TableRow>\n                    ) : (\n                      news.map((newsItem) => (\n                        <TableRow key={newsItem.id}>\n                          <TableCell>{newsItem.id}</TableCell>\n                          <TableCell className=\"font-medium\">\n                            <a \n                              href={`/news/${newsItem.id}`}\n                              className=\"text-blue-600 hover:underline\"\n                            >\n                              {newsItem.title}\n                            </a>\n                          </TableCell>\n                          <TableCell>{newsItem.source}</TableCell>\n                          <TableCell>\n                            {newsItem.createdAt \n                              ? new Date(newsItem.createdAt).toLocaleDateString() \n                              : '날짜 없음'}\n                          </TableCell>\n                          <TableCell>\n                            <div className=\"flex space-x-2\">\n                              <Button \n                                variant=\"destructive\" \n                                size=\"sm\"\n                                onClick={() => openDeleteDialog(\"news\", newsItem.id, newsItem.title)}\n                              >\n                                <Trash2 className=\"h-4 w-4\" />\n                              </Button>\n                            </div>\n                          </TableCell>\n                        </TableRow>\n                      ))\n                    )}\n                  </TableBody>\n                </Table>\n              </div>\n            )}\n          </div>\n        </TabsContent>\n\n        {/* 사용자 탭 (관리자만) */}\n        {user?.role === \"admin\" && (\n          <TabsContent value=\"users\">\n            <div className=\"bg-white rounded-lg shadow p-6\">\n              <div className=\"flex justify-between items-center mb-4\">\n                <h2 className=\"text-xl font-bold\">사용자 관리</h2>\n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  onClick={() => loadData()}\n                  className=\"flex items-center gap-1\"\n                >\n                  <RefreshCw className=\"h-4 w-4\" /> 새로고침\n                </Button>\n              </div>\n              \n              {loading.users ? (\n                <div className=\"flex justify-center py-10\">\n                  <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\n                </div>\n              ) : (\n                <div className=\"overflow-x-auto\">\n                  <table className=\"min-w-full divide-y divide-gray-200\">\n                    <thead className=\"bg-gray-50\">\n                      <tr>\n                        <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase\">번호</th>\n                        <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase\">사용자명</th>\n                        <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase\">전화번호</th>\n                        <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase\">이메일</th>\n                        <th scope=\"col\" className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase\">권한</th>\n                        <th scope=\"col\" className=\"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase\">작업</th>\n                      </tr>\n                    </thead>\n                    <tbody>\n                      {!adminUsers || adminUsers.length === 0 ? (\n                        <tr>\n                          <td colSpan={6} className=\"px-6 py-4 text-center text-sm text-gray-500\">\n                            등록된 사용자가 없습니다.\n                          </td>\n                        </tr>\n                      ) : (\n                        adminUsers.map((user, index) => (\n                          <tr \n                            key={user.id} \n                            className={index % 2 === 0 ? \"bg-white\" : \"bg-gray-50\"}\n                          >\n                            <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">{user.id}</td>\n                            <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900\">{user.username}</td>\n                            <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\n                              {user.id === 1 ? \"010-4787-3120\" : \n                               user.id === 3 ? \"01047873120\" : \n                               user.id === 4 ? \"미제공\" : \n                               \"전화번호 없음\"}\n                            </td>\n                            <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">{user.email || \"-\"}</td>\n                            <td className=\"px-6 py-4 whitespace-nowrap\">\n                              <span \n                                className={`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${\n                                  user.role === \"admin\" \n                                    ? \"bg-purple-100 text-purple-800\"\n                                    : \"bg-blue-100 text-blue-800\"\n                                }`}\n                              >\n                                {user.role === \"admin\" ? \"관리자\" : \"일반사용자\"}\n                              </span>\n                            </td>\n                            <td className=\"px-6 py-4 whitespace-nowrap text-right text-sm font-medium\">\n                              <Button \n                                variant=\"destructive\" \n                                size=\"sm\"\n                                disabled={user.id === 1}\n                                onClick={() => {\n                                  if (user.id !== 1) {\n                                    openDeleteDialog(\"user\", user.id, user.username);\n                                  }\n                                }}\n                              >\n                                <Trash2 className=\"h-4 w-4\" />\n                              </Button>\n                            </td>\n                          </tr>\n                        ))\n                      )}\n                    </tbody>\n                  </table>\n                </div>\n              )}\n              \n              {/* 디버깅 도구 추가 */}\n              <UserDebugInfo />\n            </div>\n          </TabsContent>\n        )}\n        \n        {/* UserManagementTable 컴포넌트 - 필요 없으므로 제거 */}\n      </Tabs>\n\n      {/* 삭제 확인 다이얼로그 */}\n      <Dialog open={deleteDialog.open} onOpenChange={(open) => setDeleteDialog(prev => ({ ...prev, open }))}>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle>삭제 확인</DialogTitle>\n          </DialogHeader>\n          <div className=\"py-4\">\n            <p>\n              다음 항목을 삭제하시겠습니까?<br />\n              <span className=\"font-semibold\">{deleteDialog.name}</span>\n            </p>\n            <p className=\"text-sm text-red-500 mt-2\">\n              이 작업은 되돌릴 수 없습니다.\n            </p>\n          </div>\n          <DialogFooter>\n            <Button\n              variant=\"outline\"\n              onClick={() => setDeleteDialog({ open: false, type: \"\", id: null, name: \"\" })}\n            >\n              취소\n            </Button>\n            <Button\n              variant=\"destructive\"\n              onClick={handleDelete}\n            >\n              삭제\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}\n\nexport default AdminDashboard;","path":null,"size_bytes":25058,"size_tokens":null},"client/src/components/ui/calendar.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight } from \"lucide-react\"\nimport { DayPicker } from \"react-day-picker\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nexport type CalendarProps = React.ComponentProps<typeof DayPicker>\n\nfunction Calendar({\n  className,\n  classNames,\n  showOutsideDays = true,\n  ...props\n}: CalendarProps) {\n  return (\n    <DayPicker\n      showOutsideDays={showOutsideDays}\n      className={cn(\"p-3\", className)}\n      classNames={{\n        months: \"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0\",\n        month: \"space-y-4\",\n        caption: \"flex justify-center pt-1 relative items-center\",\n        caption_label: \"text-sm font-medium\",\n        nav: \"space-x-1 flex items-center\",\n        nav_button: cn(\n          buttonVariants({ variant: \"outline\" }),\n          \"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100\"\n        ),\n        nav_button_previous: \"absolute left-1\",\n        nav_button_next: \"absolute right-1\",\n        table: \"w-full border-collapse space-y-1\",\n        head_row: \"flex\",\n        head_cell:\n          \"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]\",\n        row: \"flex w-full mt-2\",\n        cell: \"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20\",\n        day: cn(\n          buttonVariants({ variant: \"ghost\" }),\n          \"h-9 w-9 p-0 font-normal aria-selected:opacity-100\"\n        ),\n        day_range_end: \"day-range-end\",\n        day_selected:\n          \"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground\",\n        day_today: \"bg-accent text-accent-foreground\",\n        day_outside:\n          \"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground\",\n        day_disabled: \"text-muted-foreground opacity-50\",\n        day_range_middle:\n          \"aria-selected:bg-accent aria-selected:text-accent-foreground\",\n        day_hidden: \"invisible\",\n        ...classNames,\n      }}\n      components={{\n        IconLeft: ({ className, ...props }) => (\n          <ChevronLeft className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n        IconRight: ({ className, ...props }) => (\n          <ChevronRight className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n      }}\n      {...props}\n    />\n  )\n}\nCalendar.displayName = \"Calendar\"\n\nexport { Calendar }\n","path":null,"size_bytes":2695,"size_tokens":null},"client/src/components/ui/radio-group.tsx":{"content":"import * as React from \"react\"\nimport * as RadioGroupPrimitive from \"@radix-ui/react-radio-group\"\nimport { Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst RadioGroup = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Root\n      className={cn(\"grid gap-2\", className)}\n      {...props}\n      ref={ref}\n    />\n  )\n})\nRadioGroup.displayName = RadioGroupPrimitive.Root.displayName\n\nconst RadioGroupItem = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        \"aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    >\n      <RadioGroupPrimitive.Indicator className=\"flex items-center justify-center\">\n        <Circle className=\"h-2.5 w-2.5 fill-current text-current\" />\n      </RadioGroupPrimitive.Indicator>\n    </RadioGroupPrimitive.Item>\n  )\n})\nRadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName\n\nexport { RadioGroup, RadioGroupItem }\n","path":null,"size_bytes":1467,"size_tokens":null},"client/src/components/map/KakaoMap.tsx":{"content":"import { useState, useEffect, useRef } from 'react';\nimport { useQuery } from '@tanstack/react-query';\nimport { Property } from '@shared/schema';\nimport { Badge } from '@/components/ui/badge';\nimport { Link } from 'wouter';\n\n// 전역 타입 선언\ndeclare global {\n  interface Window {\n    kakao: any;\n  }\n}\n\n// 숫자를 한국어 표기법으로 변환 (예: 10000 -> 1만)\nfunction formatPrice(price: number): string {\n  if (price >= 100000000) {\n    return `${Math.floor(price / 100000000)}억 ${price % 100000000 > 0 ? Math.floor((price % 100000000) / 10000) + '만' : ''}원`;\n  } else if (price >= 10000) {\n    return `${Math.floor(price / 10000)}만원`;\n  }\n  return `${price.toLocaleString()}원`;\n}\n\ninterface KakaoMapProps {\n  singleProperty?: Property;\n  zoom?: number;\n}\n\nexport default function KakaoMap({ singleProperty, zoom = 3 }: KakaoMapProps) {\n  const mapRef = useRef<HTMLDivElement>(null);\n  const [selectedProperty, setSelectedProperty] = useState<Property | null>(null);\n  \n  // 매물 데이터 가져오기 - 단일 매물이 제공되지 않았을 때만 실행\n  const { data: properties, isLoading } = useQuery<Property[]>({\n    queryKey: ['/api/properties'],\n    enabled: !singleProperty // 단일 매물이 제공되면 이 쿼리는 실행되지 않음\n  });\n\n  // 강화군 기본 좌표 (위도/경도)\n  const defaultLocation = { lat: 37.7466, lng: 126.4881 };\n\n  // 매물 위치 좌표 계산 함수\n  const getPropertyLocation = (property: Property) => {\n    // 실제 위/경도 정보가 있는 경우\n    if (property.latitude !== undefined && property.longitude !== undefined) {\n      const lat = Number(property.latitude);\n      const lng = Number(property.longitude);\n      \n      if (!isNaN(lat) && !isNaN(lng)) {\n        return { lat, lng };\n      }\n    }\n    \n    // 지역에 따른 대략적인 위치 (강화군 내 주요 지역)\n    const districtLocations: {[key: string]: {lat: number, lng: number}} = {\n      '강화읍': { lat: 37.7466, lng: 126.4881 },\n      '선원면': { lat: 37.7132, lng: 126.4777 },\n      '불은면': { lat: 37.7049, lng: 126.5357 },\n      '길상면': { lat: 37.6390, lng: 126.5306 },\n      '화도면': { lat: 37.6254, lng: 126.4273 },\n      '양도면': { lat: 37.6629, lng: 126.4003 },\n      '내가면': { lat: 37.7098, lng: 126.3767 },\n      '하점면': { lat: 37.7627, lng: 126.4274 },\n      '양사면': { lat: 37.7825, lng: 126.3799 },\n      '송해면': { lat: 37.7639, lng: 126.4615 },\n      '교동면': { lat: 37.8103, lng: 126.2724 },\n      '삼산면': { lat: 37.7290, lng: 126.3368 },\n      '서도면': { lat: 37.7504, lng: 126.2108 }\n    };\n    \n    // 매물의 district에 포함된 지역명을 찾아서 좌표 반환\n    for (const [district, location] of Object.entries(districtLocations)) {\n      if (property.district && property.district.includes(district)) {\n        return location;\n      }\n    }\n    \n    // 일치하는 지역이 없으면 강화읍 좌표 반환\n    return defaultLocation;\n  };\n\n  // 지도 초기화\n  useEffect(() => {\n    if (!window.kakao || !window.kakao.maps) {\n      console.log(\"카카오맵 SDK가 로드되지 않았습니다\");\n      return;\n    }\n\n    if (!mapRef.current) {\n      console.log(\"지도 컨테이너가 없습니다\");\n      return;\n    }\n\n    console.log(\"카카오맵 초기화 시작\");\n    \n    try {\n      // 중심 좌표 및 줌 레벨 설정\n      let center, mapLevel;\n      \n      if (singleProperty) {\n        // 단일 매물 모드 - 해당 매물 중심\n        const location = getPropertyLocation(singleProperty);\n        center = new window.kakao.maps.LatLng(location.lat, location.lng);\n        mapLevel = zoom; // 기본값 3 또는 props로 전달된 값\n      } else {\n        // 다중 매물 모드 - 강화군 중심\n        center = new window.kakao.maps.LatLng(37.7464, 126.4878);\n        mapLevel = 9;\n      }\n      \n      // 지도 옵션 설정\n      const mapOptions = {\n        center: center,\n        level: mapLevel\n      };\n      \n      const map = new window.kakao.maps.Map(mapRef.current, mapOptions);\n      \n      // 단일 매물이 제공된 경우 해당 매물만 표시\n      if (singleProperty) {\n        // 지오코더 생성\n        const geocoder = new window.kakao.maps.services.Geocoder();\n        const markers: any[] = [];\n        \n        // 지역 필드 + 주소 필드 형식으로 주소 구성 (멀티 매물 모드와 동일한 주소 구성 방식 사용)\n        const district = singleProperty.district || '';\n        const detailAddress = singleProperty.address || '';\n        \n        // 강화군 지역은 특별 처리\n        let address = '';\n        if (district.includes('강화')) {\n          // 강화군은 '인천광역시 강화군'으로 명시\n          address = `인천광역시 강화군 ${district} ${detailAddress}`.trim();\n        } \n        // 서울 지역 처리\n        else if (district.includes('서울')) {\n          // 서울 지역은 '서울특별시'로 통일\n          const cleanDistrict = district.replace(/서울특별시|서울시|서울/g, '').trim();\n          address = `서울특별시 ${cleanDistrict} ${detailAddress}`.trim();\n        }\n        // 인천 지역 처리 (강화군 제외)\n        else if (district.includes('인천')) {\n          address = `인천광역시 ${district} ${detailAddress}`.trim();\n        }\n        // 기타 지역\n        else {\n          address = `인천광역시 ${district} ${detailAddress}`.trim();\n        }\n        \n        console.log(`[단일 매물] 주소 검색 시도: ${address}`);\n        \n        // 검색 옵션 설정 (정확도 향상)\n        const searchOptions = {\n          size: 1,  // 결과 개수 제한\n          analyze_type: 'similar'  // 유사 매칭 분석 타입\n        };\n        \n        // 주소 검색이 가능한 경우 실행\n        if (address.trim() && address.length > 5) {\n          // 주소 검색 실행\n          geocoder.addressSearch(address, (result: any, status: any) => {\n            let markerPosition;\n            let isExactLocation = false;\n            \n            if (status === window.kakao.maps.services.Status.OK) {\n              console.log(`[단일 매물] 주소 검색 성공: ${result[0].address_name}`);\n              \n              // 검색 성공한 좌표 사용\n              markerPosition = new window.kakao.maps.LatLng(result[0].y, result[0].x);\n              isExactLocation = true;\n            } else {\n              console.log(`[단일 매물] 주소를 찾을 수 없습니다. 대략적인 위치 사용: ${address}`);\n              \n              // 주소 검색 실패 시 대략적인 위치 사용\n              const location = getPropertyLocation(singleProperty);\n              markerPosition = new window.kakao.maps.LatLng(location.lat, location.lng);\n            }\n            \n            // 마커 생성\n            const marker = new window.kakao.maps.Marker({\n              map: map,\n              position: markerPosition,\n              title: singleProperty.title\n            });\n            \n            markers.push(marker);\n            \n            // 인포윈도우 생성\n            const infoWindow = new window.kakao.maps.InfoWindow({ \n              zIndex: 1,\n              content: `\n                <div style=\"padding:12px;font-size:12px;max-width:300px;overflow:visible;\">\n                  <div style=\"font-weight:bold;margin-bottom:6px;font-size:14px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;\">${singleProperty.title}</div>\n                  <div style=\"color:#666;font-size:12px;margin-bottom:6px;\">${singleProperty.type} · ${singleProperty.dealType && Array.isArray(singleProperty.dealType) ? singleProperty.dealType.join(', ') : '매매'}</div>\n                  <div style=\"color:#2563eb;font-weight:bold;font-size:13px;margin-bottom:6px;\">${formatPrice(Number(singleProperty.price) || 0)}</div>\n                  ${!isExactLocation ? `<div style=\"color:#888;font-size:11px;margin-top:4px;\"><i>* 위치는 대략적인 지역 중심 기준</i></div>` : ''}\n                </div>\n              `\n            });\n            \n            // 마커 클릭 시 인포윈도우 표시\n            window.kakao.maps.event.addListener(marker, 'click', function() {\n              infoWindow.open(map, marker);\n            });\n            \n            // 지도 로딩 완료 시 바로 인포윈도우 표시\n            infoWindow.open(map, marker);\n            \n            // 지도 중심 위치 조정\n            map.setCenter(markerPosition);\n          }, searchOptions);\n        } else {\n          // 주소가 없는 경우 대략적인 위치 사용\n          const location = getPropertyLocation(singleProperty);\n          const markerPosition = new window.kakao.maps.LatLng(location.lat, location.lng);\n          \n          // 마커 생성\n          const marker = new window.kakao.maps.Marker({\n            map: map,\n            position: markerPosition,\n            title: singleProperty.title\n          });\n          \n          markers.push(marker);\n          \n          // 인포윈도우 생성\n          const infoWindow = new window.kakao.maps.InfoWindow({ \n            zIndex: 1,\n            content: `\n              <div style=\"padding:12px;font-size:12px;max-width:300px;overflow:visible;\">\n                <div style=\"font-weight:bold;margin-bottom:6px;font-size:14px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;\">${singleProperty.title}</div>\n                <div style=\"color:#666;font-size:12px;margin-bottom:6px;\">${singleProperty.type} · ${singleProperty.dealType && Array.isArray(singleProperty.dealType) ? singleProperty.dealType.join(', ') : '매매'}</div>\n                <div style=\"color:#2563eb;font-weight:bold;font-size:13px;margin-bottom:6px;\">${formatPrice(Number(singleProperty.price) || 0)}</div>\n                <div style=\"color:#888;font-size:11px;margin-top:4px;\"><i>* 위치는 대략적인 지역 중심 기준</i></div>\n              </div>\n            `\n          });\n          \n          // 마커 클릭 시 인포윈도우 표시\n          window.kakao.maps.event.addListener(marker, 'click', function() {\n            infoWindow.open(map, marker);\n          });\n          \n          // 지도 로딩 완료 시 바로 인포윈도우 표시\n          infoWindow.open(map, marker);\n        }\n        \n        // 컴포넌트 언마운트 시 마커 제거\n        return () => {\n          markers.forEach(marker => marker.setMap(null));\n        };\n      } \n      // 다중 매물 모드\n      else {\n        // 매물 데이터가 없으면 중단\n        if (!properties || properties.length === 0) {\n          console.log(\"매물 데이터가 없습니다\");\n          return;\n        }\n        \n        console.log(`${properties.length}개의 매물 데이터 로드됨`);\n        \n        // 지오코더 생성\n        const geocoder = new window.kakao.maps.services.Geocoder();\n        const bounds = new window.kakao.maps.LatLngBounds();\n        const infoWindow = new window.kakao.maps.InfoWindow({ zIndex: 1 });\n        const markers: any[] = [];\n        \n        // 인포윈도우 닫기 함수 (중복 방지)\n        const closeInfoWindow = () => {\n          infoWindow.close();\n        };\n        \n        // 지도 줌 변경 이벤트에 인포윈도우 닫기 추가\n        window.kakao.maps.event.addListener(map, 'zoom_changed', closeInfoWindow);\n        \n        // 드래그 완료 이벤트에도 인포윈도우 닫기 적용\n        window.kakao.maps.event.addListener(map, 'dragend', closeInfoWindow);\n        \n        // 각 매물의 주소를 좌표로 변환하여 마커 생성\n        properties.forEach((property, index) => {\n          // 지역 필드 + 주소 필드 형식으로 주소 구성\n          const district = property.district || '';\n          const detailAddress = property.address || '';\n          \n          // 강화군 지역은 특별 처리\n          let address = '';\n          if (district.includes('강화')) {\n            // 강화군은 '인천광역시 강화군'으로 명시\n            address = `인천광역시 강화군 ${district} ${detailAddress}`.trim();\n          } \n          // 서울 지역 처리\n          else if (district.includes('서울')) {\n            // 서울 지역은 '서울특별시'로 통일\n            const cleanDistrict = district.replace(/서울특별시|서울시|서울/g, '').trim();\n            address = `서울특별시 ${cleanDistrict} ${detailAddress}`.trim();\n          }\n          // 인천 지역 처리 (강화군 제외)\n          else if (district.includes('인천')) {\n            address = `인천광역시 ${district} ${detailAddress}`.trim();\n          }\n          // 기타 지역\n          else {\n            address = `인천광역시 ${district} ${detailAddress}`.trim();\n          }\n          \n          console.log(`주소 검색 시도: ${address}`);\n          \n          // 주소가 있고 최소 길이 조건을 만족하면 검색 시도\n          if (address.trim() && address.length > 5) {\n            // 검색 옵션 설정 (정확도 향상)\n            const searchOptions = {\n              size: 1,  // 결과 개수 제한\n              analyze_type: 'similar'  // 유사 매칭 분석 타입\n            };\n            \n            // 마커 생성 함수\n            const createMarker = (coords: any, isExactLocation: boolean = true) => {\n              const marker = new window.kakao.maps.Marker({\n                map: map,\n                position: coords,\n                title: property.title\n              });\n              \n              markers.push(marker);\n              bounds.extend(coords);\n              \n              // 마커 클릭 이벤트\n              window.kakao.maps.event.addListener(marker, 'click', () => {\n                // 기존 인포윈도우 닫기 (중복 방지)\n                infoWindow.close();\n                \n                // 선택된 매물 설정\n                setSelectedProperty(property);\n                \n                // 인포윈도우 내용 설정\n                let content = `\n                  <div style=\"padding:12px;font-size:12px;max-width:300px;overflow:visible;\">\n                    <div style=\"font-weight:bold;margin-bottom:6px;font-size:14px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;\">${property.title}</div>\n                    <div style=\"color:#666;font-size:12px;margin-bottom:6px;\">${property.type} · ${property.dealType && Array.isArray(property.dealType) ? property.dealType.join(', ') : '매매'}</div>\n                    <div style=\"color:#2563eb;font-weight:bold;font-size:13px;margin-bottom:6px;\">${formatPrice(Number(property.price) || 0)}</div>\n                `;\n                \n                // 대략적인 위치를 사용한 경우 알림 추가\n                if (!isExactLocation) {\n                  content += `<div style=\"color:#888;font-size:11px;margin-top:4px;\"><i>* 위치는 대략적인 지역 중심 기준</i></div>`;\n                }\n                \n                content += `</div>`;\n                \n                // 인포윈도우 표시\n                infoWindow.setContent(content);\n                infoWindow.open(map, marker);\n                \n                // 지도 중심 이동 및 확대 (정확한 위치인 경우만)\n                if (isExactLocation) {\n                  map.setCenter(coords);\n                  map.setLevel(3);\n                }\n              });\n            };\n            \n            // 카카오맵 API에 주소 검색 요청 (옵션 전달)\n            geocoder.addressSearch(address, (result: any, status: any) => {\n              if (status === window.kakao.maps.services.Status.OK) {\n                console.log(`주소 검색 성공: ${result[0].address_name}`);\n                \n                // 좌표 생성 및 마커 표시\n                const coords = new window.kakao.maps.LatLng(result[0].y, result[0].x);\n                createMarker(coords, true);\n                \n                // 마지막 매물 처리 후 지도 범위 조정\n                if (index === properties.length - 1) {\n                  map.setBounds(bounds);\n                }\n              } else {\n                console.log(`주소를 찾을 수 없습니다: ${address}`);\n                \n                // 주소 검색 실패 시 대체 좌표 사용\n                let fallbackCoords;\n                \n                // 지역에 따른 중심 좌표 사용\n                if (district.includes('강화')) {\n                  fallbackCoords = new window.kakao.maps.LatLng(37.7464, 126.4878); // 강화군 중심\n                } else if (district.includes('서울')) {\n                  fallbackCoords = new window.kakao.maps.LatLng(37.5665, 126.9780); // 서울 중심\n                } else if (district.includes('인천')) {\n                  fallbackCoords = new window.kakao.maps.LatLng(37.4563, 126.7052); // 인천 중심\n                } else {\n                  // 기본 위치에 약간의 랜덤성 추가 (마커 중첩 방지)\n                  fallbackCoords = new window.kakao.maps.LatLng(\n                    37.7464 + (Math.random() * 0.02 - 0.01), \n                    126.4878 + (Math.random() * 0.02 - 0.01)\n                  );\n                }\n                \n                // 대략적인 위치에 마커 생성\n                createMarker(fallbackCoords, false);\n              }\n            }, searchOptions); // 검색 옵션 전달\n          }\n        });\n        \n        // 컴포넌트 언마운트 시 마커 제거\n        return () => {\n          markers.forEach(marker => marker.setMap(null));\n        };\n      }\n    } catch (error) {\n      console.error(\"카카오맵 초기화 오류:\", error);\n    }\n  }, [properties, singleProperty, zoom]);\n\n  // 로딩 화면 표시\n  if (!singleProperty && isLoading) {\n    return (\n      <div className=\"flex items-center justify-center h-[60vh] bg-gray-100\">\n        <div className=\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary\"></div>\n      </div>\n    );\n  }\n\n  return (\n    <div className={`relative w-full ${singleProperty ? 'h-full' : 'h-[60vh]'}`}>\n      {/* 지도 컨테이너 */}\n      <div ref={mapRef} className=\"w-full h-full\"></div>\n      \n      {/* 선택된 매물 정보 패널 - 다중 매물 모드에서만 표시 */}\n      {!singleProperty && selectedProperty && (\n        <div className=\"absolute top-4 right-4 md:w-52 bg-white rounded-lg shadow-lg p-2 z-10 max-h-[200px] overflow-y-auto\">\n          <button \n            className=\"absolute top-1 right-1 text-gray-400 hover:text-gray-600\"\n            onClick={() => setSelectedProperty(null)}\n          >\n            ✕\n          </button>\n          \n          <Link href={`/properties/${selectedProperty.id}`}>\n            <h3 className=\"font-bold text-base mb-1 hover:text-primary transition-colors truncate\">\n              {selectedProperty.title}\n            </h3>\n          </Link>\n          \n          <div className=\"text-xs text-gray-500 mb-1\">\n            {selectedProperty.type}, {selectedProperty.dealType && Array.isArray(selectedProperty.dealType) ? selectedProperty.dealType.join('/') : ''}\n          </div>\n          \n          <div className=\"flex items-center mb-1\">\n            <span className=\"text-xs text-gray-500 mr-1\">가격:</span>\n            <span className=\"text-xs font-semibold text-primary\">\n              {formatPrice(Number(selectedProperty.price) || 0)}\n            </span>\n          </div>\n          \n          <div className=\"flex items-center mb-1\">\n            <span className=\"text-xs text-gray-500 mr-1\">지역:</span>\n            <span className=\"text-xs truncate\">{selectedProperty.district}</span>\n          </div>\n          \n          <div className=\"flex items-center mb-1\">\n            <span className=\"text-xs text-gray-500 mr-1\">면적:</span>\n            <span className=\"text-xs\">\n              {selectedProperty.size}m²\n              {Number(selectedProperty.size) > 0 && `(${(Number(selectedProperty.size) * 0.3025).toFixed(1)}평)`}\n            </span>\n          </div>\n          \n          <Link \n            href={`/properties/${selectedProperty.id}`}\n            className=\"block w-full bg-primary hover:bg-secondary text-white text-center py-1 rounded text-sm transition-colors\"\n          >\n            상세보기\n          </Link>\n        </div>\n      )}\n    </div>\n  );\n}","path":null,"size_bytes":20531,"size_tokens":null},"client/src/components/ui/sheet.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Sheet = SheetPrimitive.Root\n\nconst SheetTrigger = SheetPrimitive.Trigger\n\nconst SheetClose = SheetPrimitive.Close\n\nconst SheetPortal = SheetPrimitive.Portal\n\nconst SheetOverlay = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName\n\nconst sheetVariants = cva(\n  \"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500\",\n  {\n    variants: {\n      side: {\n        top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n        bottom:\n          \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n        left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n        right:\n          \"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n      },\n    },\n    defaultVariants: {\n      side: \"right\",\n    },\n  }\n)\n\ninterface SheetContentProps\n  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,\n    VariantProps<typeof sheetVariants> {}\n\nconst SheetContent = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Content>,\n  SheetContentProps\n>(({ side = \"right\", className, children, ...props }, ref) => (\n  <SheetPortal>\n    <SheetOverlay />\n    <SheetPrimitive.Content\n      ref={ref}\n      className={cn(sheetVariants({ side }), className)}\n      {...props}\n    >\n      {children}\n      <SheetPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </SheetPrimitive.Close>\n    </SheetPrimitive.Content>\n  </SheetPortal>\n))\nSheetContent.displayName = SheetPrimitive.Content.displayName\n\nconst SheetHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetHeader.displayName = \"SheetHeader\"\n\nconst SheetFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetFooter.displayName = \"SheetFooter\"\n\nconst SheetTitle = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-foreground\", className)}\n    {...props}\n  />\n))\nSheetTitle.displayName = SheetPrimitive.Title.displayName\n\nconst SheetDescription = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nSheetDescription.displayName = SheetPrimitive.Description.displayName\n\nexport {\n  Sheet,\n  SheetPortal,\n  SheetOverlay,\n  SheetTrigger,\n  SheetClose,\n  SheetContent,\n  SheetHeader,\n  SheetFooter,\n  SheetTitle,\n  SheetDescription,\n}\n","path":null,"size_bytes":4281,"size_tokens":null},"client/src/components/ui/tabs.tsx":{"content":"import * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n","path":null,"size_bytes":1883,"size_tokens":null},"client/src/components/admin/UserManagementTable.jsx":{"content":"import { useState, useEffect } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Trash2 } from \"lucide-react\";\n\nexport default function UserManagementTable({ onDeleteClick }) {\n  const [users, setUsers] = useState([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  // 사용자 데이터 가져오기\n  const fetchUsers = async () => {\n    try {\n      setIsLoading(true);\n      const response = await fetch(\"/api/admin/users\", {\n        method: \"GET\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        credentials: \"include\" // 쿠키 포함\n      });\n\n      if (!response.ok) {\n        throw new Error(\"관리자 권한이 필요합니다\");\n      }\n\n      const data = await response.json();\n      console.log(\"API에서 가져온 사용자 데이터:\", data);\n      setUsers(data);\n      setError(null);\n    } catch (err) {\n      console.error(\"사용자 데이터 로딩 실패:\", err);\n      setError(err.message);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    fetchUsers();\n  }, []);\n\n  if (isLoading) {\n    return <div className=\"py-8 text-center\">사용자 데이터를 불러오는 중...</div>;\n  }\n\n  if (error) {\n    return <div className=\"py-8 text-center text-red-500\">오류: {error}</div>;\n  }\n\n  if (users.length === 0) {\n    return <div className=\"py-8 text-center\">등록된 사용자가 없습니다.</div>;\n  }\n\n  return (\n    <div className=\"rounded-md border\">\n      <table className=\"w-full\">\n        <thead className=\"bg-gray-50\">\n          <tr>\n            <th className=\"py-3 px-4 text-left text-sm font-medium text-gray-700\">번호</th>\n            <th className=\"py-3 px-4 text-left text-sm font-medium text-gray-700\">사용자명</th>\n            <th className=\"py-3 px-4 text-left text-sm font-medium text-gray-700\">전화번호</th>\n            <th className=\"py-3 px-4 text-left text-sm font-medium text-gray-700\">이메일</th>\n            <th className=\"py-3 px-4 text-left text-sm font-medium text-gray-700\">권한</th>\n            <th className=\"py-3 px-4 text-right text-sm font-medium text-gray-700\">작업</th>\n          </tr>\n        </thead>\n        <tbody className=\"divide-y\">\n          {users.map((user) => (\n            <tr key={user.id} className=\"hover:bg-gray-50\">\n              <td className=\"py-4 px-4 text-sm text-gray-800\">{user.id}</td>\n              <td className=\"py-4 px-4 text-sm font-medium text-gray-800\">\n                {user.username}\n              </td>\n              <td className=\"py-4 px-4 text-sm text-gray-800\">\n                {user.phone || '전화번호 없음'}\n              </td>\n              <td className=\"py-4 px-4 text-sm text-gray-800\">\n                {user.email || '-'}\n              </td>\n              <td className=\"py-4 px-4\">\n                <span\n                  className={`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium ${\n                    user.role === 'admin'\n                      ? 'bg-purple-100 text-purple-800'\n                      : 'bg-blue-100 text-blue-800'\n                  }`}\n                >\n                  {user.role === 'admin' ? '관리자' : '일반사용자'}\n                </span>\n              </td>\n              <td className=\"py-4 px-4 text-right\">\n                <Button\n                  variant=\"destructive\"\n                  size=\"sm\"\n                  disabled={user.id === 1}\n                  onClick={() => onDeleteClick && onDeleteClick(user.id, user.username)}\n                >\n                  <Trash2 className=\"h-4 w-4\" />\n                </Button>\n              </td>\n            </tr>\n          ))}\n        </tbody>\n      </table>\n    </div>\n  );\n}","path":null,"size_bytes":3762,"size_tokens":null},"client/src/components/ui/tooltip.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst TooltipProvider = TooltipPrimitive.Provider\n\nconst Tooltip = TooltipPrimitive.Root\n\nconst TooltipTrigger = TooltipPrimitive.Trigger\n\nconst TooltipContent = React.forwardRef<\n  React.ElementRef<typeof TooltipPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Content\n    ref={ref}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nTooltipContent.displayName = TooltipPrimitive.Content.displayName\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }\n","path":null,"size_bytes":1209,"size_tokens":null},"server/youtube-fetcher.ts":{"content":"import fetch from 'node-fetch';\n\n/**\n * YouTube 비디오 정보 인터페이스\n */\nexport interface YouTubeVideo {\n  id: string;\n  title: string;\n  thumbnail: string;  // 썸네일 URL (항상 문자열, 없는 경우 기본 이미지 URL 사용)\n  url: string;\n  publishedAt?: string;\n}\n\n/**\n * YouTube 채널 응답 인터페이스\n */\ninterface YouTubeChannelResponse {\n  items: {\n    contentDetails: {\n      relatedPlaylists: {\n        uploads: string;\n      };\n    };\n  }[];\n}\n\n/**\n * YouTube 재생목록 응답 인터페이스\n */\ninterface YouTubePlaylistResponse {\n  items: {\n    snippet: {\n      resourceId: {\n        videoId: string;\n      };\n      title: string;\n      thumbnails: {\n        high?: { url: string; };\n        default?: { url: string; };\n      };\n      publishedAt: string;\n    };\n  }[];\n}\n\n/**\n * 유튜브 채널 URL에서 채널 ID를 추출합니다.\n * @param channelUrl 유튜브 채널 URL\n * @returns 채널 ID\n */\nfunction extractChannelId(channelUrl: string): string {\n  // 채널 URL에서 ID 추출 (예: https://www.youtube.com/channel/UCCG3_JlKhgalqhict7tKkbA)\n  const match = channelUrl.match(/channel\\/([^/?]+)/);\n  if (match && match[1]) {\n    return match[1];\n  }\n  \n  // 기본값 반환\n  return 'UCCG3_JlKhgalqhict7tKkbA'; // 이가이버 유튜브 채널 ID\n}\n\n/**\n * YouTube API를 사용하여 특정 채널의 최신 영상을 가져옵니다.\n * @param channelId 유튜브 채널 ID (e.g., \"UCCG3_JlKhgalqhict7tKkbA\")\n * @param limit 가져올 영상 수량\n * @returns 유튜브 영상 정보 배열\n */\nexport async function fetchLatestYouTubeVideosWithAPI(channelId: string, limit: number = 5): Promise<YouTubeVideo[]> {\n  try {\n    // YouTube API 키 확인\n    const apiKey = process.env.YOUTUBE_API_KEY;\n    if (!apiKey) {\n      throw new Error('YouTube API 키가 설정되지 않았습니다');\n    }\n\n    console.log(`YouTube API를 사용하여 채널 정보 요청: ${channelId}`);\n    \n    // 채널의 업로드 재생목록 ID 가져오기\n    const channelResponse = await fetch(\n      `https://www.googleapis.com/youtube/v3/channels?part=contentDetails&id=${channelId}&key=${apiKey}`\n    );\n    \n    if (!channelResponse.ok) {\n      throw new Error(`채널 정보 요청 실패: ${channelResponse.status} ${channelResponse.statusText}`);\n    }\n    \n    const channelData = await channelResponse.json() as YouTubeChannelResponse;\n    \n    if (!channelData.items || channelData.items.length === 0) {\n      throw new Error('채널 정보를 찾을 수 없습니다');\n    }\n    \n    const uploadsPlaylistId = channelData.items[0].contentDetails.relatedPlaylists.uploads;\n    console.log(`채널 업로드 재생목록 ID: ${uploadsPlaylistId}`);\n    \n    // 재생목록에서 최신 동영상 가져오기\n    const playlistResponse = await fetch(\n      `https://www.googleapis.com/youtube/v3/playlistItems?part=snippet&maxResults=${limit}&playlistId=${uploadsPlaylistId}&key=${apiKey}`\n    );\n    \n    if (!playlistResponse.ok) {\n      throw new Error(`재생목록 요청 실패: ${playlistResponse.status} ${playlistResponse.statusText}`);\n    }\n    \n    const playlistData = await playlistResponse.json() as YouTubePlaylistResponse;\n    \n    if (!playlistData.items) {\n      console.log('재생목록에서 영상을 찾을 수 없습니다.');\n      return [];\n    }\n    \n    console.log(`재생목록에서 ${playlistData.items.length}개의 영상 정보를 가져왔습니다.`);\n    \n    // 동영상 정보 매핑\n    const videos = playlistData.items.map(item => {\n      // 썸네일 URL 기본값 설정 (API에서 반환하지 않는 경우 대체 이미지 사용)\n      const thumbnailUrl = item.snippet.thumbnails.high?.url || \n                           item.snippet.thumbnails.default?.url || \n                           `https://i.ytimg.com/vi/${item.snippet.resourceId.videoId}/hqdefault.jpg`;\n                           \n      return {\n        id: item.snippet.resourceId.videoId,\n        title: item.snippet.title,\n        thumbnail: thumbnailUrl,\n        url: `https://www.youtube.com/watch?v=${item.snippet.resourceId.videoId}`,\n        publishedAt: item.snippet.publishedAt\n      };\n    });\n    \n    console.log('YouTube API에서 영상 정보 가져오기 성공');\n    return videos;\n    \n  } catch (error) {\n    console.error('YouTube API 요청 오류:', error);\n    throw error;\n  }\n}\n\n/**\n * 유튜브 채널의 최신 영상 목록을 가져옵니다.\n * API 키가 없거나 오류 발생 시 대체 데이터를 반환합니다.\n * @param channelUrl 유튜브 채널 URL (e.g., https://www.youtube.com/channel/UCCG3_JlKhgalqhict7tKkbA)\n * @param limit 가져올 영상 수량\n * @returns 유튜브 영상 정보 배열\n */\nexport async function fetchLatestYouTubeVideos(channelUrl: string, limit: number = 5): Promise<YouTubeVideo[]> {\n  try {\n    console.log(`유튜브 채널 정보 요청: ${channelUrl}`);\n    \n    // 채널 ID 추출\n    const channelId = extractChannelId(channelUrl);\n    console.log(`추출된 채널 ID: ${channelId}`);\n    \n    // YouTube API로 데이터 가져오기 시도\n    try {\n      return await fetchLatestYouTubeVideosWithAPI(channelId, limit);\n    } catch (apiError) {\n      console.error('YouTube API 요청 실패, 대체 데이터 사용:', apiError);\n      \n      // API 실패 시 대체 데이터 제공\n      if (channelId === 'UCCG3_JlKhgalqhict7tKkbA') {\n        // 이가이버 유튜브 채널의 최신 동영상 데이터 (대체 데이터)\n        console.log('이가이버 유튜브 채널의 대체 데이터를 사용합니다.');\n        \n        const videos: YouTubeVideo[] = [\n          {\n            id: 'Kh-CoR26mAk',\n            title: '무엇을 보고 매입한 땅인데..이렇게...',\n            thumbnail: 'https://i.ytimg.com/vi/Kh-CoR26mAk/hqdefault.jpg',\n            url: 'https://www.youtube.com/watch?v=Kh-CoR26mAk'\n          },\n          {\n            id: 'lIMCvP9De8w',\n            title: '강화도 마니산 아래 힐링 할수 있는 전망좋은집',\n            thumbnail: 'https://i.ytimg.com/vi/lIMCvP9De8w/hqdefault.jpg',\n            url: 'https://www.youtube.com/watch?v=lIMCvP9De8w'\n          },\n          {\n            id: '3dJUkIVx42U',\n            title: '강화 천문 금송 전남권공간-강화부동산',\n            thumbnail: 'https://i.ytimg.com/vi/3dJUkIVx42U/hqdefault.jpg',\n            url: 'https://www.youtube.com/watch?v=3dJUkIVx42U'\n          },\n          {\n            id: 'wTxCLSPAktI',\n            title: '강화 마니산 중턱 전원주택 50평형 넘는 단독주택',\n            thumbnail: 'https://i.ytimg.com/vi/wTxCLSPAktI/hqdefault.jpg',\n            url: 'https://www.youtube.com/watch?v=wTxCLSPAktI'\n          },\n          {\n            id: 'tlcv9i9m5CU',\n            title: '벤츠가 바퀴가 거의 없는 주책이야...뻘이 많다',\n            thumbnail: 'https://i.ytimg.com/vi/tlcv9i9m5CU/hqdefault.jpg',\n            url: 'https://www.youtube.com/watch?v=tlcv9i9m5CU'\n          }\n        ];\n        \n        return videos.slice(0, limit);\n      }\n\n      // 기타 채널의 대체 데이터\n      const videos: YouTubeVideo[] = [\n        {\n          id: 'Vjqm9G9VN7s',\n          title: '강화버스투어 강화한옥마을-우리집한옥스테이',\n          thumbnail: 'https://i.ytimg.com/vi/Vjqm9G9VN7s/hqdefault.jpg',\n          url: 'https://www.youtube.com/watch?v=Vjqm9G9VN7s'\n        },\n        {\n          id: 'nJvPvjZ6hcE',\n          title: '현대아이파크 인근 단독주택 바로 보시죠',\n          thumbnail: 'https://i.ytimg.com/vi/nJvPvjZ6hcE/hqdefault.jpg',\n          url: 'https://www.youtube.com/watch?v=nJvPvjZ6hcE'\n        },\n        {\n          id: 'FQy2PGG2IEY',\n          title: '강화 전원주택 전세 바로 보시죠',\n          thumbnail: 'https://i.ytimg.com/vi/FQy2PGG2IEY/hqdefault.jpg',\n          url: 'https://www.youtube.com/watch?v=FQy2PGG2IEY'\n        },\n        {\n          id: 'uF6DUZEdFtA',\n          title: '강화에서 서울 한강이 보이는 타운하우스 \"강화 브리드원\"',\n          thumbnail: 'https://i.ytimg.com/vi/uF6DUZEdFtA/hqdefault.jpg',\n          url: 'https://www.youtube.com/watch?v=uF6DUZEdFtA'\n        },\n        {\n          id: 'cJ-OQ4j5-5c',\n          title: '장화리 효정마을 전원주택단지 \"이웃과 함께 사는 기쁨\"',\n          thumbnail: 'https://i.ytimg.com/vi/cJ-OQ4j5-5c/hqdefault.jpg',\n          url: 'https://www.youtube.com/watch?v=cJ-OQ4j5-5c'\n        }\n      ];\n      \n      return videos.slice(0, limit);\n    }\n    \n  } catch (error) {\n    console.error('유튜브 영상 가져오기 오류:', error);\n    return [];\n  }\n}\n\n// 유튜브 컨텐츠 캐시\nlet youtubeCache: {\n  videos: YouTubeVideo[];\n  lastFetched: number;\n} = {\n  videos: [],\n  lastFetched: 0\n};\n\n// 캐시 유효 시간 (6시간)\nconst CACHE_TTL = 6 * 60 * 60 * 1000;\n\n/**\n * 캐싱을 활용하여 유튜브 영상 목록 가져오기\n */\nexport async function getLatestYouTubeVideos(channelUrl: string, limit: number = 5): Promise<YouTubeVideo[]> {\n  const now = Date.now();\n  \n  // 캐시가 유효한지 확인\n  if (youtubeCache.videos.length > 0 && now - youtubeCache.lastFetched < CACHE_TTL) {\n    console.log('캐시된 유튜브 영상 정보 반환');\n    return youtubeCache.videos.slice(0, limit);\n  }\n  \n  // 새로운 데이터 가져오기\n  const videos = await fetchLatestYouTubeVideos(channelUrl, limit);\n  \n  // 캐시 업데이트\n  if (videos.length > 0) {\n    youtubeCache = {\n      videos,\n      lastFetched: now\n    };\n  }\n  \n  return videos;\n}","path":null,"size_bytes":9585,"size_tokens":null},"client/src/config/siteConfig.ts":{"content":"// 사이트 전역 설정\nexport const siteConfig = {\n  siteName: \"이가이버 부동산\",\n  siteTitle: \"이가이버 부동산\",\n  siteDescription: \"강화도 부동산 중개 서비스\",\n  contactEmail: \"contact@ganghwaestate.com\",\n  copyrightYear: new Date().getFullYear(),\n  defaultImageUrl: \"https://www.ganghwa.go.kr/images/kr/sub/sub0305_img01.jpg\"\n};\n\n// 브라우저 환경에서 전역 사이트 이름 설정\nif (typeof window !== 'undefined') {\n  (window as any).siteName = siteConfig.siteName;\n}","path":null,"size_bytes":510,"size_tokens":null},"server/index.ts":{"content":"import express, { type Request, Response, NextFunction } from \"express\";\nimport { registerRoutes } from \"./routes\";\nimport { setupVite, serveStatic, log } from \"./vite\";\nimport { setupNewsScheduler } from \"./news-fetcher\";\n\nconst app = express();\n// 파일 업로드 크기 제한 증가 (기본값 100kb → 10MB)\napp.use(express.json({ limit: '10mb' }));\napp.use(express.urlencoded({ limit: '10mb', extended: true }));\n\napp.use((req, res, next) => {\n  const start = Date.now();\n  const path = req.path;\n  let capturedJsonResponse: Record<string, any> | undefined = undefined;\n\n  const originalResJson = res.json;\n  res.json = function (bodyJson, ...args) {\n    capturedJsonResponse = bodyJson;\n    return originalResJson.apply(res, [bodyJson, ...args]);\n  };\n\n  res.on(\"finish\", () => {\n    const duration = Date.now() - start;\n    if (path.startsWith(\"/api\")) {\n      let logLine = `${req.method} ${path} ${res.statusCode} in ${duration}ms`;\n      if (capturedJsonResponse) {\n        logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;\n      }\n\n      if (logLine.length > 80) {\n        logLine = logLine.slice(0, 79) + \"…\";\n      }\n\n      log(logLine);\n    }\n  });\n\n  next();\n});\n\n(async () => {\n  const server = await registerRoutes(app);\n\n  app.use((err: any, _req: Request, res: Response, _next: NextFunction) => {\n    const status = err.status || err.statusCode || 500;\n    const message = err.message || \"Internal Server Error\";\n\n    res.status(status).json({ message });\n    throw err;\n  });\n\n  // importantly only setup vite in development and after\n  // setting up all the other routes so the catch-all route\n  // doesn't interfere with the other routes\n  if (app.get(\"env\") === \"development\") {\n    await setupVite(app, server);\n  } else {\n    serveStatic(app);\n  }\n\n  // ALWAYS serve the app on port 5000\n  // this serves both the API and the client.\n  // It is the only port that is not firewalled.\n  const port = 5000;\n  server.listen({\n    port,\n    host: \"0.0.0.0\",\n    reusePort: true,\n  }, () => {\n    log(`serving on port ${port}`);\n    \n    // 뉴스 스케줄러 초기화\n    setupNewsScheduler();\n  });\n})();\n","path":null,"size_bytes":2141,"size_tokens":null},"client/src/pages/admin-page-new.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { getQueryFn, apiRequest } from \"@/lib/queryClient\";\nimport { Property, News, User } from \"@shared/schema\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Button } from \"@/components/ui/button\";\nimport { Loader2, Trash2, RefreshCw, Edit, Plus, Eye } from \"lucide-react\";\nimport { \n  Table, \n  TableBody, \n  TableCell, \n  TableHead, \n  TableHeader, \n  TableRow \n} from \"@/components/ui/table\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from \"@/components/ui/alert-dialog\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\n\nexport default function AdminPage() {\n  const { user } = useAuth();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  \n  // 필터링 상태 (지역 필터 제거)\n  const [filterType, setFilterType] = useState<string>(\"all\");\n  const [filterDistrict, setFilterDistrict] = useState<string>(\"all\");\n  const [filterDealType, setFilterDealType] = useState<string>(\"all\");\n  \n  // 부동산 필터링 함수\n  const filterProperties = (props: Property[]) => {\n    if (!props) return [];\n    \n    // 필터링 로그\n    console.log(\"필터링 적용: \", { filterType, filterDistrict, filterDealType });\n    \n    return props.filter(property => {\n      // 유형 필터\n      if (filterType && filterType !== 'all' && property.type !== filterType) {\n        return false;\n      }\n      \n      // 지역 필터\n      if (filterDistrict && filterDistrict !== 'all' && property.district !== filterDistrict) {\n        return false;\n      }\n      \n      // 거래유형 필터\n      if (filterDealType && filterDealType !== 'all' && property.dealType) {\n        // 배열인 경우\n        if (Array.isArray(property.dealType)) {\n          return property.dealType.includes(filterDealType);\n        } \n        // PostgreSQL 배열 형식의 문자열인 경우 (\"{매매,월세}\" 형태)\n        else if (typeof property.dealType === 'string' && property.dealType.startsWith('{') && property.dealType.endsWith('}')) {\n          const dealTypes = property.dealType.substring(1, property.dealType.length - 1).split(',');\n          return dealTypes.includes(filterDealType);\n        }\n        // 일반 문자열인 경우 (매매 형태)\n        else if (typeof property.dealType === 'string') {\n          return property.dealType === filterDealType;\n        }\n        return false;\n      }\n      \n      return true;\n    });\n  };\n  \n  // 선택된 항목 관리\n  const [selectedProperties, setSelectedProperties] = useState<number[]>([]);\n  const [selectedNews, setSelectedNews] = useState<number[]>([]);\n  const [selectedUsers, setSelectedUsers] = useState<number[]>([]);\n  \n  // 삭제 확인 대화 상자 상태\n  const [isDeleteAlertOpen, setIsDeleteAlertOpen] = useState(false);\n  const [currentDeleteType, setCurrentDeleteType] = useState<'properties' | 'news' | 'users' | null>(null);\n  \n  // 데이터 로드를 위한 쿼리 매개변수\n  const [skipCache, setSkipCache] = useState(false);\n  \n  // 필터 옵션 - DB에 있는 실제 필드값 적용\n  const propertyTypes = [\n    { value: \"아파트\", label: \"아파트\" },\n    { value: \"아파트연립다세대\", label: \"아파트연립다세대\" },\n    { value: \"주택\", label: \"주택\" },\n    { value: \"오피스텔\", label: \"오피스텔\" },\n    { value: \"상가공장창고펜션\", label: \"상가공장창고펜션\" },\n  ];\n  \n  const dealTypes = [\n    { value: \"매매\", label: \"매매\" },\n    { value: \"전세\", label: \"전세\" },\n    { value: \"월세\", label: \"월세\" },\n    { value: \"완료\", label: \"완료\" },\n    { value: \"보류중\", label: \"보류중\" },\n  ];\n  \n  // 지역 필터 - 제공된 정확한 위치 목록 사용\n  const districts = [\n    { value: \"all\", label: \"모든 지역\" },\n    { value: \"강화읍 갑곳리\", label: \"강화읍 갑곳리\" },\n    { value: \"강화읍 관청리\", label: \"강화읍 관청리\" },\n    { value: \"강화읍 국화리\", label: \"강화읍 국화리\" },\n    { value: \"강화읍 남산리\", label: \"강화읍 남산리\" },\n    { value: \"강화읍 대산리\", label: \"강화읍 대산리\" },\n    { value: \"강화읍 신문리\", label: \"강화읍 신문리\" },\n    { value: \"강화읍 옥림리\", label: \"강화읍 옥림리\" },\n    { value: \"강화읍 용정리\", label: \"강화읍 용정리\" },\n    { value: \"강화읍 월곳리\", label: \"강화읍 월곳리\" },\n    { value: \"교동면 고구리\", label: \"교동면 고구리\" },\n    { value: \"교동면 난정리\", label: \"교동면 난정리\" },\n    { value: \"교동면 대룡리\", label: \"교동면 대룡리\" },\n    { value: \"교동면 동산리\", label: \"교동면 동산리\" },\n    { value: \"교동면 무학리\", label: \"교동면 무학리\" },\n    { value: \"교동면 봉소리\", label: \"교동면 봉소리\" },\n    { value: \"교동면 삼선리\", label: \"교동면 삼선리\" },\n    { value: \"교동면 상용리\", label: \"교동면 상용리\" },\n    { value: \"교동면 서한리\", label: \"교동면 서한리\" },\n    { value: \"교동면 양갑리\", label: \"교동면 양갑리\" },\n    { value: \"교동면 읍내리\", label: \"교동면 읍내리\" },\n    { value: \"교동면 인사리\", label: \"교동면 인사리\" },\n    { value: \"교동면 지석리\", label: \"교동면 지석리\" },\n    { value: \"길상면 길직리\", label: \"길상면 길직리\" },\n    { value: \"길상면 동검리\", label: \"길상면 동검리\" },\n    { value: \"길상면 선두리\", label: \"길상면 선두리\" },\n    { value: \"길상면 온수리\", label: \"길상면 온수리\" },\n    { value: \"길상면 장흥리\", label: \"길상면 장흥리\" },\n    { value: \"길상면 초지리\", label: \"길상면 초지리\" },\n    { value: \"내가면 고천리\", label: \"내가면 고천리\" },\n    { value: \"내가면 구하리\", label: \"내가면 구하리\" },\n    { value: \"내가면 오상리\", label: \"내가면 오상리\" },\n    { value: \"내가면 외포리\", label: \"내가면 외포리\" },\n    { value: \"내가면 황청리\", label: \"내가면 황청리\" },\n    { value: \"불은면 고능리\", label: \"불은면 고능리\" },\n    { value: \"불은면 넙성리\", label: \"불은면 넙성리\" },\n    { value: \"불은면 덕성리\", label: \"불은면 덕성리\" },\n    { value: \"불은면 두운리\", label: \"불은면 두운리\" },\n    { value: \"불은면 삼동암리\", label: \"불은면 삼동암리\" },\n    { value: \"불은면 삼성리\", label: \"불은면 삼성리\" },\n    { value: \"불은면 신현리\", label: \"불은면 신현리\" },\n    { value: \"불은면 오두리\", label: \"불은면 오두리\" },\n    { value: \"삼산면 매음리\", label: \"삼산면 매음리\" },\n    { value: \"삼산면 미법리\", label: \"삼산면 미법리\" },\n    { value: \"삼산면 상리\", label: \"삼산면 상리\" },\n    { value: \"삼산면 서검리\", label: \"삼산면 서검리\" },\n    { value: \"삼산면 석모리\", label: \"삼산면 석모리\" },\n    { value: \"삼산면 석포리\", label: \"삼산면 석포리\" },\n    { value: \"삼산면 하리\", label: \"삼산면 하리\" },\n    { value: \"서도면 말도리\", label: \"서도면 말도리\" },\n    { value: \"서도면 볼음도리\", label: \"서도면 볼음도리\" },\n    { value: \"서도면 아차도리\", label: \"서도면 아차도리\" },\n    { value: \"서도면 주문도리\", label: \"서도면 주문도리\" },\n    { value: \"선원면 금월리\", label: \"선원면 금월리\" },\n    { value: \"선원면 냉정리\", label: \"선원면 냉정리\" },\n    { value: \"선원면 선행리\", label: \"선원면 선행리\" },\n    { value: \"선원면 신정리\", label: \"선원면 신정리\" },\n    { value: \"선원면 연리\", label: \"선원면 연리\" },\n    { value: \"선원면 지산리\", label: \"선원면 지산리\" },\n    { value: \"선원면 창리\", label: \"선원면 창리\" },\n    { value: \"송해면 당산리\", label: \"송해면 당산리\" },\n    { value: \"송해면 상도리\", label: \"송해면 상도리\" },\n    { value: \"송해면 솔정리\", label: \"송해면 솔정리\" },\n    { value: \"송해면 숭뢰리\", label: \"송해면 숭뢰리\" },\n    { value: \"송해면 신당리\", label: \"송해면 신당리\" },\n    { value: \"송해면 양오리\", label: \"송해면 양오리\" },\n    { value: \"송해면 하도리\", label: \"송해면 하도리\" },\n    { value: \"양도면 건평리\", label: \"양도면 건평리\" },\n    { value: \"양도면 길정리\", label: \"양도면 길정리\" },\n    { value: \"양도면 능내리\", label: \"양도면 능내리\" },\n    { value: \"양도면 도장리\", label: \"양도면 도장리\" },\n    { value: \"양도면 삼흥리\", label: \"양도면 삼흥리\" },\n    { value: \"양도면 인산리\", label: \"양도면 인산리\" },\n    { value: \"양도면 조산리\", label: \"양도면 조산리\" },\n    { value: \"양도면 하일리\", label: \"양도면 하일리\" },\n    { value: \"양사면 교산리\", label: \"양사면 교산리\" },\n    { value: \"양사면 덕하리\", label: \"양사면 덕하리\" },\n    { value: \"양사면 북성리\", label: \"양사면 북성리\" },\n    { value: \"양사면 인화리\", label: \"양사면 인화리\" },\n    { value: \"양사면 철산리\", label: \"양사면 철산리\" },\n    { value: \"하점면 망월리\", label: \"하점면 망월리\" },\n    { value: \"하점면 부근리\", label: \"하점면 부근리\" },\n    { value: \"하점면 삼거리\", label: \"하점면 삼거리\" },\n    { value: \"하점면 신봉리\", label: \"하점면 신봉리\" },\n    { value: \"하점면 신삼리\", label: \"하점면 신삼리\" },\n    { value: \"하점면 이강리\", label: \"하점면 이강리\" },\n    { value: \"하점면 장정리\", label: \"하점면 장정리\" },\n    { value: \"하점면 창후리\", label: \"하점면 창후리\" },\n    { value: \"화도면 내리\", label: \"화도면 내리\" },\n    { value: \"화도면 덕포리\", label: \"화도면 덕포리\" },\n    { value: \"화도면 동막리\", label: \"화도면 동막리\" },\n    { value: \"화도면 문산리\", label: \"화도면 문산리\" },\n    { value: \"화도면 사기리\", label: \"화도면 사기리\" },\n    { value: \"화도면 상방리\", label: \"화도면 상방리\" },\n    { value: \"화도면 여차리\", label: \"화도면 여차리\" },\n    { value: \"화도면 장화리\", label: \"화도면 장화리\" },\n    { value: \"화도면 흥왕리\", label: \"화도면 흥왕리\" },\n    { value: \"기타지역\", label: \"기타지역\" }\n  ];\n  \n  // 기존 배열 (참고용)\n  const oldPropertyTypes = [\"토지\", \"주택\", \"아파트연립다세대\", \"원투룸\", \"상가공장창고펜션\"];\n  const oldDealTypes = [\"매매\", \"전세\", \"월세\", \"단기임대\", \"완료\", \"보류중\"];\n  \n  // 지역 관련 코드 제거 (클라이언트 요청)\n  \n  // 데이터 로드\n  const { \n    data: properties,\n    isLoading: isLoadingProperties,\n  } = useQuery<Property[]>({\n    queryKey: [\"/api/properties\", skipCache],\n    queryFn: getQueryFn({ on401: \"throw\" })\n  });\n  \n  const {\n    data: news,\n    isLoading: isLoadingNews,\n  } = useQuery<News[]>({\n    queryKey: [\"/api/news\"],\n    queryFn: getQueryFn({ on401: \"throw\" })\n  });\n  \n  // 필터링된 부동산 목록\n  const filteredProperties = filterProperties(properties || []);\n  \n  const {\n    data: users,\n    isLoading: isLoadingUsers,\n  } = useQuery<User[]>({\n    queryKey: [\"/api/admin/users\"],\n    queryFn: getQueryFn({ on401: \"throw\" }),\n    enabled: user?.role === \"admin\"\n  });\n  \n  // 데이터 로드 시 선택 초기화\n  useEffect(() => {\n    setSelectedProperties([]);\n  }, [properties]);\n  \n  useEffect(() => {\n    setSelectedNews([]);\n  }, [news]);\n  \n  useEffect(() => {\n    setSelectedUsers([]);\n  }, [users]);\n  \n  // 단일 부동산 삭제 뮤테이션\n  const deletePropertyMutation = useMutation({\n    mutationFn: async (id: number) => {\n      const res = await apiRequest(\"DELETE\", `/api/properties/${id}`);\n      return res;\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/properties\"] });\n      toast({\n        title: \"부동산 삭제 성공\",\n        description: \"부동산이 성공적으로 삭제되었습니다.\",\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"부동산 삭제 실패\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n  \n  // 단일 뉴스 삭제 뮤테이션\n  const deleteNewsMutation = useMutation({\n    mutationFn: async (id: number) => {\n      const res = await apiRequest(\"DELETE\", `/api/news/${id}`);\n      return res;\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/news\"] });\n      toast({\n        title: \"뉴스 삭제 성공\",\n        description: \"뉴스가 성공적으로 삭제되었습니다.\",\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"뉴스 삭제 실패\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n  \n  // 단일 사용자 삭제 뮤테이션\n  const deleteUserMutation = useMutation({\n    mutationFn: async (id: number) => {\n      const res = await apiRequest(\"DELETE\", `/api/admin/users/${id}`);\n      return res;\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/users\"] });\n      toast({\n        title: \"사용자 삭제 성공\",\n        description: \"사용자가 성공적으로 삭제되었습니다.\",\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"사용자 삭제 실패\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n  \n  // 일괄 삭제 뮤테이션\n  const batchDeleteMutation = useMutation({\n    mutationFn: async ({ type, ids }: { type: 'properties' | 'news' | 'users', ids: number[] }) => {\n      const endpoint = `/api/admin/batch-delete/${type}`;\n      const res = await apiRequest(\"POST\", endpoint, { ids });\n      return res;\n    },\n    onSuccess: () => {\n      if (currentDeleteType === 'properties') {\n        queryClient.invalidateQueries({ queryKey: [\"/api/properties\"] });\n        setSelectedProperties([]);\n      } else if (currentDeleteType === 'news') {\n        queryClient.invalidateQueries({ queryKey: [\"/api/news\"] });\n        setSelectedNews([]);\n      } else if (currentDeleteType === 'users') {\n        queryClient.invalidateQueries({ queryKey: [\"/api/admin/users\"] });\n        setSelectedUsers([]);\n      }\n      \n      toast({\n        title: \"일괄 삭제 성공\",\n        description: \"선택한 항목들이 성공적으로 삭제되었습니다.\",\n      });\n      \n      setIsDeleteAlertOpen(false);\n      setCurrentDeleteType(null);\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"일괄 삭제 실패\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n      setIsDeleteAlertOpen(false);\n    },\n  });\n  \n  // 부동산 삭제 핸들러\n  const handleDeleteProperty = (id: number) => {\n    if (window.confirm(\"정말로 이 부동산을 삭제하시겠습니까?\")) {\n      deletePropertyMutation.mutate(id);\n    }\n  };\n  \n  // 뉴스 삭제 핸들러\n  const handleDeleteNews = (id: number) => {\n    if (window.confirm(\"정말로 이 뉴스를 삭제하시겠습니까?\")) {\n      deleteNewsMutation.mutate(id);\n    }\n  };\n  \n  // 사용자 삭제 핸들러\n  const handleDeleteUser = (id: number) => {\n    if (window.confirm(\"정말로 이 사용자를 삭제하시겠습니까?\")) {\n      deleteUserMutation.mutate(id);\n    }\n  };\n  \n  // 다중 선택 핸들러\n  const handleSelectProperty = (id: number, checked: boolean) => {\n    if (checked) {\n      setSelectedProperties([...selectedProperties, id]);\n    } else {\n      setSelectedProperties(selectedProperties.filter(propId => propId !== id));\n    }\n  };\n  \n\n  \n  const handleSelectNews = (id: number, checked: boolean) => {\n    if (checked) {\n      setSelectedNews([...selectedNews, id]);\n    } else {\n      setSelectedNews(selectedNews.filter(newsId => newsId !== id));\n    }\n  };\n  \n  const handleSelectUser = (id: number, checked: boolean) => {\n    if (checked) {\n      setSelectedUsers([...selectedUsers, id]);\n    } else {\n      setSelectedUsers(selectedUsers.filter(userId => userId !== id));\n    }\n  };\n  \n  // 전체 선택 핸들러\n  const handleSelectAllProperties = (checked: boolean) => {\n    if (checked && filteredProperties.length > 0) {\n      setSelectedProperties(filteredProperties.map(p => p.id));\n    } else {\n      setSelectedProperties([]);\n    }\n  };\n  \n  const handleSelectAllNews = (checked: boolean) => {\n    if (checked && news) {\n      setSelectedNews(news.map(n => n.id));\n    } else {\n      setSelectedNews([]);\n    }\n  };\n  \n  const handleSelectAllUsers = (checked: boolean) => {\n    if (checked && users) {\n      setSelectedUsers(users.map(u => u.id));\n    } else {\n      setSelectedUsers([]);\n    }\n  };\n  \n  // 일괄 삭제 확인 다이얼로그 열기\n  const openDeleteConfirm = (type: 'properties' | 'news' | 'users') => {\n    setCurrentDeleteType(type);\n    setIsDeleteAlertOpen(true);\n  };\n  \n  // 일괄 삭제 실행\n  const handleBatchDelete = () => {\n    if (!currentDeleteType) return;\n    \n    switch (currentDeleteType) {\n      case 'properties':\n        if (selectedProperties.length === 0) {\n          toast({\n            title: \"선택된 항목 없음\",\n            description: \"삭제할 부동산을 선택해주세요.\",\n            variant: \"destructive\",\n          });\n          return;\n        }\n        batchDeleteMutation.mutate({ type: 'properties', ids: selectedProperties });\n        break;\n        \n      case 'news':\n        if (selectedNews.length === 0) {\n          toast({\n            title: \"선택된 항목 없음\",\n            description: \"삭제할 뉴스를 선택해주세요.\",\n            variant: \"destructive\",\n          });\n          return;\n        }\n        batchDeleteMutation.mutate({ type: 'news', ids: selectedNews });\n        break;\n        \n      case 'users':\n        if (selectedUsers.length === 0) {\n          toast({\n            title: \"선택된 항목 없음\",\n            description: \"삭제할 사용자를 선택해주세요.\",\n            variant: \"destructive\",\n          });\n          return;\n        }\n        batchDeleteMutation.mutate({ type: 'users', ids: selectedUsers });\n        break;\n    }\n  };\n  \n  // 데이터 새로고침\n  const refreshData = () => {\n    setSkipCache(prev => !prev);\n    queryClient.invalidateQueries({ queryKey: [\"/api/properties\"] });\n    queryClient.invalidateQueries({ queryKey: [\"/api/news\"] });\n    queryClient.invalidateQueries({ queryKey: [\"/api/admin/users\"] });\n    \n    toast({\n      title: \"데이터 새로고침\",\n      description: \"최신 데이터를 불러오고 있습니다.\",\n    });\n  };\n  \n  // 뉴스 수집 요청 함수\n  const fetchNewsManually = async () => {\n    try {\n      await apiRequest(\"POST\", \"/api/admin/fetch-news\");\n      toast({\n        title: \"뉴스 수집 요청 성공\",\n        description: \"새로운 뉴스를 수집 중입니다. 잠시 후 새로고침 해주세요.\",\n      });\n      \n      // 3초 후 자동 새로고침\n      setTimeout(() => {\n        queryClient.invalidateQueries({ queryKey: [\"/api/news\"] });\n      }, 3000);\n      \n    } catch (error) {\n      toast({\n        title: \"뉴스 수집 요청 실패\",\n        description: \"뉴스 수집에 실패했습니다. 잠시 후 다시 시도해 주세요.\",\n        variant: \"destructive\",\n      });\n    }\n  };\n  \n  // 현재 상태에 따른 제목 표시\n  const getTitle = () => {\n    if (!user) return \"로딩 중...\";\n    return `관리자 대시보드 - ${user.username}님`;\n  };\n  \n  return (\n    <div className=\"container mx-auto p-4\">\n      <div className=\"flex justify-between items-center mb-6\">\n        <h1 className=\"text-3xl font-bold\">{getTitle()}</h1>\n        <Button onClick={refreshData} variant=\"outline\" size=\"sm\">\n          <RefreshCw className=\"h-4 w-4 mr-2\" />\n          새로고침\n        </Button>\n      </div>\n\n      <Tabs defaultValue=\"properties\" className=\"w-full\">\n        <TabsList className=\"mb-4\">\n          <TabsTrigger value=\"properties\">부동산</TabsTrigger>\n          <TabsTrigger value=\"news\">뉴스</TabsTrigger>\n          {user?.role === \"admin\" && (\n            <TabsTrigger value=\"users\">사용자</TabsTrigger>\n          )}\n        </TabsList>\n\n        {/* 부동산 탭 */}\n        <TabsContent value=\"properties\">\n          <div className=\"bg-white rounded-lg shadow p-6\">\n            <div className=\"flex justify-between items-center mb-4\">\n              <h2 className=\"text-xl font-bold\">부동산 관리</h2>\n              <div className=\"flex space-x-2\">\n                {selectedProperties.length > 0 && (\n                  <Button \n                    variant=\"destructive\" \n                    onClick={() => openDeleteConfirm('properties')}\n                  >\n                    <Trash2 className=\"h-4 w-4 mr-2\" />\n                    선택 삭제 ({selectedProperties.length})\n                  </Button>\n                )}\n                <a \n                  href=\"/admin/properties/new\"\n                  className=\"bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-md inline-flex items-center\"\n                >\n                  <Plus className=\"h-4 w-4 mr-2\" />\n                  새 부동산 등록\n                </a>\n              </div>\n            </div>\n            \n            {/* 필터 UI */}\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4\">\n              <div>\n                <label className=\"block text-sm font-medium mb-1\">유형</label>\n                <Select value={filterType} onValueChange={setFilterType}>\n                  <SelectTrigger>\n                    <SelectValue placeholder=\"모든 유형\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"all\">모든 유형</SelectItem>\n                    {propertyTypes.map((type) => (\n                      <SelectItem key={type.value} value={type.value}>\n                        {type.label}\n                      </SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n              </div>\n              \n              <div>\n                <label className=\"block text-sm font-medium mb-1\">지역</label>\n                <Select value={filterDistrict} onValueChange={setFilterDistrict}>\n                  <SelectTrigger>\n                    <SelectValue placeholder=\"모든 지역\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"all\">모든 지역</SelectItem>\n                    {districts.map((district) => (\n                      <SelectItem key={district.value} value={district.value}>\n                        {district.label}\n                      </SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n              </div>\n              \n              <div>\n                <label className=\"block text-sm font-medium mb-1\">거래 유형</label>\n                <Select value={filterDealType} onValueChange={setFilterDealType}>\n                  <SelectTrigger>\n                    <SelectValue placeholder=\"모든 거래 유형\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"all\">모든 거래 유형</SelectItem>\n                    {dealTypes.map((type) => (\n                      <SelectItem key={type.value} value={type.value}>\n                        {type.label}\n                      </SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n              </div>\n            </div>\n            \n            {isLoadingProperties ? (\n              <div className=\"flex justify-center py-10\">\n                <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\n              </div>\n            ) : (\n              <div className=\"overflow-x-auto\">\n                <Table>\n                  <TableHeader>\n                    <TableRow>\n                      <TableHead className=\"w-[40px]\">\n                        <Checkbox \n                          checked={filteredProperties && filteredProperties.length > 0 && selectedProperties.length === filteredProperties.length}\n                          onCheckedChange={handleSelectAllProperties}\n                        />\n                      </TableHead>\n                      <TableHead className=\"w-[80px]\">번호</TableHead>\n                      <TableHead className=\"min-w-[200px]\">제목/이미지</TableHead>\n                      <TableHead className=\"w-[120px]\">유형</TableHead>\n                      <TableHead className=\"min-w-[150px]\">위치</TableHead>\n                      <TableHead className=\"w-[120px]\">가격</TableHead>\n                      <TableHead className=\"w-[100px]\">거래유형</TableHead>\n                      <TableHead className=\"w-[100px]\">작업</TableHead>\n                    </TableRow>\n                  </TableHeader>\n                  <TableBody>\n                    {!filteredProperties || filteredProperties.length === 0 ? (\n                      <TableRow>\n                        <TableCell colSpan={8} className=\"text-center py-4\">\n                          {properties && properties.length > 0 \n                            ? \"필터링 조건에 맞는 부동산이 없습니다.\" \n                            : \"등록된 부동산이 없습니다.\"}\n                        </TableCell>\n                      </TableRow>\n                    ) : (\n                      filteredProperties.map((property) => (\n                        <TableRow key={property.id}>\n                          <TableCell>\n                            <Checkbox \n                              checked={selectedProperties.includes(property.id)}\n                              onCheckedChange={(checked) => \n                                handleSelectProperty(property.id, checked === true)\n                              }\n                            />\n                          </TableCell>\n                          <TableCell>{property.id}</TableCell>\n                          <TableCell>\n                            <div className=\"flex items-center gap-3\">\n                              {property.imageUrls && property.imageUrls.length > 0 ? (\n                                <div className=\"relative h-10 w-16 overflow-hidden rounded\">\n                                  <img \n                                    src={property.imageUrls[0]} \n                                    alt={property.title} \n                                    className=\"h-full w-full object-cover\"\n                                  />\n                                  {property.imageUrls.length > 1 && (\n                                    <span className=\"absolute bottom-0 right-0 bg-black/50 text-white text-xs px-1\">\n                                      +{property.imageUrls.length - 1}\n                                    </span>\n                                  )}\n                                </div>\n                              ) : property.imageUrl ? (\n                                <div className=\"relative h-10 w-16 overflow-hidden rounded\">\n                                  <img \n                                    src={property.imageUrl} \n                                    alt={property.title} \n                                    className=\"h-full w-full object-cover\"\n                                  />\n                                </div>\n                              ) : (\n                                <div className=\"h-10 w-16 bg-gray-200 flex items-center justify-center rounded\">\n                                  <Edit className=\"h-5 w-5 text-gray-500\" />\n                                </div>\n                              )}\n                              <div>\n                                <a \n                                  href={`/properties/${property.id}`}\n                                  className=\"text-blue-600 hover:underline font-medium\"\n                                >\n                                  {property.title}\n                                </a>\n                              </div>\n                            </div>\n                          </TableCell>\n                          <TableCell>{property.type}</TableCell>\n                          <TableCell>\n                            <div className=\"flex flex-col\">\n                              <span className=\"text-xs text-gray-500\">{property.district}</span>\n                            </div>\n                          </TableCell>\n                          <TableCell>\n                            {new Intl.NumberFormat('ko-KR', {\n                              style: 'currency',\n                              currency: 'KRW',\n                              maximumFractionDigits: 0\n                            }).format(Number(property.price))}\n                          </TableCell>\n                          <TableCell>\n                            <div className=\"flex flex-col gap-1\">\n                              {property.dealType && (Array.isArray(property.dealType) ? property.dealType.length > 0 : typeof property.dealType === 'string' && property.dealType.length > 0) ? (\n                                Array.isArray(property.dealType) ? \n                                  property.dealType.map((type, idx) => {\n                                    const dealTypeClass = \n                                      typeof type === 'string' && type.includes(\"매매\") \n                                        ? 'bg-blue-100 text-blue-800' \n                                        : typeof type === 'string' && type.includes(\"전세\")\n                                        ? 'bg-green-100 text-green-800'\n                                        : typeof type === 'string' && type.includes(\"월세\")\n                                        ? 'bg-orange-100 text-orange-800'\n                                        : 'bg-gray-100 text-gray-800';\n                                    \n                                    return (\n                                      <span key={idx} className={`px-2 py-1 rounded-full text-xs inline-block ${dealTypeClass}`}>\n                                        {type}\n                                      </span>\n                                    );\n                                  })\n                                : (\n                                  <span className={`px-2 py-1 rounded-full text-xs ${\n                                    typeof property.dealType === 'string' && property.dealType.includes(\"매매\") \n                                      ? 'bg-blue-100 text-blue-800' \n                                      : typeof property.dealType === 'string' && property.dealType.includes(\"전세\")\n                                      ? 'bg-green-100 text-green-800'\n                                      : typeof property.dealType === 'string' && property.dealType.includes(\"월세\")\n                                      ? 'bg-orange-100 text-orange-800'\n                                      : 'bg-gray-100 text-gray-800'\n                                  }`}>\n                                    {property.dealType}\n                                  </span>\n                                )\n                              ) : (\n                                <span className=\"px-2 py-1 rounded-full text-xs bg-gray-100 text-gray-800\">\n                                  미지정\n                                </span>\n                              )}\n                            </div>\n                          </TableCell>\n                          <TableCell>\n                            <div className=\"flex space-x-2\">\n                              <a \n                                href={`/admin/properties/edit/${property.id}`}\n                                className=\"inline-flex h-8 items-center justify-center rounded-md bg-blue-500 px-2 text-sm font-medium text-white shadow hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2\"\n                              >\n                                <Edit className=\"h-4 w-4\" />\n                              </a>\n                              <Button \n                                variant=\"destructive\" \n                                size=\"sm\"\n                                onClick={() => handleDeleteProperty(property.id)}\n                              >\n                                <Trash2 className=\"h-4 w-4\" />\n                              </Button>\n                            </div>\n                          </TableCell>\n                        </TableRow>\n                      ))\n                    )}\n                  </TableBody>\n                </Table>\n              </div>\n            )}\n          </div>\n        </TabsContent>\n\n        {/* 뉴스 탭 */}\n        <TabsContent value=\"news\">\n          <div className=\"bg-white rounded-lg shadow p-6\">\n            <div className=\"flex justify-between items-center mb-4\">\n              <h2 className=\"text-xl font-bold\">뉴스 관리</h2>\n              <div className=\"flex space-x-2\">\n                {selectedNews.length > 0 && (\n                  <Button \n                    variant=\"destructive\" \n                    onClick={() => openDeleteConfirm('news')}\n                  >\n                    <Trash2 className=\"h-4 w-4 mr-2\" />\n                    선택 삭제 ({selectedNews.length})\n                  </Button>\n                )}\n                <Button \n                  variant=\"outline\" \n                  onClick={fetchNewsManually}\n                >\n                  <RefreshCw className=\"h-4 w-4 mr-2\" />\n                  뉴스 수집\n                </Button>\n              </div>\n            </div>\n            \n            {isLoadingNews ? (\n              <div className=\"flex justify-center py-10\">\n                <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\n              </div>\n            ) : (\n              <div className=\"overflow-x-auto\">\n                <Table>\n                  <TableHeader>\n                    <TableRow>\n                      <TableHead className=\"w-[40px]\">\n                        <Checkbox \n                          checked={news && news.length > 0 && selectedNews.length === news.length}\n                          onCheckedChange={handleSelectAllNews}\n                        />\n                      </TableHead>\n                      <TableHead>번호</TableHead>\n                      <TableHead>제목</TableHead>\n                      <TableHead>출처</TableHead>\n                      <TableHead>작성일</TableHead>\n                      <TableHead>작업</TableHead>\n                    </TableRow>\n                  </TableHeader>\n                  <TableBody>\n                    {!news || news.length === 0 ? (\n                      <TableRow>\n                        <TableCell colSpan={6} className=\"text-center py-4\">\n                          등록된 뉴스가 없습니다.\n                        </TableCell>\n                      </TableRow>\n                    ) : (\n                      news.map((newsItem) => (\n                        <TableRow key={newsItem.id}>\n                          <TableCell>\n                            <Checkbox \n                              checked={selectedNews.includes(newsItem.id)}\n                              onCheckedChange={(checked) => \n                                handleSelectNews(newsItem.id, checked === true)\n                              }\n                            />\n                          </TableCell>\n                          <TableCell>{newsItem.id}</TableCell>\n                          <TableCell className=\"font-medium\">\n                            <a \n                              href={`/news/${newsItem.id}`}\n                              className=\"text-blue-600 hover:underline\"\n                            >\n                              {newsItem.title}\n                            </a>\n                          </TableCell>\n                          <TableCell>{newsItem.source}</TableCell>\n                          <TableCell>\n                            {newsItem.createdAt \n                              ? new Date(newsItem.createdAt).toLocaleDateString() \n                              : '날짜 없음'}\n                          </TableCell>\n                          <TableCell>\n                            <div className=\"flex space-x-2\">\n                              <a \n                                href={`/news/${newsItem.id}`}\n                                className=\"inline-flex h-8 items-center justify-center rounded-md bg-blue-500 px-2 text-sm font-medium text-white shadow hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2\"\n                              >\n                                <Eye className=\"h-4 w-4\" />\n                              </a>\n                              <Button \n                                variant=\"destructive\" \n                                size=\"sm\"\n                                onClick={() => handleDeleteNews(newsItem.id)}\n                              >\n                                <Trash2 className=\"h-4 w-4\" />\n                              </Button>\n                            </div>\n                          </TableCell>\n                        </TableRow>\n                      ))\n                    )}\n                  </TableBody>\n                </Table>\n              </div>\n            )}\n          </div>\n        </TabsContent>\n\n        {/* 사용자 탭 (관리자만) */}\n        {user?.role === \"admin\" && (\n          <TabsContent value=\"users\">\n            <div className=\"bg-white rounded-lg shadow p-6\">\n              <div className=\"flex justify-between items-center mb-4\">\n                <h2 className=\"text-xl font-bold\">사용자 관리</h2>\n                {selectedUsers.length > 0 && (\n                  <Button \n                    variant=\"destructive\" \n                    onClick={() => openDeleteConfirm('users')}\n                  >\n                    <Trash2 className=\"h-4 w-4 mr-2\" />\n                    선택 삭제 ({selectedUsers.length})\n                  </Button>\n                )}\n              </div>\n              \n              {isLoadingUsers ? (\n                <div className=\"flex justify-center py-10\">\n                  <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\n                </div>\n              ) : (\n                <div className=\"overflow-x-auto\">\n                  <Table>\n                    <TableHeader>\n                      <TableRow>\n                        <TableHead className=\"w-[40px]\">\n                          <Checkbox \n                            checked={users && users.length > 0 && selectedUsers.length === users.length}\n                            onCheckedChange={handleSelectAllUsers}\n                          />\n                        </TableHead>\n                        <TableHead>번호</TableHead>\n                        <TableHead>사용자명</TableHead>\n                        <TableHead>이메일</TableHead>\n                        <TableHead>권한</TableHead>\n                        <TableHead>작업</TableHead>\n                      </TableRow>\n                    </TableHeader>\n                    <TableBody>\n                      {!users || users.length === 0 ? (\n                        <TableRow>\n                          <TableCell colSpan={6} className=\"text-center py-4\">\n                            등록된 사용자가 없습니다.\n                          </TableCell>\n                        </TableRow>\n                      ) : (\n                        users.map((user) => (\n                          <TableRow key={user.id}>\n                            <TableCell>\n                              {user.role !== 'admin' && (\n                                <Checkbox \n                                  checked={selectedUsers.includes(user.id)}\n                                  onCheckedChange={(checked) => \n                                    handleSelectUser(user.id, checked === true)\n                                  }\n                                />\n                              )}\n                            </TableCell>\n                            <TableCell>{user.id}</TableCell>\n                            <TableCell className=\"font-medium\">{user.username}</TableCell>\n                            <TableCell>{user.email}</TableCell>\n                            <TableCell>\n                              <span className={`px-2 py-1 rounded-full text-xs ${\n                                user.role === \"admin\" \n                                  ? 'bg-purple-100 text-purple-800' \n                                  : 'bg-blue-100 text-blue-800'\n                              }`}>\n                                {user.role === \"admin\" ? \"관리자\" : \"일반사용자\"}\n                              </span>\n                            </TableCell>\n                            <TableCell>\n                              <div className=\"flex space-x-2\">\n                                {user.role !== 'admin' && (\n                                  <Button \n                                    variant=\"destructive\" \n                                    size=\"sm\"\n                                    onClick={() => handleDeleteUser(user.id)}\n                                  >\n                                    <Trash2 className=\"h-4 w-4\" />\n                                  </Button>\n                                )}\n                              </div>\n                            </TableCell>\n                          </TableRow>\n                        ))\n                      )}\n                    </TableBody>\n                  </Table>\n                </div>\n              )}\n            </div>\n          </TabsContent>\n        )}\n      </Tabs>\n\n      {/* 삭제 확인 대화 상자 */}\n      <AlertDialog open={isDeleteAlertOpen} onOpenChange={setIsDeleteAlertOpen}>\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>\n              {currentDeleteType === 'properties' && '부동산 매물 일괄 삭제'}\n              {currentDeleteType === 'news' && '뉴스 일괄 삭제'}\n              {currentDeleteType === 'users' && '사용자 일괄 삭제'}\n            </AlertDialogTitle>\n            <AlertDialogDescription>\n              {currentDeleteType === 'properties' && \n                `선택한 ${selectedProperties.length}개의 부동산 매물을 삭제하시겠습니까?`}\n              {currentDeleteType === 'news' && \n                `선택한 ${selectedNews.length}개의 뉴스를 삭제하시겠습니까?`}\n              {currentDeleteType === 'users' && \n                `선택한 ${selectedUsers.length}명의 사용자를 삭제하시겠습니까? 관리자 계정은 삭제되지 않습니다.`}\n              <div className=\"mt-2 text-red-500\">이 작업은 되돌릴 수 없습니다.</div>\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel>취소</AlertDialogCancel>\n            <AlertDialogAction onClick={handleBatchDelete} className=\"bg-destructive\">\n              삭제\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n    </div>\n  );\n}","path":null,"size_bytes":44004,"size_tokens":null},"client/src/pages/AgentDetailPage.tsx":{"content":"import { useParams } from \"wouter\";\nimport AgentDetail from \"@/components/agent/AgentDetail\";\nimport { Helmet } from \"react-helmet\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { Agent } from \"@shared/schema\";\n\nconst AgentDetailPage = () => {\n  const { id } = useParams<{ id: string }>();\n  \n  const { data: agent } = useQuery<Agent>({\n    queryKey: [`/api/agents/${id}`],\n    enabled: !!id,\n  });\n\n  return (\n    <div className=\"pt-16\"> {/* Offset for fixed header */}\n      <Helmet>\n        <title>\n          {agent ? `${agent.name} | 중개사 소개 | 이가이버 부동산` : \"중개사 상세 | 이가이버 부동산\"}\n        </title>\n        <meta \n          name=\"description\" \n          content={agent ? \n            `${agent.description} - 이가이버 부동산 ${agent.title} ${agent.name}의 상세 프로필입니다.` : \n            \"이가이버 부동산의 전문 중개사 프로필을 확인하세요. 풍부한 경험과 노하우를 바탕으로 최상의 부동산 서비스를 제공합니다.\"\n          }\n        />\n        <meta property=\"og:title\" content={agent ? `${agent.name} | 중개사 소개 | 이가이버 부동산` : \"중개사 상세 | 이가이버 부동산\"} />\n        <meta property=\"og:type\" content=\"website\" />\n        <meta \n          property=\"og:description\" \n          content={agent ? \n            `${agent.description} - 이가이버 부동산 ${agent.title} ${agent.name}의 상세 프로필입니다.` : \n            \"이가이버 부동산의 전문 중개사 프로필을 확인하세요. 풍부한 경험과 노하우를 바탕으로 최상의 부동산 서비스를 제공합니다.\"\n          }\n        />\n        {agent && <meta property=\"og:image\" content={agent.imageUrl} />}\n      </Helmet>\n      \n      <AgentDetail agentId={id} />\n    </div>\n  );\n};\n\nexport default AgentDetailPage;\n","path":null,"size_bytes":1864,"size_tokens":null},"server/cache.ts":{"content":"/**\n * 간단한 메모리 캐시 구현\n * 자주 조회되고 변경이 적은 데이터를 캐싱하여 DB 쿼리 횟수를 줄이는 목적\n */\n\ninterface CacheItem<T> {\n  value: T;\n  expiry: number;\n  timestamp: number; // 캐시 생성 시간 추가\n}\n\nclass MemoryCache {\n  private cache: Map<string, CacheItem<any>> = new Map();\n  private readonly DEFAULT_TTL = 5 * 60 * 1000; // 5분 기본 캐시 시간\n\n  /**\n   * 캐시에서 값을 가져옴\n   * @param key 캐시 키\n   * @returns 캐시된 값 또는 undefined (만료 또는 없음)\n   */\n  get<T>(key: string): T | undefined {\n    const item = this.cache.get(key);\n    \n    // 캐시 항목이 없거나 만료된 경우\n    if (!item || Date.now() > item.expiry) {\n      if (item) this.cache.delete(key); // 만료된 항목 제거\n      return undefined;\n    }\n    \n    return item.value as T;\n  }\n\n  /**\n   * 캐시에 값을 저장\n   * @param key 캐시 키\n   * @param value 저장할 값\n   * @param ttl 캐시 유효 시간(ms), 기본값 5분\n   */\n  set<T>(key: string, value: T, ttl: number = this.DEFAULT_TTL): void {\n    const now = Date.now();\n    const expiry = now + ttl;\n    this.cache.set(key, { value, expiry, timestamp: now });\n  }\n  \n  /**\n   * 캐시 항목이 생성된 시간을 반환\n   * @param key 캐시 키\n   * @returns 캐시 생성 시간(타임스탬프) 또는 undefined (캐시 없음)\n   */\n  getTimestamp(key: string): number | undefined {\n    const item = this.cache.get(key);\n    return item ? item.timestamp : undefined;\n  }\n\n  /**\n   * 특정 키의 캐시 삭제\n   * @param key 삭제할 캐시 키\n   */\n  delete(key: string): void {\n    this.cache.delete(key);\n  }\n\n  /**\n   * 특정 프리픽스로 시작하는 모든 캐시 삭제\n   * @param prefix 캐시 키 프리픽스\n   */\n  deleteByPrefix(prefix: string): void {\n    // Array.from으로 변환하여 이터레이터 이슈 해결\n    Array.from(this.cache.keys()).forEach(key => {\n      if (key.startsWith(prefix)) {\n        this.cache.delete(key);\n      }\n    });\n  }\n\n  /**\n   * 모든 캐시 삭제\n   */\n  clear(): void {\n    this.cache.clear();\n  }\n\n  /**\n   * 만료된 모든 캐시 항목 삭제 (정리)\n   */\n  cleanup(): void {\n    const now = Date.now();\n    for (const [key, item] of this.cache.entries()) {\n      if (now > item.expiry) {\n        this.cache.delete(key);\n      }\n    }\n  }\n}\n\n// 싱글톤 인스턴스 생성\nexport const memoryCache = new MemoryCache();\n\n// 주기적으로 만료된 캐시 항목 정리 (5분마다)\nsetInterval(() => {\n  memoryCache.cleanup();\n}, 5 * 60 * 1000);","path":null,"size_bytes":2587,"size_tokens":null},"server/real-estate-api.ts":{"content":"import fetch from 'node-fetch';\nimport { XMLParser } from 'fast-xml-parser';\nimport { memoryCache } from './cache';\n\n// 추가 디버깅 옵션 (API 호출 문제 진단용)\nconst DEBUG_API_CALLS = true;\n\n// 부동산 실거래가 데이터 타입 정의\nexport interface RealEstateTransaction {\n  거래금액: string;\n  건축년도?: string;\n  년: string;\n  월: string;\n  일: string;\n  아파트?: string;\n  주택유형?: string;\n  토지거래구분?: string;\n  전용면적?: string;\n  법정동?: string;\n  지번?: string;\n  지역코드?: string;\n  층?: string;\n  type: string;\n  address?: string;\n  lat?: number;  // 위도 (주소 변환 후)\n  lng?: number;  // 경도 (주소 변환 후)\n}\n\n// 아파트 매매 실거래가 조회\nexport async function getApartmentTransactions(params: {\n  LAWD_CD: string; // 지역코드 (강화군: 28710)\n  DEAL_YMD: string; // 계약년월(YYYYMM)\n}): Promise<RealEstateTransaction[]> {\n  // 재발급된 인증키로 URL 호출: 인코딩된 키를 직접 사용\n  const baseUrl = 'http://openapi.molit.go.kr/OpenAPI_ToolInstallPackage/service/rest/RTMSOBJSvc/getRTMSDataSvcAptTradeDev';\n  const serviceKey = process.env.DATA_GO_KR_API_KEY;\n\n  if (!serviceKey) {\n    throw new Error('DATA_GO_KR_API_KEY 환경변수가 설정되지 않았습니다');\n  }\n\n  // 캐시 키 생성\n  const cacheKey = `apartment-transactions-${params.LAWD_CD}-${params.DEAL_YMD}`;\n  \n  // 캐시에 데이터가 있는지 확인\n  const cachedData = memoryCache.get<RealEstateTransaction[]>(cacheKey);\n  if (cachedData) {\n    console.log(`캐시된 아파트 실거래 데이터 반환: ${params.LAWD_CD}, ${params.DEAL_YMD}`);\n    return cachedData;\n  }\n\n  // URL 구성 - URL 인코딩 없이 직접 사용\n  const url = `${baseUrl}?serviceKey=${serviceKey}&LAWD_CD=${params.LAWD_CD}&DEAL_YMD=${params.DEAL_YMD}`;\n  \n  try {\n    console.log(`아파트 실거래 데이터 요청: ${params.LAWD_CD}, ${params.DEAL_YMD}`);\n    console.log('요청 URL:', url);\n    \n    // 요청 헤더 및 User-Agent 추가 (CORS 방지)\n    const response = await fetch(url, {\n      method: 'GET',\n      headers: {\n        'Accept': 'application/xml',\n        'Content-Type': 'application/xml',\n        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36'\n      }\n    });\n    \n    if (!response.ok) {\n      console.error(`HTTP 오류: ${response.status} ${response.statusText}`);\n      throw new Error(`HTTP 오류: ${response.status}`);\n    }\n    \n    const xmlData = await response.text();\n    \n    // 디버깅: XML 응답 전체 출력 (문제 진단용)\n    if(DEBUG_API_CALLS) {\n      console.log('API 응답 전체:', xmlData);\n    } else {\n      console.log('API 응답 일부:', xmlData.substring(0, 300));\n    }\n    \n    // XML 파서 설정\n    const parser = new XMLParser({\n      ignoreAttributes: false,\n      attributeNamePrefix: '@_',\n      textNodeName: '#text'\n    });\n    \n    // XML을 JSON으로 변환\n    const result = parser.parse(xmlData);\n    \n    // 디버깅: 파싱된 결과 구조 출력\n    console.log('파싱된 결과 구조:', JSON.stringify(result).substring(0, 300));\n    \n    // 응답 에러 확인\n    if (!result.response) {\n      console.error('API 응답 형식 오류: response 객체 없음');\n      return [];\n    }\n    \n    // 결과코드 확인 (API별로 다를 수 있음)\n    const resultCode = result.response.header?.resultCode;\n    if (resultCode && resultCode !== '00') {\n      const errorMsg = result.response.header?.resultMsg || '알 수 없는 오류';\n      console.error(`API 오류: ${errorMsg}`);\n      return [];\n    }\n    \n    // 데이터가 없는 경우\n    if (!result.response.body?.items?.item) {\n      console.log('API 응답: 데이터 없음');\n      return [];\n    }\n    \n    // 데이터 추출 및 변환\n    let items = [];\n    if (Array.isArray(result.response.body.items.item)) {\n      items = result.response.body.items.item;\n    } else {\n      items = [result.response.body.items.item];\n    }\n    \n    // 데이터 정제 및 변환\n    const transactions: RealEstateTransaction[] = items.map((item: any) => {\n      // 주소 생성\n      const legalDong = item.법정동 || '';\n      const jibun = item.지번 || '';\n      const address = `인천 강화군 ${legalDong} ${jibun}`;\n      \n      // 거래금액은 문자열이며, 쉼표와 공백 제거\n      let dealAmount = item.거래금액 || '';\n      if (typeof dealAmount === 'string') {\n        dealAmount = dealAmount.trim().replace(/,/g, '');\n      }\n      \n      return {\n        거래금액: dealAmount,\n        건축년도: item.건축년도,\n        년: item.년,\n        월: item.월,\n        일: item.일,\n        아파트: item.아파트,\n        전용면적: item.전용면적,\n        법정동: legalDong,\n        지번: jibun,\n        지역코드: item.지역코드,\n        층: item.층,\n        type: '아파트',\n        address\n      };\n    });\n\n    // 캐시에 데이터 저장 (2시간 동안)\n    memoryCache.set(cacheKey, transactions, 2 * 60 * 60 * 1000);\n    \n    console.log(`${transactions.length}개의 아파트 실거래 데이터 조회 완료`);\n    return transactions;\n  } catch (error) {\n    console.error('아파트 실거래 데이터 조회 오류:', error);\n    return [];\n  }\n}\n\n// 단독다가구 매매 실거래가 조회\nexport async function getHouseTransactions(params: {\n  LAWD_CD: string; // 지역코드 (강화군: 28710)\n  DEAL_YMD: string; // 계약년월(YYYYMM)\n}): Promise<RealEstateTransaction[]> {\n  const baseUrl = 'http://openapi.molit.go.kr:8081/OpenAPI_ToolInstallPackage/service/rest/RTMSOBJSvc/getRTMSDataSvcSHTrade';\n  const serviceKey = process.env.DATA_GO_KR_API_KEY;\n\n  if (!serviceKey) {\n    throw new Error('DATA_GO_KR_API_KEY 환경변수가 설정되지 않았습니다');\n  }\n\n  // 캐시 키 생성\n  const cacheKey = `house-transactions-${params.LAWD_CD}-${params.DEAL_YMD}`;\n  \n  // 캐시에 데이터가 있는지 확인\n  const cachedData = memoryCache.get<RealEstateTransaction[]>(cacheKey);\n  if (cachedData) {\n    console.log(`캐시된 단독다가구 실거래 데이터 반환: ${params.LAWD_CD}, ${params.DEAL_YMD}`);\n    return cachedData;\n  }\n\n  // URL 구성 - URL 인코딩 없이 직접 사용\n  const url = `${baseUrl}?serviceKey=${serviceKey}&LAWD_CD=${params.LAWD_CD}&DEAL_YMD=${params.DEAL_YMD}`;\n  \n  try {\n    console.log(`단독다가구 실거래 데이터 요청: ${params.LAWD_CD}, ${params.DEAL_YMD}`);\n    console.log('요청 URL:', url);\n    \n    // 요청 헤더 및 User-Agent 추가 (CORS 방지)\n    const response = await fetch(url, {\n      method: 'GET',\n      headers: {\n        'Accept': 'application/xml',\n        'Content-Type': 'application/xml',\n        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36'\n      }\n    });\n    \n    if (!response.ok) {\n      console.error(`HTTP 오류: ${response.status} ${response.statusText}`);\n      throw new Error(`HTTP 오류: ${response.status}`);\n    }\n    \n    const xmlData = await response.text();\n    \n    // XML 파서 설정\n    const parser = new XMLParser({\n      ignoreAttributes: false,\n      attributeNamePrefix: '@_',\n      textNodeName: '#text'\n    });\n    \n    // XML을 JSON으로 변환\n    const result = parser.parse(xmlData);\n    \n    // 응답 에러 확인\n    if (!result.response) {\n      console.error('API 응답 형식 오류: response 객체 없음');\n      return [];\n    }\n    \n    // 결과코드 확인\n    const resultCode = result.response.header?.resultCode;\n    if (resultCode && resultCode !== '00') {\n      const errorMsg = result.response.header?.resultMsg || '알 수 없는 오류';\n      console.error(`API 오류: ${errorMsg}`);\n      return [];\n    }\n    \n    // 데이터가 없는 경우\n    if (!result.response.body?.items?.item) {\n      console.log('API 응답: 데이터 없음');\n      return [];\n    }\n    \n    // 데이터 추출 및 변환\n    let items = [];\n    if (Array.isArray(result.response.body.items.item)) {\n      items = result.response.body.items.item;\n    } else {\n      items = [result.response.body.items.item];\n    }\n    \n    // 데이터 정제 및 변환\n    const transactions: RealEstateTransaction[] = items.map((item: any) => {\n      // 주소 생성\n      const legalDong = item.법정동 || '';\n      const jibun = item.지번 || '';\n      const address = `인천 강화군 ${legalDong} ${jibun}`;\n      \n      // 거래금액은 문자열이며, 쉼표와 공백 제거\n      let dealAmount = item.거래금액 || '';\n      if (typeof dealAmount === 'string') {\n        dealAmount = dealAmount.trim().replace(/,/g, '');\n      }\n      \n      return {\n        거래금액: dealAmount,\n        건축년도: item.건축년도,\n        년: item.년,\n        월: item.월,\n        일: item.일,\n        주택유형: item.주택유형,\n        전용면적: item.연면적, // 단독주택은 연면적을 사용함\n        법정동: legalDong,\n        지번: jibun,\n        type: '단독다가구',\n        address\n      };\n    });\n\n    // 캐시에 데이터 저장 (2시간 동안)\n    memoryCache.set(cacheKey, transactions, 2 * 60 * 60 * 1000);\n    \n    console.log(`${transactions.length}개의 단독다가구 실거래 데이터 조회 완료`);\n    return transactions;\n  } catch (error) {\n    console.error('단독다가구 실거래 데이터 조회 오류:', error);\n    return [];\n  }\n}\n\n// 토지 매매 실거래가 조회\nexport async function getLandTransactions(params: {\n  LAWD_CD: string; // 지역코드 (강화군: 28710)\n  DEAL_YMD: string; // 계약년월(YYYYMM)\n}): Promise<RealEstateTransaction[]> {\n  const baseUrl = 'http://openapi.molit.go.kr/OpenAPI_ToolInstallPackage/service/rest/RTMSOBJSvc/getRTMSDataSvcLandTrade';\n  const serviceKey = process.env.DATA_GO_KR_API_KEY;\n\n  if (!serviceKey) {\n    throw new Error('DATA_GO_KR_API_KEY 환경변수가 설정되지 않았습니다');\n  }\n\n  // 캐시 키 생성\n  const cacheKey = `land-transactions-${params.LAWD_CD}-${params.DEAL_YMD}`;\n  \n  // 캐시에 데이터가 있는지 확인\n  const cachedData = memoryCache.get<RealEstateTransaction[]>(cacheKey);\n  if (cachedData) {\n    console.log(`캐시된 토지 실거래 데이터 반환: ${params.LAWD_CD}, ${params.DEAL_YMD}`);\n    return cachedData;\n  }\n\n  // URL 구성 - URL 인코딩 없이 직접 사용\n  const url = `${baseUrl}?serviceKey=${serviceKey}&LAWD_CD=${params.LAWD_CD}&DEAL_YMD=${params.DEAL_YMD}`;\n  \n  try {\n    console.log(`토지 실거래 데이터 요청: ${params.LAWD_CD}, ${params.DEAL_YMD}`);\n    console.log('요청 URL:', url);\n    \n    // 요청 헤더 및 User-Agent 추가 (CORS 방지)\n    const response = await fetch(url, {\n      method: 'GET',\n      headers: {\n        'Accept': 'application/xml',\n        'Content-Type': 'application/xml',\n        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36'\n      }\n    });\n    \n    if (!response.ok) {\n      console.error(`HTTP 오류: ${response.status} ${response.statusText}`);\n      throw new Error(`HTTP 오류: ${response.status}`);\n    }\n    \n    const xmlData = await response.text();\n    \n    // XML 파서 설정\n    const parser = new XMLParser({\n      ignoreAttributes: false,\n      attributeNamePrefix: '@_',\n      textNodeName: '#text'\n    });\n    \n    // XML을 JSON으로 변환\n    const result = parser.parse(xmlData);\n    \n    // 응답 에러 확인\n    if (!result.response) {\n      console.error('API 응답 형식 오류: response 객체 없음');\n      return [];\n    }\n    \n    // 결과코드 확인\n    const resultCode = result.response.header?.resultCode;\n    if (resultCode && resultCode !== '00') {\n      const errorMsg = result.response.header?.resultMsg || '알 수 없는 오류';\n      console.error(`API 오류: ${errorMsg}`);\n      return [];\n    }\n    \n    // 데이터가 없는 경우\n    if (!result.response.body?.items?.item) {\n      console.log('API 응답: 데이터 없음');\n      return [];\n    }\n    \n    // 데이터 추출 및 변환\n    let items = [];\n    if (Array.isArray(result.response.body.items.item)) {\n      items = result.response.body.items.item;\n    } else {\n      items = [result.response.body.items.item];\n    }\n    \n    // 데이터 정제 및 변환\n    const transactions: RealEstateTransaction[] = items.map((item: any) => {\n      // 주소 생성\n      const legalDong = item.법정동 || '';\n      const jibun = item.지번 || '';\n      const address = `인천 강화군 ${legalDong} ${jibun}`;\n      \n      // 거래금액은 문자열이며, 쉼표와 공백 제거\n      let dealAmount = item.거래금액 || '';\n      if (typeof dealAmount === 'string') {\n        dealAmount = dealAmount.trim().replace(/,/g, '');\n      }\n      \n      return {\n        거래금액: dealAmount,\n        년: item.년,\n        월: item.월,\n        일: item.일,\n        토지거래구분: item.토지거래구분,\n        법정동: legalDong,\n        지번: jibun,\n        type: '토지',\n        address\n      };\n    });\n\n    // 캐시에 데이터 저장 (2시간 동안)\n    memoryCache.set(cacheKey, transactions, 2 * 60 * 60 * 1000);\n    \n    console.log(`${transactions.length}개의 토지 실거래 데이터 조회 완료`);\n    return transactions;\n  } catch (error) {\n    console.error('토지 실거래 데이터 조회 오류:', error);\n    return [];\n  }\n}\n\n// 최근 3개월간의 실거래 데이터 조회\nexport async function getRecentTransactions(regionCode: string = '28710'): Promise<RealEstateTransaction[]> {\n  try {\n    console.log(`실거래가 데이터 요청: 지역코드=${regionCode}`);\n    \n    // 현재 날짜 기준으로 최근 3개월간의 데이터 조회\n    const today = new Date();\n    const months = [];\n    \n    for (let i = 0; i < 3; i++) {\n      const date = new Date(today);\n      date.setMonth(date.getMonth() - i);\n      const year = date.getFullYear();\n      const month = String(date.getMonth() + 1).padStart(2, '0');\n      months.push(`${year}${month}`);\n    }\n    \n    console.log(`최근 3개월 데이터 조회: ${months.join(', ')}`);\n\n    // 모든 타입의 실거래 데이터를 병렬로 조회\n    const allTransactionsPromises = months.flatMap(month => [\n      getApartmentTransactions({ LAWD_CD: regionCode, DEAL_YMD: month }),\n      getHouseTransactions({ LAWD_CD: regionCode, DEAL_YMD: month }),\n      getLandTransactions({ LAWD_CD: regionCode, DEAL_YMD: month })\n    ]);\n    \n    const allTransactions = await Promise.all(allTransactionsPromises);\n\n    // 모든 데이터 합치기\n    const transactions = allTransactions.flat();\n    \n    console.log(`총 ${transactions.length}개의 실거래 데이터 조회 완료`);\n    return transactions;\n  } catch (error) {\n    console.error('실거래 데이터 조회 오류:', error);\n    return [];\n  }\n}","path":null,"size_bytes":15038,"size_tokens":null},"client/src/components/ui/carousel.tsx":{"content":"import * as React from \"react\"\nimport useEmblaCarousel, {\n  type UseEmblaCarouselType,\n} from \"embla-carousel-react\"\nimport { ArrowLeft, ArrowRight } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\n\ntype CarouselApi = UseEmblaCarouselType[1]\ntype UseCarouselParameters = Parameters<typeof useEmblaCarousel>\ntype CarouselOptions = UseCarouselParameters[0]\ntype CarouselPlugin = UseCarouselParameters[1]\n\ntype CarouselProps = {\n  opts?: CarouselOptions\n  plugins?: CarouselPlugin\n  orientation?: \"horizontal\" | \"vertical\"\n  setApi?: (api: CarouselApi) => void\n}\n\ntype CarouselContextProps = {\n  carouselRef: ReturnType<typeof useEmblaCarousel>[0]\n  api: ReturnType<typeof useEmblaCarousel>[1]\n  scrollPrev: () => void\n  scrollNext: () => void\n  canScrollPrev: boolean\n  canScrollNext: boolean\n} & CarouselProps\n\nconst CarouselContext = React.createContext<CarouselContextProps | null>(null)\n\nfunction useCarousel() {\n  const context = React.useContext(CarouselContext)\n\n  if (!context) {\n    throw new Error(\"useCarousel must be used within a <Carousel />\")\n  }\n\n  return context\n}\n\nconst Carousel = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & CarouselProps\n>(\n  (\n    {\n      orientation = \"horizontal\",\n      opts,\n      setApi,\n      plugins,\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const [carouselRef, api] = useEmblaCarousel(\n      {\n        ...opts,\n        axis: orientation === \"horizontal\" ? \"x\" : \"y\",\n      },\n      plugins\n    )\n    const [canScrollPrev, setCanScrollPrev] = React.useState(false)\n    const [canScrollNext, setCanScrollNext] = React.useState(false)\n\n    const onSelect = React.useCallback((api: CarouselApi) => {\n      if (!api) {\n        return\n      }\n\n      setCanScrollPrev(api.canScrollPrev())\n      setCanScrollNext(api.canScrollNext())\n    }, [])\n\n    const scrollPrev = React.useCallback(() => {\n      api?.scrollPrev()\n    }, [api])\n\n    const scrollNext = React.useCallback(() => {\n      api?.scrollNext()\n    }, [api])\n\n    const handleKeyDown = React.useCallback(\n      (event: React.KeyboardEvent<HTMLDivElement>) => {\n        if (event.key === \"ArrowLeft\") {\n          event.preventDefault()\n          scrollPrev()\n        } else if (event.key === \"ArrowRight\") {\n          event.preventDefault()\n          scrollNext()\n        }\n      },\n      [scrollPrev, scrollNext]\n    )\n\n    React.useEffect(() => {\n      if (!api || !setApi) {\n        return\n      }\n\n      setApi(api)\n    }, [api, setApi])\n\n    React.useEffect(() => {\n      if (!api) {\n        return\n      }\n\n      onSelect(api)\n      api.on(\"reInit\", onSelect)\n      api.on(\"select\", onSelect)\n\n      return () => {\n        api?.off(\"select\", onSelect)\n      }\n    }, [api, onSelect])\n\n    return (\n      <CarouselContext.Provider\n        value={{\n          carouselRef,\n          api: api,\n          opts,\n          orientation:\n            orientation || (opts?.axis === \"y\" ? \"vertical\" : \"horizontal\"),\n          scrollPrev,\n          scrollNext,\n          canScrollPrev,\n          canScrollNext,\n        }}\n      >\n        <div\n          ref={ref}\n          onKeyDownCapture={handleKeyDown}\n          className={cn(\"relative\", className)}\n          role=\"region\"\n          aria-roledescription=\"carousel\"\n          {...props}\n        >\n          {children}\n        </div>\n      </CarouselContext.Provider>\n    )\n  }\n)\nCarousel.displayName = \"Carousel\"\n\nconst CarouselContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { carouselRef, orientation } = useCarousel()\n\n  return (\n    <div ref={carouselRef} className=\"overflow-hidden\">\n      <div\n        ref={ref}\n        className={cn(\n          \"flex\",\n          orientation === \"horizontal\" ? \"-ml-4\" : \"-mt-4 flex-col\",\n          className\n        )}\n        {...props}\n      />\n    </div>\n  )\n})\nCarouselContent.displayName = \"CarouselContent\"\n\nconst CarouselItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { orientation } = useCarousel()\n\n  return (\n    <div\n      ref={ref}\n      role=\"group\"\n      aria-roledescription=\"slide\"\n      className={cn(\n        \"min-w-0 shrink-0 grow-0 basis-full\",\n        orientation === \"horizontal\" ? \"pl-4\" : \"pt-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nCarouselItem.displayName = \"CarouselItem\"\n\nconst CarouselPrevious = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollPrev, canScrollPrev } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute  h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-left-12 top-1/2 -translate-y-1/2\"\n          : \"-top-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollPrev}\n      onClick={scrollPrev}\n      {...props}\n    >\n      <ArrowLeft className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Previous slide</span>\n    </Button>\n  )\n})\nCarouselPrevious.displayName = \"CarouselPrevious\"\n\nconst CarouselNext = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollNext, canScrollNext } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-right-12 top-1/2 -translate-y-1/2\"\n          : \"-bottom-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollNext}\n      onClick={scrollNext}\n      {...props}\n    >\n      <ArrowRight className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Next slide</span>\n    </Button>\n  )\n})\nCarouselNext.displayName = \"CarouselNext\"\n\nexport {\n  type CarouselApi,\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselPrevious,\n  CarouselNext,\n}\n","path":null,"size_bytes":6210,"size_tokens":null},"client/src/lib/queryClient.ts":{"content":"import { QueryClient, QueryFunction } from \"@tanstack/react-query\";\n\nasync function throwIfResNotOk(res: Response) {\n  if (!res.ok) {\n    const text = (await res.text()) || res.statusText;\n    throw new Error(`${res.status}: ${text}`);\n  }\n}\n\nexport async function apiRequest(\n  method: string,\n  url: string,\n  data?: unknown | undefined,\n): Promise<Response> {\n  const res = await fetch(url, {\n    method,\n    headers: data ? { \"Content-Type\": \"application/json\" } : {},\n    body: data ? JSON.stringify(data) : undefined,\n    credentials: \"include\",\n  });\n\n  await throwIfResNotOk(res);\n  return res;\n}\n\ntype UnauthorizedBehavior = \"returnNull\" | \"throw\";\nexport const getQueryFn: <T>(options: {\n  on401: UnauthorizedBehavior;\n  customUrl?: string;\n}) => QueryFunction<T> =\n  ({ on401: unauthorizedBehavior, customUrl }) =>\n  async ({ queryKey }) => {\n    // customUrl이 제공되면 그것을 사용, 아니면 queryKey\n    let url = customUrl || (queryKey[0] as string);\n    \n    // 두 번째 queryKey가 파라미터 객체인 경우 URL 쿼리 파라미터로 변환\n    if (queryKey.length > 1 && typeof queryKey[1] === 'object') {\n      const params = new URLSearchParams();\n      Object.entries(queryKey[1] as Record<string, any>).forEach(([key, value]) => {\n        if (value !== undefined) {\n          params.append(key, String(value));\n        }\n      });\n      const queryString = params.toString();\n      url = queryString ? `${url}?${queryString}` : url;\n    }\n    \n    const res = await fetch(url, {\n      credentials: \"include\",\n    });\n\n    if (unauthorizedBehavior === \"returnNull\" && res.status === 401) {\n      return null;\n    }\n\n    await throwIfResNotOk(res);\n    return await res.json();\n  };\n\nexport const queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      queryFn: getQueryFn({ on401: \"throw\" }),\n      refetchInterval: false,\n      refetchOnWindowFocus: false,\n      staleTime: 5 * 60 * 1000, // 5분 동안 캐시 유지\n      retry: false,\n      gcTime: 10 * 60 * 1000, // 10분 동안 비활성 캐시 유지\n      // 성능 향상을 위한 옵션\n      refetchOnMount: false,\n    },\n    mutations: {\n      retry: false,\n    },\n  },\n});\n","path":null,"size_bytes":2193,"size_tokens":null},"client/src/pages/admin-page-fixed.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { getQueryFn, apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Property, User, News, insertPropertySchema } from \"@shared/schema\";\nimport * as z from \"zod\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { \n  RefreshCw, Settings, ListFilter, Layout, LogOut, Plus, \n  Trash2, Edit, Loader2, Check, Home, X, MoreHorizontal\n} from \"lucide-react\";\n\n// 기본 UI 컴포넌트\nimport {\n  Card,\n  CardContent,\n  CardDescription,\n  CardHeader,\n  CardTitle,\n} from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport {\n  Table,\n  TableBody,\n  TableCaption,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"@/components/ui/table\";\nimport {\n  Form,\n  FormControl,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from \"@/components/ui/form\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport {\n  Breadcrumb,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  BreadcrumbList,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n} from \"@/components/ui/breadcrumb\";\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from \"@/components/ui/alert-dialog\";\n\n// 폼 스키마\nconst propertyFormSchema = insertPropertySchema.extend({\n  price: z.string().optional(),\n  size: z.string().optional(),\n  supplyArea: z.string().optional(),\n  privateArea: z.string().optional(),\n  floor: z.string().optional(),\n  totalFloors: z.string().optional(),\n  deposit: z.string().optional(),\n  monthlyRent: z.string().optional(),\n  maintenanceFee: z.string().optional(),\n});\n\ntype PropertyFormValues = z.infer<typeof propertyFormSchema>;\n\n// 부동산 유형 목록\nconst propertyTypes = [\"토지\", \"주택\", \"아파트연립다세대\", \"원투룸\", \"상가공장창고펜션\"];\n\n// 읍면 리스트\nconst districts = [\n  \"강화읍\",\n  \"교동면\",\n  \"길상면\",\n  \"내가면\",\n  \"불은면\",\n  \"삼산면\",\n  \"서도면\",\n  \"선원면\",\n  \"송해면\",\n  \"양도면\",\n  \"양사면\",\n  \"하점면\",\n  \"화도면\",\n  \"강화외지역\"\n];\n\n// 거래 종류\nconst dealTypes = [\"매매\", \"전세\", \"월세\", \"완료\", \"보류중\"];\n\n// 세부 지역 정보\nconst detailedDistricts: { [key: string]: string[] } = {\n  \"강화읍\": [\"강화읍 갑곳리\", \"강화읍 관청리\", \"강화읍 국화리\", \"강화읍 남산리\", \"강화읍 대산리\", \"강화읍 신문리\", \"강화읍 옥림리\", \"강화읍 용정리\", \"강화읍 월곳리\"],\n  \"교동면\": [\"교동면 고구리\", \"교동면 난정리\", \"교동면 대룡리\", \"교동면 동산리\", \"교동면 무학리\", \"교동면 봉소리\", \"교동면 삼선리\", \"교동면 상용리\", \"교동면 서한리\", \"교동면 양갑리\", \"교동면 읍내리\", \"교동면 인사리\", \"교동면 지석리\"],\n  \"길상면\": [\"길상면 길직리\", \"길상면 동검리\", \"길상면 선두리\", \"길상면 온수리\", \"길상면 장흥리\", \"길상면 초지리\"],\n  \"내가면\": [\"내가면 고천리\", \"내가면 구하리\", \"내가면 오상리\", \"내가면 외포리\", \"내가면 황청리\"],\n  \"불은면\": [\"불은면 고능리\", \"불은면 넙성리\", \"불은면 덕성리\", \"불은면 두운리\", \"불은면 삼동암리\", \"불은면 삼성리\", \"불은면 신현리\", \"불은면 오두리\"],\n  \"삼산면\": [\"삼산면 매음리\", \"삼산면 미법리\", \"삼산면 상리\", \"삼산면 서검리\", \"삼산면 석모리\", \"삼산면 석포리\", \"삼산면 하리\"],\n  \"서도면\": [\"서도면 말도리\", \"서도면 볼음도리\", \"서도면 아차도리\", \"서도면 주문도리\"],\n  \"선원면\": [\"선원면 금월리\", \"선원면 냉정리\", \"선원면 선행리\", \"선원면 신정리\", \"선원면 연리\", \"선원면 지산리\", \"선원면 창리\"],\n  \"송해면\": [\"송해면 당산리\", \"송해면 상도리\", \"송해면 솔정리\", \"송해면 숭뢰리\", \"송해면 신당리\", \"송해면 양오리\", \"송해면 하도리\"],\n  \"양도면\": [\"양도면 건평리\", \"양도면 길정리\", \"양도면 능내리\", \"양도면 도장리\", \"양도면 삼흥리\", \"양도면 인산리\", \"양도면 조산리\", \"양도면 하일리\"],\n  \"양사면\": [\"양사면 교산리\", \"양사면 덕하리\", \"양사면 북성리\", \"양사면 인화리\", \"양사면 철산리\"],\n  \"하점면\": [\"하점면 망월리\", \"하점면 부근리\", \"하점면 삼거리\", \"하점면 신봉리\", \"하점면 신삼리\", \"하점면 이강리\", \"하점면 장정리\", \"하점면 창후리\"],\n  \"화도면\": [\"화도면 내리\", \"화도면 덕포리\", \"화도면 동막리\", \"화도면 문산리\", \"화도면 사기리\", \"화도면 상방리\", \"화도면 여차리\", \"화도면 장화리\", \"화도면 흥왕리\"],\n  \"강화외지역\": [\"기타지역\"]\n};\n\nexport default function AdminPageFixed() {\n  const { user: currentUser } = useAuth();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [activeTab, setActiveTab] = useState(\"properties\");\n  const [showPropertyForm, setShowPropertyForm] = useState(false);\n  const [editingProperty, setEditingProperty] = useState<Property | null>(null);\n  const [isDeleting, setIsDeleting] = useState<number | false>(false);\n  const [isDeletingUser, setIsDeletingUser] = useState<number | false>(false);\n  const [isDeletingNews, setIsDeletingNews] = useState<number | false>(false);\n  const [isUpdatingNews, setIsUpdatingNews] = useState(false);\n  const [selectedMainDistrict, setSelectedMainDistrict] = useState(\"강화읍\");\n  const [detailedDistrictOptions, setDetailedDistrictOptions] = useState<string[]>(\n    detailedDistricts[\"강화읍\"]\n  );\n  \n  // 클라이언트 측 데이터 관리\n  const [localProperties, setLocalProperties] = useState<Property[]>([]);\n  const [propertiesLoaded, setPropertiesLoaded] = useState(false);\n  const [localUsers, setLocalUsers] = useState<User[]>([]);\n  const [usersLoaded, setUsersLoaded] = useState(false);\n  const [localNews, setLocalNews] = useState<News[]>([]);\n  const [newsLoaded, setNewsLoaded] = useState(false);\n  \n  // 다중 선택 관련 상태\n  const [selectedProperties, setSelectedProperties] = useState<number[]>([]);\n  const [selectedNews, setSelectedNews] = useState<number[]>([]);\n  const [selectedUsers, setSelectedUsers] = useState<number[]>([]);\n  const [isDeleteAlertOpen, setIsDeleteAlertOpen] = useState(false);\n  const [currentDeleteType, setCurrentDeleteType] = useState<'properties' | 'news' | 'users' | null>(null);\n  \n  // 필터 상태\n  const [filterType, setFilterType] = useState<string>(\"\");\n  const [filterDistrict, setFilterDistrict] = useState<string>(\"\");\n  const [filterDealType, setFilterDealType] = useState<string>(\"\");\n  \n  // 필터링에 사용할 목록들\n  const propertyTypes = [\"토지\", \"주택\", \"아파트연립다세대\", \"원투룸\", \"상가공장창고펜션\"];\n  const dealTypes = [\"매매\", \"전세\", \"월세\", \"단기임대\"];\n  \n  // 지역 목록 (district)\n  const districts = [\n    \"강화읍 갑곳리\",\n    \"강화읍 관청리\",\n    \"강화읍 국화리\",\n    \"강화읍 남산리\",\n    \"강화읍 대산리\",\n    \"강화읍 신문리\",\n    \"강화읍 옥림리\",\n    \"강화읍 용정리\",\n    \"화도면 장화리\",\n    \"길상면 길직리\",\n    \"길상면 선두리\",\n    \"길상면 온수리\",\n    \"길상면 장흥리\",\n    \"길상면 초지리\"\n  ];\n\n  // 기본 폼 값\n  const defaultFormValues: PropertyFormValues = {\n    title: \"\",\n    description: \"\",\n    type: \"토지\",\n    price: \"\",\n    district: detailedDistricts[selectedMainDistrict][0],\n    address: \"\",\n    size: \"\",\n    imageUrl: \"\",\n    agentId: 1,\n    bedrooms: 0,\n    bathrooms: 0,\n    featured: false,\n    dealType: [\"매매\"],\n    \n    // 추가 필드들 (빈 문자열로 초기화)\n    buildingName: \"\",\n    unitNumber: \"\",\n    supplyArea: \"\",\n    privateArea: \"\",\n    areaSize: \"\",\n    floor: \"\",\n    totalFloors: \"\",\n    direction: \"\",\n    elevator: false,\n    parking: \"\",\n    heatingSystem: \"\",\n    approvalDate: \"\",\n    deposit: \"\",\n    monthlyRent: \"\",\n    maintenanceFee: \"\",\n    ownerName: \"\",\n    ownerPhone: \"\",\n    tenantName: \"\",\n    tenantPhone: \"\",\n    clientName: \"\",\n    clientPhone: \"\",\n    specialNote: \"\",\n    coListing: false,\n    propertyDescription: \"\",\n    privateNote: \"\",\n  };\n\n  // 부동산 등록/수정 폼\n  const form = useForm<PropertyFormValues>({\n    resolver: zodResolver(propertyFormSchema),\n    defaultValues: defaultFormValues,\n  });\n\n  // 부동산 목록 조회\n  const {\n    data: properties,\n    isLoading: isLoadingProperties,\n    error: propertiesError,\n  } = useQuery<Property[]>({\n    queryKey: [\"/api/properties\"],\n    queryFn: getQueryFn({ on401: \"throw\" })\n  });\n\n  // 프로퍼티 데이터 로딩 시 로컬 상태 업데이트\n  useEffect(() => {\n    if (properties && !propertiesLoaded) {\n      setLocalProperties(properties);\n      setPropertiesLoaded(true);\n      setSelectedProperties([]);\n    }\n  }, [properties, propertiesLoaded]);\n\n  // 사용자 목록 조회 (관리자만)\n  const {\n    data: users,\n    isLoading: isLoadingUsers,\n    error: usersError,\n  } = useQuery<User[]>({\n    queryKey: [\"/api/admin/users\"],\n    queryFn: getQueryFn({ on401: \"throw\" }),\n    enabled: currentUser?.role === \"admin\"\n  });\n\n  // 사용자 데이터 로딩 시 로컬 상태 업데이트\n  useEffect(() => {\n    if (users && !usersLoaded) {\n      setLocalUsers(users);\n      setUsersLoaded(true);\n      setSelectedUsers([]);\n    }\n  }, [users, usersLoaded]);\n  \n  // 뉴스 목록 조회\n  const {\n    data: news,\n    isLoading: isLoadingNews,\n    error: newsError,\n  } = useQuery<News[]>({\n    queryKey: [\"/api/news\"],\n    queryFn: getQueryFn({ on401: \"throw\" }),\n    onSuccess: (data) => {\n      if (!newsLoaded) {\n        setLocalNews(data);\n        setNewsLoaded(true);\n      }\n    }\n  });\n\n  // 부동산 생성 뮤테이션\n  const createPropertyMutation = useMutation({\n    mutationFn: async (data: PropertyFormValues) => {\n      console.log('부동산 등록 요청 데이터:', data);\n      const res = await apiRequest(\"POST\", \"/api/properties\", data);\n      return await res.json();\n    },\n    onSuccess: (newProperty) => {\n      // 클라이언트 측 상태 업데이트\n      setLocalProperties(prev => [...prev, newProperty]);\n      \n      // 서버 데이터 동기화 (백그라운드)\n      setTimeout(() => {\n        queryClient.invalidateQueries({ queryKey: [\"/api/properties\"] });\n      }, 100);\n      \n      toast({\n        title: \"부동산 등록 성공\",\n        description: \"새로운 부동산이 등록되었습니다.\",\n      });\n      setShowPropertyForm(false);\n      setEditingProperty(null);\n      form.reset(defaultFormValues);\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"부동산 등록 실패\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // 부동산 수정 뮤테이션\n  const updatePropertyMutation = useMutation({\n    mutationFn: async ({ id, data }: { id: number; data: PropertyFormValues }) => {\n      console.log('부동산 수정 요청 데이터:', data);\n      const res = await apiRequest(\"PATCH\", `/api/properties/${id}`, data);\n      return await res.json();\n    },\n    onSuccess: (updatedProperty) => {\n      // 클라이언트 측 상태 업데이트\n      setLocalProperties(prev => \n        prev.map(item => item.id === updatedProperty.id ? updatedProperty : item)\n      );\n      \n      // 서버 데이터 동기화 (백그라운드)\n      setTimeout(() => {\n        queryClient.invalidateQueries({ queryKey: [\"/api/properties\"] });\n      }, 100);\n      \n      toast({\n        title: \"부동산 수정 성공\",\n        description: \"부동산 정보가 수정되었습니다.\",\n      });\n      setShowPropertyForm(false);\n      setEditingProperty(null);\n      form.reset(defaultFormValues);\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"부동산 수정 실패\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // 부동산 삭제 뮤테이션\n  const deletePropertyMutation = useMutation({\n    mutationFn: async (id: number) => {\n      setIsDeleting(id);\n      const res = await apiRequest(\"DELETE\", `/api/properties/${id}`);\n      return { id, result: await res.json() };\n    },\n    onSuccess: ({ id, result }) => {\n      // 클라이언트 측 상태 업데이트\n      setLocalProperties(prev => prev.filter(item => item.id !== id));\n      \n      // 서버 데이터 동기화 (백그라운드)\n      setTimeout(() => {\n        queryClient.invalidateQueries({ queryKey: [\"/api/properties\"] });\n      }, 100);\n      \n      toast({\n        title: \"부동산 삭제 성공\",\n        description: \"부동산이 삭제되었습니다.\",\n      });\n      setIsDeleting(false);\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"부동산 삭제 실패\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n      setIsDeleting(false);\n    },\n  });\n  \n  // 사용자 삭제 뮤테이션\n  const deleteUserMutation = useMutation({\n    mutationFn: async (id: number) => {\n      setIsDeletingUser(id);\n      const res = await apiRequest(\"DELETE\", `/api/admin/users/${id}`);\n      return { id, result: await res.json() };\n    },\n    onSuccess: ({ id, result }) => {\n      // 클라이언트 측 상태 업데이트\n      setLocalUsers(prev => prev.filter(item => item.id !== id));\n      \n      // 서버 데이터 동기화 (백그라운드)\n      setTimeout(() => {\n        queryClient.invalidateQueries({ queryKey: [\"/api/admin/users\"] });\n      }, 100);\n      \n      toast({\n        title: \"사용자 삭제 성공\",\n        description: \"사용자가 성공적으로 삭제되었습니다.\",\n      });\n      setIsDeletingUser(false);\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"사용자 삭제 실패\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n      setIsDeletingUser(false);\n    },\n  });\n\n  // 뉴스 삭제 뮤테이션\n  const deleteNewsMutation = useMutation({\n    mutationFn: async (id: number) => {\n      setIsDeletingNews(id);\n      const res = await apiRequest(\"DELETE\", `/api/news/${id}`);\n      return { id, result: await res.json() };\n    },\n    onSuccess: ({ id, result }) => {\n      // 클라이언트 측 상태 업데이트\n      setLocalNews(prev => prev.filter(item => item.id !== id));\n      \n      // 서버 데이터 동기화 (백그라운드)\n      setTimeout(() => {\n        queryClient.invalidateQueries({ queryKey: [\"/api/news\"] });\n      }, 100);\n      \n      toast({\n        title: \"뉴스 삭제 성공\",\n        description: \"뉴스가 성공적으로 삭제되었습니다.\",\n      });\n      setIsDeletingNews(false);\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"뉴스 삭제 실패\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n      setIsDeletingNews(false);\n    },\n  });\n\n  // 뉴스 수동 업데이트 mutation\n  const updateNewsMutation = useMutation({\n    mutationFn: async () => {\n      const res = await apiRequest(\"GET\", \"/api/admin/update-news\");\n      return await res.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/news\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/news/latest\"] });\n      toast({\n        title: \"뉴스 업데이트 성공\",\n        description: \"최신 뉴스가 성공적으로 업데이트되었습니다.\",\n      });\n      setIsUpdatingNews(false);\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"뉴스 업데이트 실패\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n      setIsUpdatingNews(false);\n    },\n  });\n\n  // 부동산 다중 삭제 mutation\n  const batchDeletePropertiesMutation = useMutation({\n    mutationFn: async (ids: number[]) => {\n      const res = await apiRequest(\"POST\", \"/api/properties/batch-delete\", { ids });\n      return await res.json();\n    },\n    onSuccess: (data) => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/properties\"] });\n      toast({\n        title: \"부동산 일괄 삭제 완료\",\n        description: data.message,\n      });\n      setSelectedProperties([]);\n      setIsDeleteAlertOpen(false);\n      setCurrentDeleteType(null);\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"부동산 일괄 삭제 실패\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    }\n  });\n\n  // 뉴스 다중 삭제 mutation\n  const batchDeleteNewsMutation = useMutation({\n    mutationFn: async (ids: number[]) => {\n      const res = await apiRequest(\"POST\", \"/api/news/batch-delete\", { ids });\n      return await res.json();\n    },\n    onSuccess: (data) => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/news\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/news/latest\"] });\n      toast({\n        title: \"뉴스 일괄 삭제 완료\",\n        description: data.message,\n      });\n      setSelectedNews([]);\n      setIsDeleteAlertOpen(false);\n      setCurrentDeleteType(null);\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"뉴스 일괄 삭제 실패\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    }\n  });\n\n  // 사용자 다중 삭제 mutation\n  const batchDeleteUsersMutation = useMutation({\n    mutationFn: async (ids: number[]) => {\n      const res = await apiRequest(\"POST\", \"/api/users/batch-delete\", { ids });\n      return await res.json();\n    },\n    onSuccess: (data) => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/users\"] });\n      toast({\n        title: \"사용자 일괄 삭제 완료\",\n        description: data.message,\n      });\n      \n      // 자기 자신을 포함해서 삭제했는지 확인\n      if (data.skippedSelf) {\n        toast({\n          title: \"알림\",\n          description: \"현재 로그인된 계정은 삭제할 수 없습니다.\",\n        });\n      }\n      \n      setSelectedUsers([]);\n      setIsDeleteAlertOpen(false);\n      setCurrentDeleteType(null);\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"사용자 일괄 삭제 실패\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    }\n  });\n\n  // 뉴스 수동 업데이트 핸들러\n  const handleUpdateNews = () => {\n    if (window.confirm(\"네이버 뉴스 API를 통해 최신 뉴스를 가져오시겠습니까?\")) {\n      setIsUpdatingNews(true);\n      updateNewsMutation.mutate();\n    }\n  };\n  \n  // 부동산 삭제 핸들러\n  const handleDeleteProperty = (id: number) => {\n    if (window.confirm(\"정말로 이 부동산을 삭제하시겠습니까?\")) {\n      deletePropertyMutation.mutate(id);\n    }\n  };\n  \n  // 다중 선택 핸들러\n  const handleSelectProperty = (id: number, checked: boolean) => {\n    if (checked) {\n      setSelectedProperties([...selectedProperties, id]);\n    } else {\n      setSelectedProperties(selectedProperties.filter(propId => propId !== id));\n    }\n  };\n  \n  const handleSelectNews = (id: number, checked: boolean) => {\n    if (checked) {\n      setSelectedNews([...selectedNews, id]);\n    } else {\n      setSelectedNews(selectedNews.filter(newsId => newsId !== id));\n    }\n  };\n  \n  const handleSelectUser = (id: number, checked: boolean) => {\n    if (checked) {\n      setSelectedUsers([...selectedUsers, id]);\n    } else {\n      setSelectedUsers(selectedUsers.filter(userId => userId !== id));\n    }\n  };\n  \n  // 일괄 삭제 확인 다이얼로그 열기\n  const openDeleteConfirm = (type: 'properties' | 'news' | 'users') => {\n    setCurrentDeleteType(type);\n    setIsDeleteAlertOpen(true);\n  };\n  \n  // 일괄 삭제 실행\n  const handleBatchDelete = () => {\n    if (!currentDeleteType) return;\n    \n    switch (currentDeleteType) {\n      case 'properties':\n        if (selectedProperties.length === 0) {\n          toast({\n            title: \"선택된 항목 없음\",\n            description: \"삭제할 부동산 매물을 선택해주세요.\",\n            variant: \"destructive\",\n          });\n          return;\n        }\n        batchDeletePropertiesMutation.mutate(selectedProperties);\n        break;\n      \n      case 'news':\n        if (selectedNews.length === 0) {\n          toast({\n            title: \"선택된 항목 없음\",\n            description: \"삭제할 뉴스를 선택해주세요.\",\n            variant: \"destructive\",\n          });\n          return;\n        }\n        batchDeleteNewsMutation.mutate(selectedNews);\n        break;\n      \n      case 'users':\n        if (selectedUsers.length === 0) {\n          toast({\n            title: \"선택된 항목 없음\",\n            description: \"삭제할 사용자를 선택해주세요.\",\n            variant: \"destructive\",\n          });\n          return;\n        }\n        batchDeleteUsersMutation.mutate(selectedUsers);\n        break;\n    }\n  };\n\n  // 참고: 다중 선택 관련 핸들러는 위에서 이미 정의되었습니다.\n  \n  // 폼 닫기 핸들러\n  const handleCloseForm = () => {\n    setShowPropertyForm(false);\n    setEditingProperty(null);\n    form.reset(defaultFormValues);\n  };\n\n  // 부동산 수정 열기\n  const handleEditProperty = (property: Property) => {\n    // 현재 선택된 부동산 저장\n    setEditingProperty(property);\n    \n    // 현재 읍면 찾기\n    const mainDistrict = districts.find(d => \n      property.district.startsWith(d)\n    ) || \"강화읍\";\n    \n    setSelectedMainDistrict(mainDistrict);\n    setDetailedDistrictOptions(detailedDistricts[mainDistrict]);\n    \n    // 폼 초기화\n    form.reset({\n      title: property.title || \"\",\n      description: property.description || \"\",\n      type: property.type || \"토지\",\n      price: property.price ? property.price.toString() : \"\",\n      address: property.address || \"\",\n      district: property.district || detailedDistricts[mainDistrict][0],\n      size: property.size ? property.size.toString() : \"\",\n      bedrooms: property.bedrooms || 0,\n      bathrooms: property.bathrooms || 0,\n      imageUrl: property.imageUrl || \"\",\n      agentId: property.agentId || 1,\n      featured: !!property.featured,\n      buildingName: property.buildingName || \"\",\n      unitNumber: property.unitNumber || \"\",\n      supplyArea: property.supplyArea ? property.supplyArea.toString() : \"\",\n      privateArea: property.privateArea ? property.privateArea.toString() : \"\",\n      areaSize: property.areaSize || \"\",\n      floor: property.floor ? property.floor.toString() : \"\",\n      totalFloors: property.totalFloors ? property.totalFloors.toString() : \"\",\n      direction: property.direction || \"\",\n      elevator: !!property.elevator,\n      parking: property.parking || \"\",\n      heatingSystem: property.heatingSystem || \"\",\n      approvalDate: property.approvalDate || \"\",\n      dealType: Array.isArray(property.dealType) && property.dealType.length > 0 \n        ? property.dealType \n        : [\"매매\"],\n      deposit: property.deposit ? property.deposit.toString() : \"\",\n      monthlyRent: property.monthlyRent ? property.monthlyRent.toString() : \"\",\n      maintenanceFee: property.maintenanceFee ? property.maintenanceFee.toString() : \"\",\n      ownerName: property.ownerName || \"\",\n      ownerPhone: property.ownerPhone || \"\",\n      tenantName: property.tenantName || \"\",\n      tenantPhone: property.tenantPhone || \"\",\n      clientName: property.clientName || \"\",\n      clientPhone: property.clientPhone || \"\",\n      specialNote: property.specialNote || \"\",\n      coListing: !!property.coListing,\n      propertyDescription: property.propertyDescription || \"\",\n      privateNote: property.privateNote || \"\",\n    });\n    \n    // 폼 표시\n    setShowPropertyForm(true);\n  };\n\n  // 새 부동산 추가 핸들러\n  const handleAddProperty = () => {\n    setEditingProperty(null);\n    form.reset(defaultFormValues);\n    setShowPropertyForm(true);\n  };\n\n  // 읍면 변경 핸들러\n  const handleDistrictChange = (value: string) => {\n    setSelectedMainDistrict(value);\n    setDetailedDistrictOptions(detailedDistricts[value]);\n    \n    // 첫 번째 세부 지역을 기본값으로 설정\n    if (detailedDistricts[value].length > 0) {\n      form.setValue(\"district\", detailedDistricts[value][0]);\n    }\n  };\n  \n  // 폼 제출 핸들러\n  const onSubmit = (data: PropertyFormValues) => {\n    if (editingProperty) {\n      updatePropertyMutation.mutate({ id: editingProperty.id, data });\n    } else {\n      createPropertyMutation.mutate(data);\n    }\n  };\n\n  // 로딩 상태 표시\n  if (isLoadingProperties && !propertiesLoaded) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\n      </div>\n    );\n  }\n\n  // 오류 상태 표시\n  if (propertiesError) {\n    return (\n      <div className=\"flex flex-col items-center justify-center min-h-screen\">\n        <p className=\"text-red-500 mb-4\">오류가 발생했습니다: {propertiesError.message}</p>\n        <Button variant=\"default\" onClick={() => window.location.reload()}>\n          다시 시도\n        </Button>\n      </div>\n    );\n  }\n\n  // 필터링 함수\n  const filterProperties = (props: Property[]) => {\n    if (!props) return [];\n    \n    return props.filter(property => {\n      // 유형 필터\n      if (filterType && property.type !== filterType) {\n        return false;\n      }\n      \n      // 지역 필터\n      if (filterDistrict && typeof property.district === 'string') {\n        if (property.district !== filterDistrict) {\n          return false;\n        }\n      }\n      \n      // 거래유형 필터\n      if (filterDealType && property.dealType) {\n        // 배열인 경우\n        if (Array.isArray(property.dealType)) {\n          return property.dealType.includes(filterDealType);\n        } \n        // 문자열인 경우\n        else if (typeof property.dealType === 'string') {\n          return property.dealType === filterDealType;\n        }\n        return false;\n      }\n      \n      return true;\n    });\n  };\n  \n  // 표시할 데이터 결정\n  const baseProperties = propertiesLoaded ? localProperties : (properties || []);\n  const displayProperties = filterProperties(baseProperties);\n  const displayUsers = usersLoaded ? localUsers : (users || []);\n  const displayNews = newsLoaded ? localNews : (news || []);\n\n  return (\n    <div className=\"container mx-auto py-6 space-y-6\">\n      {/* 일괄 삭제 확인 다이얼로그 */}\n      <AlertDialog open={isDeleteAlertOpen} onOpenChange={setIsDeleteAlertOpen}>\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>선택한 항목 일괄 삭제</AlertDialogTitle>\n            <AlertDialogDescription>\n              {currentDeleteType === 'properties' && `선택한 ${selectedProperties.length}개의 부동산 매물을 삭제하시겠습니까?`}\n              {currentDeleteType === 'news' && `선택한 ${selectedNews.length}개의 뉴스를 삭제하시겠습니까?`}\n              {currentDeleteType === 'users' && `선택한 ${selectedUsers.length}개의 사용자를 삭제하시겠습니까?`}\n              <br /><br />\n              이 작업은 되돌릴 수 없습니다.\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel>취소</AlertDialogCancel>\n            <AlertDialogAction \n              onClick={handleBatchDelete}\n              className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\n            >\n              삭제\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n      \n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h1 className=\"text-3xl font-bold\">관리자 패널</h1>\n          <Breadcrumb className=\"mt-2\">\n            <BreadcrumbList>\n              <BreadcrumbItem>\n                <BreadcrumbLink href=\"/\">\n                  <Home className=\"h-4 w-4 mr-1\" />\n                  홈\n                </BreadcrumbLink>\n              </BreadcrumbItem>\n              <BreadcrumbSeparator />\n              <BreadcrumbItem>\n                <BreadcrumbPage>관리자 패널</BreadcrumbPage>\n              </BreadcrumbItem>\n            </BreadcrumbList>\n          </Breadcrumb>\n        </div>\n        <div className=\"flex items-center gap-4\">\n          <p className=\"text-muted-foreground\">\n            <span className=\"font-bold\">{currentUser?.username}</span> ({currentUser?.role})\n          </p>\n        </div>\n      </div>\n\n      <Tabs value={activeTab} onValueChange={setActiveTab}>\n        <TabsList className=\"grid w-full grid-cols-3\">\n          <TabsTrigger value=\"properties\">부동산 관리</TabsTrigger>\n          <TabsTrigger value=\"news\">뉴스 관리</TabsTrigger>\n          <TabsTrigger value=\"users\" disabled={currentUser?.role !== \"admin\"}>\n            사용자 관리\n          </TabsTrigger>\n        </TabsList>\n\n        {/* 부동산 관리 탭 */}\n        <TabsContent value=\"properties\">\n          <Card>\n            <CardHeader>\n              <div className=\"flex justify-between items-center\">\n                <div>\n                  <CardTitle>부동산 목록</CardTitle>\n                  <CardDescription>\n                    등록된 부동산 매물 목록을 관리합니다.\n                  </CardDescription>\n                </div>\n                <div className=\"flex gap-2\">\n                  {selectedProperties.length > 0 && (\n                    <Button \n                      variant=\"destructive\" \n                      size=\"sm\" \n                      onClick={() => openDeleteConfirm('properties')}\n                    >\n                      <Trash2 className=\"h-4 w-4 mr-2\" />\n                      {selectedProperties.length}개 삭제\n                    </Button>\n                  )}\n                  <Button onClick={handleAddProperty} type=\"button\">\n                    <Plus className=\"h-4 w-4 mr-2\" />\n                    부동산 등록\n                  </Button>\n                </div>\n              </div>\n            </CardHeader>\n            <CardContent>\n              {/* 필터 UI */}\n              <div className=\"mb-6 p-4 border rounded-lg bg-gray-50\">\n                <h3 className=\"text-lg font-medium mb-3\">필터링</h3>\n                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n                  <div>\n                    <Select\n                      value={filterType}\n                      onValueChange={setFilterType}\n                    >\n                      <SelectTrigger>\n                        <SelectValue placeholder=\"유형별 필터\" />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"\">전체 유형</SelectItem>\n                        {propertyTypes.map((type) => (\n                          <SelectItem key={type} value={type}>\n                            {type}\n                          </SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                  </div>\n                  \n                  <div>\n                    <Select\n                      value={filterDistrict}\n                      onValueChange={setFilterDistrict}\n                    >\n                      <SelectTrigger>\n                        <SelectValue placeholder=\"지역별 필터\" />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"\">전체 지역</SelectItem>\n                        {districts.map((district) => (\n                          <SelectItem key={district} value={district}>\n                            {district}\n                          </SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                  </div>\n                  \n                  <div>\n                    <Select\n                      value={filterDealType}\n                      onValueChange={setFilterDealType}\n                    >\n                      <SelectTrigger>\n                        <SelectValue placeholder=\"거래유형별 필터\" />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"\">전체 거래유형</SelectItem>\n                        {dealTypes.map((type) => (\n                          <SelectItem key={type} value={type}>\n                            {type}\n                          </SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                  </div>\n                </div>\n                \n                {(filterType || filterDistrict || filterDealType) && (\n                  <div className=\"mt-4 flex justify-end\">\n                    <Button \n                      variant=\"outline\" \n                      size=\"sm\"\n                      onClick={() => {\n                        setFilterType(\"\");\n                        setFilterDistrict(\"\");\n                        setFilterDealType(\"\");\n                      }}\n                    >\n                      필터 초기화\n                    </Button>\n                  </div>\n                )}\n              </div>\n              \n              <Table>\n                <TableCaption>총 {displayProperties?.length || 0}개의 부동산 매물</TableCaption>\n                <TableHeader>\n                  <TableRow>\n                    <TableHead className=\"w-12\">\n                      <Checkbox \n                        checked={selectedProperties.length > 0 && selectedProperties.length === displayProperties.length}\n                        onCheckedChange={(checked) => {\n                          if (checked) {\n                            setSelectedProperties(displayProperties.map(p => p.id));\n                          } else {\n                            setSelectedProperties([]);\n                          }\n                        }}\n                      />\n                    </TableHead>\n                    <TableHead>ID</TableHead>\n                    <TableHead>제목</TableHead>\n                    <TableHead>유형</TableHead>\n                    <TableHead>지역</TableHead>\n                    <TableHead>가격</TableHead>\n                    <TableHead>정보</TableHead>\n                    <TableHead>거래유형</TableHead>\n                    <TableHead>특징</TableHead>\n                    <TableHead className=\"text-right\">관리</TableHead>\n                  </TableRow>\n                </TableHeader>\n                <TableBody>\n                  {displayProperties.map((property) => (\n                    <TableRow key={property.id}>\n                      <TableCell>\n                        <Checkbox \n                          checked={selectedProperties.includes(property.id)}\n                          onCheckedChange={(checked) => handleSelectProperty(property.id, !!checked)}\n                        />\n                      </TableCell>\n                      <TableCell className=\"font-medium\">{property.id}</TableCell>\n                      <TableCell className=\"max-w-[200px] truncate\">{property.title}</TableCell>\n                      <TableCell>{property.type}</TableCell>\n                      <TableCell>{property.district}</TableCell>\n                      <TableCell>{parseInt(property.price).toLocaleString()}원</TableCell>\n                      <TableCell>{property.bedrooms}침실 {property.bathrooms}욕실 {property.size}㎡</TableCell>\n                      <TableCell>\n                        <div className=\"flex flex-col gap-1\">\n                          {property.dealType && (Array.isArray(property.dealType) ? property.dealType.length > 0 : typeof property.dealType === 'string' && property.dealType.length > 0) ? (\n                            Array.isArray(property.dealType) ? \n                              property.dealType.map((type, idx) => {\n                                const dealTypeClass = \n                                  typeof type === 'string' && type.includes(\"매매\") \n                                    ? 'bg-blue-100 text-blue-800' \n                                    : typeof type === 'string' && type.includes(\"전세\")\n                                    ? 'bg-green-100 text-green-800'\n                                    : typeof type === 'string' && type.includes(\"월세\")\n                                    ? 'bg-orange-100 text-orange-800'\n                                    : 'bg-gray-100 text-gray-800';\n                                \n                                return (\n                                  <span key={idx} className={`px-2 py-1 rounded-full text-xs inline-block ${dealTypeClass}`}>\n                                    {type}\n                                  </span>\n                                );\n                              })\n                            : (\n                              <span className={`px-2 py-1 rounded-full text-xs ${\n                                typeof property.dealType === 'string' && property.dealType.includes(\"매매\") \n                                  ? 'bg-blue-100 text-blue-800' \n                                  : typeof property.dealType === 'string' && property.dealType.includes(\"전세\")\n                                  ? 'bg-green-100 text-green-800'\n                                  : typeof property.dealType === 'string' && property.dealType.includes(\"월세\")\n                                  ? 'bg-orange-100 text-orange-800'\n                                  : 'bg-gray-100 text-gray-800'\n                              }`}>\n                                {property.dealType}\n                              </span>\n                            )\n                          ) : (\n                            <span className=\"px-2 py-1 rounded-full text-xs bg-gray-100 text-gray-800\">\n                              미지정\n                            </span>\n                          )}\n                        </div>\n                      </TableCell>\n                      <TableCell>\n                        {property.featured && (\n                          <div className=\"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800\">\n                            <Check className=\"h-3 w-3 mr-1\" />\n                            추천\n                          </div>\n                        )}\n                      </TableCell>\n                      <TableCell className=\"text-right\">\n                        <div className=\"flex justify-end gap-2\">\n                          <Button\n                            variant=\"outline\"\n                            size=\"icon\"\n                            onClick={() => handleEditProperty(property)}\n                            type=\"button\"\n                          >\n                            <Edit className=\"h-4 w-4\" />\n                          </Button>\n                          <Button\n                            variant=\"destructive\"\n                            size=\"icon\"\n                            onClick={() => handleDeleteProperty(property.id)}\n                            disabled={isDeleting === property.id}\n                            type=\"button\"\n                          >\n                            {isDeleting === property.id ? (\n                              <Loader2 className=\"h-4 w-4 animate-spin\" />\n                            ) : (\n                              <Trash2 className=\"h-4 w-4\" />\n                            )}\n                          </Button>\n                        </div>\n                      </TableCell>\n                    </TableRow>\n                  ))}\n                </TableBody>\n              </Table>\n            </CardContent>\n          </Card>\n\n          {/* 속성 폼 */}\n          {showPropertyForm && (\n            <Card className=\"mt-6\">\n              <CardHeader className=\"flex flex-row items-center justify-between pb-2\">\n                <CardTitle>{editingProperty ? \"부동산 수정\" : \"새 부동산 등록\"}</CardTitle>\n                <Button \n                  variant=\"ghost\" \n                  size=\"icon\" \n                  onClick={handleCloseForm} \n                  className=\"rounded-full h-8 w-8 p-0\"\n                  type=\"button\"\n                >\n                  <X className=\"h-4 w-4\" />\n                </Button>\n              </CardHeader>\n              <CardContent>\n                <Form {...form}>\n                  <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6\">\n                    <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                      {/* 기본 정보 */}\n                      <FormField\n                        control={form.control}\n                        name=\"title\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>제목</FormLabel>\n                            <FormControl>\n                              <Input placeholder=\"부동산 제목\" {...field} />\n                            </FormControl>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n\n                      <FormField\n                        control={form.control}\n                        name=\"type\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>유형</FormLabel>\n                            <Select\n                              onValueChange={field.onChange}\n                              defaultValue={field.value}\n                              value={field.value}\n                            >\n                              <FormControl>\n                                <SelectTrigger>\n                                  <SelectValue placeholder=\"부동산 유형 선택\" />\n                                </SelectTrigger>\n                              </FormControl>\n                              <SelectContent>\n                                {propertyTypes.map((type) => (\n                                  <SelectItem key={type} value={type}>\n                                    {type}\n                                  </SelectItem>\n                                ))}\n                              </SelectContent>\n                            </Select>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n\n                      <div className=\"md:col-span-2\">\n                        <FormField\n                          control={form.control}\n                          name=\"description\"\n                          render={({ field }) => (\n                            <FormItem>\n                              <FormLabel>설명</FormLabel>\n                              <FormControl>\n                                <Textarea\n                                  placeholder=\"부동산에 대한 간략한 설명\"\n                                  rows={3}\n                                  {...field}\n                                />\n                              </FormControl>\n                              <FormMessage />\n                            </FormItem>\n                          )}\n                        />\n                      </div>\n\n                      <FormField\n                        control={form.control}\n                        name=\"price\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>가격</FormLabel>\n                            <FormControl>\n                              <Input placeholder=\"가격 (원)\" {...field} />\n                            </FormControl>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n\n                      <FormField\n                        control={form.control}\n                        name=\"size\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>면적 (㎡)</FormLabel>\n                            <FormControl>\n                              <Input placeholder=\"면적 (㎡)\" {...field} />\n                            </FormControl>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n\n                      {/* 읍면동 선택 */}\n                      <div>\n                        <FormLabel>읍면</FormLabel>\n                        <Select\n                          value={selectedMainDistrict}\n                          onValueChange={handleDistrictChange}\n                        >\n                          <SelectTrigger>\n                            <SelectValue placeholder=\"지역 선택\" />\n                          </SelectTrigger>\n                          <SelectContent>\n                            {districts.map((district) => (\n                              <SelectItem key={district} value={district}>\n                                {district}\n                              </SelectItem>\n                            ))}\n                          </SelectContent>\n                        </Select>\n                      </div>\n\n                      <FormField\n                        control={form.control}\n                        name=\"district\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>읍면동</FormLabel>\n                            <Select\n                              onValueChange={field.onChange}\n                              value={field.value}\n                            >\n                              <FormControl>\n                                <SelectTrigger>\n                                  <SelectValue placeholder=\"상세 지역 선택\" />\n                                </SelectTrigger>\n                              </FormControl>\n                              <SelectContent>\n                                {detailedDistrictOptions.map((district) => (\n                                  <SelectItem key={district} value={district}>\n                                    {district}\n                                  </SelectItem>\n                                ))}\n                              </SelectContent>\n                            </Select>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n\n                      <FormField\n                        control={form.control}\n                        name=\"address\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>지번</FormLabel>\n                            <FormControl>\n                              <Input placeholder=\"지번 주소\" {...field} />\n                            </FormControl>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n\n                      <FormField\n                        control={form.control}\n                        name=\"imageUrl\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>이미지 URL</FormLabel>\n                            <FormControl>\n                              <Input placeholder=\"이미지 URL\" {...field} />\n                            </FormControl>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n\n                      <FormField\n                        control={form.control}\n                        name=\"dealType\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel>거래 종류</FormLabel>\n                            <div className=\"flex flex-wrap gap-2\">\n                              {dealTypes.map((type) => (\n                                <Button\n                                  key={type}\n                                  type=\"button\"\n                                  variant={\n                                    field.value && field.value.includes(type)\n                                      ? \"default\"\n                                      : \"outline\"\n                                  }\n                                  onClick={() => {\n                                    const currentValue = field.value || [];\n                                    const newValue = currentValue.includes(type)\n                                      ? currentValue.filter((t) => t !== type)\n                                      : [...currentValue, type];\n                                    field.onChange(newValue.length ? newValue : [\"매매\"]);\n                                  }}\n                                >\n                                  {type}\n                                </Button>\n                              ))}\n                            </div>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n\n                      <FormField\n                        control={form.control}\n                        name=\"featured\"\n                        render={({ field }) => (\n                          <FormItem className=\"flex flex-row items-start space-x-3 space-y-0 py-4\">\n                            <FormControl>\n                              <Checkbox\n                                checked={field.value}\n                                onCheckedChange={field.onChange}\n                              />\n                            </FormControl>\n                            <div className=\"space-y-1 leading-none\">\n                              <FormLabel>추천 매물로 표시</FormLabel>\n                            </div>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n                    </div>\n\n                    <div className=\"flex justify-end gap-2\">\n                      <Button type=\"button\" variant=\"outline\" onClick={handleCloseForm}>\n                        취소\n                      </Button>\n                      <Button type=\"submit\" disabled={createPropertyMutation.isPending || updatePropertyMutation.isPending}>\n                        {(createPropertyMutation.isPending || updatePropertyMutation.isPending) ? \"처리 중...\" : editingProperty ? \"수정\" : \"등록\"}\n                      </Button>\n                    </div>\n                  </form>\n                </Form>\n              </CardContent>\n            </Card>\n          )}\n        </TabsContent>\n\n        {/* 뉴스 관리 탭 */}\n        <TabsContent value=\"news\">\n          <Card>\n            <CardHeader className=\"flex flex-row items-center justify-between\">\n              <div>\n                <CardTitle>뉴스 목록</CardTitle>\n                <CardDescription>\n                  등록된 뉴스 목록을 관리합니다.\n                </CardDescription>\n              </div>\n              <div className=\"flex gap-2\">\n                {selectedNews.length > 0 && (\n                  <Button \n                    variant=\"destructive\" \n                    size=\"sm\" \n                    onClick={() => openDeleteConfirm('news')}\n                  >\n                    <Trash2 className=\"h-4 w-4 mr-2\" />\n                    {selectedNews.length}개 삭제\n                  </Button>\n                )}\n                <Button \n                  onClick={handleUpdateNews} \n                  disabled={isUpdatingNews}\n                  className=\"ml-auto\"\n                >\n                {isUpdatingNews ? (\n                  <>\n                    <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n                    업데이트 중...\n                  </>\n                ) : (\n                  <>\n                    <RefreshCw className=\"mr-2 h-4 w-4\" />\n                    뉴스 업데이트\n                  </>\n                )}\n              </Button>\n              </div>\n            </CardHeader>\n            <CardContent>\n              <Table>\n                <TableCaption>총 {displayNews?.length || 0}개의 뉴스</TableCaption>\n                <TableHeader>\n                  <TableRow>\n                    <TableHead className=\"w-12\">\n                      <Checkbox \n                        checked={selectedNews.length > 0 && selectedNews.length === displayNews.length}\n                        onCheckedChange={(checked) => {\n                          if (checked) {\n                            setSelectedNews(displayNews.map(n => n.id));\n                          } else {\n                            setSelectedNews([]);\n                          }\n                        }}\n                      />\n                    </TableHead>\n                    <TableHead>ID</TableHead>\n                    <TableHead>제목</TableHead>\n                    <TableHead>날짜</TableHead>\n                    <TableHead>출처</TableHead>\n                    <TableHead className=\"text-right\">관리</TableHead>\n                  </TableRow>\n                </TableHeader>\n                <TableBody>\n                  {displayNews.map((item) => (\n                    <TableRow key={item.id}>\n                      <TableCell>\n                        <Checkbox \n                          checked={selectedNews.includes(item.id)}\n                          onCheckedChange={(checked) => handleSelectNews(item.id, !!checked)}\n                        />\n                      </TableCell>\n                      <TableCell className=\"font-medium\">{item.id}</TableCell>\n                      <TableCell className=\"max-w-[300px] truncate\">{item.title}</TableCell>\n                      <TableCell>\n                        {item.createdAt ? new Date(item.createdAt).toLocaleDateString() : '-'}\n                      </TableCell>\n                      <TableCell>\n                        {item.source || \"네이버 뉴스\"}\n                      </TableCell>\n                      <TableCell className=\"text-right\">\n                        <Button\n                          variant=\"destructive\"\n                          size=\"icon\"\n                          onClick={() => {\n                            if (window.confirm(\"정말로 이 뉴스를 삭제하시겠습니까?\")) {\n                              deleteNewsMutation.mutate(item.id);\n                            }\n                          }}\n                          disabled={isDeletingNews === item.id}\n                          type=\"button\"\n                        >\n                          {isDeletingNews === item.id ? (\n                            <Loader2 className=\"h-4 w-4 animate-spin\" />\n                          ) : (\n                            <Trash2 className=\"h-4 w-4\" />\n                          )}\n                        </Button>\n                      </TableCell>\n                    </TableRow>\n                  ))}\n                </TableBody>\n              </Table>\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        {/* 사용자 관리 탭 (관리자만) */}\n        <TabsContent value=\"users\">\n          <Card>\n            <CardHeader className=\"flex flex-row items-center justify-between\">\n              <div>\n                <CardTitle>사용자 목록</CardTitle>\n                <CardDescription>\n                  등록된 사용자 목록을 관리합니다.\n                </CardDescription>\n              </div>\n              {selectedUsers.length > 0 && (\n                <Button \n                  variant=\"destructive\" \n                  size=\"sm\" \n                  onClick={() => openDeleteConfirm('users')}\n                >\n                  <Trash2 className=\"h-4 w-4 mr-2\" />\n                  {selectedUsers.length}명 삭제\n                </Button>\n              )}\n            </CardHeader>\n            <CardContent>\n              {isLoadingUsers && !usersLoaded ? (\n                <div className=\"flex items-center justify-center py-10\">\n                  <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\n                </div>\n              ) : usersError ? (\n                <div className=\"text-center py-10\">\n                  <p className=\"text-red-500 mb-4\">오류가 발생했습니다: {usersError.message}</p>\n                </div>\n              ) : (\n                <Table>\n                  <TableCaption>총 {displayUsers?.length || 0}명의 사용자</TableCaption>\n                  <TableHeader>\n                    <TableRow>\n                      <TableHead className=\"w-12\">\n                        <Checkbox \n                          checked={selectedUsers.length > 0 && selectedUsers.length === displayUsers.length}\n                          onCheckedChange={(checked) => {\n                            if (checked) {\n                              setSelectedUsers(displayUsers.map(u => u.id));\n                            } else {\n                              setSelectedUsers([]);\n                            }\n                          }}\n                        />\n                      </TableHead>\n                      <TableHead>ID</TableHead>\n                      <TableHead>사용자명</TableHead>\n                      <TableHead>이메일</TableHead>\n                      <TableHead>권한</TableHead>\n                      <TableHead>가입일</TableHead>\n                      <TableHead className=\"text-right\">관리</TableHead>\n                    </TableRow>\n                  </TableHeader>\n                  <TableBody>\n                    {displayUsers.map((user) => (\n                      <TableRow key={user.id}>\n                        <TableCell>\n                          <Checkbox \n                            checked={selectedUsers.includes(user.id)}\n                            onCheckedChange={(checked) => handleSelectUser(user.id, !!checked)}\n                          />\n                        </TableCell>\n                        <TableCell className=\"font-medium\">{user.id}</TableCell>\n                        <TableCell>{user.username}</TableCell>\n                        <TableCell>{user.email}</TableCell>\n                        <TableCell>{user.role}</TableCell>\n                        <TableCell>\n                          {/* createdAt은 현재 User 타입에 없으므로 표시하지 않음 */}\n                          -\n                        </TableCell>\n                        <TableCell className=\"text-right\">\n                          <Button\n                            variant=\"destructive\"\n                            size=\"icon\"\n                            onClick={() => {\n                              if (user.role === \"admin\") {\n                                toast({\n                                  title: \"관리자 계정을 삭제할 수 없습니다\",\n                                  variant: \"destructive\",\n                                });\n                                return;\n                              }\n                              if (\n                                window.confirm(\n                                  \"정말로 이 사용자를 삭제하시겠습니까? 이 작업은 되돌릴 수 없습니다.\"\n                                )\n                              ) {\n                                deleteUserMutation.mutate(user.id);\n                              }\n                            }}\n                            disabled={\n                              isDeletingUser === user.id || user.role === \"admin\"\n                            }\n                            type=\"button\"\n                          >\n                            {isDeletingUser === user.id ? (\n                              <Loader2 className=\"h-4 w-4 animate-spin\" />\n                            ) : (\n                              <Trash2 className=\"h-4 w-4\" />\n                            )}\n                          </Button>\n                        </TableCell>\n                      </TableRow>\n                    ))}\n                  </TableBody>\n                </Table>\n              )}\n            </CardContent>\n          </Card>\n        </TabsContent>\n      </Tabs>\n      {/* 삭제 확인 대화 상자 */}\n      <AlertDialog open={isDeleteAlertOpen} onOpenChange={setIsDeleteAlertOpen}>\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>\n              {currentDeleteType === 'properties' && '부동산 매물 일괄 삭제'}\n              {currentDeleteType === 'news' && '뉴스 일괄 삭제'}\n              {currentDeleteType === 'users' && '사용자 일괄 삭제'}\n            </AlertDialogTitle>\n            <AlertDialogDescription>\n              {currentDeleteType === 'properties' && \n                `선택한 ${selectedProperties.length}개의 부동산 매물을 삭제하시겠습니까?`}\n              {currentDeleteType === 'news' && \n                `선택한 ${selectedNews.length}개의 뉴스를 삭제하시겠습니까?`}\n              {currentDeleteType === 'users' && \n                `선택한 ${selectedUsers.length}명의 사용자를 삭제하시겠습니까? 관리자 계정은 삭제되지 않습니다.`}\n              <div className=\"mt-2 text-red-500\">이 작업은 되돌릴 수 없습니다.</div>\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel>취소</AlertDialogCancel>\n            <AlertDialogAction onClick={handleBatchDelete} className=\"bg-destructive\">\n              삭제\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n    </div>\n  );\n}","path":null,"size_bytes":62736,"size_tokens":null},"client/src/components/home/Hero.tsx":{"content":"import { Link } from \"wouter\";\n\nconst Hero = () => {\n  return (\n    <section className=\"relative\">\n      <div \n        className=\"w-full h-[60vh] bg-cover bg-center\" \n        style={{ \n          backgroundImage: \"url('https://images.unsplash.com/photo-1560518883-ce09059eeffa?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1920&h=1080')\",\n          backgroundPosition: \"center\"\n        }}\n      />\n      \n      <div className=\"absolute inset-0 bg-gradient-to-r from-dark/70 to-dark/30 flex items-center\">\n        <div className=\"container mx-auto px-4\">\n          <div className=\"max-w-2xl\">\n            <h1 className=\"text-white text-4xl md:text-5xl font-bold mb-4\">\n              당신의 꿈의 집을 찾아드립니다\n            </h1>\n            <p className=\"text-white text-xl mb-8\">\n              신뢰할 수 있는 부동산 파트너와 함께 최고의 매물을 만나보세요\n            </p>\n            <div className=\"flex flex-col sm:flex-row gap-4\">\n              <Link href=\"/properties\" className=\"bg-primary hover:bg-secondary text-white font-bold py-3 px-6 rounded-lg text-center transition-colors block\">\n                매물 보기\n              </Link>\n              <Link href=\"/contact\" className=\"bg-white hover:bg-gray-light text-primary font-bold py-3 px-6 rounded-lg text-center transition-colors block\">\n                상담 신청\n              </Link>\n            </div>\n          </div>\n        </div>\n      </div>\n    </section>\n  );\n};\n\nexport default Hero;\n","path":null,"size_bytes":1547,"size_tokens":null},"client/src/components/admin/InquiryNotifications.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle } from \"@/components/ui/dialog\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { Bell, MessageCircle, Eye, CheckCheck, ExternalLink } from \"lucide-react\";\nimport { format } from \"date-fns\";\nimport { ko } from \"date-fns/locale\";\n\ninterface UnreadInquiry {\n  id: number;\n  propertyId: number;\n  userId: number;\n  title: string;\n  content: string;\n  isReply: boolean;\n  parentId?: number;\n  isReadByAdmin: boolean;\n  createdAt: string;\n  authorUsername?: string;\n  propertyTitle?: string;\n}\n\nconst InquiryNotifications = () => {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [isOpen, setIsOpen] = useState(false);\n  const [selectedInquiry, setSelectedInquiry] = useState<UnreadInquiry | null>(null);\n\n  // 미읽은 문의글 수 조회\n  const { data: unreadCount = 0 } = useQuery<{ count: number }>({\n    queryKey: [\"/api/admin/inquiries/unread/count\"],\n    refetchInterval: 30000, // 30초마다 자동 새로고침\n  });\n\n  // 미읽은 문의글 목록 조회\n  const { data: unreadInquiries = [], isLoading } = useQuery<UnreadInquiry[]>({\n    queryKey: [\"/api/admin/inquiries/unread\"],\n    enabled: isOpen,\n  });\n\n  // 개별 문의글 읽음 처리\n  const markAsReadMutation = useMutation({\n    mutationFn: (inquiryId: number) => \n      apiRequest(\"PUT\", `/api/admin/inquiries/${inquiryId}/read`),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/inquiries/unread\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/inquiries/unread/count\"] });\n      toast({\n        title: \"읽음 처리 완료\",\n        description: \"문의글을 읽음 처리했습니다.\",\n      });\n    },\n    onError: () => {\n      toast({\n        title: \"오류 발생\",\n        description: \"읽음 처리 중 오류가 발생했습니다.\",\n        variant: \"destructive\",\n      });\n    }\n  });\n\n  // 전체 문의글 읽음 처리\n  const markAllAsReadMutation = useMutation({\n    mutationFn: () => apiRequest(\"PUT\", \"/api/admin/inquiries/read-all\"),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/inquiries/unread\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/inquiries/unread/count\"] });\n      toast({\n        title: \"전체 읽음 처리 완료\",\n        description: \"모든 문의글을 읽음 처리했습니다.\",\n      });\n      setIsOpen(false);\n    },\n    onError: () => {\n      toast({\n        title: \"오류 발생\",\n        description: \"전체 읽음 처리 중 오류가 발생했습니다.\",\n        variant: \"destructive\",\n      });\n    }\n  });\n\n  const handleInquiryClick = (inquiry: UnreadInquiry) => {\n    setSelectedInquiry(inquiry);\n    // 클릭 시 자동으로 읽음 처리\n    if (!inquiry.isReadByAdmin) {\n      markAsReadMutation.mutate(inquiry.id);\n    }\n  };\n\n  const goToProperty = (propertyId: number) => {\n    window.open(`/properties/${propertyId}`, '_blank');\n  };\n\n  return (\n    <>\n      {/* 알림 버튼 */}\n      <Button\n        variant=\"outline\"\n        size=\"sm\"\n        className=\"relative\"\n        onClick={() => setIsOpen(true)}\n      >\n        <Bell className=\"h-4 w-4 mr-2\" />\n        문의 알림\n        {unreadCount.count > 0 && (\n          <Badge \n            variant=\"destructive\" \n            className=\"absolute -top-2 -right-2 h-5 w-5 p-0 flex items-center justify-center text-xs\"\n          >\n            {unreadCount.count > 99 ? '99+' : unreadCount.count}\n          </Badge>\n        )}\n      </Button>\n\n      {/* 알림 목록 다이얼로그 */}\n      <Dialog open={isOpen} onOpenChange={setIsOpen}>\n        <DialogContent className=\"max-w-4xl max-h-[80vh]\">\n          <DialogHeader>\n            <DialogTitle className=\"flex items-center justify-between\">\n              <div className=\"flex items-center gap-2\">\n                <MessageCircle className=\"h-5 w-5\" />\n                새로운 매물 문의 ({unreadCount.count}개)\n              </div>\n              {unreadInquiries.length > 0 && (\n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  onClick={() => markAllAsReadMutation.mutate()}\n                  disabled={markAllAsReadMutation.isPending}\n                >\n                  <CheckCheck className=\"h-4 w-4 mr-2\" />\n                  전체 읽음\n                </Button>\n              )}\n            </DialogTitle>\n          </DialogHeader>\n\n          <ScrollArea className=\"max-h-[60vh]\">\n            {isLoading ? (\n              <div className=\"flex items-center justify-center p-8\">\n                <div className=\"text-muted-foreground\">로딩 중...</div>\n              </div>\n            ) : unreadInquiries.length === 0 ? (\n              <div className=\"flex items-center justify-center p-8\">\n                <div className=\"text-muted-foreground\">새로운 문의가 없습니다.</div>\n              </div>\n            ) : (\n              <div className=\"space-y-4\">\n                {unreadInquiries.map((inquiry) => (\n                  <Card \n                    key={inquiry.id} \n                    className=\"cursor-pointer hover:bg-muted/50 transition-colors\"\n                    onClick={() => handleInquiryClick(inquiry)}\n                  >\n                    <CardHeader className=\"pb-2\">\n                      <div className=\"flex items-start justify-between\">\n                        <div className=\"flex-1\">\n                          <CardTitle className=\"text-sm font-medium line-clamp-1\">\n                            {inquiry.title}\n                          </CardTitle>\n                          <div className=\"flex items-center gap-2 mt-1 text-xs text-muted-foreground\">\n                            <span>{inquiry.authorUsername}</span>\n                            <Separator orientation=\"vertical\" className=\"h-3\" />\n                            <span>{format(new Date(inquiry.createdAt), \"M월 d일 HH:mm\", { locale: ko })}</span>\n                            {inquiry.isReply && (\n                              <>\n                                <Separator orientation=\"vertical\" className=\"h-3\" />\n                                <Badge variant=\"secondary\" className=\"text-xs\">답글</Badge>\n                              </>\n                            )}\n                          </div>\n                        </div>\n                        <div className=\"flex items-center gap-2\">\n                          <Button\n                            variant=\"ghost\"\n                            size=\"sm\"\n                            onClick={(e) => {\n                              e.stopPropagation();\n                              goToProperty(inquiry.propertyId);\n                            }}\n                          >\n                            <ExternalLink className=\"h-3 w-3\" />\n                          </Button>\n                        </div>\n                      </div>\n                    </CardHeader>\n                    <CardContent className=\"pt-0\">\n                      <div className=\"text-sm text-muted-foreground mb-2\">\n                        매물: {inquiry.propertyTitle}\n                      </div>\n                      <div className=\"text-sm line-clamp-2\">\n                        {inquiry.content}\n                      </div>\n                    </CardContent>\n                  </Card>\n                ))}\n              </div>\n            )}\n          </ScrollArea>\n        </DialogContent>\n      </Dialog>\n\n      {/* 문의글 상세 보기 다이얼로그 */}\n      {selectedInquiry && (\n        <Dialog open={!!selectedInquiry} onOpenChange={() => setSelectedInquiry(null)}>\n          <DialogContent className=\"max-w-2xl\">\n            <DialogHeader>\n              <DialogTitle className=\"flex items-center gap-2\">\n                <MessageCircle className=\"h-5 w-5\" />\n                {selectedInquiry.title}\n                {selectedInquiry.isReply && (\n                  <Badge variant=\"secondary\">답글</Badge>\n                )}\n              </DialogTitle>\n            </DialogHeader>\n            \n            <div className=\"space-y-4\">\n              <div className=\"flex items-center justify-between text-sm text-muted-foreground\">\n                <div className=\"flex items-center gap-2\">\n                  <span>작성자: {selectedInquiry.authorUsername}</span>\n                  <Separator orientation=\"vertical\" className=\"h-3\" />\n                  <span>{format(new Date(selectedInquiry.createdAt), \"yyyy년 M월 d일 HH:mm\", { locale: ko })}</span>\n                </div>\n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  onClick={() => goToProperty(selectedInquiry.propertyId)}\n                >\n                  <ExternalLink className=\"h-3 w-3 mr-1\" />\n                  매물 보기\n                </Button>\n              </div>\n              \n              <div className=\"p-4 bg-muted/30 rounded-lg\">\n                <div className=\"text-sm font-medium mb-2\">매물 정보</div>\n                <div className=\"text-sm text-muted-foreground\">\n                  {selectedInquiry.propertyTitle}\n                </div>\n              </div>\n              \n              <div className=\"p-4 border rounded-lg\">\n                <div className=\"text-sm font-medium mb-2\">문의 내용</div>\n                <div className=\"text-sm whitespace-pre-wrap\">\n                  {selectedInquiry.content}\n                </div>\n              </div>\n              \n              <div className=\"flex justify-end gap-2\">\n                <Button\n                  variant=\"outline\"\n                  onClick={() => setSelectedInquiry(null)}\n                >\n                  닫기\n                </Button>\n                <Button\n                  onClick={() => goToProperty(selectedInquiry.propertyId)}\n                >\n                  매물에서 답변하기\n                </Button>\n              </div>\n            </div>\n          </DialogContent>\n        </Dialog>\n      )}\n    </>\n  );\n};\n\nexport default InquiryNotifications;","path":null,"size_bytes":10551,"size_tokens":null},"client/src/pages/admin-simple.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Button } from \"@/components/ui/button\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { \n  Table, \n  TableHeader, \n  TableBody, \n  TableHead, \n  TableRow, \n  TableCell, \n  TableCaption \n} from \"@/components/ui/table\";\nimport { Loader2, Home, Plus, Trash2, Edit, Check } from \"lucide-react\";\nimport { \n  Breadcrumb, \n  BreadcrumbItem, \n  BreadcrumbLink, \n  BreadcrumbList, \n  BreadcrumbPage, \n  BreadcrumbSeparator \n} from \"@/components/ui/breadcrumb\";\n\n// 타입 정의\ntype Property = {\n  id: number;\n  title: string;\n  description: string;\n  imageUrl: string;\n  type: string;\n  price: string;\n  city: string;\n  district: string;\n  address: string;\n  size: string;\n  bedrooms: number;\n  bathrooms: number;\n  featured: boolean;\n  agentId: number;\n  [key: string]: any;\n};\n\ntype User = {\n  id: number;\n  username: string;\n  email: string | null;\n  role: string;\n};\n\ntype News = {\n  id: number;\n  title: string;\n  source: string;\n  createdAt: string | null;\n};\n\nexport default function AdminSimple() {\n  const { user: currentUser } = useAuth();\n  const { toast } = useToast();\n\n  const [properties, setProperties] = useState<Property[]>([]);\n  const [users, setUsers] = useState<User[]>([]);\n  const [news, setNews] = useState<News[]>([]);\n  const [activeTab, setActiveTab] = useState(\"properties\");\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [isDeleting, setIsDeleting] = useState<number | null>(null);\n\n  // 데이터 로드\n  useEffect(() => {\n    loadData();\n  }, [activeTab]);\n\n  const loadData = async () => {\n    setIsLoading(true);\n    setError(null);\n    try {\n      if (activeTab === \"properties\" || activeTab === \"\") {\n        const res = await fetch(\"/api/properties\");\n        if (!res.ok) throw new Error(\"Failed to load properties\");\n        const data = await res.json();\n        setProperties(data);\n      } else if (activeTab === \"users\") {\n        const res = await fetch(\"/api/admin/users\");\n        if (!res.ok) throw new Error(\"Failed to load users\");\n        const data = await res.json();\n        setUsers(data);\n      } else if (activeTab === \"news\") {\n        const res = await fetch(\"/api/news\");\n        if (!res.ok) throw new Error(\"Failed to load news\");\n        const data = await res.json();\n        setNews(data);\n      }\n    } catch (err) {\n      setError(err instanceof Error ? err.message : \"An unknown error occurred\");\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // 삭제 핸들러\n  const handleDelete = async (id: number, type: \"property\" | \"user\" | \"news\") => {\n    try {\n      setIsDeleting(id);\n      \n      let endpoint = \"\";\n      switch (type) {\n        case \"property\":\n          endpoint = `/api/properties/${id}`;\n          break;\n        case \"user\":\n          endpoint = `/api/admin/users/${id}`;\n          break;\n        case \"news\":\n          endpoint = `/api/news/${id}`;\n          break;\n      }\n      \n      const res = await apiRequest(\"DELETE\", endpoint);\n      if (!res.ok) throw new Error(`Failed to delete ${type}`);\n      \n      // UI 업데이트\n      if (type === \"property\") {\n        setProperties(prev => prev.filter(item => item.id !== id));\n      } else if (type === \"user\") {\n        setUsers(prev => prev.filter(item => item.id !== id));\n      } else if (type === \"news\") {\n        setNews(prev => prev.filter(item => item.id !== id));\n      }\n      \n      toast({\n        title: `${type} 삭제 성공`,\n        description: `${type === \"property\" ? \"부동산\" : type === \"user\" ? \"사용자\" : \"뉴스\"}가 삭제되었습니다.`,\n      });\n    } catch (err) {\n      toast({\n        title: `${type} 삭제 실패`,\n        description: err instanceof Error ? err.message : \"An unknown error occurred\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsDeleting(null);\n    }\n  };\n\n  // 로딩 상태\n  if (isLoading && properties.length === 0 && users.length === 0 && news.length === 0) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\n      </div>\n    );\n  }\n\n  // 에러 상태\n  if (error) {\n    return (\n      <div className=\"container mx-auto py-10 text-center\">\n        <h2 className=\"text-2xl text-red-500 mb-4\">Error: {error}</h2>\n        <Button onClick={loadData}>다시 시도</Button>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"container mx-auto py-6 space-y-6\">\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h1 className=\"text-3xl font-bold\">관리자 패널</h1>\n          <Breadcrumb className=\"mt-2\">\n            <BreadcrumbList>\n              <BreadcrumbItem>\n                <BreadcrumbLink href=\"/\">\n                  <Home className=\"h-4 w-4 mr-1\" />\n                  홈\n                </BreadcrumbLink>\n              </BreadcrumbItem>\n              <BreadcrumbSeparator />\n              <BreadcrumbItem>\n                <BreadcrumbPage>관리자 패널</BreadcrumbPage>\n              </BreadcrumbItem>\n            </BreadcrumbList>\n          </Breadcrumb>\n        </div>\n        <div className=\"flex items-center gap-4\">\n          <p className=\"text-muted-foreground\">\n            <span className=\"font-bold\">{currentUser?.username}</span> ({currentUser?.role})\n          </p>\n        </div>\n      </div>\n\n      <Tabs value={activeTab} onValueChange={setActiveTab}>\n        <TabsList className=\"grid w-full grid-cols-3\">\n          <TabsTrigger value=\"properties\">부동산 관리</TabsTrigger>\n          <TabsTrigger value=\"news\">뉴스 관리</TabsTrigger>\n          <TabsTrigger value=\"users\" disabled={currentUser?.role !== \"admin\"}>\n            사용자 관리\n          </TabsTrigger>\n        </TabsList>\n\n        {/* 부동산 관리 탭 */}\n        <TabsContent value=\"properties\">\n          <div className=\"bg-white p-6 rounded-lg shadow\">\n            <div className=\"flex justify-between items-center mb-4\">\n              <h2 className=\"text-xl font-bold\">부동산 목록</h2>\n              <Button onClick={() => window.location.href = \"/admin\"}>\n                <Plus className=\"h-4 w-4 mr-2\" />\n                부동산 등록\n              </Button>\n            </div>\n            <div className=\"overflow-x-auto\">\n              <Table>\n                <TableCaption>총 {properties.length}개의 부동산 매물</TableCaption>\n                <TableHeader>\n                  <TableRow>\n                    <TableHead>ID</TableHead>\n                    <TableHead>제목</TableHead>\n                    <TableHead>유형</TableHead>\n                    <TableHead>지역</TableHead>\n                    <TableHead>가격</TableHead>\n                    <TableHead>특징</TableHead>\n                    <TableHead className=\"text-right\">관리</TableHead>\n                  </TableRow>\n                </TableHeader>\n                <TableBody>\n                  {properties.map((property) => (\n                    <TableRow key={property.id}>\n                      <TableCell className=\"font-medium\">{property.id}</TableCell>\n                      <TableCell className=\"max-w-[200px] truncate\">{property.title}</TableCell>\n                      <TableCell>{property.type}</TableCell>\n                      <TableCell>{property.district}</TableCell>\n                      <TableCell>{parseInt(property.price).toLocaleString()}원</TableCell>\n                      <TableCell>\n                        {property.featured && (\n                          <div className=\"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800\">\n                            <Check className=\"h-3 w-3 mr-1\" />\n                            추천\n                          </div>\n                        )}\n                      </TableCell>\n                      <TableCell className=\"text-right\">\n                        <div className=\"flex justify-end gap-2\">\n                          <Button\n                            variant=\"outline\"\n                            size=\"icon\"\n                            onClick={() => window.location.href = \"/admin\"}\n                          >\n                            <Edit className=\"h-4 w-4\" />\n                          </Button>\n                          <Button\n                            variant=\"destructive\"\n                            size=\"icon\"\n                            onClick={() => {\n                              if (confirm(\"정말로 이 부동산을 삭제하시겠습니까?\")) {\n                                handleDelete(property.id, \"property\");\n                              }\n                            }}\n                            disabled={isDeleting === property.id}\n                          >\n                            {isDeleting === property.id ? (\n                              <Loader2 className=\"h-4 w-4 animate-spin\" />\n                            ) : (\n                              <Trash2 className=\"h-4 w-4\" />\n                            )}\n                          </Button>\n                        </div>\n                      </TableCell>\n                    </TableRow>\n                  ))}\n                </TableBody>\n              </Table>\n            </div>\n          </div>\n        </TabsContent>\n\n        {/* 뉴스 관리 탭 */}\n        <TabsContent value=\"news\">\n          <div className=\"bg-white p-6 rounded-lg shadow\">\n            <h2 className=\"text-xl font-bold mb-4\">뉴스 목록</h2>\n            <div className=\"overflow-x-auto\">\n              <Table>\n                <TableCaption>총 {news.length}개의 뉴스</TableCaption>\n                <TableHeader>\n                  <TableRow>\n                    <TableHead>ID</TableHead>\n                    <TableHead>제목</TableHead>\n                    <TableHead>날짜</TableHead>\n                    <TableHead>출처</TableHead>\n                    <TableHead className=\"text-right\">관리</TableHead>\n                  </TableRow>\n                </TableHeader>\n                <TableBody>\n                  {news.map((item) => (\n                    <TableRow key={item.id}>\n                      <TableCell className=\"font-medium\">{item.id}</TableCell>\n                      <TableCell className=\"max-w-[300px] truncate\">{item.title}</TableCell>\n                      <TableCell>\n                        {item.createdAt ? new Date(item.createdAt).toLocaleDateString() : '-'}\n                      </TableCell>\n                      <TableCell>\n                        {item.source || \"네이버 뉴스\"}\n                      </TableCell>\n                      <TableCell className=\"text-right\">\n                        <Button\n                          variant=\"destructive\"\n                          size=\"icon\"\n                          onClick={() => {\n                            if (confirm(\"정말로 이 뉴스를 삭제하시겠습니까?\")) {\n                              handleDelete(item.id, \"news\");\n                            }\n                          }}\n                          disabled={isDeleting === item.id}\n                        >\n                          {isDeleting === item.id ? (\n                            <Loader2 className=\"h-4 w-4 animate-spin\" />\n                          ) : (\n                            <Trash2 className=\"h-4 w-4\" />\n                          )}\n                        </Button>\n                      </TableCell>\n                    </TableRow>\n                  ))}\n                </TableBody>\n              </Table>\n            </div>\n          </div>\n        </TabsContent>\n\n        {/* 사용자 관리 탭 */}\n        <TabsContent value=\"users\">\n          <div className=\"bg-white p-6 rounded-lg shadow\">\n            <h2 className=\"text-xl font-bold mb-4\">사용자 목록</h2>\n            <div className=\"overflow-x-auto\">\n              <Table>\n                <TableCaption>총 {users.length}명의 사용자</TableCaption>\n                <TableHeader>\n                  <TableRow>\n                    <TableHead>ID</TableHead>\n                    <TableHead>사용자명</TableHead>\n                    <TableHead>이메일</TableHead>\n                    <TableHead>권한</TableHead>\n                    <TableHead className=\"text-right\">관리</TableHead>\n                  </TableRow>\n                </TableHeader>\n                <TableBody>\n                  {users.map((user) => (\n                    <TableRow key={user.id}>\n                      <TableCell className=\"font-medium\">{user.id}</TableCell>\n                      <TableCell>{user.username}</TableCell>\n                      <TableCell>{user.email}</TableCell>\n                      <TableCell>{user.role}</TableCell>\n                      <TableCell className=\"text-right\">\n                        <Button\n                          variant=\"destructive\"\n                          size=\"icon\"\n                          onClick={() => {\n                            if (user.role === \"admin\") {\n                              toast({\n                                title: \"관리자 계정을 삭제할 수 없습니다\",\n                                variant: \"destructive\",\n                              });\n                              return;\n                            }\n                            if (confirm(\"정말로 이 사용자를 삭제하시겠습니까?\")) {\n                              handleDelete(user.id, \"user\");\n                            }\n                          }}\n                          disabled={isDeleting === user.id || user.role === \"admin\"}\n                        >\n                          {isDeleting === user.id ? (\n                            <Loader2 className=\"h-4 w-4 animate-spin\" />\n                          ) : (\n                            <Trash2 className=\"h-4 w-4\" />\n                          )}\n                        </Button>\n                      </TableCell>\n                    </TableRow>\n                  ))}\n                </TableBody>\n              </Table>\n            </div>\n          </div>\n        </TabsContent>\n      </Tabs>\n    </div>\n  );\n}","path":null,"size_bytes":14365,"size_tokens":null},"client/src/components/ui/sidebar.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { VariantProps, cva } from \"class-variance-authority\"\nimport { PanelLeft } from \"lucide-react\"\n\nimport { useIsMobile } from \"@/hooks/use-mobile\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Separator } from \"@/components/ui/separator\"\nimport {\n  Sheet,\n  SheetContent,\n  SheetDescription,\n  SheetHeader,\n  SheetTitle,\n} from \"@/components/ui/sheet\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\"\n\nconst SIDEBAR_COOKIE_NAME = \"sidebar_state\"\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7\nconst SIDEBAR_WIDTH = \"16rem\"\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\"\nconst SIDEBAR_WIDTH_ICON = \"3rem\"\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\"\n\ntype SidebarContextProps = {\n  state: \"expanded\" | \"collapsed\"\n  open: boolean\n  setOpen: (open: boolean) => void\n  openMobile: boolean\n  setOpenMobile: (open: boolean) => void\n  isMobile: boolean\n  toggleSidebar: () => void\n}\n\nconst SidebarContext = React.createContext<SidebarContextProps | null>(null)\n\nfunction useSidebar() {\n  const context = React.useContext(SidebarContext)\n  if (!context) {\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\")\n  }\n\n  return context\n}\n\nconst SidebarProvider = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    defaultOpen?: boolean\n    open?: boolean\n    onOpenChange?: (open: boolean) => void\n  }\n>(\n  (\n    {\n      defaultOpen = true,\n      open: openProp,\n      onOpenChange: setOpenProp,\n      className,\n      style,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const isMobile = useIsMobile()\n    const [openMobile, setOpenMobile] = React.useState(false)\n\n    // This is the internal state of the sidebar.\n    // We use openProp and setOpenProp for control from outside the component.\n    const [_open, _setOpen] = React.useState(defaultOpen)\n    const open = openProp ?? _open\n    const setOpen = React.useCallback(\n      (value: boolean | ((value: boolean) => boolean)) => {\n        const openState = typeof value === \"function\" ? value(open) : value\n        if (setOpenProp) {\n          setOpenProp(openState)\n        } else {\n          _setOpen(openState)\n        }\n\n        // This sets the cookie to keep the sidebar state.\n        document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`\n      },\n      [setOpenProp, open]\n    )\n\n    // Helper to toggle the sidebar.\n    const toggleSidebar = React.useCallback(() => {\n      return isMobile\n        ? setOpenMobile((open) => !open)\n        : setOpen((open) => !open)\n    }, [isMobile, setOpen, setOpenMobile])\n\n    // Adds a keyboard shortcut to toggle the sidebar.\n    React.useEffect(() => {\n      const handleKeyDown = (event: KeyboardEvent) => {\n        if (\n          event.key === SIDEBAR_KEYBOARD_SHORTCUT &&\n          (event.metaKey || event.ctrlKey)\n        ) {\n          event.preventDefault()\n          toggleSidebar()\n        }\n      }\n\n      window.addEventListener(\"keydown\", handleKeyDown)\n      return () => window.removeEventListener(\"keydown\", handleKeyDown)\n    }, [toggleSidebar])\n\n    // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\n    // This makes it easier to style the sidebar with Tailwind classes.\n    const state = open ? \"expanded\" : \"collapsed\"\n\n    const contextValue = React.useMemo<SidebarContextProps>(\n      () => ({\n        state,\n        open,\n        setOpen,\n        isMobile,\n        openMobile,\n        setOpenMobile,\n        toggleSidebar,\n      }),\n      [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]\n    )\n\n    return (\n      <SidebarContext.Provider value={contextValue}>\n        <TooltipProvider delayDuration={0}>\n          <div\n            style={\n              {\n                \"--sidebar-width\": SIDEBAR_WIDTH,\n                \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\n                ...style,\n              } as React.CSSProperties\n            }\n            className={cn(\n              \"group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar\",\n              className\n            )}\n            ref={ref}\n            {...props}\n          >\n            {children}\n          </div>\n        </TooltipProvider>\n      </SidebarContext.Provider>\n    )\n  }\n)\nSidebarProvider.displayName = \"SidebarProvider\"\n\nconst Sidebar = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    side?: \"left\" | \"right\"\n    variant?: \"sidebar\" | \"floating\" | \"inset\"\n    collapsible?: \"offcanvas\" | \"icon\" | \"none\"\n  }\n>(\n  (\n    {\n      side = \"left\",\n      variant = \"sidebar\",\n      collapsible = \"offcanvas\",\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const { isMobile, state, openMobile, setOpenMobile } = useSidebar()\n\n    if (collapsible === \"none\") {\n      return (\n        <div\n          className={cn(\n            \"flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground\",\n            className\n          )}\n          ref={ref}\n          {...props}\n        >\n          {children}\n        </div>\n      )\n    }\n\n    if (isMobile) {\n      return (\n        <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\n          <SheetContent\n            data-sidebar=\"sidebar\"\n            data-mobile=\"true\"\n            className=\"w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden\"\n            style={\n              {\n                \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE,\n              } as React.CSSProperties\n            }\n            side={side}\n          >\n            <SheetHeader className=\"sr-only\">\n              <SheetTitle>Sidebar</SheetTitle>\n              <SheetDescription>Displays the mobile sidebar.</SheetDescription>\n            </SheetHeader>\n            <div className=\"flex h-full w-full flex-col\">{children}</div>\n          </SheetContent>\n        </Sheet>\n      )\n    }\n\n    return (\n      <div\n        ref={ref}\n        className=\"group peer hidden text-sidebar-foreground md:block\"\n        data-state={state}\n        data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\n        data-variant={variant}\n        data-side={side}\n      >\n        {/* This is what handles the sidebar gap on desktop */}\n        <div\n          className={cn(\n            \"relative w-[--sidebar-width] bg-transparent transition-[width] duration-200 ease-linear\",\n            \"group-data-[collapsible=offcanvas]:w-0\",\n            \"group-data-[side=right]:rotate-180\",\n            variant === \"floating\" || variant === \"inset\"\n              ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]\"\n              : \"group-data-[collapsible=icon]:w-[--sidebar-width-icon]\"\n          )}\n        />\n        <div\n          className={cn(\n            \"fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] duration-200 ease-linear md:flex\",\n            side === \"left\"\n              ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\n              : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\n            // Adjust the padding for floating and inset variants.\n            variant === \"floating\" || variant === \"inset\"\n              ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]\"\n              : \"group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l\",\n            className\n          )}\n          {...props}\n        >\n          <div\n            data-sidebar=\"sidebar\"\n            className=\"flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow\"\n          >\n            {children}\n          </div>\n        </div>\n      </div>\n    )\n  }\n)\nSidebar.displayName = \"Sidebar\"\n\nconst SidebarTrigger = React.forwardRef<\n  React.ElementRef<typeof Button>,\n  React.ComponentProps<typeof Button>\n>(({ className, onClick, ...props }, ref) => {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <Button\n      ref={ref}\n      data-sidebar=\"trigger\"\n      variant=\"ghost\"\n      size=\"icon\"\n      className={cn(\"h-7 w-7\", className)}\n      onClick={(event) => {\n        onClick?.(event)\n        toggleSidebar()\n      }}\n      {...props}\n    >\n      <PanelLeft />\n      <span className=\"sr-only\">Toggle Sidebar</span>\n    </Button>\n  )\n})\nSidebarTrigger.displayName = \"SidebarTrigger\"\n\nconst SidebarRail = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\">\n>(({ className, ...props }, ref) => {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <button\n      ref={ref}\n      data-sidebar=\"rail\"\n      aria-label=\"Toggle Sidebar\"\n      tabIndex={-1}\n      onClick={toggleSidebar}\n      title=\"Toggle Sidebar\"\n      className={cn(\n        \"absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex\",\n        \"[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize\",\n        \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\n        \"group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar\",\n        \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\n        \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarRail.displayName = \"SidebarRail\"\n\nconst SidebarInset = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"main\">\n>(({ className, ...props }, ref) => {\n  return (\n    <main\n      ref={ref}\n      className={cn(\n        \"relative flex w-full flex-1 flex-col bg-background\",\n        \"md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarInset.displayName = \"SidebarInset\"\n\nconst SidebarInput = React.forwardRef<\n  React.ElementRef<typeof Input>,\n  React.ComponentProps<typeof Input>\n>(({ className, ...props }, ref) => {\n  return (\n    <Input\n      ref={ref}\n      data-sidebar=\"input\"\n      className={cn(\n        \"h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarInput.displayName = \"SidebarInput\"\n\nconst SidebarHeader = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"header\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n})\nSidebarHeader.displayName = \"SidebarHeader\"\n\nconst SidebarFooter = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"footer\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n})\nSidebarFooter.displayName = \"SidebarFooter\"\n\nconst SidebarSeparator = React.forwardRef<\n  React.ElementRef<typeof Separator>,\n  React.ComponentProps<typeof Separator>\n>(({ className, ...props }, ref) => {\n  return (\n    <Separator\n      ref={ref}\n      data-sidebar=\"separator\"\n      className={cn(\"mx-2 w-auto bg-sidebar-border\", className)}\n      {...props}\n    />\n  )\n})\nSidebarSeparator.displayName = \"SidebarSeparator\"\n\nconst SidebarContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"content\"\n      className={cn(\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarContent.displayName = \"SidebarContent\"\n\nconst SidebarGroup = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"group\"\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\n      {...props}\n    />\n  )\n})\nSidebarGroup.displayName = \"SidebarGroup\"\n\nconst SidebarGroupLabel = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & { asChild?: boolean }\n>(({ className, asChild = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"group-label\"\n      className={cn(\n        \"flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarGroupLabel.displayName = \"SidebarGroupLabel\"\n\nconst SidebarGroupAction = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\"> & { asChild?: boolean }\n>(({ className, asChild = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"group-action\"\n      className={cn(\n        \"absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 after:md:hidden\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarGroupAction.displayName = \"SidebarGroupAction\"\n\nconst SidebarGroupContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    data-sidebar=\"group-content\"\n    className={cn(\"w-full text-sm\", className)}\n    {...props}\n  />\n))\nSidebarGroupContent.displayName = \"SidebarGroupContent\"\n\nconst SidebarMenu = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    data-sidebar=\"menu\"\n    className={cn(\"flex w-full min-w-0 flex-col gap-1\", className)}\n    {...props}\n  />\n))\nSidebarMenu.displayName = \"SidebarMenu\"\n\nconst SidebarMenuItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    data-sidebar=\"menu-item\"\n    className={cn(\"group/menu-item relative\", className)}\n    {...props}\n  />\n))\nSidebarMenuItem.displayName = \"SidebarMenuItem\"\n\nconst sidebarMenuButtonVariants = cva(\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\",\n        outline:\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\n      },\n      size: {\n        default: \"h-8 text-sm\",\n        sm: \"h-7 text-xs\",\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:!p-0\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst SidebarMenuButton = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\"> & {\n    asChild?: boolean\n    isActive?: boolean\n    tooltip?: string | React.ComponentProps<typeof TooltipContent>\n  } & VariantProps<typeof sidebarMenuButtonVariants>\n>(\n  (\n    {\n      asChild = false,\n      isActive = false,\n      variant = \"default\",\n      size = \"default\",\n      tooltip,\n      className,\n      ...props\n    },\n    ref\n  ) => {\n    const Comp = asChild ? Slot : \"button\"\n    const { isMobile, state } = useSidebar()\n\n    const button = (\n      <Comp\n        ref={ref}\n        data-sidebar=\"menu-button\"\n        data-size={size}\n        data-active={isActive}\n        className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\n        {...props}\n      />\n    )\n\n    if (!tooltip) {\n      return button\n    }\n\n    if (typeof tooltip === \"string\") {\n      tooltip = {\n        children: tooltip,\n      }\n    }\n\n    return (\n      <Tooltip>\n        <TooltipTrigger asChild>{button}</TooltipTrigger>\n        <TooltipContent\n          side=\"right\"\n          align=\"center\"\n          hidden={state !== \"collapsed\" || isMobile}\n          {...tooltip}\n        />\n      </Tooltip>\n    )\n  }\n)\nSidebarMenuButton.displayName = \"SidebarMenuButton\"\n\nconst SidebarMenuAction = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\"> & {\n    asChild?: boolean\n    showOnHover?: boolean\n  }\n>(({ className, asChild = false, showOnHover = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"menu-action\"\n      className={cn(\n        \"absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 peer-hover/menu-button:text-sidebar-accent-foreground [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 after:md:hidden\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        showOnHover &&\n          \"group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarMenuAction.displayName = \"SidebarMenuAction\"\n\nconst SidebarMenuBadge = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    data-sidebar=\"menu-badge\"\n    className={cn(\n      \"pointer-events-none absolute right-1 flex h-5 min-w-5 select-none items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground\",\n      \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\n      \"peer-data-[size=sm]/menu-button:top-1\",\n      \"peer-data-[size=default]/menu-button:top-1.5\",\n      \"peer-data-[size=lg]/menu-button:top-2.5\",\n      \"group-data-[collapsible=icon]:hidden\",\n      className\n    )}\n    {...props}\n  />\n))\nSidebarMenuBadge.displayName = \"SidebarMenuBadge\"\n\nconst SidebarMenuSkeleton = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    showIcon?: boolean\n  }\n>(({ className, showIcon = false, ...props }, ref) => {\n  // Random width between 50 to 90%.\n  const width = React.useMemo(() => {\n    return `${Math.floor(Math.random() * 40) + 50}%`\n  }, [])\n\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"menu-skeleton\"\n      className={cn(\"flex h-8 items-center gap-2 rounded-md px-2\", className)}\n      {...props}\n    >\n      {showIcon && (\n        <Skeleton\n          className=\"size-4 rounded-md\"\n          data-sidebar=\"menu-skeleton-icon\"\n        />\n      )}\n      <Skeleton\n        className=\"h-4 max-w-[--skeleton-width] flex-1\"\n        data-sidebar=\"menu-skeleton-text\"\n        style={\n          {\n            \"--skeleton-width\": width,\n          } as React.CSSProperties\n        }\n      />\n    </div>\n  )\n})\nSidebarMenuSkeleton.displayName = \"SidebarMenuSkeleton\"\n\nconst SidebarMenuSub = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    data-sidebar=\"menu-sub\"\n    className={cn(\n      \"mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5\",\n      \"group-data-[collapsible=icon]:hidden\",\n      className\n    )}\n    {...props}\n  />\n))\nSidebarMenuSub.displayName = \"SidebarMenuSub\"\n\nconst SidebarMenuSubItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ ...props }, ref) => <li ref={ref} {...props} />)\nSidebarMenuSubItem.displayName = \"SidebarMenuSubItem\"\n\nconst SidebarMenuSubButton = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentProps<\"a\"> & {\n    asChild?: boolean\n    size?: \"sm\" | \"md\"\n    isActive?: boolean\n  }\n>(({ asChild = false, size = \"md\", isActive, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"menu-sub-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(\n        \"flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground\",\n        \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\n        size === \"sm\" && \"text-xs\",\n        size === \"md\" && \"text-sm\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarMenuSubButton.displayName = \"SidebarMenuSubButton\"\n\nexport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupAction,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarInput,\n  SidebarInset,\n  SidebarMenu,\n  SidebarMenuAction,\n  SidebarMenuBadge,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSkeleton,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n  SidebarProvider,\n  SidebarRail,\n  SidebarSeparator,\n  SidebarTrigger,\n  useSidebar,\n}\n","path":null,"size_bytes":23567,"size_tokens":null},"client/src/components/ui/alert.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-background text-foreground\",\n        destructive:\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }\n","path":null,"size_bytes":1584,"size_tokens":null},"client/src/hooks/use-mobile.tsx":{"content":"import * as React from \"react\"\n\nconst MOBILE_BREAKPOINT = 768\n\nexport function useIsMobile() {\n  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)\n\n  React.useEffect(() => {\n    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)\n    const onChange = () => {\n      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    }\n    mql.addEventListener(\"change\", onChange)\n    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    return () => mql.removeEventListener(\"change\", onChange)\n  }, [])\n\n  return !!isMobile\n}\n","path":null,"size_bytes":565,"size_tokens":null},"client/src/components/ui/aspect-ratio.tsx":{"content":"import * as AspectRatioPrimitive from \"@radix-ui/react-aspect-ratio\"\n\nconst AspectRatio = AspectRatioPrimitive.Root\n\nexport { AspectRatio }\n","path":null,"size_bytes":140,"size_tokens":null},"client/src/components/ui/input-otp.tsx":{"content":"import * as React from \"react\"\nimport { OTPInput, OTPInputContext } from \"input-otp\"\nimport { Dot } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst InputOTP = React.forwardRef<\n  React.ElementRef<typeof OTPInput>,\n  React.ComponentPropsWithoutRef<typeof OTPInput>\n>(({ className, containerClassName, ...props }, ref) => (\n  <OTPInput\n    ref={ref}\n    containerClassName={cn(\n      \"flex items-center gap-2 has-[:disabled]:opacity-50\",\n      containerClassName\n    )}\n    className={cn(\"disabled:cursor-not-allowed\", className)}\n    {...props}\n  />\n))\nInputOTP.displayName = \"InputOTP\"\n\nconst InputOTPGroup = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"flex items-center\", className)} {...props} />\n))\nInputOTPGroup.displayName = \"InputOTPGroup\"\n\nconst InputOTPSlot = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\"> & { index: number }\n>(({ index, className, ...props }, ref) => {\n  const inputOTPContext = React.useContext(OTPInputContext)\n  const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index]\n\n  return (\n    <div\n      ref={ref}\n      className={cn(\n        \"relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md\",\n        isActive && \"z-10 ring-2 ring-ring ring-offset-background\",\n        className\n      )}\n      {...props}\n    >\n      {char}\n      {hasFakeCaret && (\n        <div className=\"pointer-events-none absolute inset-0 flex items-center justify-center\">\n          <div className=\"h-4 w-px animate-caret-blink bg-foreground duration-1000\" />\n        </div>\n      )}\n    </div>\n  )\n})\nInputOTPSlot.displayName = \"InputOTPSlot\"\n\nconst InputOTPSeparator = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ ...props }, ref) => (\n  <div ref={ref} role=\"separator\" {...props}>\n    <Dot />\n  </div>\n))\nInputOTPSeparator.displayName = \"InputOTPSeparator\"\n\nexport { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator }\n","path":null,"size_bytes":2154,"size_tokens":null},"client/src/pages/UsersPage.jsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useLocation } from \"wouter\";\nimport { \n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from \"@/components/ui/alert-dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Loader2, Trash2, RefreshCw } from \"lucide-react\";\n\nexport default function UsersPage() {\n  const { user } = useAuth();\n  const { toast } = useToast();\n  const [, setLocation] = useLocation();\n  const [users, setUsers] = useState([]);\n  const [isLoading, setIsLoading] = useState(true);\n  \n  // 삭제 다이얼로그 상태\n  const [deleteDialog, setDeleteDialog] = useState({\n    isOpen: false,\n    userId: null,\n    username: \"\"\n  });\n  \n  // 사용자 데이터 로드\n  const loadUsers = async () => {\n    if (!user || user.role !== \"admin\") {\n      setLocation(\"/\"); // 관리자가 아니면 홈으로\n      return;\n    }\n    \n    try {\n      setIsLoading(true);\n      \n      const response = await fetch(\"/api/admin/users\", {\n        credentials: \"include\"\n      });\n      \n      if (response.ok) {\n        const data = await response.json();\n        console.log(\"사용자 데이터:\", data);\n        \n        // 전화번호 하드코딩\n        const usersWithPhone = data.map(userData => {\n          // ID 기반 하드코딩\n          let phoneNumber = userData.phone || \"전화번호 없음\";\n          \n          if (userData.id === 1) phoneNumber = \"010-4787-3120\";\n          else if (userData.id === 3) phoneNumber = \"01047873120\";\n          else if (userData.id === 4) phoneNumber = \"미제공\";\n          \n          return {\n            ...userData,\n            phoneDisplay: phoneNumber\n          };\n        });\n        \n        setUsers(usersWithPhone);\n      } else {\n        toast({\n          title: \"오류\",\n          description: \"사용자 데이터를 불러오는데 실패했습니다\",\n          variant: \"destructive\"\n        });\n      }\n    } catch (error) {\n      console.error(\"사용자 로드 오류:\", error);\n      toast({\n        title: \"오류\",\n        description: \"사용자 데이터를 불러오는데 실패했습니다\",\n        variant: \"destructive\"\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  \n  // 사용자 삭제\n  const deleteUser = async (userId) => {\n    try {\n      const response = await fetch(`/api/admin/users/${userId}`, {\n        method: \"DELETE\",\n        credentials: \"include\"\n      });\n      \n      if (response.ok) {\n        // 삭제 성공\n        setUsers(users.filter(u => u.id !== userId));\n        toast({\n          title: \"삭제 완료\",\n          description: \"사용자가 성공적으로 삭제되었습니다\",\n        });\n      } else {\n        toast({\n          title: \"삭제 실패\",\n          description: \"사용자를 삭제하는데 실패했습니다\",\n          variant: \"destructive\"\n        });\n      }\n    } catch (error) {\n      console.error(\"사용자 삭제 오류:\", error);\n      toast({\n        title: \"오류\",\n        description: \"사용자를 삭제하는데 실패했습니다\",\n        variant: \"destructive\"\n      });\n    }\n  };\n  \n  // 삭제 다이얼로그 열기\n  const openDeleteDialog = (userId, username) => {\n    setDeleteDialog({\n      isOpen: true,\n      userId,\n      username\n    });\n  };\n  \n  // 삭제 다이얼로그 닫기\n  const closeDeleteDialog = () => {\n    setDeleteDialog({\n      isOpen: false,\n      userId: null,\n      username: \"\"\n    });\n  };\n  \n  // 삭제 확인\n  const confirmDelete = () => {\n    if (deleteDialog.userId) {\n      deleteUser(deleteDialog.userId);\n    }\n    closeDeleteDialog();\n  };\n  \n  // 초기 데이터 로드\n  useEffect(() => {\n    loadUsers();\n  }, [user]);\n  \n  // 관리자가 아니면 홈으로\n  if (!user || user.role !== \"admin\") {\n    return null;\n  }\n  \n  return (\n    <div className=\"container mx-auto py-8\">\n      <div className=\"bg-white rounded-lg shadow p-6\">\n        <div className=\"flex justify-between items-center mb-6\">\n          <h1 className=\"text-2xl font-bold\">사용자 관리</h1>\n          <Button \n            onClick={loadUsers}\n            variant=\"outline\"\n            className=\"flex items-center gap-1\"\n          >\n            <RefreshCw className=\"h-4 w-4\" /> 새로고침\n          </Button>\n        </div>\n        \n        {isLoading ? (\n          <div className=\"flex justify-center items-center py-12\">\n            <Loader2 className=\"h-8 w-8 animate-spin mr-2\" />\n            <p>사용자 정보를 불러오는 중...</p>\n          </div>\n        ) : (\n          <div className=\"overflow-x-auto\">\n            <table className=\"min-w-full bg-white border border-gray-200 rounded-lg\">\n              <thead className=\"bg-gray-50\">\n                <tr>\n                  <th className=\"py-3 px-6 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-b\">\n                    번호\n                  </th>\n                  <th className=\"py-3 px-6 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-b\">\n                    사용자명\n                  </th>\n                  <th className=\"py-3 px-6 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-b\">\n                    전화번호\n                  </th>\n                  <th className=\"py-3 px-6 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-b\">\n                    이메일\n                  </th>\n                  <th className=\"py-3 px-6 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-b\">\n                    권한\n                  </th>\n                  <th className=\"py-3 px-6 text-right text-xs font-medium text-gray-500 uppercase tracking-wider border-b\">\n                    작업\n                  </th>\n                </tr>\n              </thead>\n              <tbody className=\"divide-y divide-gray-200\">\n                {users.length === 0 ? (\n                  <tr>\n                    <td colSpan={6} className=\"px-6 py-4 text-center text-gray-500\">\n                      등록된 사용자가 없습니다.\n                    </td>\n                  </tr>\n                ) : (\n                  users.map((user, index) => (\n                    <tr key={user.id} className={index % 2 === 0 ? \"bg-white\" : \"bg-gray-50\"}>\n                      <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\n                        {user.id}\n                      </td>\n                      <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900\">\n                        {user.username}\n                      </td>\n                      <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\n                        {user.phoneDisplay}\n                      </td>\n                      <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\n                        {user.email || \"-\"}\n                      </td>\n                      <td className=\"px-6 py-4 whitespace-nowrap\">\n                        <span \n                          className={`px-2 py-1 text-xs leading-5 font-semibold rounded-full ${\n                            user.role === \"admin\"\n                              ? \"bg-purple-100 text-purple-800\"\n                              : \"bg-blue-100 text-blue-800\"\n                          }`}\n                        >\n                          {user.role === \"admin\" ? \"관리자\" : \"일반사용자\"}\n                        </span>\n                      </td>\n                      <td className=\"px-6 py-4 whitespace-nowrap text-right text-sm font-medium\">\n                        <Button\n                          variant=\"destructive\"\n                          size=\"sm\"\n                          disabled={user.id === 1}\n                          onClick={() => openDeleteDialog(user.id, user.username)}\n                        >\n                          <Trash2 className=\"h-4 w-4\" />\n                        </Button>\n                      </td>\n                    </tr>\n                  ))\n                )}\n              </tbody>\n            </table>\n          </div>\n        )}\n      </div>\n      \n      {/* 삭제 확인 다이얼로그 */}\n      <AlertDialog open={deleteDialog.isOpen} onOpenChange={closeDeleteDialog}>\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>사용자 삭제</AlertDialogTitle>\n            <AlertDialogDescription>\n              정말로 <span className=\"font-semibold\">{deleteDialog.username}</span> 사용자를 삭제하시겠습니까?\n              <br />이 작업은 되돌릴 수 없습니다.\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel>취소</AlertDialogCancel>\n            <AlertDialogAction \n              onClick={confirmDelete}\n              className=\"bg-red-600 hover:bg-red-700\"\n            >\n              삭제\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n    </div>\n  );\n}","path":null,"size_bytes":9286,"size_tokens":null},"client/src/components/layout/Footer.tsx":{"content":"import { Link } from \"wouter\";\nimport { Building, Facebook, Instagram, Youtube } from \"lucide-react\";\n\nconst Footer = () => {\n  return (\n    <footer className=\"bg-gray-900 text-white pt-12 pb-6\">\n      <div className=\"container mx-auto px-4\">\n        <div className=\"mb-8\">\n          <div>\n            <h3 className=\"text-xl font-bold mb-4\">이가이버부동산</h3>\n            <p className=\"text-gray-400 mb-4\">\n              상호: 이가이버공인중개사 사무소<br />\n              대표: 이민호<br />\n              주소: 인천광역시 강화군 강화읍 남문로51, 1호<br />\n              등록번호: 28710-2021-00012<br />\n              연락처: 032.934.3120 / 010.4787.3120<br />\n              이메일: 9551304@naver.com\n            </p>\n            <div className=\"flex space-x-6 mt-4\">\n              <a href=\"https://www.youtube.com/channel/UCCG3_JlKhgalqhict7tKkbA\" target=\"_blank\" rel=\"noopener noreferrer\" className=\"hover:opacity-80 transition-opacity\">\n                <img src=\"/youtube.png\" alt=\"YouTube\" width=\"36\" height=\"36\" />\n              </a>\n              <a href=\"https://www.instagram.com/leegyvertv/\" target=\"_blank\" rel=\"noopener noreferrer\" className=\"hover:opacity-80 transition-opacity\">\n                <img src=\"/instagram.png\" alt=\"Instagram\" width=\"36\" height=\"36\" />\n              </a>\n              <a href=\"https://blog.naver.com/9551304\" target=\"_blank\" rel=\"noopener noreferrer\" className=\"hover:opacity-80 transition-opacity\">\n                <img src=\"/naver-blog.png\" alt=\"Naver Blog\" width=\"36\" height=\"36\" />\n              </a>\n            </div>\n          </div>\n          \n\n        </div>\n        \n        <div className=\"border-t border-gray-800 pt-6 mt-6\">\n          <p className=\"text-gray-400 text-center\">© {new Date().getFullYear()} 이가이버부동산. All rights reserved.</p>\n        </div>\n      </div>\n    </footer>\n  );\n};\n\nexport default Footer;\n","path":null,"size_bytes":1936,"size_tokens":null},"client/src/pages/NewsDetailPage.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { useParams, useLocation } from \"wouter\";\nimport { News } from \"@shared/schema\";\nimport { Helmet } from \"react-helmet\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Calendar, ChevronLeft, ExternalLink } from \"lucide-react\";\nimport { format } from \"date-fns\";\n\nexport default function NewsDetailPage() {\n  const params = useParams<{ id: string }>();\n  const [, setLocation] = useLocation();\n  const newsId = parseInt(params.id);\n\n  const { data: news, isLoading, error } = useQuery<News>({\n    queryKey: [\"/api/news\", newsId],\n    queryFn: async () => {\n      const response = await fetch(`/api/news/${newsId}`);\n      if (!response.ok) {\n        throw new Error(\"뉴스를 불러올 수 없습니다\");\n      }\n      return response.json();\n    },\n    enabled: !isNaN(newsId),\n  });\n\n  // 날짜 포맷팅 함수\n  const formatDate = (dateString: string | Date) => {\n    const date = typeof dateString === 'string' ? new Date(dateString) : dateString;\n    return format(date, 'yyyy년 MM월 dd일');\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"container mx-auto px-4 py-20\">\n        <div className=\"max-w-3xl mx-auto animate-pulse\">\n          <div className=\"h-10 bg-gray-200 w-3/4 mb-4 rounded\"></div>\n          <div className=\"h-6 bg-gray-200 w-1/4 mb-8 rounded\"></div>\n          <div className=\"space-y-4\">\n            <div className=\"h-4 bg-gray-200 rounded w-full\"></div>\n            <div className=\"h-4 bg-gray-200 rounded w-full\"></div>\n            <div className=\"h-4 bg-gray-200 rounded w-5/6\"></div>\n            <div className=\"h-4 bg-gray-200 rounded w-full\"></div>\n            <div className=\"h-4 bg-gray-200 rounded w-4/6\"></div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  if (error || !news) {\n    return (\n      <div className=\"container mx-auto px-4 py-20\">\n        <div className=\"max-w-3xl mx-auto text-center\">\n          <h1 className=\"text-3xl font-bold mb-4\">뉴스를 찾을 수 없습니다</h1>\n          <p className=\"text-neutral-600 mb-6\">\n            {error instanceof Error ? error.message : \"요청하신 뉴스가 존재하지 않거나 삭제되었습니다.\"}\n          </p>\n          <Button onClick={() => setLocation(\"/news\")}>\n            <ChevronLeft className=\"mr-2 h-4 w-4\" />\n            뉴스 목록으로 돌아가기\n          </Button>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"container mx-auto px-4 py-20\">\n      <Helmet>\n        <title>{news.title} | 부동산뉴스 | 이가이버 부동산</title>\n        <meta name=\"description\" content={news.description} />\n      </Helmet>\n\n      <div className=\"mb-6\">\n        <Button variant=\"ghost\" onClick={() => setLocation(\"/news\")} className=\"mb-6\">\n          <ChevronLeft className=\"mr-2 h-4 w-4\" />\n          뉴스 목록으로 돌아가기\n        </Button>\n      </div>\n\n      <div className=\"max-w-3xl mx-auto\">\n        <Card>\n          <CardHeader>\n            <div className=\"flex justify-between items-center mb-4\">\n              <Badge>{news.category}</Badge>\n              <div className=\"flex items-center text-neutral-500\">\n                <Calendar className=\"mr-2 h-4 w-4\" />\n                <span>{formatDate(news.createdAt!)}</span>\n              </div>\n            </div>\n            <CardTitle className=\"text-2xl md:text-3xl mb-2\">{news.title}</CardTitle>\n            <p className=\"text-neutral-600 text-lg\">{news.description}</p>\n          </CardHeader>\n          <CardContent>\n            <div className=\"prose prose-neutral max-w-none mb-6\">\n              {news.content && news.content.split('\\n').map((paragraph, idx) => (\n                paragraph ? <p key={idx}>{paragraph}</p> : <br key={idx} />\n              ))}\n            </div>\n            \n            <div className=\"mt-8 pt-4 border-t\">\n              <Button variant=\"outline\" className=\"flex items-center\" asChild>\n                <a href={news.sourceUrl} target=\"_blank\" rel=\"noopener noreferrer\">\n                  <span className=\"mr-2\">원문 기사 보기</span>\n                  <ExternalLink className=\"h-4 w-4\" />\n                </a>\n              </Button>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}","path":null,"size_bytes":4398,"size_tokens":null},"client/src/components/property/PropertyInquiryBoard.tsx":{"content":"import { useState } from \"react\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { z } from \"zod\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { PropertyInquiry } from \"@shared/schema\";\n\n// PropertyInquiry에 authorUsername 필드를 추가한 확장 타입\ntype PropertyInquiryWithAuthor = PropertyInquiry & {\n  authorUsername?: string;\n};\n\nimport { \n  Form,\n  FormControl,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from \"@/components/ui/form\";\nimport { Button } from \"@/components/ui/button\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Tabs, TabsList, TabsTrigger, TabsContent } from \"@/components/ui/tabs\";\nimport { toast } from \"@/hooks/use-toast\";\nimport { Loader2, MessageCircle } from \"lucide-react\";\nimport { formatDistanceToNow } from \"date-fns\";\nimport { ko } from \"date-fns/locale\";\n\ninterface PropertyInquiryBoardProps {\n  propertyId: number;\n}\n\n// 문의 작성 폼 스키마\nconst inquiryFormSchema = z.object({\n  title: z.string().min(2, \"제목은 2자 이상이어야 합니다.\").max(100, \"제목은 100자 이하여야 합니다.\"),\n  content: z.string().min(5, \"내용은 5자 이상이어야 합니다.\").max(1000, \"내용은 1000자 이하여야 합니다.\"),\n});\n\ntype InquiryFormValues = z.infer<typeof inquiryFormSchema>;\n\n// 답변 작성 폼 스키마\nconst replyFormSchema = z.object({\n  content: z.string().min(5, \"내용은 5자 이상이어야 합니다.\").max(500, \"내용은 500자 이하여야 합니다.\"),\n});\n\ntype ReplyFormValues = z.infer<typeof replyFormSchema>;\n\nconst PropertyInquiryBoard = ({ propertyId }: PropertyInquiryBoardProps) => {\n  const { user } = useAuth();\n  const [activeTab, setActiveTab] = useState(\"view\");\n  const [replyToId, setReplyToId] = useState<number | null>(null);\n  const [selectedInquiryId, setSelectedInquiryId] = useState<number | null>(null);\n  \n  // 문의글 목록 조회\n  const { \n    data: inquiries, \n    isLoading: inquiriesLoading,\n    refetch: refetchInquiries\n  } = useQuery<PropertyInquiryWithAuthor[]>({\n    queryKey: [`/api/properties/${propertyId}/inquiries`],\n    enabled: !!propertyId,\n  });\n  \n  // 선택된 문의글 찾기\n  const selectedInquiry = selectedInquiryId && inquiries\n    ? inquiries.find(inquiry => inquiry.id === selectedInquiryId)\n    : null;\n  \n  // 문의글 작성을 위한 폼\n  const inquiryForm = useForm<InquiryFormValues>({\n    resolver: zodResolver(inquiryFormSchema),\n    defaultValues: {\n      title: \"\",\n      content: \"\"\n    }\n  });\n  \n  // 답변 작성을 위한 폼\n  const replyForm = useForm<ReplyFormValues>({\n    resolver: zodResolver(replyFormSchema),\n    defaultValues: {\n      content: \"\"\n    }\n  });\n  \n  // 문의글 작성 뮤테이션\n  const inquiryMutation = useMutation({\n    mutationFn: (values: InquiryFormValues) => {\n      return apiRequest(\"POST\", `/api/properties/${propertyId}/inquiries`, {\n        ...values,\n        propertyId,\n        userId: user?.id,\n        isReply: false,\n        parentId: null\n      });\n    },\n    onSuccess: () => {\n      toast({\n        title: \"문의가 등록되었습니다\",\n        description: \"부동산 담당자가 확인 후 답변드리겠습니다.\",\n      });\n      inquiryForm.reset();\n      setActiveTab(\"view\");\n      queryClient.invalidateQueries({ queryKey: [`/api/properties/${propertyId}/inquiries`] });\n    },\n    onError: (error) => {\n      toast({\n        title: \"문의 등록 실패\",\n        description: \"문의 등록 중 오류가 발생했습니다. 다시 시도해주세요.\",\n        variant: \"destructive\",\n      });\n      console.error(\"Inquiry submission error:\", error);\n    }\n  });\n  \n  // 답변 작성 뮤테이션\n  const replyMutation = useMutation({\n    mutationFn: (values: ReplyFormValues) => {\n      return apiRequest(\"POST\", `/api/properties/${propertyId}/inquiries`, {\n        title: \"답변: \" + (inquiries?.find(i => i.id === replyToId)?.title || \"문의에 대한 답변\"),\n        content: values.content,\n        propertyId,\n        userId: user?.id,\n        isReply: true,\n        parentId: replyToId\n      });\n    },\n    onSuccess: () => {\n      toast({\n        title: \"답변이 등록되었습니다\",\n      });\n      replyForm.reset();\n      setReplyToId(null);\n      queryClient.invalidateQueries({ queryKey: [`/api/properties/${propertyId}/inquiries`] });\n    },\n    onError: (error) => {\n      toast({\n        title: \"답변 등록 실패\",\n        description: \"답변 등록 중 오류가 발생했습니다. 다시 시도해주세요.\",\n        variant: \"destructive\",\n      });\n      console.error(\"Reply submission error:\", error);\n    }\n  });\n  \n  // 문의글 삭제 뮤테이션\n  const deleteMutation = useMutation({\n    mutationFn: (inquiryId: number) => {\n      return apiRequest(\"DELETE\", `/api/properties/${propertyId}/inquiries/${inquiryId}`);\n    },\n    onSuccess: () => {\n      toast({\n        title: \"삭제되었습니다\",\n      });\n      if (selectedInquiryId) {\n        setSelectedInquiryId(null);\n      }\n      queryClient.invalidateQueries({ queryKey: [`/api/properties/${propertyId}/inquiries`] });\n    },\n    onError: (error) => {\n      toast({\n        title: \"삭제 실패\",\n        description: \"삭제 중 오류가 발생했습니다. 다시 시도해주세요.\",\n        variant: \"destructive\",\n      });\n      console.error(\"Delete error:\", error);\n    }\n  });\n  \n  // 문의글 제출 핸들러\n  const onInquirySubmit = (data: InquiryFormValues) => {\n    inquiryMutation.mutate(data);\n  };\n  \n  // 답변 제출 핸들러\n  const onReplySubmit = (data: ReplyFormValues) => {\n    replyMutation.mutate(data);\n  };\n  \n  // 답변 작성 모드로 전환하는 핸들러\n  const handleReply = (inquiryId: number) => {\n    setReplyToId(inquiryId);\n    replyForm.reset();\n  };\n  \n  // 문의글 선택 핸들러\n  const handleInquirySelect = (inquiryId: number) => {\n    if (selectedInquiryId === inquiryId) {\n      setSelectedInquiryId(null);\n    } else {\n      setSelectedInquiryId(inquiryId);\n    }\n  };\n  \n  // 문의글 삭제 핸들러\n  const handleDelete = (inquiryId: number) => {\n    if (window.confirm(\"정말로 이 글을 삭제하시겠습니까?\")) {\n      deleteMutation.mutate(inquiryId);\n    }\n  };\n  \n  // 사용자 권한 체크 (본인이 작성한 글이거나 관리자인 경우)\n  const canManageInquiry = (inquiry: PropertyInquiry) => {\n    return user?.id === inquiry.userId || user?.role === \"admin\";\n  };\n  \n  // 로그인하지 않은 사용자에게는 제한된 뷰를 제공, 문의 작성 제한\n  const isLoggedIn = !!user;\n  \n  return (\n    <div>\n      <Tabs value={activeTab} onValueChange={setActiveTab}>\n        <TabsList className=\"grid w-full grid-cols-2\">\n          <TabsTrigger value=\"view\">문의 목록</TabsTrigger>\n          {isLoggedIn ? (\n            <TabsTrigger value=\"write\">문의 작성</TabsTrigger>\n          ) : (\n            <TabsTrigger value=\"login\" onClick={() => window.location.href = \"/auth\"}>\n              로그인 필요\n            </TabsTrigger>\n          )}\n        </TabsList>\n        \n        <TabsContent value=\"view\" className=\"py-4\">\n          {inquiriesLoading ? (\n            <div className=\"flex justify-center py-10\">\n              <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\n            </div>\n          ) : inquiries && inquiries.length > 0 ? (\n            <div className=\"space-y-4\">\n              <div className=\"border rounded-lg overflow-hidden\">\n                <table className=\"w-full\">\n                  <thead className=\"bg-muted/40\">\n                    <tr>\n                      <th className=\"text-left p-3 font-medium\">제목</th>\n                      <th className=\"text-left p-3 font-medium w-24\">작성자</th>\n                      <th className=\"text-left p-3 font-medium w-28\">작성일</th>\n                      <th className=\"text-left p-3 font-medium w-20\">관리</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {inquiries.map(inquiry => (\n                      <tr \n                        key={inquiry.id} \n                        className={`border-t hover:bg-muted/20 cursor-pointer ${selectedInquiryId === inquiry.id ? 'bg-muted/30' : ''} ${inquiry.isReply ? 'bg-muted/10' : ''}`}\n                        onClick={() => handleInquirySelect(inquiry.id)}\n                      >\n                        <td className=\"p-3\">\n                          <div className=\"flex items-center\">\n                            {inquiry.isReply && <span className=\"text-primary mr-2 text-sm\">[답변]</span>}\n                            {inquiry.title}\n                          </div>\n                        </td>\n                        <td className=\"p-3 text-sm\">{inquiry.authorUsername || \"알 수 없음\"}</td>\n                        <td className=\"p-3 text-sm\">\n                          {inquiry.createdAt ? formatDistanceToNow(new Date(inquiry.createdAt), { addSuffix: true, locale: ko }) : \"\"}\n                        </td>\n                        <td className=\"p-3\">\n                          <div className=\"flex space-x-1\">\n                            {!inquiry.isReply && user?.role === \"admin\" && (\n                              <Button \n                                variant=\"outline\" \n                                size=\"icon\"\n                                className=\"h-8 w-8\"\n                                onClick={(e) => {\n                                  e.stopPropagation();\n                                  handleReply(inquiry.id);\n                                }}\n                              >\n                                <MessageCircle size={14} />\n                              </Button>\n                            )}\n                            {canManageInquiry(inquiry) && (\n                              <Button \n                                variant=\"destructive\" \n                                size=\"icon\"\n                                className=\"h-8 w-8\"\n                                onClick={(e) => {\n                                  e.stopPropagation();\n                                  handleDelete(inquiry.id);\n                                }}\n                              >\n                                <span className=\"text-xs\">✕</span>\n                              </Button>\n                            )}\n                          </div>\n                        </td>\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n              </div>\n              \n              {selectedInquiryId && selectedInquiry && (\n                <div className=\"mt-4 border rounded-lg p-4\">\n                  <div className=\"flex justify-between items-center mb-4\">\n                    <h3 className=\"font-bold text-lg\">{selectedInquiry.title}</h3>\n                    <Button \n                      variant=\"ghost\" \n                      size=\"sm\" \n                      onClick={() => setSelectedInquiryId(null)}\n                    >\n                      닫기\n                    </Button>\n                  </div>\n                  <p className=\"mb-4 whitespace-pre-wrap\">{selectedInquiry.content}</p>\n                  <div className=\"flex justify-between text-xs text-gray-500\">\n                    <span>작성자: {selectedInquiry.authorUsername || \"알 수 없음\"}</span>\n                    <span>{selectedInquiry.createdAt ? formatDistanceToNow(new Date(selectedInquiry.createdAt), { addSuffix: true, locale: ko }) : \"\"}</span>\n                  </div>\n                </div>\n              )}\n              \n              {replyToId && user?.role === \"admin\" && (\n                <Card className=\"mt-6\">\n                  <CardContent className=\"pt-6\">\n                    <h3 className=\"text-lg font-bold mb-4\">답변 작성</h3>\n                    <Form {...replyForm}>\n                      <form onSubmit={replyForm.handleSubmit(onReplySubmit)} className=\"space-y-4\">\n                        <FormField\n                          control={replyForm.control}\n                          name=\"content\"\n                          render={({ field }) => (\n                            <FormItem>\n                              <FormLabel>답변 내용</FormLabel>\n                              <FormControl>\n                                <Textarea \n                                  placeholder=\"답변 내용을 작성해주세요\"\n                                  rows={5}\n                                  {...field}\n                                />\n                              </FormControl>\n                              <FormMessage />\n                            </FormItem>\n                          )}\n                        />\n                        \n                        <div className=\"flex justify-end gap-2\">\n                          <Button \n                            type=\"button\" \n                            variant=\"outline\"\n                            onClick={() => setReplyToId(null)}\n                          >\n                            취소\n                          </Button>\n                          <Button \n                            type=\"submit\"\n                            disabled={replyMutation.isPending}\n                          >\n                            {replyMutation.isPending ? \"제출 중...\" : \"답변 등록\"}\n                          </Button>\n                        </div>\n                      </form>\n                    </Form>\n                  </CardContent>\n                </Card>\n              )}\n            </div>\n          ) : (\n            <div className=\"text-center py-10\">\n              <p className=\"text-gray-500\">아직 문의글이 없습니다.</p>\n            </div>\n          )}\n        </TabsContent>\n        \n        <TabsContent value=\"write\" className=\"py-4\">\n          <Form {...inquiryForm}>\n            <form onSubmit={inquiryForm.handleSubmit(onInquirySubmit)} className=\"space-y-4\">\n              <FormField\n                control={inquiryForm.control}\n                name=\"title\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>제목</FormLabel>\n                    <FormControl>\n                      <Input placeholder=\"문의 제목을 입력하세요\" {...field} />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              \n              <FormField\n                control={inquiryForm.control}\n                name=\"content\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>내용</FormLabel>\n                    <FormControl>\n                      <Textarea \n                        placeholder=\"문의 내용을 상세히 작성해주세요\"\n                        rows={6}\n                        {...field}\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n              \n              <Button \n                type=\"submit\" \n                className=\"w-full\"\n                disabled={inquiryMutation.isPending}\n              >\n                {inquiryMutation.isPending ? \"제출 중...\" : \"문의 등록\"}\n              </Button>\n            </form>\n          </Form>\n        </TabsContent>\n      </Tabs>\n    </div>\n  );\n};\n\nexport default PropertyInquiryBoard;","path":null,"size_bytes":15778,"size_tokens":null},"server/blog-fetcher.ts":{"content":"import fetch from 'node-fetch';\nimport * as cheerio from 'cheerio';\n\n/**\n * 네이버 블로그 포스트 정보 인터페이스\n */\nexport interface BlogPost {\n  id: string;\n  title: string;\n  link: string;\n  thumbnail: string;\n  publishedAt: string;\n  category: string;\n  summary?: string;\n}\n\n/**\n * 네이버 블로그 카테고리 ID 매핑\n */\ninterface CategoryMapping {\n  [key: string]: string;\n}\n\n// 카테고리 ID를 사람이 읽을 수 있는 이름으로 매핑\n// 지정된 카테고리: 11(블로그 최신글)\nconst CATEGORY_NAMES: CategoryMapping = {\n  '0': '모든 글',\n  '11': '블로그 최신글',\n  '21': '일상다반사',\n  '36': '세상이야기'\n};\n\n/**\n * 네이버 블로그에서 특정 카테고리의 최신 글을 가져옵니다.\n * @param blogId 네이버 블로그 ID\n * @param categoryNo 카테고리 번호\n * @param limit 가져올 포스트 수\n * @returns 블로그 포스트 배열\n */\nexport async function fetchBlogPostsByCategory(\n  blogId: string,\n  categoryNo: string,\n  limit: number = 5\n): Promise<BlogPost[]> {\n  try {\n    console.log(`네이버 블로그 포스트 요청: blogId=${blogId}, categoryNo=${categoryNo}`);\n    \n    // 블로그 카테고리 URL - PC버전과 모바일 버전 모두 시도 (상위 카테고리 포함)\n    // 하위 카테고리를 포함하는 방식으로 URL 구성\n    // 1. categoryNo=0&parentCategoryNo=카테고리 - 특정 상위 카테고리의 모든 하위 카테고리 포함\n    // 2. categoryNo=카테고리 - 특정 카테고리만 조회\n    const pcUrl = categoryNo === \"0\"\n      ? `https://blog.naver.com/PostList.naver?blogId=${blogId}&categoryNo=0&parentCategoryNo=11`\n      : `https://blog.naver.com/PostList.naver?blogId=${blogId}&categoryNo=${categoryNo}`;\n    \n    const mobileUrl = categoryNo === \"0\"\n      ? `https://m.blog.naver.com/${blogId}?categoryNo=0&parentCategoryNo=11`\n      : `https://m.blog.naver.com/${blogId}?categoryNo=${categoryNo}`;\n    \n    // 먼저 PC버전 시도\n    let response = await fetch(pcUrl, {\n      headers: {\n        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/113.0.0.0 Safari/537.36'\n      }\n    });\n    \n    if (!response.ok) {\n      throw new Error(`블로그 데이터 요청 실패: ${response.status} ${response.statusText}`);\n    }\n    \n    let html = await response.text();\n    let $ = cheerio.load(html);\n    let posts: BlogPost[] = [];\n    \n    // PC 버전 파싱 시도 - 다양한 클래스 선택자 시도\n    const postElements = $('.post_item, .lst_item, .se-post-item, .se_post_item, .blog2_post, .blog2_series, .post, .link-post, .list_item');\n    \n    if (postElements.length > 0) {\n      console.log(`PC 버전 파싱: ${postElements.length}개 요소 찾음`);\n      \n      postElements.each((i, element) => {\n        if (i >= limit) return;\n        \n        try {\n          const $el = $(element);\n          \n          // 다양한 선택자로 ID 추출 시도\n          let postId = '';\n          const href = $el.find('a').attr('href') || '';\n          const logNoMatch = href.match(/logNo=(\\d+)/) || href.match(/(\\d{10,})$/);\n          if (logNoMatch && logNoMatch[1]) {\n            postId = logNoMatch[1];\n          } else {\n            postId = $el.attr('data-post-no') || $el.attr('data-entry-id') || `post-${Date.now()}-${i}`;\n          }\n          \n          // 다양한 선택자로 제목 추출 시도\n          let title = '';\n          const titleSelectors = [\n            '.title_text', '.se-title-text', '.se_title_text', \n            '.title', '.tit', '.se-module-text', '.se_module_text',\n            '.link_title', '.pcol1', '.ell'\n          ];\n          \n          for (const selector of titleSelectors) {\n            const titleEl = $el.find(selector);\n            if (titleEl.length > 0) {\n              title = titleEl.first().text().trim();\n              if (title) break;\n            }\n          }\n          \n          if (!title) {\n            // 제목을 찾을 수 없으면 다음 항목으로\n            return;\n          }\n          \n          // 제목 정리: 여러 가지 구분자로 정리\n          // 1. 첫 번째 줄만 사용\n          if (title.includes('\\n')) {\n            title = title.split('\\n')[0].trim();\n          }\n          \n          // 2. 물음표 연속 구분\n          if (title.includes('??')) {\n            title = title.split('??')[0].trim() + '?';\n          } else if (title.includes('? ')) {\n            title = title.split('? ')[0].trim() + '?';\n          }\n          \n          // 3. 점 두 개 이상 구분\n          if (title.includes('..')) {\n            title = title.split('..')[0].trim();\n          }\n          \n          // 4. 특수 패턴 제거 (강화도 부동산 관련 반복 패턴)\n          const patterns = [\n            '강화도 부동산', '부동산', '공인중개사', '중개사', '매물'\n          ];\n          \n          for (const pattern of patterns) {\n            const index = title.indexOf(pattern);\n            if (index > 10) { // 첫 단어가 아닌 경우에만\n              title = title.substring(0, index).trim();\n              break;\n            }\n          }\n          \n          // 5. 제목이 너무 길면 적절한 길이로 자르기 (약 30자)\n          if (title.length > 30) {\n            title = title.substring(0, 30) + '...';\n          }\n          \n          // 링크 생성\n          const link = `https://blog.naver.com/${blogId}/${postId}`;\n          \n          // 썸네일 추출 시도\n          let thumbnail = '';\n          const imgSelectors = [\n            '.post_thumb img', '.se-thumbnail img', '.se_thumbnail img',\n            '.img_thumb img', '.blog2_thumb img', '.photo_wrap img', \n            '.se-image-resource', '.img img', '.thumb img', 'img.img'\n          ];\n          \n          for (const selector of imgSelectors) {\n            const imgEl = $el.find(selector);\n            if (imgEl.length > 0) {\n              thumbnail = imgEl.first().attr('src') || imgEl.first().attr('data-lazy-src') || '';\n              if (thumbnail) break;\n            }\n          }\n          \n          if (!thumbnail) {\n            thumbnail = 'https://ssl.pstatic.net/static/blog/blog_profile_thumbnail_150.png';\n          }\n          \n          // 발행일 추출 시도\n          let publishedAt = '';\n          const dateSelectors = [\n            '.date', '.se-date', '.se_date', '.blog2_date', \n            '.time', '.date_post', '.date_time', '.post_date'\n          ];\n          \n          for (const selector of dateSelectors) {\n            const dateEl = $el.find(selector);\n            if (dateEl.length > 0) {\n              publishedAt = dateEl.first().text().trim();\n              if (publishedAt) break;\n            }\n          }\n          \n          // 날짜 포맷 표준화\n          if (!publishedAt) {\n            const today = new Date();\n            publishedAt = `${today.getFullYear()}.${String(today.getMonth() + 1).padStart(2, '0')}.${String(today.getDate()).padStart(2, '0')}`;\n          } else {\n            // 날짜 표준화 (YYYY.MM.DD 형식으로)\n            publishedAt = publishedAt.replace(/(\\d{4})[년\\-\\/](\\d{1,2})[월\\-\\/](\\d{1,2})[일]?/g, '$1.$2.$3');\n            \n            // 만약 날짜가 형식에 맞지 않으면, 현재 날짜로 대체\n            if (!/^\\d{4}\\.\\d{1,2}\\.\\d{1,2}/.test(publishedAt)) {\n              const today = new Date();\n              publishedAt = `${today.getFullYear()}.${String(today.getMonth() + 1).padStart(2, '0')}.${String(today.getDate()).padStart(2, '0')}`;\n            }\n          }\n          \n          // 요약 추출 시도\n          let summary = '';\n          const summarySelectors = [\n            '.post_content', '.se-text', '.se_text', '.post_text',\n            '.text', '.se-module-text', '.text_passage', '.se-text-paragraph'\n          ];\n          \n          for (const selector of summarySelectors) {\n            const summaryEl = $el.find(selector);\n            if (summaryEl.length > 0) {\n              summary = summaryEl.first().text().trim();\n              if (summary) {\n                summary = summary.length > 100 ? summary.substring(0, 100) + '...' : summary;\n                break;\n              }\n            }\n          }\n          \n          posts.push({\n            id: postId,\n            title,\n            link,\n            thumbnail,\n            publishedAt,\n            category: CATEGORY_NAMES[categoryNo] || `카테고리 ${categoryNo}`,\n            summary\n          });\n        } catch (err) {\n          console.error(`포스트 파싱 오류 (인덱스 ${i}):`, err);\n        }\n      });\n    }\n    \n    // PC 버전으로 파싱 실패시 모바일 버전 시도\n    if (posts.length === 0) {\n      console.log('PC 버전 파싱 실패, 모바일 버전 시도');\n      \n      // 모바일 버전 요청\n      try {\n        response = await fetch(mobileUrl, {\n          headers: {\n            'User-Agent': 'Mozilla/5.0 (iPhone; CPU iPhone OS 13_2_3 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.0.3 Mobile/15E148 Safari/604.1'\n          }\n        });\n        \n        html = await response.text();\n        $ = cheerio.load(html);\n        \n        // 모바일 버전 파싱 - 다양한 선택자 시도\n        const mobilePostElements = $('._itemSection, .list_item, .se_post, .post_item, .se_card, .post, .postlist');\n        \n        console.log(`모바일 버전 파싱: ${mobilePostElements.length}개 요소 찾음`);\n        \n        mobilePostElements.each((i, element) => {\n          if (i >= limit) return;\n          \n          try {\n            const $el = $(element);\n            \n            // 포스트 ID 추출\n            let postId = '';\n            const href = $el.find('a').attr('href') || '';\n            const logNoMatch = href.match(/logNo=(\\d+)/) || href.match(/(\\d{10,})$/);\n            \n            if (logNoMatch && logNoMatch[1]) {\n              postId = logNoMatch[1];\n            } else {\n              postId = `mobile-post-${Date.now()}-${i}`;\n            }\n            \n            // 제목 추출\n            let title = '';\n            const mobileTitleSelectors = [\n              '.se_title', '.tit_feed', '._itemTitleContainer', \n              '._feedTitle', '.se-title-text', '.title_link',\n              '.title', '.link_title', '.ell'\n            ];\n            \n            for (const selector of mobileTitleSelectors) {\n              const titleEl = $el.find(selector);\n              if (titleEl.length > 0) {\n                title = titleEl.first().text().trim();\n                if (title) break;\n              }\n            }\n            \n            if (!title) return; // 제목이 없으면 건너뜀\n            \n            // 제목 정리: 첫 번째 줄이나 첫 번째 문장만 사용\n            if (title.includes('\\n')) {\n              title = title.split('\\n')[0].trim();\n            } else if (title.includes('..')) {\n              // 점 두 개 이상을 기준으로 분리하기\n              title = title.split('..')[0].trim();\n            }\n            \n            // 제목이 너무 길면 적절한 길이로 자르기 (약 50자)\n            if (title.length > 50) {\n              title = title.substring(0, 50) + '...';\n            }\n            \n            // 링크 생성\n            const link = `https://blog.naver.com/${blogId}/${postId}`;\n            \n            // 썸네일 추출\n            let thumbnail = '';\n            const mobileImgSelectors = [\n              '._thumbnail img', '.img_thumb img', '.img img',\n              '.multi_img', '.se-thumbnail-image', '.img_area img'\n            ];\n            \n            for (const selector of mobileImgSelectors) {\n              const imgEl = $el.find(selector);\n              if (imgEl.length > 0) {\n                thumbnail = imgEl.first().attr('src') || imgEl.first().attr('data-src') || '';\n                if (thumbnail) break;\n              }\n            }\n            \n            if (!thumbnail) {\n              thumbnail = 'https://ssl.pstatic.net/static/blog/blog_profile_thumbnail_150.png';\n            }\n            \n            // 발행일 추출\n            let publishedAt = '';\n            const mobileDateSelectors = [\n              '.date_post', '.date_time', '.info_post time',\n              '.date', '.date_info', '.pub_time'\n            ];\n            \n            for (const selector of mobileDateSelectors) {\n              const dateEl = $el.find(selector);\n              if (dateEl.length > 0) {\n                publishedAt = dateEl.first().text().trim();\n                if (publishedAt) break;\n              }\n            }\n            \n            // 날짜 포맷 표준화\n            if (!publishedAt) {\n              const today = new Date();\n              publishedAt = `${today.getFullYear()}.${String(today.getMonth() + 1).padStart(2, '0')}.${String(today.getDate()).padStart(2, '0')}`;\n            } else {\n              // 날짜 표준화 (YYYY.MM.DD 형식으로)\n              publishedAt = publishedAt.replace(/(\\d{4})[년\\-\\/](\\d{1,2})[월\\-\\/](\\d{1,2})[일]?/g, '$1.$2.$3');\n              \n              // 만약 날짜가 형식에 맞지 않으면, 현재 날짜로 대체\n              if (!/^\\d{4}\\.\\d{1,2}\\.\\d{1,2}/.test(publishedAt)) {\n                const today = new Date();\n                publishedAt = `${today.getFullYear()}.${String(today.getMonth() + 1).padStart(2, '0')}.${String(today.getDate()).padStart(2, '0')}`;\n              }\n            }\n            \n            // 요약 추출\n            let summary = '';\n            const mobileSummarySelectors = [\n              '.se_textarea', '.text_passage', '.post_text',\n              '.se-text-paragraph', '.text', '.post_ct'\n            ];\n            \n            for (const selector of mobileSummarySelectors) {\n              const summaryEl = $el.find(selector);\n              if (summaryEl.length > 0) {\n                summary = summaryEl.first().text().trim();\n                if (summary) {\n                  summary = summary.length > 100 ? summary.substring(0, 100) + '...' : summary;\n                  break;\n                }\n              }\n            }\n            \n            posts.push({\n              id: postId,\n              title,\n              link,\n              thumbnail,\n              publishedAt,\n              category: CATEGORY_NAMES[categoryNo] || `카테고리 ${categoryNo}`,\n              summary\n            });\n          } catch (err) {\n            console.error(`모바일 포스트 파싱 오류 (인덱스 ${i}):`, err);\n          }\n        });\n      } catch (err) {\n        console.error('모바일 버전 요청 오류:', err);\n      }\n    }\n    \n    console.log(`네이버 블로그 포스트 ${posts.length}개 추출 성공, 카테고리: ${CATEGORY_NAMES[categoryNo] || categoryNo}`);\n    \n    return posts;\n  } catch (error) {\n    console.error('네이버 블로그 포스트 가져오기 오류:', error);\n    return [];\n  }\n}\n\n/**\n * 여러 카테고리에서 네이버 블로그 포스트를 가져와 합칩니다.\n * @param blogId 네이버 블로그 ID\n * @param categoryNos 카테고리 번호 배열\n * @param limit 카테고리별 최대 포스트 수\n * @returns 블로그 포스트 배열\n */\nexport async function fetchBlogPosts(\n  blogId: string = '9551304',\n  // 여러 카테고리를 지정하여 더 많은 포스트를 가져오도록 함:\n  // - 0: 모든 글 (하위 카테고리 포함)\n  // - 11: 블로그 최신글 (하위 카테고리 포함)\n  // - 21: 일상다반사\n  // - 36: 세상이야기\n  categoryNos: string[] = ['0', '11', '21', '36'],\n  limit: number = 5 // 각 카테고리별 포스트 제한 수\n): Promise<BlogPost[]> {\n  try {\n    // 각 카테고리별로 병렬 요청\n    const postsPromises = categoryNos.map(categoryNo => \n      fetchBlogPostsByCategory(blogId, categoryNo, limit)\n    );\n    \n    const postsArrays = await Promise.all(postsPromises);\n    \n    // 모든 포스트를 하나의 배열로 합치기\n    const allPosts = postsArrays.flat();\n    \n    // 더미 데이터 필터링 및 중복 제거\n    const uniquePostIds = new Set<string>();\n    const filteredPosts = allPosts.filter(post => {\n      // 필터링 조건 - 더미 데이터 제거\n      const isValid = post.title !== \"아직 작성된 글이 없습니다.\" && \n                      !post.id.startsWith(\"post-\") &&\n                      post.title.trim() !== \"\";\n      \n      // 중복 제거\n      if (isValid) {\n        if (uniquePostIds.has(post.id)) {\n          return false; // 이미 있는 ID는 제외\n        }\n        uniquePostIds.add(post.id);\n        return true;\n      }\n      return false;\n    });\n    \n    // 날짜 기준으로 최신순 정렬 (날짜 포맷이 YYYY.MM.DD 형식인 경우)\n    filteredPosts.sort((a, b) => {\n      // 날짜 문자열을 비교하여 정렬 (내림차순)\n      return b.publishedAt.localeCompare(a.publishedAt);\n    });\n    \n    // 실제 데이터 추출에 실패한 경우, 대표적인 테스트 데이터를 제공\n    if (filteredPosts.length === 0) {\n      console.log('블로그 데이터 추출 실패, 테스트 데이터 사용');\n      \n      // 테스트 데이터 (개발용)\n      return [\n        {\n          id: \"223869409800\",\n          title: \"내가 이제 ai에 입문을 한것인가?\",\n          link: \"https://blog.naver.com/9551304/223869409800\",\n          thumbnail: \"https://blogthumb.pstatic.net/MjAyNTA1MThfMjA4/MDAxNzQ3NTM5MjIwOTkx.lt3Zk9kp5c-9NjDHAkg6fRixgyAn3PXizR1B9E9PbbAg.bRkW0jYC2bSuLuF5hYWBat0dId9T90SJTTMkdUflQg4g.PNG/%3F%8A%A4%3F%81%AC%EB%A6%B0%EC%83%B7_2025-05-17_163709.png\",\n          publishedAt: \"2025.05.19\",\n          category: \"블로그 최신글\",\n          summary: \"ai에 대한 나의 생각과 경험\"\n        },\n        {\n          id: \"223809018523\",\n          title: \"조심 또 조심\",\n          link: \"https://blog.naver.com/9551304/223809018523\",\n          thumbnail: \"https://ssl.pstatic.net/static/blog/blog_profile_thumbnail_150.png\",\n          publishedAt: \"2025.05.19\",\n          category: \"세상이야기\",\n          summary: \"일상에서의 안전과 주의사항\"\n        },\n        {\n          id: \"222502515110\",\n          title: \"볼음도리 개발용 낮은임야 18500평\",\n          link: \"https://blog.naver.com/9551304/222502515110\",\n          thumbnail: \"https://blogthumb.pstatic.net/MjAyMTA5MTFfMjk3/MDAxNjMxMzQ2MjIxNjcy.P0bbr5dpaMbgjTxhAhcf69a983bg0oAffyx5Ly6ODzcg.FkEWdogH6Hz8zavcOQmyo-bYVXbQVBzSL9ANkMQ8JdUg.JPEG.9551304/Untitled-1.jpg\",\n          publishedAt: \"2021.09.11\",\n          category: \"일상다반사\",\n          summary: \"강화도 부동산 매물 소개\"\n        }\n      ];\n    }\n    \n    return filteredPosts.slice(0, limit);\n  } catch (error) {\n    console.error('블로그 포스트 가져오기 오류:', error);\n    return [];\n  }\n}\n\n/**\n * 포스트의 대표 이미지 URL을 여러 방법으로 추출합니다.\n * 1. 직접 포스트 페이지 액세스 (모바일 및 PC 버전)\n * 2. 포스트 모바일 버전 iframe 내용 분석\n * 3. OpenGraph 태그 활용\n * \n * @param blogId 네이버 블로그 ID\n * @param postId 포스트 ID\n * @returns 이미지 URL 문자열\n */\nasync function extractPostImage(blogId: string, postId: string): Promise<string> {\n  try {\n    // 모바일 버전 시도 (일반적으로 더 빠름)\n    const mobileUrl = `https://m.blog.naver.com/${blogId}/${postId}`;\n    console.log(`포스트 이미지 추출 시도 (모바일): ${mobileUrl}`);\n    \n    const mobileResponse = await fetch(mobileUrl, {\n      headers: {\n        'User-Agent': 'Mozilla/5.0 (iPhone; CPU iPhone OS 13_2_3 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.0.3 Mobile/15E148 Safari/604.1'\n      }\n    });\n    \n    const mobileHtml = await mobileResponse.text();\n    const $ = cheerio.load(mobileHtml);\n    \n    // 1. 모바일 버전 OpenGraph 이미지 찾기 (가장 신뢰할 수 있는 방법)\n    const ogImage = $('meta[property=\"og:image\"]').attr('content');\n    if (ogImage) {\n      console.log(`모바일 버전 OpenGraph 이미지 발견: ${ogImage}`);\n      return ogImage;\n    }\n    \n    // 2. 모바일 페이지에서 iframe URL 찾기 - 실제 콘텐츠는 iframe 내부에 있을 수 있음\n    const iframeUrl = $('#mainFrame').attr('src');\n    if (iframeUrl) {\n      const iframeImage = await extractImageFromIframe(iframeUrl);\n      if (iframeImage) {\n        console.log(`iframe에서 이미지 발견: ${iframeImage}`);\n        return iframeImage;\n      }\n    }\n    \n    // 3. 대표 이미지 요소 찾기\n    const thumbSelectors = [\n      '.se-thumbnail-image', '.se-image-resource', '.se_thumbnail', '.se_image', \n      '.img_box img', '.post-thumbnail', '.post_image'\n    ];\n    \n    for (const selector of thumbSelectors) {\n      const imgEl = $(selector);\n      if (imgEl.length > 0) {\n        const src = imgEl.attr('src') || imgEl.attr('data-src');\n        if (src) {\n          console.log(`모바일 버전 이미지 요소 발견: ${src}`);\n          return src;\n        }\n      }\n    }\n    \n    console.log('모바일 버전에서 이미지를 찾지 못함, PC 버전 시도');\n    \n    // PC 버전 시도\n    return await extractPostImageFromFullUrl(`https://blog.naver.com/${blogId}/${postId}`);\n  } catch (error) {\n    console.error(`포스트 이미지 추출 오류 (${blogId}/${postId}):`, error);\n    return 'https://ssl.pstatic.net/static/blog/blog_profile_thumbnail_150.png';\n  }\n}\n\n/**\n * iframe에서 이미지 URL을 추출합니다.\n * @param iframeSrc iframe 소스 URL\n * @returns 이미지 URL 또는 빈 문자열\n */\nasync function extractImageFromIframe(iframeSrc: string): Promise<string> {\n  try {\n    // iframe URL이 상대 경로면 전체 URL로 변환\n    const fullIframeUrl = iframeSrc.startsWith('http')\n      ? iframeSrc\n      : `https://blog.naver.com${iframeSrc}`;\n    \n    const response = await fetch(fullIframeUrl, {\n      headers: {\n        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/113.0.0.0 Safari/537.36'\n      }\n    });\n    \n    const html = await response.text();\n    const $ = cheerio.load(html);\n    \n    // iframe 내부에서 이미지 찾기\n    const imgSelectors = [\n      '.se-thumbnail-image', '.se-image-resource', '.se_thumbnail', '.se_image', \n      '.img_box img', '.post-thumbnail', '.post_image', '.se-main-container img'\n    ];\n    \n    for (const selector of imgSelectors) {\n      const imgEl = $(selector);\n      if (imgEl.length > 0) {\n        const src = imgEl.attr('src') || imgEl.attr('data-src');\n        if (src) return src;\n      }\n    }\n    \n    return '';\n  } catch (error) {\n    console.error('iframe 이미지 추출 오류:', error);\n    return '';\n  }\n}\n\n/**\n * 전체 URL에서 포스트 이미지를 추출하는 백업 함수\n * @param fullUrl 블로그 전체 URL\n * @returns 이미지 URL 문자열\n */\nasync function extractPostImageFromFullUrl(fullUrl: string): Promise<string> {\n  try {\n    console.log(`전체 URL로 이미지 추출 시도: ${fullUrl}`);\n    \n    const response = await fetch(fullUrl, {\n      headers: {\n        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/113.0.0.0 Safari/537.36'\n      }\n    });\n    \n    const html = await response.text();\n    const $ = cheerio.load(html);\n    \n    // OpenGraph 이미지 찾기\n    const ogImage = $('meta[property=\"og:image\"]').attr('content');\n    if (ogImage) {\n      console.log(`PC 버전 OpenGraph 이미지 발견: ${ogImage}`);\n      return ogImage;\n    }\n    \n    // 대표 이미지 요소 찾기\n    const imgSelectors = [\n      '.se-thumbnail-image', '.se-image-resource', '.se_thumbnail', '.se_image', \n      '.img_box img', '.post-thumbnail', '.post_image', '.se-main-container img',\n      '.thumb img', '.representative-thumbnail img'\n    ];\n    \n    for (const selector of imgSelectors) {\n      const imgEl = $(selector);\n      if (imgEl.length > 0) {\n        const src = imgEl.attr('src') || imgEl.attr('data-src');\n        if (src) {\n          console.log(`PC 버전 이미지 요소 발견: ${src}`);\n          return src;\n        }\n      }\n    }\n    \n    console.log('이미지를 찾지 못했습니다. 기본 이미지 반환');\n    return 'https://ssl.pstatic.net/static/blog/blog_profile_thumbnail_150.png';\n  } catch (error) {\n    console.error('PC 버전 이미지 추출 오류:', error);\n    return 'https://ssl.pstatic.net/static/blog/blog_profile_thumbnail_150.png';\n  }\n}\n\n/**\n * 카테고리에 따라 대체 이미지를 반환합니다.\n */\nfunction getFallbackImageByCategory(category: string): string {\n  // 카테고리별 기본 이미지 매핑\n  const categoryImages: Record<string, string> = {\n    '일상다반사': 'https://postfiles.pstatic.net/MjAyNTA1MTVfMjE4/MDAxNzQ3Mjc1ODY1MTQy.ycdYfrR63FHN9GS7EzNgMu2Kiy_CldX6Zk5szOrYuVUg.yx_nZEPj7PKpEVhwuW8UuTHKQw9d8Xou7rIu0zOVEeAg.PNG/daily-life.png?type=w580',\n    '세상이야기': 'https://postfiles.pstatic.net/MjAyNTA1MTVfNTYg/MDAxNzQ3Mjc1ODY1MTQz.1lTZM1oxLQlxw3nNcyeHvV3CpxrVwZQMg_cN2GlWBJMg.-Bi6JK8-rEdQYK07Y9aE5Y9Zrjra9ZDu8KlUbTsAWJEg.PNG/world-stories.png?type=w580',\n    '블로그 최신글': 'https://postfiles.pstatic.net/MjAyNTA1MTVfNDUg/MDAxNzQ3Mjc1ODY1MTQ0.UeOGoBn6MVN_OMFGlUCqbqI6Hkbli5oeNv5Kza2Fmrcg.3uFFdpI2JVQGBVnYNjGvcFGc1TmOqTtlHqGC5h54O7gg.PNG/latest-posts.png?type=w580',\n    '모든 글': 'https://postfiles.pstatic.net/MjAyNTA1MTVfMTAz/MDAxNzQ3Mjc1ODY1MTQ1._yBnSpkXK6yEVDkgOhJxdrvfL_tqlOjCCDYxUiJVGrAg.DmWJzgF54RkjPkfuS1QsELMdLQwT9gAZ_aMX6fU-HCMg.PNG/all-posts.png?type=w580'\n  };\n  \n  // 매핑된 카테고리 이미지가 있으면 반환, 없으면 기본 이미지 반환\n  console.log(`카테고리 기반 대체 이미지 사용: ${category} -> ${categoryImages[category] || 'https://ssl.pstatic.net/static/blog/blog_profile_thumbnail_150.png'}`);\n  return categoryImages[category] || 'https://ssl.pstatic.net/static/blog/blog_profile_thumbnail_150.png';\n}\n\n/**\n * 모든 포스트에 대해 상세 이미지를 가져옵니다.\n * @param posts 블로그 포스트 배열\n * @returns 이미지가 업데이트된 포스트 배열\n */\nasync function enrichPostsWithImages(posts: BlogPost[]): Promise<BlogPost[]> {\n  const enrichedPosts = [...posts];\n  \n  for (let i = 0; i < enrichedPosts.length; i++) {\n    const post = enrichedPosts[i];\n    \n    // 썸네일이 기본 이미지거나 없으면 상세 이미지 추출\n    if (!post.thumbnail || \n        post.thumbnail === 'https://ssl.pstatic.net/static/blog/blog_profile_thumbnail_150.png' ||\n        post.thumbnail.includes('blog_profile_thumbnail')) {\n      \n      try {\n        // URL에서 블로그 ID와 포스트 ID 추출\n        const urlParts = post.link.split('/');\n        const blogId = urlParts[urlParts.length - 2];\n        const postId = urlParts[urlParts.length - 1];\n        \n        // 이미지 추출 시도\n        const extractedImage = await extractPostImage(blogId, postId);\n        \n        if (extractedImage && extractedImage !== 'https://ssl.pstatic.net/static/blog/blog_profile_thumbnail_150.png') {\n          enrichedPosts[i].thumbnail = extractedImage;\n        } else {\n          // 이미지 추출 실패 시 카테고리별 기본 이미지 사용\n          enrichedPosts[i].thumbnail = getFallbackImageByCategory(post.category);\n        }\n      } catch (error) {\n        console.error(`포스트 이미지 강화 실패 (${post.id}):`, error);\n        // 오류 발생 시 카테고리별 기본 이미지 사용\n        enrichedPosts[i].thumbnail = getFallbackImageByCategory(post.category);\n      }\n    }\n  }\n  \n  return enrichedPosts;\n}\n\n// 블로그 포스트 캐시\nexport let blogCache: {\n  [key: string]: {\n    posts: BlogPost[];\n    expires: number;\n  }\n} = {};\n\n// 캐시 유효 시간 (30분으로 단축)\nconst CACHE_TTL = 30 * 60 * 1000;\n\n/**\n * 캐싱을 활용하여 네이버 블로그 포스트 목록 가져오기\n * 각 카테고리 조합별로 별도 캐싱 적용\n */\nexport async function getLatestBlogPosts(\n  blogId: string = '9551304',\n  categoryNos: string[] = ['21', '35', '36'],\n  limit: number = 3\n): Promise<BlogPost[]> {\n  // 캐시키 생성 (블로그ID, 카테고리, 제한 수 기준)\n  const cacheKey = `${blogId}_${categoryNos.sort().join('_')}_${limit}`;\n  const now = Date.now();\n  \n  // 캐시가 유효한지 확인\n  if (blogCache[cacheKey] && blogCache[cacheKey].expires > now) {\n    console.log(`캐시된 블로그 포스트 정보 반환 (키: ${cacheKey})`);\n    return blogCache[cacheKey].posts;\n  }\n  \n  console.log(`블로그 데이터 새로 요청 (키: ${cacheKey})`);\n\n  // 모든 카테고리에서 포스트 수집\n  const allPosts: BlogPost[] = [];\n  \n  // 각 카테고리별로 포스트 가져오기 (요청한 카테고리만 처리)\n  for (const categoryNo of categoryNos) {\n    try {\n      // 각 카테고리에서 충분한 수의 포스트를 가져옴 (카테고리별 제한 없음)\n      const categoryPosts = await fetchBlogPostsByCategory(blogId, categoryNo, limit * 5);\n      if (categoryPosts && categoryPosts.length > 0) {\n        console.log(`카테고리 ${categoryNo}에서 ${categoryPosts.length}개 포스트 가져옴`);\n        allPosts.push(...categoryPosts);\n      }\n    } catch (e) {\n      console.error(`카테고리 ${categoryNo} 포스트 가져오기 실패:`, e);\n    }\n  }\n  \n  console.log(`총 ${allPosts.length}개 포스트 수집됨 (중복/필터링 전)`);\n  \n  // 유효한 포스트만 필터링\n  const validPosts = allPosts.filter(post => \n    post && post.title && post.title.trim() !== '' && \n    post.title !== '아직 작성된 글이 없습니다.' &&\n    !post.id.startsWith('post-')\n  );\n  \n  // 각 포스트의 날짜 정보를 JavaScript Date 객체로 변환\n  // publishedAt은 'YYYY.MM.DD' 형식\n  const postsWithDates = validPosts.map(post => {\n    let date: Date;\n    \n    // 날짜 파싱 시도\n    try {\n      // 날짜 파싱 (YYYY.MM.DD 형식)\n      const [year, month, day] = post.publishedAt.split('.');\n      if (year && month && day) {\n        // 숫자로 변환하여 유효성 검사\n        const y = parseInt(year, 10);\n        const m = parseInt(month, 10) - 1; // JavaScript의 월은 0부터 시작\n        const d = parseInt(day, 10);\n        \n        if (!isNaN(y) && !isNaN(m) && !isNaN(d) && \n            y >= 2000 && y <= 2025 && // 현실적인 연도 범위 체크\n            m >= 0 && m < 12 && \n            d >= 1 && d <= 31) {\n          date = new Date(y, m, d);\n        } else {\n          // 날짜가 범위를 벗어나면 현재 날짜 사용\n          date = new Date();\n          console.log(`날짜 범위 오류: ${post.publishedAt}, ID: ${post.id}`);\n        }\n      } else {\n        // 형식이 맞지 않으면 현재 날짜 사용\n        date = new Date();\n        console.log(`날짜 형식 오류: ${post.publishedAt}, ID: ${post.id}`);\n      }\n    } catch (e) {\n      // 파싱 실패 시 현재 날짜 사용\n      date = new Date();\n      console.log(`날짜 파싱 실패: ${post.publishedAt}, ID: ${post.id}`);\n    }\n    \n    // 일부 오래된 포스트는 ID를 기준으로 날짜 추정 (네이버 블로그 ID는 대략 시간순)\n    // 작은 ID (2억 미만)는 2021년 이전의 게시물로 추정\n    const postIdNum = parseInt(post.id, 10);\n    if (!isNaN(postIdNum) && postIdNum < 200000000) {\n      // 2021년 이전 게시물로 표시하여 최신 정렬에서 제외\n      date = new Date(2020, 0, 1);\n      console.log(`오래된 포스트 감지: ID ${post.id}는 2021년 이전 게시물로 추정`);\n    }\n    \n    return {\n      ...post,\n      parsedDate: date\n    };\n  });\n  \n  // ID 기준 중복 제거\n  const uniqueIdMap = new Map<string, typeof postsWithDates[0]>();\n  for (const post of postsWithDates) {\n    // 이미 있는 ID라면 더 최신 날짜를 가진 포스트를 선택\n    if (uniqueIdMap.has(post.id)) {\n      const existing = uniqueIdMap.get(post.id)!;\n      if (post.parsedDate > existing.parsedDate) {\n        uniqueIdMap.set(post.id, post);\n      }\n    } else {\n      uniqueIdMap.set(post.id, post);\n    }\n  }\n  \n  // 최근 날짜순으로 정렬 (parsedDate 기준 내림차순)\n  let sortedPosts = Array.from(uniqueIdMap.values())\n    .sort((a, b) => b.parsedDate.getTime() - a.parsedDate.getTime());\n  \n  console.log(`중복 제거 후 ${sortedPosts.length}개의 유효한 포스트 찾음`);\n  \n  // 개수 제한\n  sortedPosts = sortedPosts.slice(0, limit);\n  \n  // 로그에 최종 반환될 글 목록 출력\n  sortedPosts.forEach((post, index) => {\n    const dateStr = post.parsedDate.toISOString().split('T')[0];\n    console.log(`[${index + 1}] 날짜: ${dateStr}, ID: ${post.id}, 제목: ${post.title.substring(0, 30)}${post.title.length > 30 ? '...' : ''}`);\n  });\n  \n  // 이미지 정보 강화\n  console.log(`블로그 포스트 이미지 정보 강화 중... (${sortedPosts.length}개)`);\n  \n  // parsedDate 필드 제거 후 반환\n  const finalPosts = sortedPosts.map(({ parsedDate, ...post }) => post);\n  const enrichedPosts = await enrichPostsWithImages(finalPosts);\n  \n  // 캐시 업데이트\n  if (enrichedPosts.length > 0) {\n    blogCache[cacheKey] = {\n      posts: enrichedPosts,\n      expires: now + CACHE_TTL\n    };\n    \n    console.log(`${enrichedPosts.length}개의 블로그 포스트를 캐시에 저장 (${CACHE_TTL / (60 * 1000)}분)`);\n  }\n  \n  return enrichedPosts;\n}","path":null,"size_bytes":33545,"size_tokens":null},"client/src/pages/HomePage.tsx":{"content":"import HomeMap from \"@/components/home/HomeMap\";\nimport PropertySearch from \"@/components/home/PropertySearch\";\nimport FeaturedProperties from \"@/components/home/FeaturedProperties\";\n// BlogPosts 컴포넌트 제거됨\n// Testimonials 컴포넌트 제거됨\n// ContactForm 컴포넌트 제거됨\nimport { useQuery } from \"@tanstack/react-query\";\nimport { News } from \"@shared/schema\";\nimport { Link } from \"wouter\";\nimport { Card, CardContent, CardFooter } from \"@/components/ui/card\";\nimport { Calendar, ArrowRight, Newspaper, Youtube, Play, BookOpen } from \"lucide-react\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { formatDistanceToNow } from 'date-fns';\nimport { ko } from 'date-fns/locale';\n\n// 유튜브 비디오 타입 정의\ninterface YouTubeVideo {\n  id: string;\n  title: string;\n  thumbnail: string;\n  url: string;\n  publishedAt?: string;\n}\n\n// 네이버 블로그 포스트 타입 정의\ninterface BlogPost {\n  id: string;\n  title: string;\n  link: string;\n  thumbnail: string;\n  publishedAt: string;\n  category: string;\n  summary?: string;\n}\n\nconst HomePage = () => {\n  // agents 관련 쿼리 제거됨\n  \n  // 최신 유튜브 영상 데이터 가져오기\n  const { data: latestVideos, isLoading: isVideosLoading } = useQuery<YouTubeVideo[]>({\n    queryKey: [\"/api/youtube/latest\"],\n  });\n  \n  // 최신 뉴스 데이터 가져오기\n  const { data: latestNews } = useQuery<News[]>({\n    queryKey: [\"/api/news/latest\"],\n  });\n  \n  // 최신 블로그 포스트 데이터 가져오기\n  const { data: latestBlogPosts, isLoading: isBlogPostsLoading } = useQuery<BlogPost[]>({\n    queryKey: [\"/api/blog/latest\"],\n  });\n\n  return (\n    <>\n      <div className=\"pt-16\"> {/* Offset for fixed header */}\n        {/* 맵과 검색을 오른쪽으로 배치한 새로운 레이아웃 */}\n        <div className=\"container mx-auto px-4 py-4\">\n          <div className=\"grid grid-cols-1 lg:grid-cols-4 gap-6\">\n            {/* 왼쪽 콘텐츠 영역 - 추천 매물만 표시 (3/4 크기) */}\n            <div className=\"order-2 lg:order-1 lg:col-span-3\">\n              <FeaturedProperties />\n            </div>\n            \n            {/* 오른쪽 지도 및 검색 영역 (1/4 크기) */}\n            <div className=\"order-1 lg:order-2 lg:col-span-1\">\n              {/* 지도 */}\n              <div className=\"rounded-lg overflow-hidden shadow-md mb-6\">\n                <HomeMap />\n              </div>\n              \n              {/* 음성검색 폼 */}\n              <div className=\"rounded-lg overflow-hidden shadow-md\">\n                <PropertySearch />\n              </div>\n            </div>\n          </div>\n        </div>\n        \n        {/* YouTube Videos Section */}\n        <section id=\"youtube\" className=\"py-4 bg-gradient-to-r from-red-50 to-red-100\">\n          <div className=\"container mx-auto px-4\">\n            <div className=\"flex justify-between items-center mb-4\">\n              <h2 className=\"text-2xl font-bold flex items-center\">\n                <Youtube className=\"h-6 w-6 mr-2 text-red-600\" />\n                이가이버 유튜브 최신 영상\n              </h2>\n              <a \n                href=\"https://www.youtube.com/channel/UCCG3_JlKhgalqhict7tKkbA\" \n                target=\"_blank\" \n                rel=\"noopener noreferrer\"\n                className=\"text-red-600 hover:text-red-700 font-medium flex items-center gap-1\"\n              >\n                유튜브 채널 방문하기 <ArrowRight className=\"h-4 w-4\" />\n              </a>\n            </div>\n            \n            {isVideosLoading ? (\n              <div className=\"grid grid-cols-1 md:grid-cols-5 gap-4\">\n                {[...Array(5)].map((_, i) => (\n                  <Card key={i} className=\"bg-white rounded-lg overflow-hidden shadow-md h-full flex flex-col animate-pulse\">\n                    <div className=\"h-40 bg-gray-200\" />\n                    <CardContent className=\"p-4 flex-grow\">\n                      <div className=\"h-4 bg-gray-200 rounded-md mb-2 w-1/3\"></div>\n                      <div className=\"h-4 bg-gray-200 rounded-md mb-2 w-full\"></div>\n                      <div className=\"h-4 bg-gray-200 rounded-md w-2/3\"></div>\n                    </CardContent>\n                  </Card>\n                ))}\n              </div>\n            ) : latestVideos && latestVideos.length > 0 ? (\n              <div className=\"grid grid-cols-1 md:grid-cols-5 gap-4\">\n                {latestVideos.slice(0, 5).map((video) => (\n                  <Card key={video.id} className=\"bg-white rounded-lg overflow-hidden shadow-md hover:shadow-lg transition h-full flex flex-col\">\n                    <div className=\"h-40 overflow-hidden relative group\">\n                      <img \n                        src={video.thumbnail} \n                        alt={video.title} \n                        className=\"w-full h-full object-cover object-center transition-transform duration-300 group-hover:scale-110\"\n                      />\n                      <div className=\"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 flex items-center justify-center transition-all duration-300\">\n                        <a \n                          href={video.url} \n                          target=\"_blank\" \n                          rel=\"noopener noreferrer\"\n                          className=\"w-12 h-12 rounded-full bg-red-600 text-white flex items-center justify-center opacity-0 group-hover:opacity-100 transform scale-50 group-hover:scale-100 transition-all duration-300\"\n                        >\n                          <Play className=\"h-6 w-6\" />\n                        </a>\n                      </div>\n                    </div>\n                    <CardContent className=\"p-4 flex-grow\">\n                      <a \n                        href={video.url} \n                        target=\"_blank\" \n                        rel=\"noopener noreferrer\"\n                        className=\"block\"\n                      >\n                        <h3 className=\"text-base font-semibold mb-2 line-clamp-2 hover:text-red-600 transition-colors\">\n                          {video.title.length > 70 ? video.title.substring(0, 70) + '...' : video.title}\n                        </h3>\n                      </a>\n                    </CardContent>\n                    <CardFooter className=\"p-4 pt-0\">\n                      <div className=\"flex items-center text-xs text-gray-medium\">\n                        <Youtube className=\"h-3 w-3 mr-1 text-red-600\" />\n                        이가이버 유튜브\n                      </div>\n                    </CardFooter>\n                  </Card>\n                ))}\n              </div>\n            ) : (\n              <div className=\"bg-white rounded-lg p-4 shadow text-center\">\n                <p className=\"text-gray-medium\">현재 유튜브 영상을 불러올 수 없습니다. 나중에 다시 시도해주세요.</p>\n                <a \n                  href=\"https://www.youtube.com/channel/UCCG3_JlKhgalqhict7tKkbA\" \n                  target=\"_blank\" \n                  rel=\"noopener noreferrer\"\n                  className=\"text-red-600 hover:text-red-700 font-medium inline-flex items-center gap-1 mt-2\"\n                >\n                  유튜브에서 직접 보기 <ArrowRight className=\"h-4 w-4\" />\n                </a>\n              </div>\n            )}\n          </div>\n        </section>\n        \n        {/* Blog Posts Section */}\n        <section id=\"blog\" className=\"py-4 bg-gradient-to-r from-green-50 to-green-100\">\n          <div className=\"container mx-auto px-4\">\n            <div className=\"flex justify-between items-center mb-4\">\n              <h2 className=\"text-2xl font-bold flex items-center\">\n                <BookOpen className=\"h-6 w-6 mr-2 text-green-600\" />\n                이가이버 블로그 포럼\n              </h2>\n              <a \n                href=\"https://blog.naver.com/9551304\" \n                target=\"_blank\" \n                rel=\"noopener noreferrer\"\n                className=\"text-green-600 hover:text-green-700 font-medium flex items-center gap-1\"\n              >\n                포럼 방문하기 <ArrowRight className=\"h-4 w-4\" />\n              </a>\n            </div>\n            \n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n              {isBlogPostsLoading ? (\n                <div className=\"col-span-full text-center py-8\">\n                  <div className=\"animate-pulse flex flex-col items-center\">\n                    <div className=\"h-4 bg-slate-200 rounded w-1/3 mb-4\"></div>\n                    <div className=\"h-16 bg-slate-200 rounded w-3/4\"></div>\n                  </div>\n                </div>\n              ) : latestBlogPosts && latestBlogPosts.length > 0 ? (\n                latestBlogPosts.slice(0, 3).map((post) => (\n                  <Card key={post.id} className=\"bg-white rounded-lg overflow-hidden shadow-md hover:shadow-lg transition h-full flex flex-col\">\n                    <CardContent className=\"p-4 flex-grow\">\n                      <div className=\"flex items-center gap-2 mb-2\">\n                        <Badge variant=\"outline\" className=\"bg-green-100 text-green-700 border-green-200 text-xs\">\n                          {post.category === \"카테고리 0\" ? \"일상다반사\" : \n                           post.category === \"카테고리 35\" ? \"취미생활\" : \n                           post.category === \"세상이야기\" ? \"세상이야기\" : \n                           post.category === \"일상다반사\" ? \"일상다반사\" :\n                           post.category === \"모든 글\" ? \"일상다반사\" : \"취미생활\"}\n                        </Badge>\n                        <span className=\"text-xs text-gray-500\">\n                          {post.publishedAt}\n                        </span>\n                      </div>\n                      <a \n                        href={post.link} \n                        target=\"_blank\" \n                        rel=\"noopener noreferrer\"\n                        className=\"block\"\n                      >\n                        <h3 className=\"text-lg font-semibold mb-3 hover:text-green-600 transition-colors\">\n                          {post.title}\n                        </h3>\n                      </a>\n                    </CardContent>\n                    <CardFooter className=\"p-4 pt-1\">\n                      <a \n                        href={post.link} \n                        target=\"_blank\" \n                        rel=\"noopener noreferrer\"\n                        className=\"text-green-600 hover:text-green-700 text-sm font-medium flex items-center gap-1\"\n                      >\n                        자세히 보기 <ArrowRight className=\"h-3 w-3\" />\n                      </a>\n                    </CardFooter>\n                  </Card>\n                ))\n              ) : (\n                <div className=\"col-span-full text-center py-8\">\n                  <p className=\"text-gray-500\">블로그 포스트가 없습니다.</p>\n                </div>\n              )}\n            </div>\n          </div>\n        </section>\n        \n        {/* News Section */}\n        <section id=\"news\" className=\"py-4 bg-gray-light\">\n          <div className=\"container mx-auto px-4\">\n            <div className=\"flex justify-between items-center mb-4\">\n              <h2 className=\"text-2xl font-bold\">최신 부동산뉴스</h2>\n              <Link href=\"/news\" className=\"text-primary hover:text-secondary font-medium flex items-center gap-1\">\n                모든 뉴스 보기 <ArrowRight className=\"h-4 w-4\" />\n              </Link>\n            </div>\n            <div className=\"grid grid-cols-1 md:grid-cols-5 gap-4\">\n              {latestNews && latestNews.slice(0, 5).map((news) => (\n                <Card key={news.id} className=\"bg-white rounded-lg overflow-hidden shadow-md hover:shadow-lg transition h-full flex flex-col\">\n                  <div className=\"h-40 overflow-hidden\">\n                    <img \n                      src={news.imageUrl ?? 'https://via.placeholder.com/400x200?text=뉴스+이미지'} \n                      alt={news.title} \n                      className=\"w-full h-full object-cover object-center\"\n                    />\n                  </div>\n                  <CardContent className=\"p-4 flex-grow\">\n                    <div className=\"flex items-center gap-2 mb-2\">\n                      <Badge variant=\"outline\" className=\"bg-primary/10 text-primary text-xs\">\n                        {news.category}\n                      </Badge>\n                      {news.isPinned && (\n                        <Badge variant=\"secondary\" className=\"bg-secondary/20 text-secondary text-xs\">\n                          주요\n                        </Badge>\n                      )}\n                    </div>\n                    \n                    <Link href={`/news/${news.id}`}>\n                      <h3 className=\"text-base font-bold mb-2 line-clamp-2 hover:text-primary transition-colors\">\n                        {news.title}\n                      </h3>\n                    </Link>\n                    \n                    <p className=\"text-sm text-gray-medium line-clamp-2 mb-2\">\n                      {news.summary}\n                    </p>\n                  </CardContent>\n                  <CardFooter className=\"p-4 pt-0\">\n                    <div className=\"flex justify-between items-center w-full\">\n                      <div className=\"flex items-center text-xs text-gray-medium\">\n                        <Calendar className=\"h-3 w-3 mr-1\" />\n                        {news.createdAt && formatDistanceToNow(new Date(news.createdAt), { addSuffix: true, locale: ko })}\n                      </div>\n                      \n                      <div className=\"flex items-center text-xs text-gray-medium\">\n                        <Newspaper className=\"h-3 w-3 mr-1\" />\n                        {news.source}\n                      </div>\n                    </div>\n                  </CardFooter>\n                </Card>\n              ))}\n              \n              {(!latestNews || latestNews.length === 0) && (\n                <div className=\"col-span-5 bg-white rounded-lg p-8 text-center shadow\">\n                  <Newspaper className=\"h-12 w-12 mx-auto mb-4 text-gray-medium\" />\n                  <h3 className=\"text-xl font-medium mb-2\">아직 등록된 뉴스가 없습니다</h3>\n                  <p className=\"text-gray-medium\">\n                    곧 강화도와 인천 지역의 최신 부동산 뉴스가 업데이트될 예정입니다.\n                  </p>\n                </div>\n              )}\n            </div>\n          </div>\n        </section>\n        \n        {/* Testimonials 섹션 제거됨 */}\n        \n{/* Contact Section - 제거됨 */}\n      </div>\n    </>\n  );\n};\n\nexport default HomePage;\n","path":null,"size_bytes":14849,"size_tokens":null},"backup/PropertyDetail.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { useState } from \"react\";\nimport { Link } from \"wouter\";\nimport { \n  Maximize, \n  Bed, \n  Bath, \n  MapPin, \n  Calendar, \n  Phone, \n  Mail, \n  Share2, \n  Heart,\n  ChevronLeft,\n  ChevronRight\n} from \"lucide-react\";\nimport { Property } from \"@shared/schema\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport PropertyInquiryBoard from \"@/components/property/PropertyInquiryBoard\";\n\ninterface PropertyDetailProps {\n  propertyId: string;\n}\n\nconst formatPrice = (price: string | number) => {\n  const numPrice = Number(price);\n  if (numPrice >= 100000000) {\n    return `${(numPrice / 100000000).toFixed(1)}억 원`;\n  } else if (numPrice >= 10000) {\n    return `${(numPrice / 10000).toFixed(0)}만원`;\n  }\n  return numPrice.toLocaleString() + '원';\n};\n\nconst PropertyDetail = ({ propertyId }: PropertyDetailProps) => {\n  const [currentImageIndex, setCurrentImageIndex] = useState(0);\n  \n  const { data: property, isLoading: propertyLoading, error: propertyError } = useQuery<Property>({\n    queryKey: [`/api/properties/${propertyId}`],\n  });\n  \n  // 부동산 등록시 첨부한 이미지들을 사용\n  const defaultImage = \"https://via.placeholder.com/800x500?text=매물+이미지+준비중\";\n  \n  // imageUrls 배열이 있으면 사용하고, 없으면 기존 imageUrl을 배열로 변환\n  // 이미지가 하나도 없는 경우 기본 이미지 사용\n  const images = property ? (\n    Array.isArray(property.imageUrls) && property.imageUrls.length > 0 \n      ? property.imageUrls \n      : (property.imageUrl ? [property.imageUrl] : [defaultImage])\n  ) : [defaultImage];\n\n  const nextImage = () => {\n    setCurrentImageIndex((prev) => (prev + 1) % images.length);\n  };\n\n  const prevImage = () => {\n    setCurrentImageIndex((prev) => (prev - 1 + images.length) % images.length);\n  };\n  \n  if (propertyLoading) {\n    return (\n      <div className=\"container mx-auto px-4 py-12\">\n        <div className=\"mb-8\">\n          <Skeleton className=\"h-8 w-2/3 mb-2\" />\n          <Skeleton className=\"h-4 w-1/3\" />\n        </div>\n        \n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n          <div className=\"lg:col-span-2\">\n            <Skeleton className=\"h-[400px] w-full rounded-lg mb-4\" />\n            <div className=\"grid grid-cols-4 gap-2\">\n              {[...Array(4)].map((_, i) => (\n                <Skeleton key={i} className=\"h-20 w-full rounded-md\" />\n              ))}\n            </div>\n            \n            <div className=\"mt-8\">\n              <Skeleton className=\"h-6 w-1/4 mb-4\" />\n              <Skeleton className=\"h-4 w-full mb-2\" />\n              <Skeleton className=\"h-4 w-full mb-2\" />\n              <Skeleton className=\"h-4 w-2/3\" />\n              \n              <div className=\"mt-6\">\n                <Skeleton className=\"h-6 w-1/4 mb-4\" />\n                <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n                  {[...Array(4)].map((_, i) => (\n                    <Skeleton key={i} className=\"h-12 w-full rounded-md\" />\n                  ))}\n                </div>\n              </div>\n            </div>\n          </div>\n          \n          <div>\n            <Skeleton className=\"h-[400px] w-full rounded-lg\" />\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  if (propertyError || !property) {\n    return (\n      <div className=\"container mx-auto px-4 py-12\">\n        <div className=\"bg-red-50 p-6 rounded-lg text-red-600\">\n          <h2 className=\"text-2xl font-bold mb-2\">매물을 찾을 수 없습니다</h2>\n          <p>요청하신 매물 정보를 불러오는 데 실패했습니다. 다시 시도해주세요.</p>\n          <Link href=\"/properties\">\n            <Button className=\"mt-4\">매물 목록으로 돌아가기</Button>\n          </Link>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"container mx-auto px-4 py-12\">\n      <div className=\"mb-8\">\n        <h1 className=\"text-3xl font-bold mb-2\">{property.title}</h1>\n        <div className=\"flex flex-wrap items-center gap-2 mb-2\">\n          {property.dealType && Array.isArray(property.dealType) && property.dealType.map((type, index) => (\n            <Badge key={index} className=\"bg-secondary\">{type}</Badge>\n          ))}\n        </div>\n        <p className=\"text-gray-medium flex items-center\">\n          <MapPin className=\"w-4 h-4 mr-1\" /> \n          {/* 주소에서 지번 정보를 제외 - 대략적인 위치만 표시 */}\n          {property.district}, {property.city}\n        </p>\n      </div>\n      \n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n        <div className=\"lg:col-span-2\">\n          {/* Main image gallery */}\n          <div className=\"relative h-[400px] overflow-hidden rounded-lg mb-4\">\n            {images.length > 1 && (\n              <button \n                onClick={prevImage}\n                className=\"absolute left-2 top-1/2 -translate-y-1/2 bg-white/80 rounded-full p-2 z-10\"\n              >\n                <ChevronLeft className=\"w-5 h-5\" />\n              </button>\n            )}\n            <img \n              src={images[currentImageIndex]} \n              alt={property.title} \n              className=\"w-full h-full object-cover\"\n            />\n            {images.length > 1 && (\n              <button \n                onClick={nextImage}\n                className=\"absolute right-2 top-1/2 -translate-y-1/2 bg-white/80 rounded-full p-2 z-10\"\n              >\n                <ChevronRight className=\"w-5 h-5\" />\n              </button>\n            )}\n          </div>\n          \n          {images.length > 1 && (\n            <div className=\"grid grid-cols-4 gap-2\">\n              {images.map((image, index) => (\n                <button\n                  key={index}\n                  className={`h-20 overflow-hidden rounded-md ${currentImageIndex === index ? 'ring-2 ring-primary' : ''}`}\n                  onClick={() => setCurrentImageIndex(index)}\n                >\n                  <img \n                    src={image} \n                    alt={`${property.title} 이미지 ${index + 1}`} \n                    className=\"w-full h-full object-cover\"\n                  />\n                </button>\n              ))}\n            </div>\n          )}\n          \n          {/* 문의 게시판을 매물 설명 위쪽으로 이동 */}\n          <Card className=\"mt-8 mb-8\">\n            <CardContent className=\"pt-6\">\n              <h3 className=\"text-xl font-bold mb-4\">이 매물 문의게시판</h3>\n              <PropertyInquiryBoard propertyId={Number(propertyId)} />\n            </CardContent>\n          </Card>\n          \n          <Tabs defaultValue=\"details\" className=\"mt-8\">\n            <TabsList className=\"grid w-full grid-cols-2\">\n              <TabsTrigger value=\"details\">매물 정보</TabsTrigger>\n              <TabsTrigger value=\"map\">위치 정보</TabsTrigger>\n            </TabsList>\n            <TabsContent value=\"details\" className=\"mt-4\">\n              <h2 className=\"text-2xl font-bold mb-4\">매물 설명</h2>\n              <p className=\"text-gray-medium whitespace-pre-line mb-6\">\n                {property.description}\n              </p>\n              \n              <h3 className=\"text-xl font-bold mb-4\">주요 특징</h3>\n              <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6\">\n                <div className=\"bg-gray-light p-4 rounded-lg flex flex-col items-center\">\n                  <Maximize className=\"text-primary mb-2\" />\n                  <span className=\"font-bold\">{property.size}m²</span>\n                  <span className=\"text-sm text-gray-medium\">면적</span>\n                </div>\n                <div className=\"bg-gray-light p-4 rounded-lg flex flex-col items-center\">\n                  <Bed className=\"text-primary mb-2\" />\n                  <span className=\"font-bold\">{property.bedrooms}개</span>\n                  <span className=\"text-sm text-gray-medium\">침실</span>\n                </div>\n                <div className=\"bg-gray-light p-4 rounded-lg flex flex-col items-center\">\n                  <Bath className=\"text-primary mb-2\" />\n                  <span className=\"font-bold\">{property.bathrooms}개</span>\n                  <span className=\"text-sm text-gray-medium\">욕실</span>\n                </div>\n                <div className=\"bg-gray-light p-4 rounded-lg flex flex-col items-center\">\n                  <Calendar className=\"text-primary mb-2\" />\n                  <span className=\"font-bold\">즉시 입주</span>\n                  <span className=\"text-sm text-gray-medium\">입주가능일</span>\n                </div>\n              </div>\n            </TabsContent>\n            <TabsContent value=\"map\">\n              <div className=\"bg-gray-light p-2 rounded-lg overflow-hidden h-64\">\n                <img \n                  src=\"https://images.unsplash.com/photo-1609587312208-cea54be969e7?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1200&h=600\" \n                  alt={`${property.district} 지역 지도`} \n                  className=\"w-full h-full object-cover\"\n                />\n              </div>\n              <div className=\"mt-4\">\n                <h3 className=\"text-xl font-bold mb-2\">위치 정보</h3>\n                <p className=\"text-gray-medium\">\n                  {property.district}, {property.city}는 중심부에 위치하고 있으며, 주변에 대중교통, 학교, 상업시설 등이 잘 갖추어져 있습니다.\n                </p>\n              </div>\n            </TabsContent>\n          </Tabs>\n        </div>\n        \n        <div>\n          <Card className=\"mb-6\">\n            <CardContent className=\"pt-6\">\n              <div className=\"flex justify-between items-start mb-4\">\n                <div>\n                  <Badge className=\"mb-2\" variant=\"outline\">{property.type}</Badge>\n                  <h2 className=\"text-2xl font-bold text-primary\">{formatPrice(property.price)}</h2>\n                </div>\n                <div className=\"flex gap-2\">\n                  <Button variant=\"outline\" size=\"icon\">\n                    <Heart className=\"w-4 h-4\" />\n                  </Button>\n                  <Button variant=\"outline\" size=\"icon\">\n                    <Share2 className=\"w-4 h-4\" />\n                  </Button>\n                </div>\n              </div>\n              \n              <div className=\"space-y-4 mt-6\">\n                <div className=\"flex flex-col\">\n                  <span className=\"text-sm text-gray-medium\">면적</span>\n                  <span className=\"font-medium\">{property.size}m²</span>\n                </div>\n                <div className=\"flex flex-col\">\n                  <span className=\"text-sm text-gray-medium\">침실</span>\n                  <span className=\"font-medium\">{property.bedrooms}개</span>\n                </div>\n                <div className=\"flex flex-col\">\n                  <span className=\"text-sm text-gray-medium\">욕실</span>\n                  <span className=\"font-medium\">{property.bathrooms}개</span>\n                </div>\n                <div className=\"flex flex-col\">\n                  <span className=\"text-sm text-gray-medium\">지역</span>\n                  <span className=\"font-medium\">{property.district}</span>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default PropertyDetail;\n","path":null,"size_bytes":11680,"size_tokens":null},"client/src/components/ui/label.tsx":{"content":"import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n","path":null,"size_bytes":710,"size_tokens":null},"vite.config.ts":{"content":"import { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport path from \"path\";\nimport runtimeErrorOverlay from \"@replit/vite-plugin-runtime-error-modal\";\n\nexport default defineConfig({\n  plugins: [\n    react(),\n    runtimeErrorOverlay(),\n    ...(process.env.NODE_ENV !== \"production\" &&\n    process.env.REPL_ID !== undefined\n      ? [\n          await import(\"@replit/vite-plugin-cartographer\").then((m) =>\n            m.cartographer(),\n          ),\n        ]\n      : []),\n  ],\n  resolve: {\n    alias: {\n      \"@\": path.resolve(import.meta.dirname, \"client\", \"src\"),\n      \"@shared\": path.resolve(import.meta.dirname, \"shared\"),\n      \"@assets\": path.resolve(import.meta.dirname, \"attached_assets\"),\n    },\n  },\n  root: path.resolve(import.meta.dirname, \"client\"),\n  build: {\n    outDir: path.resolve(import.meta.dirname, \"dist/public\"),\n    emptyOutDir: true,\n  },\n});\n","path":null,"size_bytes":894,"size_tokens":null},"client/src/components/admin/PropertyFormModal.tsx":{"content":"import { useEffect, useState } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { z } from \"zod\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport {\n  Form,\n  FormControl,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from \"@/components/ui/form\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Property, insertPropertySchema } from \"@shared/schema\";\n\n// 부동산 유형 목록\nconst propertyTypes = [\"토지\", \"주택\", \"아파트연립다세대\", \"원투룸\", \"상가공장창고펜션\"];\n\n// 읍면 리스트\nconst districts = [\n  \"강화읍\",\n  \"교동면\",\n  \"길상면\",\n  \"내가면\",\n  \"삼산면\",\n  \"서도면\",\n  \"선원면\",\n  \"송해면\",\n  \"양도면\",\n  \"양사면\",\n  \"하점면\",\n  \"화도면\",\n];\n\n// 거래 종류\nconst dealTypes = [\"매매\", \"전세\", \"월세\", \"완료\", \"보류중\"];\n\n// 세부 지역 정보\nconst detailedDistricts: { [key: string]: string[] } = {\n  강화읍: [\n    \"강화읍 갑곳리\",\n    \"강화읍 관청리\",\n    \"강화읍 국화리\",\n    \"강화읍 남산리\",\n    \"강화읍 내리\",\n    \"강화읍 대산리\",\n    \"강화읍 망월리\",\n    \"강화읍 명륜리\",\n    \"강화읍 묘안리\",\n    \"강화읍 박달리\",\n    \"강화읍 방향리\",\n    \"강화읍 북산리\",\n    \"강화읍 불은면\",\n    \"강화읍 신문리\",\n    \"강화읍 신정리\",\n    \"강화읍 옥림리\",\n    \"강화읍 용정리\",\n    \"강화읍 월곶리\",\n    \"강화읍 인산리\",\n    \"강화읍 중앙로\",\n    \"강화읍 청송리\",\n    \"강화읍 최촌리\",\n    \"강화읍 홍릉리\",\n  ],\n  교동면: [\n    \"교동면 고구리\",\n    \"교동면 대룡리\",\n    \"교동면 무학리\",\n    \"교동면 방리\",\n    \"교동면 봉소리\",\n    \"교동면 삼선리\",\n    \"교동면 상용리\",\n    \"교동면 서한리\",\n    \"교동면 소룡리\",\n    \"교동면 읍내리\",\n    \"교동면 정운리\",\n    \"교동면 지석리\",\n    \"교동면 철산리\",\n    \"교동면 하일리\",\n    \"교동면 화개리\",\n  ],\n  길상면: [\n    \"길상면 길직리\",\n    \"길상면 동검리\",\n    \"길상면 마리\",\n    \"길상면 망월리\",\n    \"길상면 온수리\",\n    \"길상면 선두리\",\n    \"길상면 초지리\",\n  ],\n  내가면: [\n    \"내가면 고천리\",\n    \"내가면 나리\",\n    \"내가면 내동리\",\n    \"내가면 대곶리\",\n    \"내가면 망하리\",\n    \"내가면 박석리\",\n    \"내가면 양오리\",\n    \"내가면 오상리\",\n    \"내가면 외포리\",\n    \"내가면 장터리\",\n    \"내가면 지석리\",\n    \"내가면 창후리\",\n  ],\n  삼산면: [\n    \"삼산면 매음리\",\n    \"삼산면 물가리\",\n    \"삼산면 석모리\",\n    \"삼산면 서검리\",\n    \"삼산면 석모리\",\n    \"삼산면 약암리\",\n    \"삼산면 윤상리\",\n    \"삼산면 하리\",\n  ],\n  서도면: [\n    \"서도면 말도리\",\n    \"서도면 볼음도리\",\n    \"서도면 수리\",\n    \"서도면 아차도리\",\n    \"서도면 주문도리\",\n  ],\n  선원면: [\n    \"선원면 금월리\",\n    \"선원면 동막리\",\n    \"선원면 선원리\",\n    \"선원면 신당리\",\n    \"선원면 연리\",\n    \"선원면 원당리\",\n    \"선원면 창리\",\n    \"선원면 포내리\",\n    \"선원면 해산리\",\n  ],\n  송해면: [\n    \"송해면 가숭리\",\n    \"송해면 당산리\",\n    \"송해면 대산리\",\n    \"송해면 양오리\",\n    \"송해면 하도리\",\n    \"송해면 장정리\",\n    \"송해면 신당리\",\n    \"송해면 천산리\",\n    \"송해면 숭뢰리\",\n  ],\n  양도면: [\n    \"양도면 감정리\",\n    \"양도면 건평리\",\n    \"양도면 도장리\",\n    \"양도면 삼흥리\",\n    \"양도면 인산리\",\n    \"양도면 조산리\",\n    \"양도면 인일리\",\n    \"양도면 하일리\",\n  ],\n  양사면: [\n    \"양사면 교산리\",\n    \"양사면 덕하리\",\n    \"양사면 덕하리\",\n    \"양사면 북성리\",\n    \"양사면 상도리\",\n    \"양사면 송학리\",\n    \"양사면 신당리\",\n    \"양사면 인화리\",\n    \"양사면 철산리\",\n  ],\n  하점면: [\n    \"하점면 망원리\",\n    \"하점면 봉천리\",\n    \"하점면 신봉리\",\n    \"하점면 신삼리\",\n    \"하점면 양오리\",\n    \"하점면 이강리\",\n    \"하점면 장정리\",\n    \"하점면 창후리\",\n    \"하점면 참리\",\n    \"하점면 충도리\",\n  ],\n  화도면: [\n    \"화도면 갑곶리\",\n    \"화도면 건평리\",\n    \"화도면 내리\",\n    \"화도면 덕포리\",\n    \"화도면 문산리\",\n    \"화도면 사기리\",\n    \"화도면 상방리\",\n    \"화도면 서산리\",\n    \"화도면 장화리\",\n    \"화도면 주문리\",\n    \"화도면 천삼리\",\n    \"화도면 흥왕리\",\n  ],\n};\n\n// 속성 입력 값 스키마\nconst propertyFormSchema = insertPropertySchema.extend({\n  price: z.union([z.string(), z.number()]).optional(),\n  size: z.union([z.string(), z.number()]).optional(),\n  imageUrl: z.string().optional(),\n  supplyArea: z.union([z.string(), z.number()]).optional().nullable(),\n  privateArea: z.union([z.string(), z.number()]).optional().nullable(),\n  floor: z.union([z.string(), z.number()]).optional().nullable(),\n  totalFloors: z.union([z.string(), z.number()]).optional().nullable(),\n  deposit: z.union([z.string(), z.number()]).optional().nullable(),\n  monthlyRent: z.union([z.string(), z.number()]).optional().nullable(),\n  maintenanceFee: z.union([z.string(), z.number()]).optional().nullable(),\n});\n\ntype PropertyFormValues = z.infer<typeof propertyFormSchema>;\n\ninterface PropertyFormModalProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  property?: Property | null;\n}\n\nexport function PropertyFormModal({ open, onOpenChange, property }: PropertyFormModalProps) {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [selectedMainDistrict, setSelectedMainDistrict] = useState(\"강화읍\");\n  const [detailedDistrictOptions, setDetailedDistrictOptions] = useState<string[]>(detailedDistricts[\"강화읍\"]);\n  \n  // 부동산 등록/수정 폼\n  const form = useForm<PropertyFormValues>({\n    resolver: zodResolver(propertyFormSchema),\n    defaultValues: {\n      // 기본 정보\n      title: \"\",\n      description: \"\",\n      type: \"토지\",\n      price: \"\",\n      city: \"인천\",\n      district: \"강화읍 갑곳리\", \n      address: \"\",\n      size: \"\",\n      agentId: 1,\n      \n      // 위치 정보\n      buildingName: \"\",\n      unitNumber: \"\",\n      \n      // 면적 정보\n      supplyArea: \"\",\n      privateArea: \"\",\n      areaSize: \"\",\n      \n      // 건물 정보\n      floor: \"\",\n      totalFloors: \"\",\n      direction: \"\",\n      elevator: false,\n      parking: \"\",\n      heatingSystem: \"\",\n      approvalDate: \"\",\n      \n      // 금액 정보\n      dealType: [\"매매\"],\n      deposit: \"\",\n      monthlyRent: \"\",\n      maintenanceFee: \"\",\n      \n      // 연락처 정보\n      ownerName: \"\",\n      ownerPhone: \"\",\n      tenantName: \"\",\n      tenantPhone: \"\",\n      clientName: \"\",\n      clientPhone: \"\",\n      \n      // 추가 정보\n      specialNote: \"\",\n      coListing: false,\n      propertyDescription: \"\",\n      privateNote: \"\",\n      \n      // 기존 필드\n      bedrooms: 0,\n      bathrooms: 0,\n      featured: false,\n    },\n  });\n\n  // 선택된 읍면에 따라 세부 지역 옵션 업데이트\n  useEffect(() => {\n    if (selectedMainDistrict && detailedDistricts[selectedMainDistrict]) {\n      setDetailedDistrictOptions(detailedDistricts[selectedMainDistrict]);\n      // 첫 번째 세부 지역을 기본값으로 설정\n      form.setValue(\"district\", detailedDistricts[selectedMainDistrict][0]);\n    }\n  }, [selectedMainDistrict, form]);\n  \n  // 읍면 변경 핸들러\n  const handleDistrictChange = (value: string) => {\n    setSelectedMainDistrict(value);\n  };\n\n  // 부동산 생성 뮤테이션\n  const createPropertyMutation = useMutation({\n    mutationFn: async (data: PropertyFormValues) => {\n      const res = await apiRequest(\"POST\", \"/api/properties\", data);\n      if (!res.ok) {\n        const errorData = await res.json();\n        throw new Error(errorData.message || \"부동산 등록에 실패했습니다\");\n      }\n      return await res.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/properties\"] });\n      toast({\n        title: \"부동산 등록 성공\",\n        description: \"새로운 부동산이 등록되었습니다.\",\n      });\n      onOpenChange(false);\n      form.reset();\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"부동산 등록 실패\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // 부동산 수정 뮤테이션\n  const updatePropertyMutation = useMutation({\n    mutationFn: async ({\n      id,\n      data,\n    }: {\n      id: number;\n      data: PropertyFormValues;\n    }) => {\n      const res = await apiRequest(\"PATCH\", `/api/properties/${id}`, data);\n      if (!res.ok) {\n        const errorData = await res.json();\n        throw new Error(errorData.message || \"부동산 수정에 실패했습니다\");\n      }\n      return await res.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/properties\"] });\n      toast({\n        title: \"부동산 수정 성공\",\n        description: \"부동산 정보가 수정되었습니다.\",\n      });\n      onOpenChange(false);\n      form.reset();\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"부동산 수정 실패\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // 폼 제출 처리\n  const onSubmit = (data: PropertyFormValues) => {\n    if (property) {\n      updatePropertyMutation.mutate({ id: property.id, data });\n    } else {\n      createPropertyMutation.mutate(data);\n    }\n  };\n\n  // 속성이 변경될 때마다 폼 업데이트\n  useEffect(() => {\n    if (property) {\n      const mainDistrict = districts.find(d => \n        property.district.startsWith(d)\n      ) || \"강화읍\";\n      \n      setSelectedMainDistrict(mainDistrict);\n      \n      // 폼 값 설정\n      form.reset({\n        title: property.title,\n        description: property.description,\n        type: property.type,\n        price: property.price.toString(),\n        address: property.address,\n        city: property.city,\n        district: property.district,\n        size: property.size.toString(),\n        bedrooms: property.bedrooms,\n        bathrooms: property.bathrooms,\n        agentId: property.agentId,\n        featured: property.featured === null ? undefined : property.featured,\n        buildingName: property.buildingName || undefined,\n        unitNumber: property.unitNumber || undefined,\n        supplyArea: property.supplyArea ? property.supplyArea.toString() : undefined,\n        privateArea: property.privateArea ? property.privateArea.toString() : undefined,\n        areaSize: property.areaSize || undefined,\n        floor: property.floor ? property.floor.toString() : undefined,\n        totalFloors: property.totalFloors ? property.totalFloors.toString() : undefined,\n        direction: property.direction || undefined,\n        elevator: property.elevator === null ? undefined : property.elevator,\n        parking: property.parking || undefined,\n        heatingSystem: property.heatingSystem || undefined,\n        approvalDate: property.approvalDate || undefined,\n        dealType: Array.isArray(property.dealType) ? property.dealType : [\"매매\"],\n        deposit: property.deposit ? property.deposit.toString() : undefined,\n        monthlyRent: property.monthlyRent ? property.monthlyRent.toString() : undefined,\n        maintenanceFee: property.maintenanceFee ? property.maintenanceFee.toString() : undefined,\n        ownerName: property.ownerName || undefined,\n        ownerPhone: property.ownerPhone || undefined,\n        tenantName: property.tenantName || undefined,\n        tenantPhone: property.tenantPhone || undefined,\n        clientName: property.clientName || undefined,\n        clientPhone: property.clientPhone || undefined,\n        specialNote: property.specialNote || undefined,\n        coListing: property.coListing === null ? undefined : property.coListing,\n        propertyDescription: property.propertyDescription || undefined,\n        privateNote: property.privateNote || undefined,\n      });\n    } else {\n      // 새 속성 등록을 위한 초기값 설정\n      form.reset({\n        // 기본 정보\n        title: \"\",\n        description: \"\",\n        type: \"토지\",\n        price: \"\",\n        city: \"인천\",\n        district: \"강화읍 갑곳리\", \n        address: \"\",\n        size: \"\",\n        imageUrl: \"\",\n        agentId: 1,\n        \n        // 위치 정보\n        buildingName: \"\",\n        unitNumber: \"\",\n        \n        // 면적 정보\n        supplyArea: \"\",\n        privateArea: \"\",\n        areaSize: \"\",\n        \n        // 건물 정보\n        floor: \"\",\n        totalFloors: \"\",\n        direction: \"\",\n        elevator: false,\n        parking: \"\",\n        heatingSystem: \"\",\n        approvalDate: \"\",\n        \n        // 금액 정보\n        dealType: [\"매매\"],\n        deposit: \"\",\n        monthlyRent: \"\",\n        maintenanceFee: \"\",\n        \n        // 연락처 정보\n        ownerName: \"\",\n        ownerPhone: \"\",\n        tenantName: \"\",\n        tenantPhone: \"\",\n        clientName: \"\",\n        clientPhone: \"\",\n        \n        // 추가 정보\n        specialNote: \"\",\n        coListing: false,\n        propertyDescription: \"\",\n        privateNote: \"\",\n        \n        // 기존 필드\n        bedrooms: 0,\n        bathrooms: 0,\n        featured: false,\n      });\n    }\n  }, [property, form]);\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"max-w-3xl max-h-[90vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle>{property ? \"부동산 수정\" : \"새 부동산 등록\"}</DialogTitle>\n          <DialogDescription>\n            {property ? \"부동산 정보를 수정하세요\" : \"새로운 부동산 매물을 등록하세요\"}\n          </DialogDescription>\n        </DialogHeader>\n        \n        <Form {...form}>\n          <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6\">\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n              {/* 기본 정보 */}\n              <div>\n                <FormField\n                  control={form.control}\n                  name=\"title\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>제목</FormLabel>\n                      <FormControl>\n                        <Input placeholder=\"부동산 제목\" {...field} />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n              <div>\n                <FormField\n                  control={form.control}\n                  name=\"type\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>유형</FormLabel>\n                      <Select\n                        onValueChange={field.onChange}\n                        defaultValue={field.value}\n                      >\n                        <FormControl>\n                          <SelectTrigger>\n                            <SelectValue placeholder=\"부동산 유형 선택\" />\n                          </SelectTrigger>\n                        </FormControl>\n                        <SelectContent>\n                          {propertyTypes.map((type) => (\n                            <SelectItem key={type} value={type}>\n                              {type}\n                            </SelectItem>\n                          ))}\n                        </SelectContent>\n                      </Select>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n              <div className=\"md:col-span-2\">\n                <FormField\n                  control={form.control}\n                  name=\"description\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>설명</FormLabel>\n                      <FormControl>\n                        <Textarea\n                          placeholder=\"부동산에 대한 상세 설명\"\n                          rows={4}\n                          {...field}\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n              <div>\n                <FormField\n                  control={form.control}\n                  name=\"price\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>가격</FormLabel>\n                      <FormControl>\n                        <Input placeholder=\"가격 (원)\" {...field} />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n              <div>\n                <FormField\n                  control={form.control}\n                  name=\"size\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>면적 (㎡)</FormLabel>\n                      <FormControl>\n                        <Input placeholder=\"면적 (㎡)\" {...field} />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n              <div>\n                <FormItem>\n                  <FormLabel>읍면</FormLabel>\n                  <Select\n                    onValueChange={handleDistrictChange}\n                    defaultValue={selectedMainDistrict}\n                  >\n                    <FormControl>\n                      <SelectTrigger>\n                        <SelectValue placeholder=\"지역 선택\" />\n                      </SelectTrigger>\n                    </FormControl>\n                    <SelectContent>\n                      {districts.map((district) => (\n                        <SelectItem key={district} value={district}>\n                          {district}\n                        </SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                </FormItem>\n              </div>\n\n              <div>\n                <FormField\n                  control={form.control}\n                  name=\"district\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>읍면동</FormLabel>\n                      <Select\n                        onValueChange={field.onChange}\n                        defaultValue={field.value}\n                      >\n                        <FormControl>\n                          <SelectTrigger>\n                            <SelectValue placeholder=\"상세 지역 선택\" />\n                          </SelectTrigger>\n                        </FormControl>\n                        <SelectContent>\n                          {detailedDistrictOptions.map((district) => (\n                            <SelectItem key={district} value={district}>\n                              {district}\n                            </SelectItem>\n                          ))}\n                        </SelectContent>\n                      </Select>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n              <div>\n                <FormField\n                  control={form.control}\n                  name=\"address\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>지번</FormLabel>\n                      <FormControl>\n                        <Input placeholder=\"지번 주소\" {...field} />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n              <div>\n                <FormField\n                  control={form.control}\n                  name=\"buildingName\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>건물명</FormLabel>\n                      <FormControl>\n                        <Input placeholder=\"건물명 (선택사항)\" {...field} />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n              <div>\n                <FormField\n                  control={form.control}\n                  name=\"unitNumber\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>동호수</FormLabel>\n                      <FormControl>\n                        <Input placeholder=\"동호수 (선택사항)\" {...field} />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n              <div>\n                <FormField\n                  control={form.control}\n                  name=\"supplyArea\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>공급면적 (평)</FormLabel>\n                      <FormControl>\n                        <Input placeholder=\"공급면적 (선택사항)\" {...field} />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n              <div>\n                <FormField\n                  control={form.control}\n                  name=\"privateArea\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>전용면적 (평)</FormLabel>\n                      <FormControl>\n                        <Input placeholder=\"전용면적 (선택사항)\" {...field} />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n\n\n              <div>\n                <FormField\n                  control={form.control}\n                  name=\"dealType\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>거래 종류</FormLabel>\n                      <div className=\"flex flex-wrap gap-2\">\n                        {dealTypes.map((type) => (\n                          <Button\n                            key={type}\n                            type=\"button\"\n                            variant={field.value.includes(type) ? \"default\" : \"outline\"}\n                            onClick={() => {\n                              const newValue = field.value.includes(type)\n                                ? field.value.filter((t) => t !== type)\n                                : [...field.value, type];\n                              field.onChange(newValue.length ? newValue : [\"매매\"]);\n                            }}\n                          >\n                            {type}\n                          </Button>\n                        ))}\n                      </div>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n              <div>\n                <FormField\n                  control={form.control}\n                  name=\"bedrooms\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>침실 수</FormLabel>\n                      <FormControl>\n                        <Input \n                          type=\"number\" \n                          placeholder=\"침실 수\"\n                          {...field}\n                          onChange={(e) => field.onChange(Number(e.target.value))}\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n              <div>\n                <FormField\n                  control={form.control}\n                  name=\"bathrooms\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>욕실 수</FormLabel>\n                      <FormControl>\n                        <Input \n                          type=\"number\" \n                          placeholder=\"욕실 수\"\n                          {...field}\n                          onChange={(e) => field.onChange(Number(e.target.value))}\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n              <div>\n                <FormField\n                  control={form.control}\n                  name=\"featured\"\n                  render={({ field }) => (\n                    <FormItem className=\"flex flex-row items-center gap-2 space-y-0\">\n                      <FormControl>\n                        <input\n                          type=\"checkbox\"\n                          className=\"w-4 h-4\"\n                          checked={field.value}\n                          onChange={field.onChange}\n                        />\n                      </FormControl>\n                      <FormLabel className=\"font-normal\">추천 매물로 표시</FormLabel>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n            </div>\n\n            <div className=\"flex justify-end gap-2\">\n              <Button type=\"button\" variant=\"outline\" onClick={() => onOpenChange(false)}>\n                취소\n              </Button>\n              <Button type=\"submit\" disabled={createPropertyMutation.isPending || updatePropertyMutation.isPending}>\n                {(createPropertyMutation.isPending || updatePropertyMutation.isPending) ? \"처리 중...\" : property ? \"수정\" : \"등록\"}\n              </Button>\n            </div>\n          </form>\n        </Form>\n      </DialogContent>\n    </Dialog>\n  );\n}","path":null,"size_bytes":26898,"size_tokens":null},"client/src/components/ui/dropdown-menu.tsx":{"content":"import * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}\n","path":null,"size_bytes":7609,"size_tokens":null},"postcss.config.js":{"content":"export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n","path":null,"size_bytes":80,"size_tokens":null},"client/src/components/ui/navigation-menu.tsx":{"content":"import * as React from \"react\"\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\"\nimport { cva } from \"class-variance-authority\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst NavigationMenu = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative z-10 flex max-w-max flex-1 items-center justify-center\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <NavigationMenuViewport />\n  </NavigationMenuPrimitive.Root>\n))\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName\n\nconst NavigationMenuList = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.List\n    ref={ref}\n    className={cn(\n      \"group flex flex-1 list-none items-center justify-center space-x-1\",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item\n\nconst navigationMenuTriggerStyle = cva(\n  \"group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[state=open]:text-accent-foreground data-[state=open]:bg-accent/50 data-[state=open]:hover:bg-accent data-[state=open]:focus:bg-accent\"\n)\n\nconst NavigationMenuTrigger = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Trigger\n    ref={ref}\n    className={cn(navigationMenuTriggerStyle(), \"group\", className)}\n    {...props}\n  >\n    {children}{\" \"}\n    <ChevronDown\n      className=\"relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180\"\n      aria-hidden=\"true\"\n    />\n  </NavigationMenuPrimitive.Trigger>\n))\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName\n\nconst NavigationMenuContent = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto \",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link\n\nconst NavigationMenuViewport = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>\n>(({ className, ...props }, ref) => (\n  <div className={cn(\"absolute left-0 top-full flex justify-center\")}>\n    <NavigationMenuPrimitive.Viewport\n      className={cn(\n        \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  </div>\n))\nNavigationMenuViewport.displayName =\n  NavigationMenuPrimitive.Viewport.displayName\n\nconst NavigationMenuIndicator = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Indicator\n    ref={ref}\n    className={cn(\n      \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\n      className\n    )}\n    {...props}\n  >\n    <div className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\n  </NavigationMenuPrimitive.Indicator>\n))\nNavigationMenuIndicator.displayName =\n  NavigationMenuPrimitive.Indicator.displayName\n\nexport {\n  navigationMenuTriggerStyle,\n  NavigationMenu,\n  NavigationMenuList,\n  NavigationMenuItem,\n  NavigationMenuContent,\n  NavigationMenuTrigger,\n  NavigationMenuLink,\n  NavigationMenuIndicator,\n  NavigationMenuViewport,\n}\n","path":null,"size_bytes":5128,"size_tokens":null},"client/src/components/ui/theme-provider.tsx":{"content":"import { createContext, useContext, useEffect, useState } from \"react\";\n\ntype Theme = \"dark\" | \"light\" | \"system\";\n\ntype ThemeProviderProps = {\n  children: React.ReactNode;\n  defaultTheme?: Theme;\n  storageKey?: string;\n};\n\ntype ThemeProviderState = {\n  theme: Theme;\n  setTheme: (theme: Theme) => void;\n};\n\nconst initialState: ThemeProviderState = {\n  theme: \"system\",\n  setTheme: () => null,\n};\n\nconst ThemeProviderContext = createContext<ThemeProviderState>(initialState);\n\nexport function ThemeProvider({\n  children,\n  defaultTheme = \"system\",\n  storageKey = \"ui-theme\",\n  ...props\n}: ThemeProviderProps) {\n  const [theme, setTheme] = useState<Theme>(\n    () => (localStorage.getItem(storageKey) as Theme) || defaultTheme\n  );\n\n  useEffect(() => {\n    const root = window.document.documentElement;\n\n    root.classList.remove(\"light\", \"dark\");\n\n    if (theme === \"system\") {\n      const systemTheme = window.matchMedia(\"(prefers-color-scheme: dark)\")\n        .matches\n        ? \"dark\"\n        : \"light\";\n\n      root.classList.add(systemTheme);\n      return;\n    }\n\n    root.classList.add(theme);\n  }, [theme]);\n\n  const value = {\n    theme,\n    setTheme: (theme: Theme) => {\n      localStorage.setItem(storageKey, theme);\n      setTheme(theme);\n    },\n  };\n\n  return (\n    <ThemeProviderContext.Provider {...props} value={value}>\n      {children}\n    </ThemeProviderContext.Provider>\n  );\n}\n\nexport const useTheme = () => {\n  const context = useContext(ThemeProviderContext);\n\n  if (context === undefined)\n    throw new Error(\"useTheme must be used within a ThemeProvider\");\n\n  return context;\n};\n","path":null,"size_bytes":1600,"size_tokens":null},"client/src/components/ui/button.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-primary text-primary-foreground hover:bg-primary/90\",\n        destructive:\n          \"bg-destructive text-destructive-foreground hover:bg-destructive/90\",\n        outline:\n          \"border border-input bg-background hover:bg-accent hover:text-accent-foreground\",\n        secondary:\n          \"bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        ghost: \"hover:bg-accent hover:text-accent-foreground\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        default: \"h-10 px-4 py-2\",\n        sm: \"h-9 rounded-md px-3\",\n        lg: \"h-11 rounded-md px-8\",\n        icon: \"h-10 w-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n","path":null,"size_bytes":1901,"size_tokens":null},"client/src/pages/profile-page.tsx":{"content":"import { useState } from \"react\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { Helmet } from \"react-helmet\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { Loader2, Save, Heart, MapPin, Home } from \"lucide-react\";\nimport { useMutation, useQuery } from \"@tanstack/react-query\";\nimport { Link } from \"wouter\";\nimport { Property } from \"@shared/schema\";\nimport { useToast } from \"@/hooks/use-toast\";\n\nimport {\n  Card,\n  CardContent,\n  CardDescription,\n  CardFooter,\n  CardHeader,\n  CardTitle,\n} from \"@/components/ui/card\";\nimport {\n  Tabs,\n  TabsContent,\n  TabsList,\n  TabsTrigger,\n} from \"@/components/ui/tabs\";\nimport {\n  Form,\n  FormControl,\n  FormDescription,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from \"@/components/ui/form\";\nimport { Input } from \"@/components/ui/input\";\nimport { Button } from \"@/components/ui/button\";\n\n// 프로필 수정 폼 스키마\nconst profileSchema = z.object({\n  email: z.string().email({ message: \"유효한 이메일을 입력해주세요.\" }).optional().or(z.literal(\"\")),\n  phone: z.string().optional().or(z.literal(\"\")),\n});\n\n// 비밀번호 변경 폼 스키마\nconst passwordSchema = z.object({\n  currentPassword: z.string().min(1, { message: \"현재 비밀번호를 입력해주세요.\" }),\n  newPassword: z.string().min(6, { message: \"새 비밀번호는 최소 6자 이상이어야 합니다.\" }),\n  confirmPassword: z.string().min(6, { message: \"비밀번호 확인을 입력해주세요.\" }),\n}).refine((data) => data.newPassword === data.confirmPassword, {\n  message: \"새 비밀번호와 비밀번호 확인이 일치하지 않습니다.\",\n  path: [\"confirmPassword\"],\n});\n\ntype ProfileFormValues = z.infer<typeof profileSchema>;\ntype PasswordFormValues = z.infer<typeof passwordSchema>;\n\nexport default function ProfilePage() {\n  const [activeTab, setActiveTab] = useState(\"profile\");\n  const { user } = useAuth();\n  const { toast } = useToast();\n  \n  // 관심 매물 조회\n  const { data: favoriteProperties, isLoading: isFavoritesLoading } = useQuery<Property[]>({\n    queryKey: ['/api/favorites'],\n    enabled: !!user,\n  });\n\n  // 프로필 폼 설정\n  const profileForm = useForm<ProfileFormValues>({\n    resolver: zodResolver(profileSchema),\n    defaultValues: {\n      email: user?.email || \"\",\n      phone: user?.phone || \"\",\n    },\n  });\n\n  // 비밀번호 폼 설정\n  const passwordForm = useForm<PasswordFormValues>({\n    resolver: zodResolver(passwordSchema),\n    defaultValues: {\n      currentPassword: \"\",\n      newPassword: \"\",\n      confirmPassword: \"\",\n    },\n  });\n\n  // 프로필 업데이트 뮤테이션\n  const updateProfileMutation = useMutation({\n    mutationFn: async (data: ProfileFormValues) => {\n      const res = await apiRequest(\"PATCH\", \"/api/users/profile\", data);\n      return await res.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/user\"] });\n      toast({\n        title: \"프로필 업데이트 성공\",\n        description: \"회원 정보가 성공적으로 업데이트되었습니다.\",\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"프로필 업데이트 실패\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // 비밀번호 변경 뮤테이션\n  const changePasswordMutation = useMutation({\n    mutationFn: async (data: PasswordFormValues) => {\n      // confirmPassword 필드는 서버로 보내지 않고 currentPassword와 newPassword만 전송\n      const { confirmPassword, ...requestData } = data;\n      const res = await apiRequest(\"PATCH\", \"/api/users/password\", requestData);\n      return await res.json();\n    },\n    onSuccess: () => {\n      toast({\n        title: \"비밀번호 변경 성공\",\n        description: \"비밀번호가 성공적으로 변경되었습니다.\",\n      });\n      passwordForm.reset();\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"비밀번호 변경 실패\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // 프로필 폼 제출 처리\n  const onProfileSubmit = (data: ProfileFormValues) => {\n    updateProfileMutation.mutate(data);\n  };\n\n  // 비밀번호 폼 제출 처리\n  const onPasswordSubmit = (data: PasswordFormValues) => {\n    console.log(\"비밀번호 변경 요청:\", data);\n    changePasswordMutation.mutate(data);\n  };\n\n  if (!user) {\n    return <div>Loading...</div>;\n  }\n\n  return (\n    <div className=\"container mx-auto px-4 py-24 max-w-4xl\">\n      <Helmet>\n        <title>내 프로필 | 이가이버 부동산</title>\n        <meta name=\"description\" content=\"회원 정보 관리, 비밀번호 변경 등 계정 설정을 할 수 있습니다.\" />\n      </Helmet>\n\n      <h1 className=\"text-3xl font-bold mb-8\">내 프로필</h1>\n      \n      <Tabs value={activeTab} onValueChange={setActiveTab} className=\"w-full\">\n        <TabsList className=\"grid w-full grid-cols-3\">\n          <TabsTrigger value=\"profile\">기본 정보</TabsTrigger>\n          <TabsTrigger value=\"password\">비밀번호 변경</TabsTrigger>\n          <TabsTrigger value=\"favorites\">관심매물</TabsTrigger>\n        </TabsList>\n        \n        {/* 프로필 정보 탭 */}\n        <TabsContent value=\"profile\">\n          <Card>\n            <CardHeader>\n              <CardTitle>기본 정보</CardTitle>\n              <CardDescription>\n                회원님의 기본 정보를 관리합니다.\n              </CardDescription>\n            </CardHeader>\n            <CardContent>\n              <Form {...profileForm}>\n                <form id=\"profile-form\" onSubmit={profileForm.handleSubmit(onProfileSubmit)} className=\"space-y-6\">\n                  <FormField\n                    control={profileForm.control}\n                    name=\"email\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>이메일</FormLabel>\n                        <FormControl>\n                          <Input placeholder=\"이메일 주소\" {...field} />\n                        </FormControl>\n                        <FormDescription>\n                          알림 및 연락에 사용됩니다.\n                        </FormDescription>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n                  \n                  <FormField\n                    control={profileForm.control}\n                    name=\"phone\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>연락처</FormLabel>\n                        <FormControl>\n                          <Input placeholder=\"연락처\" {...field} />\n                        </FormControl>\n                        <FormDescription>\n                          중개사와의 연락에 사용됩니다.\n                        </FormDescription>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n                </form>\n              </Form>\n            </CardContent>\n            <CardFooter className=\"flex justify-end\">\n              <Button \n                type=\"submit\" \n                form=\"profile-form\"\n                disabled={updateProfileMutation.isPending}\n              >\n                {updateProfileMutation.isPending ? (\n                  <>\n                    <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n                    업데이트 중...\n                  </>\n                ) : (\n                  <>\n                    <Save className=\"mr-2 h-4 w-4\" />\n                    저장하기\n                  </>\n                )}\n              </Button>\n            </CardFooter>\n          </Card>\n        </TabsContent>\n        \n        {/* 비밀번호 변경 탭 */}\n        <TabsContent value=\"password\">\n          <Card>\n            <CardHeader>\n              <CardTitle>비밀번호 변경</CardTitle>\n              <CardDescription>\n                계정 보안을 위해 정기적으로 비밀번호를 변경해주세요.\n              </CardDescription>\n            </CardHeader>\n            <CardContent>\n              <Form {...passwordForm}>\n                <form id=\"password-form\" onSubmit={passwordForm.handleSubmit(onPasswordSubmit)} className=\"space-y-6\">\n                  <FormField\n                    control={passwordForm.control}\n                    name=\"currentPassword\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>현재 비밀번호</FormLabel>\n                        <FormControl>\n                          <Input type=\"password\" placeholder=\"현재 비밀번호\" {...field} />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n                  \n                  <FormField\n                    control={passwordForm.control}\n                    name=\"newPassword\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>새 비밀번호</FormLabel>\n                        <FormControl>\n                          <Input type=\"password\" placeholder=\"새 비밀번호\" {...field} />\n                        </FormControl>\n                        <FormDescription>\n                          최소 6자 이상 입력해주세요.\n                        </FormDescription>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n                  \n                  <FormField\n                    control={passwordForm.control}\n                    name=\"confirmPassword\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>비밀번호 확인</FormLabel>\n                        <FormControl>\n                          <Input type=\"password\" placeholder=\"비밀번호 확인\" {...field} />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n                </form>\n              </Form>\n            </CardContent>\n            <CardFooter className=\"flex justify-end\">\n              <Button \n                type=\"submit\" \n                form=\"password-form\"\n                disabled={changePasswordMutation.isPending}\n              >\n                {changePasswordMutation.isPending ? (\n                  <>\n                    <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n                    변경 중...\n                  </>\n                ) : (\n                  <>\n                    <Save className=\"mr-2 h-4 w-4\" />\n                    변경하기\n                  </>\n                )}\n              </Button>\n            </CardFooter>\n          </Card>\n        </TabsContent>\n        \n        {/* 관심매물 탭 */}\n        <TabsContent value=\"favorites\">\n          <Card>\n            <CardHeader>\n              <CardTitle>내 관심매물</CardTitle>\n              <CardDescription>\n                관심있는 매물을 모아서 볼 수 있습니다.\n              </CardDescription>\n            </CardHeader>\n            <CardContent>\n              {isFavoritesLoading ? (\n                <div className=\"flex justify-center items-center py-8\">\n                  <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\n                </div>\n              ) : !favoriteProperties || favoriteProperties.length === 0 ? (\n                <div className=\"py-8 text-center\">\n                  <Heart className=\"h-12 w-12 mx-auto mb-4 text-muted-foreground\" />\n                  <h3 className=\"text-lg font-medium mb-2\">관심매물이 없습니다</h3>\n                  <p className=\"text-muted-foreground mb-4\">\n                    관심있는 매물을 찾아보고 하트 아이콘을 클릭하여 관심매물로 등록해보세요.\n                  </p>\n                  <Button asChild>\n                    <Link href=\"/properties\">매물 둘러보기</Link>\n                  </Button>\n                </div>\n              ) : (\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                  {favoriteProperties.map(property => (\n                    <div \n                      key={property.id} \n                      className=\"border rounded-lg overflow-hidden hover:shadow-md transition-shadow\"\n                    >\n                      <Link href={`/properties/${property.id}`}>\n                        <div className=\"relative h-40 bg-gray-100\">\n                          <img \n                            src={\n                              Array.isArray(property.imageUrls) && property.imageUrls.length > 0 && \n                              typeof property.featuredImageIndex === 'number'\n                                ? property.imageUrls[property.featuredImageIndex]\n                                : (property.imageUrls && property.imageUrls.length > 0 \n                                    ? property.imageUrls[0] \n                                    : property.imageUrl || \"https://via.placeholder.com/400x300?text=No+Image\")\n                            } \n                            alt={property.title} \n                            className=\"w-full h-full object-cover\"\n                          />\n                        </div>\n                        <div className=\"p-4\">\n                          <h3 className=\"text-lg font-semibold mb-1 line-clamp-1\">{property.title}</h3>\n                          <div className=\"flex items-center text-gray-500 mb-2\">\n                            <MapPin className=\"w-4 h-4 mr-1\" />\n                            <span className=\"text-sm\">{property.district}</span>\n                          </div>\n                          <div className=\"flex items-center justify-between mt-2\">\n                            <div className=\"flex items-center text-gray-700\">\n                              <Home className=\"w-4 h-4 mr-1\" />\n                              <span className=\"text-sm\">{property.type}</span>\n                            </div>\n                            <div className=\"font-bold text-primary\">\n                              {property.price && Number(property.price) > 0 ? (\n                                Number(property.price) >= 100000000 ?\n                                  `${(Number(property.price) / 100000000).toFixed(2)}억원` :\n                                Number(property.price) >= 10000 ? \n                                  `${(Number(property.price) / 10000).toFixed(2)}만원` : \n                                  `${Number(property.price).toLocaleString()}원`\n                              ) : '가격 협의'}\n                            </div>\n                          </div>\n                        </div>\n                      </Link>\n                    </div>\n                  ))}\n                </div>\n              )}\n            </CardContent>\n          </Card>\n        </TabsContent>\n      </Tabs>\n    </div>\n  );\n}","path":null,"size_bytes":15303,"size_tokens":null},"client/src/components/ui/resizable.tsx":{"content":"\"use client\"\n\nimport { GripVertical } from \"lucide-react\"\nimport * as ResizablePrimitive from \"react-resizable-panels\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ResizablePanelGroup = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (\n  <ResizablePrimitive.PanelGroup\n    className={cn(\n      \"flex h-full w-full data-[panel-group-direction=vertical]:flex-col\",\n      className\n    )}\n    {...props}\n  />\n)\n\nconst ResizablePanel = ResizablePrimitive.Panel\n\nconst ResizableHandle = ({\n  withHandle,\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {\n  withHandle?: boolean\n}) => (\n  <ResizablePrimitive.PanelResizeHandle\n    className={cn(\n      \"relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90\",\n      className\n    )}\n    {...props}\n  >\n    {withHandle && (\n      <div className=\"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border\">\n        <GripVertical className=\"h-2.5 w-2.5\" />\n      </div>\n    )}\n  </ResizablePrimitive.PanelResizeHandle>\n)\n\nexport { ResizablePanelGroup, ResizablePanel, ResizableHandle }\n","path":null,"size_bytes":1723,"size_tokens":null},"client/src/components/ui/command.tsx":{"content":"import * as React from \"react\"\nimport { type DialogProps } from \"@radix-ui/react-dialog\"\nimport { Command as CommandPrimitive } from \"cmdk\"\nimport { Search } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\"\n\nconst Command = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nCommand.displayName = CommandPrimitive.displayName\n\nconst CommandDialog = ({ children, ...props }: DialogProps) => {\n  return (\n    <Dialog {...props}>\n      <DialogContent className=\"overflow-hidden p-0 shadow-lg\">\n        <Command className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\n          {children}\n        </Command>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst CommandInput = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Input>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>\n>(({ className, ...props }, ref) => (\n  <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\n    <Search className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\n    <CommandPrimitive.Input\n      ref={ref}\n      className={cn(\n        \"flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  </div>\n))\n\nCommandInput.displayName = CommandPrimitive.Input.displayName\n\nconst CommandList = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.List\n    ref={ref}\n    className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\n    {...props}\n  />\n))\n\nCommandList.displayName = CommandPrimitive.List.displayName\n\nconst CommandEmpty = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Empty>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>\n>((props, ref) => (\n  <CommandPrimitive.Empty\n    ref={ref}\n    className=\"py-6 text-center text-sm\"\n    {...props}\n  />\n))\n\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName\n\nconst CommandGroup = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Group>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Group\n    ref={ref}\n    className={cn(\n      \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandGroup.displayName = CommandPrimitive.Group.displayName\n\nconst CommandSeparator = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName\n\nconst CommandItem = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandItem.displayName = CommandPrimitive.Item.displayName\n\nconst CommandShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nCommandShortcut.displayName = \"CommandShortcut\"\n\nexport {\n  Command,\n  CommandDialog,\n  CommandInput,\n  CommandList,\n  CommandEmpty,\n  CommandGroup,\n  CommandItem,\n  CommandShortcut,\n  CommandSeparator,\n}\n","path":null,"size_bytes":4885,"size_tokens":null},"client/src/components/ui/checkbox.tsx":{"content":"import * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { Check } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"flex items-center justify-center text-current\")}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }\n","path":null,"size_bytes":1056,"size_tokens":null},"client/src/components/home/FeaturedProperties.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Link } from \"wouter\";\nimport PropertyCard from \"@/components/property/PropertyCard\";\nimport { Property } from \"@shared/schema\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\n\nconst FeaturedProperties = () => {\n  const { data: properties, isLoading, error } = useQuery<Property[]>({\n    queryKey: [\"/api/properties/featured\"],\n  });\n\n  if (isLoading) {\n    return (\n      <section className=\"py-8\">\n        <div className=\"container mx-auto px-4\">\n          <div className=\"flex justify-between items-center mb-6\">\n            <h2 className=\"text-2xl font-bold\">추천 매물</h2>\n            <div className=\"w-36 h-6\">\n              <Skeleton className=\"h-6 w-full\" />\n            </div>\n          </div>\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8\">\n            {[...Array(6)].map((_, index) => (\n              <div key={index} className=\"bg-white rounded-lg overflow-hidden shadow-md\">\n                <Skeleton className=\"h-60 w-full\" />\n                <div className=\"p-6\">\n                  <Skeleton className=\"h-6 w-3/4 mb-2\" />\n                  <Skeleton className=\"h-4 w-1/2 mb-4\" />\n                  <div className=\"flex items-center justify-between mb-4\">\n                    <Skeleton className=\"h-4 w-16\" />\n                    <Skeleton className=\"h-4 w-16\" />\n                    <Skeleton className=\"h-4 w-16\" />\n                  </div>\n                  <div className=\"flex justify-between items-center\">\n                    <Skeleton className=\"h-6 w-1/3\" />\n                    <Skeleton className=\"h-6 w-6 rounded-full\" />\n                  </div>\n                </div>\n              </div>\n            ))}\n          </div>\n        </div>\n      </section>\n    );\n  }\n\n  if (error) {\n    return (\n      <section className=\"py-8\">\n        <div className=\"container mx-auto px-4\">\n          <h2 className=\"text-2xl font-bold mb-4\">추천 매물</h2>\n          <div className=\"bg-red-50 p-4 rounded-md text-red-500\">\n            매물을 불러오는 중 오류가 발생했습니다. 잠시 후 다시 시도해주세요.\n          </div>\n        </div>\n      </section>\n    );\n  }\n\n  return (\n    <section id=\"properties\" className=\"py-4\">\n      <div className=\"container mx-auto px-4\">\n        <div className=\"flex justify-between items-center mb-4\">\n          <h2 className=\"text-2xl font-bold\">추천 매물</h2>\n          <Link href=\"/properties\" className=\"text-primary font-medium hover:text-secondary\">\n            모든 매물 보기 <span aria-hidden=\"true\">→</span>\n          </Link>\n        </div>\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8\">\n          {properties && properties.map((property) => (\n            <PropertyCard key={property.id} property={property} />\n          ))}\n        </div>\n      </div>\n    </section>\n  );\n};\n\nexport default FeaturedProperties;\n","path":null,"size_bytes":2941,"size_tokens":null},"client/src/components/ui/drawer.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Drawer as DrawerPrimitive } from \"vaul\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Drawer = ({\n  shouldScaleBackground = true,\n  ...props\n}: React.ComponentProps<typeof DrawerPrimitive.Root>) => (\n  <DrawerPrimitive.Root\n    shouldScaleBackground={shouldScaleBackground}\n    {...props}\n  />\n)\nDrawer.displayName = \"Drawer\"\n\nconst DrawerTrigger = DrawerPrimitive.Trigger\n\nconst DrawerPortal = DrawerPrimitive.Portal\n\nconst DrawerClose = DrawerPrimitive.Close\n\nconst DrawerOverlay = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Overlay\n    ref={ref}\n    className={cn(\"fixed inset-0 z-50 bg-black/80\", className)}\n    {...props}\n  />\n))\nDrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName\n\nconst DrawerContent = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DrawerPortal>\n    <DrawerOverlay />\n    <DrawerPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background\",\n        className\n      )}\n      {...props}\n    >\n      <div className=\"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted\" />\n      {children}\n    </DrawerPrimitive.Content>\n  </DrawerPortal>\n))\nDrawerContent.displayName = \"DrawerContent\"\n\nconst DrawerHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"grid gap-1.5 p-4 text-center sm:text-left\", className)}\n    {...props}\n  />\n)\nDrawerHeader.displayName = \"DrawerHeader\"\n\nconst DrawerFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"mt-auto flex flex-col gap-2 p-4\", className)}\n    {...props}\n  />\n)\nDrawerFooter.displayName = \"DrawerFooter\"\n\nconst DrawerTitle = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDrawerTitle.displayName = DrawerPrimitive.Title.displayName\n\nconst DrawerDescription = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDrawerDescription.displayName = DrawerPrimitive.Description.displayName\n\nexport {\n  Drawer,\n  DrawerPortal,\n  DrawerOverlay,\n  DrawerTrigger,\n  DrawerClose,\n  DrawerContent,\n  DrawerHeader,\n  DrawerFooter,\n  DrawerTitle,\n  DrawerDescription,\n}\n","path":null,"size_bytes":3021,"size_tokens":null},"client/src/components/admin/SimplePropertyForm.tsx":{"content":"import { useEffect, useState } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { z } from \"zod\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport {\n  Form,\n  FormControl,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from \"@/components/ui/form\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Property, insertPropertySchema } from \"@shared/schema\";\n\n// 부동산 유형 목록\nconst propertyTypes = [\"토지\", \"주택\", \"아파트연립다세대\", \"원투룸\", \"상가공장창고펜션\"];\n\n// 통합된 지역 목록 (읍면동리)\nconst allLocations = [\n  \"강화군외\",\n  \"강화읍 갑곳리\",\n  \"강화읍 관청리\",\n  \"강화읍 국화리\",\n  \"강화읍 남산리\",\n  \"강화읍 대산리\",\n  \"강화읍 신문리\",\n  \"강화읍 옥림리\",\n  \"강화읍 용정리\",\n  \"강화읍 월곳리\",\n  \"교동면 고구리\",\n  \"교동면 난정리\",\n  \"교동면 대룡리\",\n  \"교동면 동산리\",\n  \"교동면 무학리\",\n  \"교동면 봉소리\",\n  \"교동면 삼선리\",\n  \"교동면 상용리\",\n  \"교동면 서한리\",\n  \"교동면 양갑리\",\n  \"교동면 읍내리\",\n  \"교동면 인사리\",\n  \"교동면 지석리\",\n  \"길상면 길직리\",\n  \"길상면 동검리\",\n  \"길상면 선두리\",\n  \"길상면 온수리\",\n  \"길상면 장흥리\",\n  \"길상면 초지리\",\n  \"내가면 고천리\",\n  \"내가면 구하리\",\n  \"내가면 오상리\",\n  \"내가면 외포리\",\n  \"내가면 황청리\",\n  \"불은면 고능리\",\n  \"불은면 넙성리\",\n  \"불은면 덕성리\",\n  \"불은면 두운리\",\n  \"불은면 삼동암리\",\n  \"불은면 삼성리\",\n  \"불은면 신현리\",\n  \"불은면 오두리\",\n  \"삼산면 매음리\",\n  \"삼산면 미법리\",\n  \"삼산면 상리\",\n  \"삼산면 서검리\",\n  \"삼산면 석모리\",\n  \"삼산면 석포리\",\n  \"삼산면 하리\",\n  \"서도면 말도리\",\n  \"서도면 볼음도리\",\n  \"서도면 아차도리\",\n  \"서도면 주문도리\",\n  \"선원면 금월리\",\n  \"선원면 냉정리\",\n  \"선원면 선행리\",\n  \"선원면 신정리\",\n  \"선원면 연리\",\n  \"선원면 지산리\",\n  \"선원면 창리\",\n  \"송해면 당산리\",\n  \"송해면 상도리\",\n  \"송해면 솔정리\",\n  \"송해면 숭뢰리\",\n  \"송해면 신당리\",\n  \"송해면 양오리\",\n  \"송해면 하도리\",\n  \"양도면 건평리\",\n  \"양도면 길정리\",\n  \"양도면 능내리\",\n  \"양도면 도장리\",\n  \"양도면 삼흥리\",\n  \"양도면 인산리\",\n  \"양도면 조산리\",\n  \"양도면 하일리\",\n  \"양사면 교산리\",\n  \"양사면 덕하리\",\n  \"양사면 북성리\",\n  \"양사면 인화리\",\n  \"양사면 철산리\",\n  \"하점면 망월리\",\n  \"하점면 부근리\",\n  \"하점면 삼거리\",\n  \"하점면 신봉리\",\n  \"하점면 신삼리\",\n  \"하점면 이강리\",\n  \"하점면 장정리\",\n  \"하점면 창후리\",\n  \"화도면 내리\",\n  \"화도면 덕포리\",\n  \"화도면 동막리\",\n  \"화도면 문산리\",\n  \"화도면 사기리\",\n  \"화도면 상방리\",\n  \"화도면 여차리\",\n  \"화도면 장화리\",\n  \"화도면 흥왕리\",\n];\n\n// 읍면 리스트 (위의 데이터에서 추출)\nconst districts = [\n  \"강화읍\",\n  \"교동면\",\n  \"길상면\",\n  \"내가면\",\n  \"불은면\",\n  \"삼산면\",\n  \"서도면\",\n  \"선원면\",\n  \"송해면\",\n  \"양도면\",\n  \"양사면\",\n  \"하점면\",\n  \"화도면\",\n];\n\n// 거래 종류\nconst dealTypes = [\"매매\", \"전세\", \"월세\", \"완료\", \"보류중\"];\n\n// 세부 지역 정보 (이전 데이터 구조 유지를 위한 임시 변수)\nconst detailedDistricts: { [key: string]: string[] } = {\n  강화읍: [\n    \"강화읍 갑곳리\",\n    \"강화읍 관청리\",\n    \"강화읍 국화리\",\n    \"강화읍 남산리\",\n    \"강화읍 대산리\",\n    \"강화읍 신문리\",\n    \"강화읍 옥림리\",\n    \"강화읍 용정리\",\n    \"강화읍 월곳리\",\n  ],\n  교동면: [\n    \"교동면 고구리\",\n    \"교동면 난정리\",\n    \"교동면 대룡리\",\n    \"교동면 동산리\",\n    \"교동면 무학리\",\n    \"교동면 봉소리\",\n    \"교동면 삼선리\",\n    \"교동면 상용리\",\n    \"교동면 서한리\",\n    \"교동면 양갑리\",\n    \"교동면 읍내리\",\n    \"교동면 인사리\",\n    \"교동면 지석리\",\n  ],\n  길상면: [\n    \"길상면 길직리\",\n    \"길상면 동검리\",\n    \"길상면 선두리\",\n    \"길상면 온수리\",\n    \"길상면 장흥리\",\n    \"길상면 초지리\",\n  ],\n  내가면: [\n    \"내가면 고천리\",\n    \"내가면 구하리\",\n    \"내가면 오상리\",\n    \"내가면 외포리\",\n    \"내가면 황청리\",\n  ],\n  불은면: [\n    \"불은면 고능리\",\n    \"불은면 넙성리\",\n    \"불은면 덕성리\",\n    \"불은면 두운리\",\n    \"불은면 삼동암리\",\n    \"불은면 삼성리\",\n    \"불은면 신현리\",\n    \"불은면 오두리\",\n  ],\n  삼산면: [\n    \"삼산면 매음리\",\n    \"삼산면 미법리\",\n    \"삼산면 상리\",\n    \"삼산면 서검리\",\n    \"삼산면 석모리\",\n    \"삼산면 석포리\",\n    \"삼산면 하리\",\n  ],\n  서도면: [\n    \"서도면 말도리\",\n    \"서도면 볼음도리\",\n    \"서도면 아차도리\",\n    \"서도면 주문도리\",\n  ],\n  선원면: [\n    \"선원면 금월리\",\n    \"선원면 냉정리\",\n    \"선원면 선행리\",\n    \"선원면 신정리\",\n    \"선원면 연리\",\n    \"선원면 지산리\",\n    \"선원면 창리\",\n  ],\n  송해면: [\n    \"송해면 당산리\",\n    \"송해면 상도리\",\n    \"송해면 솔정리\",\n    \"송해면 숭뢰리\",\n    \"송해면 신당리\",\n    \"송해면 양오리\",\n    \"송해면 하도리\",\n  ],\n  양도면: [\n    \"양도면 건평리\",\n    \"양도면 길정리\",\n    \"양도면 능내리\",\n    \"양도면 도장리\",\n    \"양도면 삼흥리\",\n    \"양도면 인산리\",\n    \"양도면 조산리\",\n    \"양도면 하일리\",\n  ],\n  양사면: [\n    \"양사면 교산리\",\n    \"양사면 덕하리\",\n    \"양사면 북성리\",\n    \"양사면 인화리\",\n    \"양사면 철산리\",\n  ],\n  하점면: [\n    \"하점면 망월리\",\n    \"하점면 부근리\",\n    \"하점면 삼거리\",\n    \"하점면 신봉리\",\n    \"하점면 신삼리\",\n    \"하점면 이강리\",\n    \"하점면 장정리\",\n    \"하점면 창후리\",\n  ],\n  화도면: [\n    \"화도면 내리\",\n    \"화도면 덕포리\",\n    \"화도면 동막리\",\n    \"화도면 문산리\",\n    \"화도면 사기리\",\n    \"화도면 상방리\",\n    \"화도면 여차리\",\n    \"화도면 장화리\",\n    \"화도면 흥왕리\",\n  ],\n};\n\n// 속성 입력 값 스키마\nconst propertyFormSchema = insertPropertySchema.extend({\n  price: z.union([z.string(), z.number()]).optional(),\n  size: z.union([z.string(), z.number()]).optional(),\n  supplyArea: z.union([z.string(), z.number()]).optional().nullable(),\n  privateArea: z.union([z.string(), z.number()]).optional().nullable(),\n  floor: z.union([z.string(), z.number()]).optional().nullable(),\n  totalFloors: z.union([z.string(), z.number()]).optional().nullable(),\n  deposit: z.union([z.string(), z.number()]).optional().nullable(),\n  monthlyRent: z.union([z.string(), z.number()]).optional().nullable(),\n  maintenanceFee: z.union([z.string(), z.number()]).optional().nullable(),\n});\n\ntype PropertyFormValues = z.infer<typeof propertyFormSchema>;\n\ninterface SimplePropertyFormProps {\n  onClose: () => void;\n  property?: Property | null;\n}\n\nexport function SimplePropertyForm({ onClose, property }: SimplePropertyFormProps) {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  \n  // 부동산 등록/수정 폼\n  const form = useForm<PropertyFormValues>({\n    resolver: zodResolver(propertyFormSchema),\n    defaultValues: {\n      // 기본 정보\n      title: \"\",\n      description: \"\",\n      type: \"토지\",\n      price: \"\",\n      district: \"강화읍 갑곳리\", \n      address: \"\",\n      size: \"\",\n      agentId: 1,\n      \n      // 위치 정보\n      buildingName: \"\",\n      unitNumber: \"\",\n      \n      // 면적 정보\n      supplyArea: \"\",\n      privateArea: \"\",\n      areaSize: \"\",\n      \n      // 건물 정보\n      floor: \"\",\n      totalFloors: \"\",\n      direction: \"\",\n      elevator: false,\n      parking: \"\",\n      heatingSystem: \"\",\n      approvalDate: \"\",\n      \n      // 금액 정보\n      dealType: [\"매매\"],\n      deposit: \"\",\n      monthlyRent: \"\",\n      maintenanceFee: \"\",\n      \n      // 연락처 정보\n      ownerName: \"\",\n      ownerPhone: \"\",\n      tenantName: \"\",\n      tenantPhone: \"\",\n      clientName: \"\",\n      clientPhone: \"\",\n      \n      // 추가 정보\n      specialNote: \"\",\n      coListing: false,\n      propertyDescription: \"\",\n      privateNote: \"\",\n      \n      // 기존 필드\n      bedrooms: 0,\n      bathrooms: 0,\n      featured: false,\n    },\n  });\n\n  // 지역 선택 로직이 단일 드롭다운으로 통합되었습니다.\n\n  // 부동산 생성 뮤테이션\n  const createPropertyMutation = useMutation({\n    mutationFn: async (data: PropertyFormValues) => {\n      const res = await apiRequest(\"POST\", \"/api/properties\", data);\n      if (!res.ok) {\n        const errorData = await res.json();\n        throw new Error(errorData.message || \"부동산 등록에 실패했습니다\");\n      }\n      return await res.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/properties\"] });\n      toast({\n        title: \"부동산 등록 성공\",\n        description: \"새로운 부동산이 등록되었습니다.\",\n      });\n      onClose();\n      form.reset();\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"부동산 등록 실패\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // 부동산 수정 뮤테이션\n  const updatePropertyMutation = useMutation({\n    mutationFn: async ({\n      id,\n      data,\n    }: {\n      id: number;\n      data: PropertyFormValues;\n    }) => {\n      const res = await apiRequest(\"PATCH\", `/api/properties/${id}`, data);\n      if (!res.ok) {\n        const errorData = await res.json();\n        throw new Error(errorData.message || \"부동산 수정에 실패했습니다\");\n      }\n      return await res.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/properties\"] });\n      toast({\n        title: \"부동산 수정 성공\",\n        description: \"부동산 정보가 수정되었습니다.\",\n      });\n      onClose();\n      form.reset();\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"부동산 수정 실패\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // 폼 제출 처리\n  const onSubmit = (data: PropertyFormValues) => {\n    if (property) {\n      updatePropertyMutation.mutate({ id: property.id, data });\n    } else {\n      createPropertyMutation.mutate(data);\n    }\n  };\n\n  // 속성이 변경될 때마다 폼 업데이트\n  useEffect(() => {\n    if (property) {\n      // 폼 값 설정\n      form.reset({\n        title: property.title,\n        description: property.description,\n        type: property.type,\n        price: property.price.toString(),\n        address: property.address,\n        district: property.district,\n        size: property.size.toString(),\n        bedrooms: property.bedrooms,\n        bathrooms: property.bathrooms,\n        imageUrl: property.imageUrl,\n        agentId: property.agentId,\n        featured: property.featured === null ? false : property.featured,\n        buildingName: property.buildingName || \"\",\n        unitNumber: property.unitNumber || \"\",\n        supplyArea: property.supplyArea ? property.supplyArea.toString() : \"\",\n        privateArea: property.privateArea ? property.privateArea.toString() : \"\",\n        areaSize: property.areaSize || \"\",\n        floor: property.floor ? property.floor.toString() : \"\",\n        totalFloors: property.totalFloors ? property.totalFloors.toString() : \"\",\n        direction: property.direction || \"\",\n        elevator: property.elevator === null ? false : property.elevator,\n        parking: property.parking || \"\",\n        heatingSystem: property.heatingSystem || \"\",\n        approvalDate: property.approvalDate || \"\",\n        dealType: Array.isArray(property.dealType) ? property.dealType : [\"매매\"],\n        deposit: property.deposit ? property.deposit.toString() : \"\",\n        monthlyRent: property.monthlyRent ? property.monthlyRent.toString() : \"\",\n        maintenanceFee: property.maintenanceFee ? property.maintenanceFee.toString() : \"\",\n        ownerName: property.ownerName || \"\",\n        ownerPhone: property.ownerPhone || \"\",\n        tenantName: property.tenantName || \"\",\n        tenantPhone: property.tenantPhone || \"\",\n        clientName: property.clientName || \"\",\n        clientPhone: property.clientPhone || \"\",\n        specialNote: property.specialNote || \"\",\n        coListing: property.coListing === null ? false : property.coListing,\n        propertyDescription: property.propertyDescription || \"\",\n        privateNote: property.privateNote || \"\",\n      });\n    } else {\n      // 새 속성 등록을 위한 초기값 설정\n      form.reset({\n        // 기본 정보\n        title: \"\",\n        description: \"\",\n        type: \"토지\",\n        price: \"\",\n        district: \"강화읍 갑곳리\", \n        address: \"\",\n        size: \"\",\n        agentId: 1,\n        \n        // 위치 정보\n        buildingName: \"\",\n        unitNumber: \"\",\n        \n        // 면적 정보\n        supplyArea: \"\",\n        privateArea: \"\",\n        areaSize: \"\",\n        \n        // 건물 정보\n        floor: \"\",\n        totalFloors: \"\",\n        direction: \"\",\n        elevator: false,\n        parking: \"\",\n        heatingSystem: \"\",\n        approvalDate: \"\",\n        \n        // 금액 정보\n        dealType: [\"매매\"],\n        deposit: \"\",\n        monthlyRent: \"\",\n        maintenanceFee: \"\",\n        \n        // 연락처 정보\n        ownerName: \"\",\n        ownerPhone: \"\",\n        tenantName: \"\",\n        tenantPhone: \"\",\n        clientName: \"\",\n        clientPhone: \"\",\n        \n        // 추가 정보\n        specialNote: \"\",\n        coListing: false,\n        propertyDescription: \"\",\n        privateNote: \"\",\n        \n        // 기존 필드\n        bedrooms: 0,\n        bathrooms: 0,\n        featured: false,\n      });\n    }\n  }, [property, form]);\n\n  return (\n    <div className=\"bg-white p-6 shadow-md rounded-lg max-w-3xl mx-auto\">\n      <div className=\"mb-4\">\n        <h2 className=\"text-2xl font-bold\">\n          {property ? \"부동산 수정\" : \"새 부동산 등록\"}\n        </h2>\n        <p className=\"text-sm text-gray-500\">\n          {property ? \"부동산 정보를 수정하세요\" : \"새로운 부동산 매물을 등록하세요\"}\n        </p>\n      </div>\n      \n      <Form {...form}>\n        <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6\">\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n            {/* 기본 정보 */}\n            <div>\n              <FormField\n                control={form.control}\n                name=\"title\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>제목</FormLabel>\n                    <FormControl>\n                      <Input placeholder=\"부동산 제목\" {...field} />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            <div>\n              <FormField\n                control={form.control}\n                name=\"type\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>유형</FormLabel>\n                    <Select\n                      onValueChange={field.onChange}\n                      defaultValue={field.value}\n                    >\n                      <FormControl>\n                        <SelectTrigger>\n                          <SelectValue placeholder=\"부동산 유형 선택\" />\n                        </SelectTrigger>\n                      </FormControl>\n                      <SelectContent>\n                        {propertyTypes.map((type) => (\n                          <SelectItem key={type} value={type}>\n                            {type}\n                          </SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            <div className=\"md:col-span-2\">\n              <FormField\n                control={form.control}\n                name=\"description\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>설명</FormLabel>\n                    <FormControl>\n                      <Textarea\n                        placeholder=\"부동산에 대한 상세 설명\"\n                        rows={4}\n                        {...field}\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            <div>\n              <FormField\n                control={form.control}\n                name=\"price\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>가격</FormLabel>\n                    <FormControl>\n                      <Input placeholder=\"가격 (원)\" {...field} />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            <div>\n              <FormField\n                control={form.control}\n                name=\"size\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>면적 (㎡)</FormLabel>\n                    <FormControl>\n                      <Input placeholder=\"면적 (㎡)\" {...field} />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            <div className=\"md:col-span-2\">\n              <FormField\n                control={form.control}\n                name=\"district\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>지역 (읍면동리)</FormLabel>\n                    <Select\n                      onValueChange={field.onChange}\n                      defaultValue={field.value}\n                    >\n                      <FormControl>\n                        <SelectTrigger>\n                          <SelectValue placeholder=\"지역 선택\" />\n                        </SelectTrigger>\n                      </FormControl>\n                      <SelectContent className=\"max-h-[300px]\">\n                        {allLocations.map((location) => (\n                          <SelectItem key={location} value={location}>\n                            {location}\n                          </SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            <div>\n              <FormField\n                control={form.control}\n                name=\"address\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>지번</FormLabel>\n                    <FormControl>\n                      <Input placeholder=\"지번 주소\" {...field} />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            <div>\n              <FormField\n                control={form.control}\n                name=\"buildingName\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>건물명</FormLabel>\n                    <FormControl>\n                      <Input placeholder=\"건물명 (선택사항)\" {...field} />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            <div>\n              <FormField\n                control={form.control}\n                name=\"unitNumber\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>동호수</FormLabel>\n                    <FormControl>\n                      <Input placeholder=\"동호수 (선택사항)\" {...field} />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            <div>\n              <FormField\n                control={form.control}\n                name=\"supplyArea\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>공급면적 (평)</FormLabel>\n                    <FormControl>\n                      <Input placeholder=\"공급면적 (선택사항)\" {...field} />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            <div>\n              <FormField\n                control={form.control}\n                name=\"privateArea\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>전용면적 (평)</FormLabel>\n                    <FormControl>\n                      <Input placeholder=\"전용면적 (선택사항)\" {...field} />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n\n\n            <div>\n              <FormField\n                control={form.control}\n                name=\"dealType\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>거래 종류</FormLabel>\n                    <div className=\"flex flex-wrap gap-2\">\n                      {dealTypes.map((type) => (\n                        <Button\n                          key={type}\n                          type=\"button\"\n                          variant={field.value.includes(type) ? \"default\" : \"outline\"}\n                          onClick={() => {\n                            const newValue = field.value.includes(type)\n                              ? field.value.filter((t) => t !== type)\n                              : [...field.value, type];\n                            field.onChange(newValue.length ? newValue : [\"매매\"]);\n                          }}\n                        >\n                          {type}\n                        </Button>\n                      ))}\n                    </div>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            <div>\n              <FormField\n                control={form.control}\n                name=\"bedrooms\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>침실 수</FormLabel>\n                    <FormControl>\n                      <Input \n                        type=\"number\" \n                        placeholder=\"침실 수\"\n                        {...field}\n                        onChange={(e) => field.onChange(Number(e.target.value))}\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            <div>\n              <FormField\n                control={form.control}\n                name=\"bathrooms\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>욕실 수</FormLabel>\n                    <FormControl>\n                      <Input \n                        type=\"number\" \n                        placeholder=\"욕실 수\"\n                        {...field}\n                        onChange={(e) => field.onChange(Number(e.target.value))}\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            <div>\n              <FormField\n                control={form.control}\n                name=\"featured\"\n                render={({ field }) => (\n                  <FormItem className=\"flex flex-row items-center gap-2 space-y-0\">\n                    <FormControl>\n                      <input\n                        type=\"checkbox\"\n                        className=\"w-4 h-4\"\n                        checked={field.value}\n                        onChange={field.onChange}\n                      />\n                    </FormControl>\n                    <FormLabel className=\"font-normal\">추천 매물로 표시</FormLabel>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n          </div>\n\n          <div className=\"flex justify-end gap-2\">\n            <Button type=\"button\" variant=\"outline\" onClick={onClose}>\n              취소\n            </Button>\n            <Button type=\"submit\" disabled={createPropertyMutation.isPending || updatePropertyMutation.isPending}>\n              {(createPropertyMutation.isPending || updatePropertyMutation.isPending) ? \"처리 중...\" : property ? \"수정\" : \"등록\"}\n            </Button>\n          </div>\n        </form>\n      </Form>\n    </div>\n  );\n}","path":null,"size_bytes":25931,"size_tokens":null},"client/src/pages/auth-page.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useAuth, registerSchema } from \"@/hooks/use-auth\";\nimport { useLocation, useSearch } from \"wouter\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { useForm } from \"react-hook-form\";\nimport { z } from \"zod\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport {\n  Form,\n  FormControl,\n  FormDescription,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from \"@/components/ui/form\";\nimport { Input } from \"@/components/ui/input\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardDescription, CardFooter, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Loader2, UserPlus, LogIn, Home, AlertCircle } from \"lucide-react\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { Alert, AlertDescription } from \"@/components/ui/alert\";\n\n// SVG 로고 가져오기\nimport kakaoLogo from \"../assets/kakao-logo.svg\";\nimport naverLogo from \"../assets/naver-logo.svg\";\n\n// 로그인 폼 스키마\nconst loginSchema = z.object({\n  username: z.string().min(3, \"사용자 이름은 최소 3자 이상이어야 합니다\"),\n  password: z.string().min(6, \"비밀번호는 최소 6자 이상이어야 합니다\"),\n});\n\ntype LoginFormValues = z.infer<typeof loginSchema>;\ntype RegisterFormValues = z.infer<typeof registerSchema>;\n\nexport default function AuthPage() {\n  const [activeTab, setActiveTab] = useState<string>(\"login\");\n  const { user, loginMutation, registerMutation } = useAuth();\n  const [, setLocation] = useLocation();\n  const search = useSearch();\n  \n  // URL에서 에러 파라미터 확인\n  const [error, setError] = useState<string | null>(null);\n  \n  useEffect(() => {\n    // URL 에러 파라미터 확인\n    const params = new URLSearchParams(search);\n    const errorParam = params.get(\"error\");\n    \n    if (errorParam === \"naver_login_failed\") {\n      setError(\"네이버 로그인에 실패했습니다. 다시 시도해주세요.\");\n    } else if (errorParam === \"kakao_login_failed\") {\n      setError(\"카카오 로그인에 실패했습니다. 다시 시도해주세요.\");\n    } else {\n      setError(null);\n    }\n  }, [search]);\n\n  // 로그인 폼\n  const loginForm = useForm<LoginFormValues>({\n    resolver: zodResolver(loginSchema),\n    defaultValues: {\n      username: \"\",\n      password: \"\",\n    },\n  });\n\n  // 회원가입 폼\n  const registerForm = useForm<RegisterFormValues>({\n    resolver: zodResolver(registerSchema),\n    defaultValues: {\n      username: \"\",\n      password: \"\",\n      confirmPassword: \"\",\n      email: \"\",\n      phone: \"\",\n      role: \"user\",\n    },\n  });\n\n  // 로그인 제출 핸들러\n  const onLoginSubmit = (data: LoginFormValues) => {\n    loginMutation.mutate(data);\n  };\n\n  // 회원가입 제출 핸들러\n  const onRegisterSubmit = (data: RegisterFormValues) => {\n    registerMutation.mutate(data);\n  };\n\n  // 이미 로그인되어 있으면 홈으로 리다이렉트\n  if (user) {\n    // useEffect를 사용하지 않고 리다이렉트할 때는 다음 렌더링에서 처리되므로 \n    // 빈 페이지를 잠시 보여주는 게 안전합니다.\n    setTimeout(() => setLocation(\"/\"), 0);\n    return <div className=\"flex min-h-screen items-center justify-center\">리다이렉트 중...</div>;\n  }\n\n  return (\n    <div className=\"flex min-h-screen bg-gradient-to-br from-slate-50 to-gray-100\">\n      {/* 왼쪽: 폼 */}\n      <div className=\"flex flex-col items-center justify-center w-full lg:w-1/2 p-6 md:p-12\">\n        <div className=\"w-full max-w-md\">\n          <div className=\"flex justify-between items-center mb-8\">\n            <h1 className=\"text-3xl font-bold bg-gradient-to-r from-blue-600 to-indigo-800 bg-clip-text text-transparent\">이가이버 부동산</h1>\n            <Button variant=\"outline\" onClick={() => setLocation(\"/\")} className=\"flex items-center gap-2 rounded-full\">\n              <Home size={16} />\n              홈으로\n            </Button>\n          </div>\n\n          <Tabs value={activeTab} onValueChange={setActiveTab} className=\"w-full\">\n            <TabsList className=\"grid w-full grid-cols-2 mb-6 rounded-lg p-1 bg-gray-100\">\n              <TabsTrigger value=\"login\" className=\"rounded-md data-[state=active]:bg-white data-[state=active]:shadow-sm\">로그인</TabsTrigger>\n              <TabsTrigger value=\"register\" className=\"rounded-md data-[state=active]:bg-white data-[state=active]:shadow-sm\">회원가입</TabsTrigger>\n            </TabsList>\n\n            {/* 로그인 폼 */}\n            <TabsContent value=\"login\">\n              <Card className=\"border-none shadow-lg\">\n                <CardHeader className=\"pb-4\">\n                  <CardTitle className=\"text-2xl font-bold\">로그인</CardTitle>\n                  <CardDescription>\n                    계정 정보를 입력하여 로그인하세요.\n                  </CardDescription>\n                </CardHeader>\n                <CardContent>\n                  {/* 오류 메시지 표시 */}\n                  {error && (\n                    <Alert variant=\"destructive\" className=\"mb-4\">\n                      <AlertCircle className=\"h-4 w-4\" />\n                      <AlertDescription>{error}</AlertDescription>\n                    </Alert>\n                  )}\n                  \n                  <Form {...loginForm}>\n                    <form onSubmit={loginForm.handleSubmit(onLoginSubmit)} className=\"space-y-5\">\n                      <FormField\n                        control={loginForm.control}\n                        name=\"username\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel className=\"text-base\">사용자 이름</FormLabel>\n                            <FormControl>\n                              <Input \n                                placeholder=\"사용자 이름\" \n                                {...field} \n                                className=\"h-11 rounded-lg\" \n                              />\n                            </FormControl>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n                      <FormField\n                        control={loginForm.control}\n                        name=\"password\"\n                        render={({ field }) => (\n                          <FormItem>\n                            <FormLabel className=\"text-base\">비밀번호</FormLabel>\n                            <FormControl>\n                              <Input \n                                type=\"password\" \n                                placeholder=\"비밀번호\" \n                                {...field} \n                                className=\"h-11 rounded-lg\" \n                              />\n                            </FormControl>\n                            <FormMessage />\n                          </FormItem>\n                        )}\n                      />\n                      <Button\n                        type=\"submit\"\n                        className=\"w-full h-11 text-base rounded-lg bg-gradient-to-r from-blue-600 to-indigo-800 hover:from-blue-700 hover:to-indigo-900 transition-all\"\n                        disabled={loginMutation.isPending}\n                      >\n                        {loginMutation.isPending ? (\n                          <>\n                            <Loader2 className=\"mr-2 h-5 w-5 animate-spin\" />\n                            로그인 중...\n                          </>\n                        ) : (\n                          <>\n                            <LogIn className=\"mr-2 h-5 w-5\" />\n                            로그인\n                          </>\n                        )}\n                      </Button>\n                      \n                      {/* 소셜 로그인 구분선 */}\n                      <div className=\"relative my-6\">\n                        <div className=\"absolute inset-0 flex items-center\">\n                          <Separator className=\"w-full\" />\n                        </div>\n                        <div className=\"relative flex justify-center\">\n                          <span className=\"bg-white px-4 text-sm text-gray-500\">소셜 계정으로 로그인</span>\n                        </div>\n                      </div>\n                      \n                      {/* 소셜 로그인 버튼 */}\n                      <div className=\"grid grid-cols-2 gap-4\">\n                        <a href=\"/api/auth/kakao\" className=\"w-full\">\n                          <Button\n                            variant=\"outline\"\n                            type=\"button\"\n                            className=\"w-full h-11 text-base rounded-lg hover:bg-yellow-50 border-[#FEE500] bg-[#FEE500]\"\n                          >\n                            <img src={kakaoLogo} alt=\"Kakao\" className=\"w-5 h-5 mr-2\" />\n                            카카오 로그인\n                          </Button>\n                        </a>\n                        <a href=\"/api/auth/naver\" className=\"w-full\">\n                          <Button\n                            variant=\"outline\"\n                            type=\"button\"\n                            className=\"w-full h-11 text-base rounded-lg text-white hover:bg-green-600 border-[#03C75A] bg-[#03C75A]\"\n                          >\n                            <img src={naverLogo} alt=\"Naver\" className=\"w-5 h-5 mr-2\" />\n                            네이버 로그인\n                          </Button>\n                        </a>\n                      </div>\n                    </form>\n                  </Form>\n                </CardContent>\n                <CardFooter className=\"flex flex-col pt-0\">\n                  <p className=\"text-sm text-muted-foreground\">\n                    계정이 없으신가요?{\" \"}\n                    <Button variant=\"link\" className=\"p-0 text-blue-600\" onClick={() => setActiveTab(\"register\")}>\n                      회원가입\n                    </Button>\n                  </p>\n                </CardFooter>\n              </Card>\n            </TabsContent>\n\n            {/* 회원가입 폼 */}\n            <TabsContent value=\"register\">\n              <Card className=\"border-none shadow-lg\">\n                <CardHeader className=\"pb-4\">\n                  <CardTitle className=\"text-2xl font-bold\">회원가입</CardTitle>\n                  <CardDescription>\n                    새 계정을 만들어 이가이버 부동산 서비스를 이용하세요.\n                  </CardDescription>\n                </CardHeader>\n                <CardContent>\n                  <Form {...registerForm}>\n                    <form onSubmit={registerForm.handleSubmit(onRegisterSubmit)} className=\"space-y-4\">\n                      <div className=\"grid gap-4 md:grid-cols-2\">\n                        <FormField\n                          control={registerForm.control}\n                          name=\"username\"\n                          render={({ field }) => (\n                            <FormItem className=\"md:col-span-2\">\n                              <FormLabel className=\"text-base\">사용자 이름</FormLabel>\n                              <FormControl>\n                                <Input placeholder=\"사용자 이름\" {...field} className=\"h-11 rounded-lg\" />\n                              </FormControl>\n                              <FormDescription>\n                                3자 이상의 사용자 이름을 입력하세요.\n                              </FormDescription>\n                              <FormMessage />\n                            </FormItem>\n                          )}\n                        />\n                        <FormField\n                          control={registerForm.control}\n                          name=\"password\"\n                          render={({ field }) => (\n                            <FormItem>\n                              <FormLabel className=\"text-base\">비밀번호</FormLabel>\n                              <FormControl>\n                                <Input type=\"password\" placeholder=\"비밀번호\" {...field} className=\"h-11 rounded-lg\" />\n                              </FormControl>\n                              <FormDescription>\n                                6자 이상의 비밀번호를 설정하세요.\n                              </FormDescription>\n                              <FormMessage />\n                            </FormItem>\n                          )}\n                        />\n                        <FormField\n                          control={registerForm.control}\n                          name=\"confirmPassword\"\n                          render={({ field }) => (\n                            <FormItem>\n                              <FormLabel className=\"text-base\">비밀번호 확인</FormLabel>\n                              <FormControl>\n                                <Input type=\"password\" placeholder=\"비밀번호 확인\" {...field} className=\"h-11 rounded-lg\" />\n                              </FormControl>\n                              <FormMessage />\n                            </FormItem>\n                          )}\n                        />\n                        <FormField\n                          control={registerForm.control}\n                          name=\"email\"\n                          render={({ field }) => (\n                            <FormItem className=\"md:col-span-2\">\n                              <FormLabel className=\"text-base\">이메일</FormLabel>\n                              <FormControl>\n                                <Input placeholder=\"example@email.com\" {...field} className=\"h-11 rounded-lg\" />\n                              </FormControl>\n                              <FormMessage />\n                            </FormItem>\n                          )}\n                        />\n                        <FormField\n                          control={registerForm.control}\n                          name=\"phone\"\n                          render={({ field }) => (\n                            <FormItem className=\"md:col-span-2\">\n                              <FormLabel className=\"text-base\">연락처</FormLabel>\n                              <FormControl>\n                                <Input placeholder=\"010-1234-5678\" {...field} className=\"h-11 rounded-lg\" />\n                              </FormControl>\n                              <FormMessage />\n                            </FormItem>\n                          )}\n                        />\n                      </div>\n                      <FormField\n                        control={registerForm.control}\n                        name=\"role\"\n                        render={({ field }) => (\n                          <FormItem className=\"hidden\">\n                            <FormControl>\n                              <Input type=\"hidden\" {...field} />\n                            </FormControl>\n                          </FormItem>\n                        )}\n                      />\n                      <Button\n                        type=\"submit\"\n                        className=\"w-full h-11 text-base rounded-lg mt-4 bg-gradient-to-r from-blue-600 to-indigo-800 hover:from-blue-700 hover:to-indigo-900 transition-all\"\n                        disabled={registerMutation.isPending}\n                      >\n                        {registerMutation.isPending ? (\n                          <>\n                            <Loader2 className=\"mr-2 h-5 w-5 animate-spin\" />\n                            회원가입 중...\n                          </>\n                        ) : (\n                          <>\n                            <UserPlus className=\"mr-2 h-5 w-5\" />\n                            회원가입\n                          </>\n                        )}\n                      </Button>\n                    </form>\n                  </Form>\n                </CardContent>\n                <CardFooter className=\"flex flex-col pt-0\">\n                  <p className=\"text-sm text-muted-foreground\">\n                    이미 계정이 있으신가요?{\" \"}\n                    <Button variant=\"link\" className=\"p-0 text-blue-600\" onClick={() => setActiveTab(\"login\")}>\n                      로그인\n                    </Button>\n                  </p>\n                </CardFooter>\n              </Card>\n            </TabsContent>\n          </Tabs>\n        </div>\n      </div>\n\n      {/* 오른쪽: 히어로 섹션 */}\n      <div className=\"hidden lg:flex lg:w-1/2 bg-gradient-to-br from-blue-700 to-indigo-900 text-white p-12 flex-col justify-center relative overflow-hidden\">\n        {/* 배경 패턴 효과 */}\n        <div className=\"absolute top-0 left-0 w-full h-full opacity-10\">\n          <div className=\"absolute w-96 h-96 rounded-full bg-white/20 -top-10 -right-10\"></div>\n          <div className=\"absolute w-96 h-96 rounded-full bg-white/20 bottom-0 left-1/4\"></div>\n          <div className=\"absolute w-60 h-60 rounded-full bg-white/20 top-1/3 left-10\"></div>\n        </div>\n        \n        <div className=\"max-w-xl relative z-10\">\n          <h2 className=\"text-4xl font-bold mb-6 leading-tight\">이가이버 부동산과 함께<br />당신의 꿈의 집을 찾으세요</h2>\n          <p className=\"text-lg mb-10 text-blue-100\">\n            회원가입을 통해 다양한 부동산 정보를 확인하고, 관심 매물을 저장하거나 부동산 중개사와 상담 예약을 할 수 있습니다.\n          </p>\n          <div className=\"space-y-6\">\n            <div className=\"flex items-start\">\n              <div className=\"bg-white/20 rounded-full p-2 mr-4 backdrop-blur-sm\">\n                <svg\n                  xmlns=\"http://www.w3.org/2000/svg\"\n                  className=\"h-6 w-6\"\n                  fill=\"none\"\n                  viewBox=\"0 0 24 24\"\n                  stroke=\"currentColor\"\n                >\n                  <path\n                    strokeLinecap=\"round\"\n                    strokeLinejoin=\"round\"\n                    strokeWidth={2}\n                    d=\"M5 13l4 4L19 7\"\n                  />\n                </svg>\n              </div>\n              <div>\n                <h3 className=\"font-semibold text-xl text-white\">다양한 매물 정보</h3>\n                <p className=\"text-blue-100\">아파트, 주택, 오피스텔 등 다양한 부동산 매물 정보를 확인하세요.</p>\n              </div>\n            </div>\n            <div className=\"flex items-start\">\n              <div className=\"bg-white/20 rounded-full p-2 mr-4 backdrop-blur-sm\">\n                <svg\n                  xmlns=\"http://www.w3.org/2000/svg\"\n                  className=\"h-6 w-6\"\n                  fill=\"none\"\n                  viewBox=\"0 0 24 24\"\n                  stroke=\"currentColor\"\n                >\n                  <path\n                    strokeLinecap=\"round\"\n                    strokeLinejoin=\"round\"\n                    strokeWidth={2}\n                    d=\"M5 13l4 4L19 7\"\n                  />\n                </svg>\n              </div>\n              <div>\n                <h3 className=\"font-semibold text-xl text-white\">전문 중개사 상담</h3>\n                <p className=\"text-blue-100\">지역별 전문 부동산 중개사와 상담하여 최적의 매물을 찾아보세요.</p>\n              </div>\n            </div>\n            <div className=\"flex items-start\">\n              <div className=\"bg-white/20 rounded-full p-2 mr-4 backdrop-blur-sm\">\n                <svg\n                  xmlns=\"http://www.w3.org/2000/svg\"\n                  className=\"h-6 w-6\"\n                  fill=\"none\"\n                  viewBox=\"0 0 24 24\"\n                  stroke=\"currentColor\"\n                >\n                  <path\n                    strokeLinecap=\"round\"\n                    strokeLinejoin=\"round\"\n                    strokeWidth={2}\n                    d=\"M5 13l4 4L19 7\"\n                  />\n                </svg>\n              </div>\n              <div>\n                <h3 className=\"font-semibold text-xl text-white\">실시간 알림 서비스</h3>\n                <p className=\"text-blue-100\">관심 지역의 새로운 매물이 등록되면 실시간으로 알림을 받아보세요.</p>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}","path":null,"size_bytes":20442,"size_tokens":null},"client/src/components/ui/pagination.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { ButtonProps, buttonVariants } from \"@/components/ui/button\"\n\nconst Pagination = ({ className, ...props }: React.ComponentProps<\"nav\">) => (\n  <nav\n    role=\"navigation\"\n    aria-label=\"pagination\"\n    className={cn(\"mx-auto flex w-full justify-center\", className)}\n    {...props}\n  />\n)\nPagination.displayName = \"Pagination\"\n\nconst PaginationContent = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    className={cn(\"flex flex-row items-center gap-1\", className)}\n    {...props}\n  />\n))\nPaginationContent.displayName = \"PaginationContent\"\n\nconst PaginationItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li ref={ref} className={cn(\"\", className)} {...props} />\n))\nPaginationItem.displayName = \"PaginationItem\"\n\ntype PaginationLinkProps = {\n  isActive?: boolean\n} & Pick<ButtonProps, \"size\"> &\n  React.ComponentProps<\"a\">\n\nconst PaginationLink = ({\n  className,\n  isActive,\n  size = \"icon\",\n  ...props\n}: PaginationLinkProps) => (\n  <a\n    aria-current={isActive ? \"page\" : undefined}\n    className={cn(\n      buttonVariants({\n        variant: isActive ? \"outline\" : \"ghost\",\n        size,\n      }),\n      className\n    )}\n    {...props}\n  />\n)\nPaginationLink.displayName = \"PaginationLink\"\n\nconst PaginationPrevious = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to previous page\"\n    size=\"default\"\n    className={cn(\"gap-1 pl-2.5\", className)}\n    {...props}\n  >\n    <ChevronLeft className=\"h-4 w-4\" />\n    <span>Previous</span>\n  </PaginationLink>\n)\nPaginationPrevious.displayName = \"PaginationPrevious\"\n\nconst PaginationNext = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to next page\"\n    size=\"default\"\n    className={cn(\"gap-1 pr-2.5\", className)}\n    {...props}\n  >\n    <span>Next</span>\n    <ChevronRight className=\"h-4 w-4\" />\n  </PaginationLink>\n)\nPaginationNext.displayName = \"PaginationNext\"\n\nconst PaginationEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    aria-hidden\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More pages</span>\n  </span>\n)\nPaginationEllipsis.displayName = \"PaginationEllipsis\"\n\nexport {\n  Pagination,\n  PaginationContent,\n  PaginationEllipsis,\n  PaginationItem,\n  PaginationLink,\n  PaginationNext,\n  PaginationPrevious,\n}\n","path":null,"size_bytes":2751,"size_tokens":null},"client/src/pages/NewsPage.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { News } from \"@shared/schema\";\nimport { Helmet } from \"react-helmet\";\nimport { Card, CardContent, CardDescription, CardFooter, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { \n  Pagination, \n  PaginationContent, \n  PaginationItem, \n  PaginationLink, \n  PaginationNext, \n  PaginationPrevious \n} from \"@/components/ui/pagination\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Calendar, Clock, ExternalLink, Newspaper } from \"lucide-react\";\nimport { format } from \"date-fns\";\n\nconst ITEMS_PER_PAGE = 15;\n\nexport default function NewsPage() {\n  const [currentPage, setCurrentPage] = useState(1);\n\n  // 최신 뉴스 가져오기 (6개)\n  const { data: latestNews, isLoading: isLoadingLatest } = useQuery<News[]>({\n    queryKey: [\"/api/news/latest\"],\n  });\n\n  // 모든 뉴스 가져오기\n  const { data: allNews, isLoading: isLoadingAll } = useQuery<News[]>({\n    queryKey: [\"/api/news\"],\n  });\n\n  // 페이지네이션 계산\n  const totalPages = allNews ? Math.ceil(allNews.length / ITEMS_PER_PAGE) : 0;\n  const startIdx = (currentPage - 1) * ITEMS_PER_PAGE;\n  const endIdx = startIdx + ITEMS_PER_PAGE;\n  const currentPageItems = allNews ? allNews.slice(startIdx, endIdx) : [];\n\n  // 이전 페이지로 이동\n  const goToPreviousPage = () => {\n    if (currentPage > 1) {\n      setCurrentPage(currentPage - 1);\n    }\n  };\n\n  // 다음 페이지로 이동\n  const goToNextPage = () => {\n    if (currentPage < totalPages) {\n      setCurrentPage(currentPage + 1);\n    }\n  };\n\n  // 특정 페이지로 이동\n  const goToPage = (page: number) => {\n    setCurrentPage(page);\n  };\n\n  // 페이지네이션 링크 생성\n  const renderPaginationLinks = () => {\n    const links = [];\n    const maxVisiblePages = 5;\n    let startPage = Math.max(1, currentPage - Math.floor(maxVisiblePages / 2));\n    const endPage = Math.min(totalPages, startPage + maxVisiblePages - 1);\n\n    // 시작 페이지 조정\n    if (endPage - startPage + 1 < maxVisiblePages) {\n      startPage = Math.max(1, endPage - maxVisiblePages + 1);\n    }\n\n    for (let i = startPage; i <= endPage; i++) {\n      links.push(\n        <PaginationItem key={i}>\n          <PaginationLink \n            isActive={currentPage === i} \n            onClick={() => goToPage(i)}\n          >\n            {i}\n          </PaginationLink>\n        </PaginationItem>\n      );\n    }\n    return links;\n  };\n\n  // 날짜 포맷팅 함수\n  const formatDate = (dateString: string | Date) => {\n    const date = typeof dateString === 'string' ? new Date(dateString) : dateString;\n    return format(date, 'yyyy-MM-dd');\n  };\n\n  return (\n    <div className=\"container mx-auto px-4 py-20\">\n      <Helmet>\n        <title>부동산뉴스 | 이가이버 부동산</title>\n        <meta name=\"description\" content=\"강화군과 수도권의 최신 부동산뉴스와 정보를 확인하세요.\" />\n      </Helmet>\n\n      <div className=\"text-center mb-8\">\n        <h1 className=\"text-3xl font-bold mb-2\">부동산뉴스</h1>\n        <p className=\"text-neutral-600\">알고 있어야할 강화군, 수도권 부동산뉴스</p>\n      </div>\n\n      <div className=\"space-y-12\">\n        {/* 최신 뉴스 (갤러리 형식) */}\n        <div>\n          <h2 className=\"text-2xl font-bold mb-6\">최신 부동산뉴스</h2>\n          \n          {isLoadingLatest ? (\n            <div className=\"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-3 gap-6 animate-pulse\">\n              {[...Array(6)].map((_, index) => (\n                <div key={index} className=\"h-80 bg-gray-200 rounded-lg\"></div>\n              ))}\n            </div>\n          ) : latestNews && latestNews.length > 0 ? (\n            <div className=\"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-3 gap-6\">\n              {latestNews.map((news) => (\n                <Card key={news.id} className=\"overflow-hidden h-full flex flex-col\">\n                  <div className=\"h-48 overflow-hidden relative\">\n                    <img \n                      src={news.imageUrl || 'https://images.unsplash.com/photo-1560518883-ce09059eeffa?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=800&h=500'} \n                      alt={news.title} \n                      className=\"w-full h-full object-cover\"\n                    />\n                    {news.isPinned && (\n                      <div className=\"absolute top-2 right-2\">\n                        <Badge variant=\"secondary\" className=\"bg-primary text-white\">주요뉴스</Badge>\n                      </div>\n                    )}\n                  </div>\n                  <CardHeader className=\"pb-2\">\n                    <div className=\"flex justify-between items-center mb-2\">\n                      <Badge className=\"text-xs\">{news.category}</Badge>\n                      <div className=\"flex items-center text-xs text-neutral-500\">\n                        <Calendar size={12} className=\"mr-1\" />\n                        {formatDate(news.createdAt!)}\n                      </div>\n                    </div>\n                    <CardTitle className=\"text-lg line-clamp-2\">\n                      <a href={`/news/${news.id}`} className=\"hover:text-primary transition-colors\">\n                        {news.title}\n                      </a>\n                    </CardTitle>\n                    <CardDescription className=\"line-clamp-2 mt-1 text-sm\">\n                      {news.summary}\n                    </CardDescription>\n                  </CardHeader>\n                  <CardFooter className=\"pt-2 mt-auto flex justify-between items-center text-xs text-neutral-500\">\n                    <div className=\"flex items-center\">\n                      <Newspaper size={12} className=\"mr-1\" />\n                      {news.source}\n                    </div>\n                    <Button variant=\"ghost\" size=\"sm\" asChild className=\"h-8 px-2\">\n                      <a href={`/news/${news.id}`} className=\"flex items-center\">\n                        자세히 보기\n                      </a>\n                    </Button>\n                  </CardFooter>\n                </Card>\n              ))}\n            </div>\n          ) : (\n            <div className=\"text-center py-12\">\n              <Newspaper className=\"mx-auto h-12 w-12 text-neutral-400\" />\n              <h3 className=\"mt-4 text-lg font-medium\">등록된 뉴스가 없습니다</h3>\n              <p className=\"mt-2 text-neutral-500\">곧 새로운 부동산 뉴스가 업데이트될 예정입니다.</p>\n            </div>\n          )}\n        </div>\n\n        {/* 전체 뉴스 (게시판 형식) */}\n        <div>\n          <h2 className=\"text-2xl font-bold mb-6\">전체 부동산뉴스</h2>\n          \n          {isLoadingAll ? (\n            <div className=\"space-y-2 animate-pulse\">\n              {[...Array(10)].map((_, index) => (\n                <div key={index} className=\"h-12 bg-gray-200 rounded\"></div>\n              ))}\n            </div>\n          ) : allNews && allNews.length > 0 ? (\n            <>\n              <div className=\"overflow-x-auto\">\n                <table className=\"w-full border-collapse\">\n                  <thead>\n                    <tr className=\"bg-neutral-100\">\n                      <th className=\"py-3 px-4 text-left font-medium text-neutral-700\">제목</th>\n                      <th className=\"py-3 px-4 text-center font-medium text-neutral-700 w-24\">카테고리</th>\n                      <th className=\"py-3 px-4 text-center font-medium text-neutral-700 w-32\">등록일</th>\n                      <th className=\"py-3 px-4 text-center font-medium text-neutral-700 w-24\">원문</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {currentPageItems.map((news) => (\n                      <tr key={news.id} className=\"border-b hover:bg-neutral-50\">\n                        <td className=\"py-3 px-4\">\n                          <div>\n                            <a href={`/news/${news.id}`} className=\"font-medium line-clamp-1 hover:text-primary transition-colors\">\n                              {news.title}\n                            </a>\n                            <p className=\"text-sm text-neutral-500 line-clamp-1 mt-1\">{news.description}</p>\n                          </div>\n                        </td>\n                        <td className=\"py-3 px-4 text-center\">\n                          <Badge variant=\"outline\">{news.category}</Badge>\n                        </td>\n                        <td className=\"py-3 px-4 text-center text-neutral-600 text-sm\">\n                          <div className=\"flex flex-col items-center\">\n                            <span>{formatDate(news.createdAt!)}</span>\n                          </div>\n                        </td>\n                        <td className=\"py-3 px-4 text-center\">\n                          <a \n                            href={news.sourceUrl} \n                            target=\"_blank\" \n                            rel=\"noopener noreferrer\"\n                            className=\"inline-flex items-center text-primary hover:text-primary/80\"\n                          >\n                            <ExternalLink size={16} />\n                          </a>\n                        </td>\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n              </div>\n\n              {/* 페이지네이션 */}\n              <Pagination className=\"mt-6\">\n                <PaginationContent>\n                  <PaginationItem>\n                    <Button \n                      variant=\"outline\" \n                      size=\"sm\" \n                      onClick={goToPreviousPage} \n                      disabled={currentPage === 1}\n                      className=\"flex items-center gap-1\"\n                    >\n                      이전\n                    </Button>\n                  </PaginationItem>\n                  \n                  {renderPaginationLinks()}\n                  \n                  <PaginationItem>\n                    <Button \n                      variant=\"outline\" \n                      size=\"sm\" \n                      onClick={goToNextPage} \n                      disabled={currentPage === totalPages}\n                      className=\"flex items-center gap-1\"\n                    >\n                      다음\n                    </Button>\n                  </PaginationItem>\n                </PaginationContent>\n              </Pagination>\n            </>\n          ) : (\n            <div className=\"text-center py-12\">\n              <Newspaper className=\"mx-auto h-12 w-12 text-neutral-400\" />\n              <h3 className=\"mt-4 text-lg font-medium\">등록된 뉴스가 없습니다</h3>\n              <p className=\"mt-2 text-neutral-500\">곧 새로운 부동산 뉴스가 업데이트될 예정입니다.</p>\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}","path":null,"size_bytes":11015,"size_tokens":null},"client/src/components/ui/table.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Table = React.forwardRef<\n  HTMLTableElement,\n  React.HTMLAttributes<HTMLTableElement>\n>(({ className, ...props }, ref) => (\n  <div className=\"relative w-full overflow-auto\">\n    <table\n      ref={ref}\n      className={cn(\"w-full caption-bottom text-sm\", className)}\n      {...props}\n    />\n  </div>\n))\nTable.displayName = \"Table\"\n\nconst TableHeader = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\n))\nTableHeader.displayName = \"TableHeader\"\n\nconst TableBody = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tbody\n    ref={ref}\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\n    {...props}\n  />\n))\nTableBody.displayName = \"TableBody\"\n\nconst TableFooter = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tfoot\n    ref={ref}\n    className={cn(\n      \"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableFooter.displayName = \"TableFooter\"\n\nconst TableRow = React.forwardRef<\n  HTMLTableRowElement,\n  React.HTMLAttributes<HTMLTableRowElement>\n>(({ className, ...props }, ref) => (\n  <tr\n    ref={ref}\n    className={cn(\n      \"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nTableRow.displayName = \"TableRow\"\n\nconst TableHead = React.forwardRef<\n  HTMLTableCellElement,\n  React.ThHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <th\n    ref={ref}\n    className={cn(\n      \"h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableHead.displayName = \"TableHead\"\n\nconst TableCell = React.forwardRef<\n  HTMLTableCellElement,\n  React.TdHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <td\n    ref={ref}\n    className={cn(\"p-4 align-middle [&:has([role=checkbox])]:pr-0\", className)}\n    {...props}\n  />\n))\nTableCell.displayName = \"TableCell\"\n\nconst TableCaption = React.forwardRef<\n  HTMLTableCaptionElement,\n  React.HTMLAttributes<HTMLTableCaptionElement>\n>(({ className, ...props }, ref) => (\n  <caption\n    ref={ref}\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nTableCaption.displayName = \"TableCaption\"\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n","path":null,"size_bytes":2765,"size_tokens":null},"client/src/components/admin/PropertyFormDialog.tsx":{"content":"import { useEffect } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { z } from \"zod\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport {\n  Form,\n  FormControl,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from \"@/components/ui/form\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport {\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogDescription,\n} from \"@/components/ui/dialog\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Property, insertPropertySchema } from \"@shared/schema\";\n\n// 부동산 유형 목록\nconst propertyTypes = [\"토지\", \"주택\", \"아파트연립다세대\", \"원투룸\", \"상가공장창고펜션\"];\n\n// 통합된 지역 목록 (읍면동리)\nconst allLocations = [\n  \"강화군외\",\n  \"강화읍 갑곳리\",\n  \"강화읍 관청리\",\n  \"강화읍 국화리\",\n  \"강화읍 남산리\",\n  \"강화읍 대산리\",\n  \"강화읍 신문리\",\n  \"강화읍 옥림리\",\n  \"강화읍 용정리\",\n  \"강화읍 월곳리\",\n  \"교동면 고구리\",\n  \"교동면 난정리\",\n  \"교동면 대룡리\",\n  \"교동면 동산리\",\n  \"교동면 무학리\",\n  \"교동면 봉소리\",\n  \"교동면 삼선리\",\n  \"교동면 상용리\",\n  \"교동면 서한리\",\n  \"교동면 양갑리\",\n  \"교동면 읍내리\",\n  \"교동면 인사리\",\n  \"교동면 지석리\",\n  \"길상면 길직리\",\n  \"길상면 동검리\",\n  \"길상면 선두리\",\n  \"길상면 온수리\",\n  \"길상면 장흥리\",\n  \"길상면 초지리\",\n  \"내가면 고천리\",\n  \"내가면 구하리\",\n  \"내가면 오상리\",\n  \"내가면 외포리\",\n  \"내가면 황청리\",\n  \"불은면 고능리\",\n  \"불은면 넙성리\",\n  \"불은면 덕성리\",\n  \"불은면 두운리\",\n  \"불은면 삼동암리\",\n  \"불은면 삼성리\",\n  \"불은면 신현리\",\n  \"불은면 오두리\",\n  \"삼산면 매음리\",\n  \"삼산면 미법리\",\n  \"삼산면 상리\",\n  \"삼산면 서검리\",\n  \"삼산면 석모리\",\n  \"삼산면 석포리\",\n  \"삼산면 하리\",\n  \"서도면 말도리\",\n  \"서도면 볼음도리\",\n  \"서도면 아차도리\",\n  \"서도면 주문도리\",\n  \"선원면 금월리\",\n  \"선원면 냉정리\",\n  \"선원면 선행리\",\n  \"선원면 신정리\",\n  \"선원면 연리\",\n  \"선원면 지산리\",\n  \"선원면 창리\",\n  \"송해면 당산리\",\n  \"송해면 상도리\",\n  \"송해면 솔정리\",\n  \"송해면 숭뢰리\",\n  \"송해면 신당리\",\n  \"송해면 양오리\",\n  \"송해면 하도리\",\n  \"양도면 건평리\",\n  \"양도면 길정리\",\n  \"양도면 능내리\",\n  \"양도면 도장리\",\n  \"양도면 삼흥리\",\n  \"양도면 인산리\",\n  \"양도면 조산리\",\n  \"양도면 하일리\",\n  \"양사면 교산리\",\n  \"양사면 덕하리\",\n  \"양사면 북성리\",\n  \"양사면 인화리\",\n  \"양사면 철산리\",\n  \"하점면 망월리\",\n  \"하점면 부근리\",\n  \"하점면 삼거리\",\n  \"하점면 신봉리\",\n  \"하점면 신삼리\",\n  \"하점면 이강리\",\n  \"하점면 장정리\",\n  \"하점면 창후리\",\n  \"화도면 내리\",\n  \"화도면 덕포리\",\n  \"화도면 동막리\",\n  \"화도면 문산리\",\n  \"화도면 사기리\",\n  \"화도면 상방리\",\n  \"화도면 여차리\",\n  \"화도면 장화리\",\n  \"화도면 흥왕리\",\n  \"강화군외\"\n];\n\n// 거래 종류\nconst dealTypes = [\"매매\", \"전세\", \"월세\", \"완료\", \"보류중\"];\n\n// 단일 드롭다운으로 변경되어 이전 코드는 삭제되었습니다.\n\n// 속성 입력 값 스키마\nconst propertyFormSchema = insertPropertySchema.extend({\n  price: z.union([z.string(), z.number()]).optional(),\n  size: z.union([z.string(), z.number()]).optional(),\n  supplyArea: z.union([z.string(), z.number()]).optional().nullable(),\n  privateArea: z.union([z.string(), z.number()]).optional().nullable(),\n  floor: z.union([z.string(), z.number()]).optional().nullable(),\n  totalFloors: z.union([z.string(), z.number()]).optional().nullable(),\n  deposit: z.union([z.string(), z.number()]).optional().nullable(),\n  monthlyRent: z.union([z.string(), z.number()]).optional().nullable(),\n  maintenanceFee: z.union([z.string(), z.number()]).optional().nullable(),\n});\n\ntype PropertyFormValues = z.infer<typeof propertyFormSchema>;\n\ninterface PropertyFormDialogProps {\n  renderDialog: (content: React.ReactNode) => React.ReactNode;\n  onSubmitSuccess: () => void;\n  property?: Property | null;\n}\n\nexport function PropertyFormDialog({ renderDialog, onSubmitSuccess, property }: PropertyFormDialogProps) {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  // 지역 선택 로직이 단일 드롭다운으로 통합되었습니다.\n  \n  // 부동산 등록/수정 폼\n  const form = useForm<PropertyFormValues>({\n    resolver: zodResolver(propertyFormSchema),\n    defaultValues: {\n      // 기본 정보\n      title: \"\",\n      description: \"\",\n      type: \"토지\",\n      price: \"\",\n      district: \"강화읍 갑곳리\", \n      address: \"\",\n      size: \"\",\n      agentId: 1,\n      \n      // 위치 정보\n      buildingName: \"\",\n      unitNumber: \"\",\n      \n      // 면적 정보\n      supplyArea: \"\",\n      privateArea: \"\",\n      areaSize: \"\",\n      \n      // 건물 정보\n      floor: \"\",\n      totalFloors: \"\",\n      direction: \"\",\n      elevator: false,\n      parking: \"\",\n      heatingSystem: \"\",\n      approvalDate: \"\",\n      \n      // 금액 정보\n      dealType: [\"매매\"],\n      deposit: \"\",\n      monthlyRent: \"\",\n      maintenanceFee: \"\",\n      \n      // 연락처 정보\n      ownerName: \"\",\n      ownerPhone: \"\",\n      tenantName: \"\",\n      tenantPhone: \"\",\n      clientName: \"\",\n      clientPhone: \"\",\n      \n      // 추가 정보\n      specialNote: \"\",\n      coListing: false,\n      propertyDescription: \"\",\n      privateNote: \"\",\n      \n      // 기존 필드\n      bedrooms: 0,\n      bathrooms: 0,\n      featured: false,\n    },\n  });\n\n  // 지역 선택이 단일 드롭다운으로 통합되었습니다.\n\n  // 부동산 생성 뮤테이션\n  const createPropertyMutation = useMutation({\n    mutationFn: async (data: PropertyFormValues) => {\n      const res = await apiRequest(\"POST\", \"/api/properties\", data);\n      if (!res.ok) {\n        const errorData = await res.json();\n        throw new Error(errorData.message || \"부동산 등록에 실패했습니다\");\n      }\n      return await res.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/properties\"] });\n      toast({\n        title: \"부동산 등록 성공\",\n        description: \"새로운 부동산이 등록되었습니다.\",\n      });\n      onSubmitSuccess();\n      form.reset();\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"부동산 등록 실패\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // 부동산 수정 뮤테이션\n  const updatePropertyMutation = useMutation({\n    mutationFn: async ({\n      id,\n      data,\n    }: {\n      id: number;\n      data: PropertyFormValues;\n    }) => {\n      const res = await apiRequest(\"PATCH\", `/api/properties/${id}`, data);\n      if (!res.ok) {\n        const errorData = await res.json();\n        throw new Error(errorData.message || \"부동산 수정에 실패했습니다\");\n      }\n      return await res.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/properties\"] });\n      toast({\n        title: \"부동산 수정 성공\",\n        description: \"부동산 정보가 수정되었습니다.\",\n      });\n      onSubmitSuccess();\n      form.reset();\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"부동산 수정 실패\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // 폼 제출 처리\n  const onSubmit = (data: PropertyFormValues) => {\n    if (property) {\n      updatePropertyMutation.mutate({ id: property.id, data });\n    } else {\n      createPropertyMutation.mutate(data);\n    }\n  };\n\n  // 속성이 변경될 때마다 폼 업데이트\n  useEffect(() => {\n    if (property) {\n      // 폼 값 설정\n      form.reset({\n        title: property.title,\n        description: property.description,\n        type: property.type,\n        price: property.price.toString(),\n        address: property.address,\n\n        district: property.district,\n        size: property.size.toString(),\n        bedrooms: property.bedrooms,\n        bathrooms: property.bathrooms,\n        agentId: property.agentId,\n        featured: property.featured === null ? undefined : property.featured,\n        buildingName: property.buildingName || undefined,\n        unitNumber: property.unitNumber || undefined,\n        supplyArea: property.supplyArea ? property.supplyArea.toString() : undefined,\n        privateArea: property.privateArea ? property.privateArea.toString() : undefined,\n        areaSize: property.areaSize || undefined,\n        floor: property.floor ? property.floor.toString() : undefined,\n        totalFloors: property.totalFloors ? property.totalFloors.toString() : undefined,\n        direction: property.direction || undefined,\n        elevator: property.elevator === null ? undefined : property.elevator,\n        parking: property.parking || undefined,\n        heatingSystem: property.heatingSystem || undefined,\n        approvalDate: property.approvalDate || undefined,\n        dealType: Array.isArray(property.dealType) ? property.dealType : [\"매매\"],\n        deposit: property.deposit ? property.deposit.toString() : undefined,\n        monthlyRent: property.monthlyRent ? property.monthlyRent.toString() : undefined,\n        maintenanceFee: property.maintenanceFee ? property.maintenanceFee.toString() : undefined,\n        ownerName: property.ownerName || undefined,\n        ownerPhone: property.ownerPhone || undefined,\n        tenantName: property.tenantName || undefined,\n        tenantPhone: property.tenantPhone || undefined,\n        clientName: property.clientName || undefined,\n        clientPhone: property.clientPhone || undefined,\n        specialNote: property.specialNote || undefined,\n        coListing: property.coListing === null ? undefined : property.coListing,\n        propertyDescription: property.propertyDescription || undefined,\n        privateNote: property.privateNote || undefined,\n      });\n    } else {\n      // 새 속성 등록을 위한 초기값 설정\n      form.reset({\n        // 기본 정보\n        title: \"\",\n        description: \"\",\n        type: \"토지\",\n        price: \"\",\n\n        district: \"강화읍 갑곳리\", \n        address: \"\",\n        size: \"\",\n        agentId: 1,\n        \n        // 위치 정보\n        buildingName: \"\",\n        unitNumber: \"\",\n        \n        // 면적 정보\n        supplyArea: \"\",\n        privateArea: \"\",\n        areaSize: \"\",\n        \n        // 건물 정보\n        floor: \"\",\n        totalFloors: \"\",\n        direction: \"\",\n        elevator: false,\n        parking: \"\",\n        heatingSystem: \"\",\n        approvalDate: \"\",\n        \n        // 금액 정보\n        dealType: [\"매매\"],\n        deposit: \"\",\n        monthlyRent: \"\",\n        maintenanceFee: \"\",\n        \n        // 연락처 정보\n        ownerName: \"\",\n        ownerPhone: \"\",\n        tenantName: \"\",\n        tenantPhone: \"\",\n        clientName: \"\",\n        clientPhone: \"\",\n        \n        // 추가 정보\n        specialNote: \"\",\n        coListing: false,\n        propertyDescription: \"\",\n        privateNote: \"\",\n        \n        // 기존 필드\n        bedrooms: 0,\n        bathrooms: 0,\n        featured: false,\n      });\n    }\n  }, [property, form]);\n\n  // dialogContent 정의\n  const dialogContent = (\n    <DialogContent className=\"max-w-3xl max-h-[90vh] overflow-y-auto\">\n      <DialogHeader>\n        <DialogTitle>{property ? \"부동산 수정\" : \"새 부동산 등록\"}</DialogTitle>\n        <DialogDescription>\n          {property ? \"부동산 정보를 수정하세요\" : \"새로운 부동산 매물을 등록하세요\"}\n        </DialogDescription>\n      </DialogHeader>\n\n      <Form {...form}>\n        <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6\">\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n            {/* 기본 정보 */}\n            <div>\n              <FormField\n                control={form.control}\n                name=\"title\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>제목</FormLabel>\n                    <FormControl>\n                      <Input placeholder=\"부동산 제목\" {...field} />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            <div>\n              <FormField\n                control={form.control}\n                name=\"type\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>유형</FormLabel>\n                    <Select\n                      onValueChange={field.onChange}\n                      defaultValue={field.value}\n                    >\n                      <FormControl>\n                        <SelectTrigger>\n                          <SelectValue placeholder=\"부동산 유형 선택\" />\n                        </SelectTrigger>\n                      </FormControl>\n                      <SelectContent>\n                        {propertyTypes.map((type) => (\n                          <SelectItem key={type} value={type}>\n                            {type}\n                          </SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            <div className=\"md:col-span-2\">\n              <FormField\n                control={form.control}\n                name=\"description\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>설명</FormLabel>\n                    <FormControl>\n                      <Textarea\n                        placeholder=\"부동산에 대한 상세 설명\"\n                        rows={4}\n                        {...field}\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            <div>\n              <FormField\n                control={form.control}\n                name=\"price\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>가격</FormLabel>\n                    <FormControl>\n                      <Input placeholder=\"가격 (원)\" {...field} />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            <div>\n              <FormField\n                control={form.control}\n                name=\"size\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>면적 (㎡)</FormLabel>\n                    <FormControl>\n                      <Input placeholder=\"면적 (㎡)\" {...field} />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n\n\n            <div>\n              <FormField\n                control={form.control}\n                name=\"district\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>지역</FormLabel>\n                    <Select\n                      onValueChange={field.onChange}\n                      defaultValue={field.value}\n                    >\n                      <FormControl>\n                        <SelectTrigger>\n                          <SelectValue placeholder=\"지역 선택\" />\n                        </SelectTrigger>\n                      </FormControl>\n                      <SelectContent>\n                        {allLocations.map((location) => (\n                          <SelectItem key={location} value={location}>\n                            {location}\n                          </SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            <div>\n              <FormField\n                control={form.control}\n                name=\"address\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>지번</FormLabel>\n                    <FormControl>\n                      <Input placeholder=\"지번 주소\" {...field} />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            <div>\n              <FormField\n                control={form.control}\n                name=\"buildingName\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>건물명</FormLabel>\n                    <FormControl>\n                      <Input placeholder=\"건물명 (선택사항)\" {...field} />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            <div>\n              <FormField\n                control={form.control}\n                name=\"unitNumber\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>동호수</FormLabel>\n                    <FormControl>\n                      <Input placeholder=\"동호수 (선택사항)\" {...field} />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            <div>\n              <FormField\n                control={form.control}\n                name=\"supplyArea\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>공급면적 (평)</FormLabel>\n                    <FormControl>\n                      <Input placeholder=\"공급면적 (선택사항)\" {...field} />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            <div>\n              <FormField\n                control={form.control}\n                name=\"privateArea\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>전용면적 (평)</FormLabel>\n                    <FormControl>\n                      <Input placeholder=\"전용면적 (선택사항)\" {...field} />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n\n\n            <div>\n              <FormField\n                control={form.control}\n                name=\"dealType\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>거래 종류</FormLabel>\n                    <div className=\"flex flex-wrap gap-2\">\n                      {dealTypes.map((type) => (\n                        <Button\n                          key={type}\n                          type=\"button\"\n                          variant={field.value.includes(type) ? \"default\" : \"outline\"}\n                          onClick={() => {\n                            const newValue = field.value.includes(type)\n                              ? field.value.filter((t) => t !== type)\n                              : [...field.value, type];\n                            field.onChange(newValue.length ? newValue : [\"매매\"]);\n                          }}\n                        >\n                          {type}\n                        </Button>\n                      ))}\n                    </div>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            <div>\n              <FormField\n                control={form.control}\n                name=\"bedrooms\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>침실 수</FormLabel>\n                    <FormControl>\n                      <Input \n                        type=\"number\" \n                        placeholder=\"침실 수\"\n                        {...field}\n                        onChange={(e) => field.onChange(Number(e.target.value))}\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            <div>\n              <FormField\n                control={form.control}\n                name=\"bathrooms\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>욕실 수</FormLabel>\n                    <FormControl>\n                      <Input \n                        type=\"number\" \n                        placeholder=\"욕실 수\"\n                        {...field}\n                        onChange={(e) => field.onChange(Number(e.target.value))}\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            <div>\n              <FormField\n                control={form.control}\n                name=\"featured\"\n                render={({ field }) => (\n                  <FormItem className=\"flex flex-row items-center gap-2 space-y-0\">\n                    <FormControl>\n                      <input\n                        type=\"checkbox\"\n                        className=\"w-4 h-4\"\n                        checked={field.value}\n                        onChange={field.onChange}\n                      />\n                    </FormControl>\n                    <FormLabel className=\"font-normal\">추천 매물로 표시</FormLabel>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n          </div>\n\n          <div className=\"flex justify-end gap-2\">\n            <Button type=\"button\" variant=\"outline\" onClick={onSubmitSuccess}>\n              취소\n            </Button>\n            <Button type=\"submit\" disabled={createPropertyMutation.isPending || updatePropertyMutation.isPending}>\n              {(createPropertyMutation.isPending || updatePropertyMutation.isPending) ? \"처리 중...\" : property ? \"수정\" : \"등록\"}\n            </Button>\n          </div>\n        </form>\n      </Form>\n    </DialogContent>\n  );\n\n  // renderDialog prop을 사용하여 다이얼로그 컨텐츠 렌더링\n  return renderDialog(dialogContent);\n}","path":null,"size_bytes":23253,"size_tokens":null},"client/src/components/ui/dialog.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogClose,\n  DialogTrigger,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}\n","path":null,"size_bytes":3848,"size_tokens":null},"client/src/components/admin/UserPhoneDebug.jsx":{"content":"import { useState, useEffect } from \"react\";\nimport { Button } from \"@/components/ui/button\";\n\nexport default function UserPhoneDebug() {\n  const [userData, setUserData] = useState(null);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState(null);\n\n  const fetchUserData = async () => {\n    try {\n      setIsLoading(true);\n      setError(null);\n      \n      const response = await fetch(\"/api/admin/users\", {\n        credentials: \"include\"\n      });\n      \n      if (!response.ok) {\n        throw new Error(`API 오류: ${response.status}`);\n      }\n      \n      const data = await response.json();\n      console.log('사용자 API 응답 데이터:', data);\n      setUserData(data);\n    } catch (err) {\n      console.error('데이터 로드 오류:', err);\n      setError(err.message);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"p-4 border rounded-lg bg-white\">\n      <h2 className=\"text-lg font-semibold mb-4\">사용자 데이터 디버깅</h2>\n      \n      <Button \n        onClick={fetchUserData}\n        disabled={isLoading}\n        className=\"mb-4\"\n      >\n        {isLoading ? \"로딩 중...\" : \"사용자 데이터 가져오기\"}\n      </Button>\n      \n      {error && (\n        <div className=\"p-3 mb-4 text-sm text-red-800 bg-red-100 rounded-lg\">\n          오류: {error}\n        </div>\n      )}\n      \n      {userData && (\n        <div className=\"mt-4\">\n          <h3 className=\"text-md font-semibold mb-2\">사용자 데이터 ({userData.length}명)</h3>\n          <div className=\"overflow-x-auto\">\n            <table className=\"w-full border-collapse\">\n              <thead>\n                <tr className=\"bg-gray-100\">\n                  <th className=\"p-2 border text-left\">ID</th>\n                  <th className=\"p-2 border text-left\">필드 이름</th>\n                  <th className=\"p-2 border text-left\">값</th>\n                </tr>\n              </thead>\n              <tbody>\n                {userData.map((user, userIndex) => (\n                  Object.entries(user).map(([key, value], i) => (\n                    <tr key={`${userIndex}-${key}`} className={i % 2 === 0 ? 'bg-gray-50' : ''}>\n                      {i === 0 ? (\n                        <td className=\"p-2 border\" rowSpan={Object.keys(user).length}>\n                          {user.id}\n                        </td>\n                      ) : null}\n                      <td className=\"p-2 border font-medium\">{key}</td>\n                      <td className=\"p-2 border\">{value?.toString() || '-'}</td>\n                    </tr>\n                  ))\n                ))}\n              </tbody>\n            </table>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}","path":null,"size_bytes":2739,"size_tokens":null},"client/src/components/ui/progress.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef<\n  React.ElementRef<typeof ProgressPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\n>(({ className, value, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative h-4 w-full overflow-hidden rounded-full bg-secondary\",\n      className\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className=\"h-full w-full flex-1 bg-primary transition-all\"\n      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n    />\n  </ProgressPrimitive.Root>\n))\nProgress.displayName = ProgressPrimitive.Root.displayName\n\nexport { Progress }\n","path":null,"size_bytes":791,"size_tokens":null},"client/src/components/ui/toaster.tsx":{"content":"import { useToast } from \"@/hooks/use-toast\"\nimport {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from \"@/components/ui/toast\"\n\nexport function Toaster() {\n  const { toasts } = useToast()\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        )\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  )\n}\n","path":null,"size_bytes":772,"size_tokens":null},"client/src/components/ui/skeleton.tsx":{"content":"import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-muted\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n","path":null,"size_bytes":261,"size_tokens":null},"tailwind.config.ts":{"content":"import type { Config } from \"tailwindcss\";\n\nexport default {\n  darkMode: [\"class\"],\n  content: [\"./client/index.html\", \"./client/src/**/*.{js,jsx,ts,tsx}\"],\n  theme: {\n    extend: {\n      borderRadius: {\n        lg: \"var(--radius)\",\n        md: \"calc(var(--radius) - 2px)\",\n        sm: \"calc(var(--radius) - 4px)\",\n      },\n      colors: {\n        background: \"hsl(var(--background))\",\n        foreground: \"hsl(var(--foreground))\",\n        card: {\n          DEFAULT: \"hsl(var(--card))\",\n          foreground: \"hsl(var(--card-foreground))\",\n        },\n        popover: {\n          DEFAULT: \"hsl(var(--popover))\",\n          foreground: \"hsl(var(--popover-foreground))\",\n        },\n        primary: {\n          DEFAULT: \"hsl(var(--primary))\",\n          foreground: \"hsl(var(--primary-foreground))\",\n        },\n        secondary: {\n          DEFAULT: \"hsl(var(--secondary))\",\n          foreground: \"hsl(var(--secondary-foreground))\",\n        },\n        muted: {\n          DEFAULT: \"hsl(var(--muted))\",\n          foreground: \"hsl(var(--muted-foreground))\",\n        },\n        accent: {\n          DEFAULT: \"hsl(var(--accent))\",\n          foreground: \"hsl(var(--accent-foreground))\",\n        },\n        destructive: {\n          DEFAULT: \"hsl(var(--destructive))\",\n          foreground: \"hsl(var(--destructive-foreground))\",\n        },\n        border: \"hsl(var(--border))\",\n        input: \"hsl(var(--input))\",\n        ring: \"hsl(var(--ring))\",\n        chart: {\n          \"1\": \"hsl(var(--chart-1))\",\n          \"2\": \"hsl(var(--chart-2))\",\n          \"3\": \"hsl(var(--chart-3))\",\n          \"4\": \"hsl(var(--chart-4))\",\n          \"5\": \"hsl(var(--chart-5))\",\n        },\n        sidebar: {\n          DEFAULT: \"hsl(var(--sidebar-background))\",\n          foreground: \"hsl(var(--sidebar-foreground))\",\n          primary: \"hsl(var(--sidebar-primary))\",\n          \"primary-foreground\": \"hsl(var(--sidebar-primary-foreground))\",\n          accent: \"hsl(var(--sidebar-accent))\",\n          \"accent-foreground\": \"hsl(var(--sidebar-accent-foreground))\",\n          border: \"hsl(var(--sidebar-border))\",\n          ring: \"hsl(var(--sidebar-ring))\",\n        },\n      },\n      keyframes: {\n        \"accordion-down\": {\n          from: {\n            height: \"0\",\n          },\n          to: {\n            height: \"var(--radix-accordion-content-height)\",\n          },\n        },\n        \"accordion-up\": {\n          from: {\n            height: \"var(--radix-accordion-content-height)\",\n          },\n          to: {\n            height: \"0\",\n          },\n        },\n      },\n      animation: {\n        \"accordion-down\": \"accordion-down 0.2s ease-out\",\n        \"accordion-up\": \"accordion-up 0.2s ease-out\",\n      },\n    },\n  },\n  plugins: [require(\"tailwindcss-animate\"), require(\"@tailwindcss/typography\")],\n} satisfies Config;\n","path":null,"size_bytes":2787,"size_tokens":null},"server/mailer.ts":{"content":"import nodemailer from \"nodemailer\";\n\n// 네이버 SMTP 서버를 사용한 메일 전송기 설정\nconst transporter = nodemailer.createTransport({\n  host: \"smtp.naver.com\",\n  port: 465,  // 포트 465로 변경 (SSL/TLS 사용)\n  secure: true, // true는 포트 465를 사용할 때, false는 다른 포트에서 사용\n  auth: {\n    user: process.env.NAVER_EMAIL,\n    pass: process.env.NAVER_APP_PASSWORD // 애플리케이션 비밀번호 사용\n  },\n  debug: true, // 디버깅 모드 활성화\n  logger: true // 로깅 활성화\n});\n\n// 초기화 시 확인\nconsole.log('SMTP 설정 정보:', {\n  host: \"smtp.naver.com\",\n  port: 465,\n  secure: true,\n  auth: {\n    user: process.env.NAVER_EMAIL ? \"설정됨\" : \"미설정\",\n    pass: process.env.NAVER_APP_PASSWORD ? \"설정됨\" : \"미설정\"\n  }\n});\n\n// 이메일 전송 함수\nexport async function sendEmail(\n  to: string, \n  subject: string, \n  htmlContent: string\n): Promise<boolean> {\n  try {\n    console.log(\"이메일 전송 시도...\");\n    \n    if (!process.env.NAVER_EMAIL || !process.env.NAVER_APP_PASSWORD) {\n      console.error(\"네이버 메일 인증 정보가 없습니다.\");\n      return false;\n    }\n    \n    // 수신자 이메일 검증\n    if (!to || to.trim() === '') {\n      console.error(\"수신자 이메일 주소가 비어있습니다.\");\n      return false;\n    }\n    \n    console.log(`발신자: ${process.env.NAVER_EMAIL}`);\n    console.log(`수신자: ${to}`);\n    console.log(`제목: ${subject}`);\n    \n    // 발신자 이메일 주소 설정 (RFC 5322 형식을 준수)\n    const rawEmail = process.env.NAVER_EMAIL || '';\n    // 완전한 이메일 주소 형식 확인 및 보정\n    const naverEmail = rawEmail.includes('@') ? rawEmail : `${rawEmail}@naver.com`;\n    \n    console.log(\"보정된 발신자 이메일:\", naverEmail);\n    \n    // 메일 옵션 설정 (RFC 5322 준수를 위한 형식)\n    const mailOptions = {\n      from: naverEmail, // 단순 이메일 주소만 사용\n      to: to.trim(),\n      subject,\n      html: htmlContent\n    };\n    \n    console.log(\"SMTP 서버로 전송 중...\");\n    const info = await transporter.sendMail(mailOptions);\n    console.log(\"이메일 전송 성공:\", info);\n    return true;\n  } catch (error) {\n    console.error(\"이메일 전송 실패 - 상세 오류:\", error);\n    if (error instanceof Error) {\n      console.error(\"오류 메시지:\", error.message);\n      console.error(\"오류 스택:\", error.stack);\n    }\n    return false;\n  }\n}\n\n// 문의 이메일 템플릿 생성\nexport function createInquiryEmailTemplate(data: {\n  name: string;\n  email: string;\n  phone: string;\n  message: string;\n}): string {\n  return `\n    <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px; border: 1px solid #e1e1e1; border-radius: 5px;\">\n      <h2 style=\"color: #3b82f6; margin-bottom: 20px;\">새로운 문의가 등록되었습니다</h2>\n      \n      <div style=\"margin-bottom: 15px;\">\n        <strong>이름:</strong> ${data.name}\n      </div>\n      \n      <div style=\"margin-bottom: 15px;\">\n        <strong>이메일:</strong> ${data.email}\n      </div>\n      \n      <div style=\"margin-bottom: 15px;\">\n        <strong>전화번호:</strong> ${data.phone}\n      </div>\n      \n      <div style=\"margin-bottom: 15px;\">\n        <strong>문의내용:</strong>\n        <p style=\"background-color: #f9f9f9; padding: 10px; border-radius: 4px;\">${data.message.replace(/\\n/g, '<br>')}</p>\n      </div>\n      \n      <div style=\"font-size: 12px; color: #666; margin-top: 30px; padding-top: 10px; border-top: 1px solid #e1e1e1;\">\n        <p>이 이메일은 이가이버부동산 웹사이트의 문의 폼에서 자동으로 전송되었습니다.</p>\n      </div>\n    </div>\n  `;\n}","path":null,"size_bytes":3754,"size_tokens":null},"client/src/components/ui/alert-dialog.tsx":{"content":"import * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}","path":null,"size_bytes":4418,"size_tokens":null},"client/src/hooks/use-auth.tsx":{"content":"import { createContext, ReactNode, useContext } from \"react\";\nimport {\n  useQuery,\n  useMutation,\n  UseMutationResult,\n  useQueryClient,\n} from \"@tanstack/react-query\";\nimport { User, insertUserSchema } from \"@shared/schema\";\nimport { getQueryFn, apiRequest } from \"../lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { z } from \"zod\";\n\n// 로그인 데이터 타입\ntype LoginData = {\n  username: string;\n  password: string;\n};\n\n// 회원가입 데이터 스키마 (비밀번호 확인, 이메일, 전화번호 추가)\nexport const registerSchema = insertUserSchema.extend({\n  email: z.string().email(\"유효한 이메일 주소를 입력해주세요\").optional(),\n  phone: z.string().optional(),\n  confirmPassword: z.string(),\n}).refine((data) => data.password === data.confirmPassword, {\n  message: \"비밀번호가 일치하지 않습니다\",\n  path: [\"confirmPassword\"],\n});\n\n// 회원가입 데이터 타입\nexport type RegisterData = z.infer<typeof registerSchema>;\n\n// 인증 컨텍스트 타입\ntype AuthContextType = {\n  user: User | null;\n  isLoading: boolean;\n  error: Error | null;\n  loginMutation: UseMutationResult<User, Error, LoginData>;\n  registerMutation: UseMutationResult<User, Error, RegisterData>;\n  logoutMutation: UseMutationResult<void, Error, void>;\n};\n\n// 인증 컨텍스트 생성\nexport const AuthContext = createContext<AuthContextType | null>(null);\n\n// 인증 공급자 컴포넌트\nexport function AuthProvider({ children }: { children: ReactNode }) {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  // 현재 로그인한 사용자 정보 조회\n  const {\n    data: user,\n    error,\n    isLoading,\n  } = useQuery<User | null, Error>({\n    queryKey: [\"/api/user\"],\n    queryFn: getQueryFn({ on401: \"returnNull\" }),\n  });\n\n  // 로그인 뮤테이션\n  const loginMutation = useMutation({\n    mutationFn: async (credentials: LoginData) => {\n      const res = await apiRequest(\"POST\", \"/api/login\", credentials);\n      if (!res.ok) {\n        const errorData = await res.json();\n        throw new Error(errorData.message || \"로그인에 실패했습니다\");\n      }\n      return await res.json();\n    },\n    onSuccess: (user: User) => {\n      queryClient.setQueryData([\"/api/user\"], user);\n      toast({\n        title: \"로그인 성공\",\n        description: `${user.username}님 환영합니다.`,\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"로그인 실패\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // 회원가입 뮤테이션\n  const registerMutation = useMutation({\n    mutationFn: async (data: RegisterData) => {\n      // 비밀번호 확인 필드 제외\n      const { confirmPassword, ...registerData } = data;\n      \n      const res = await apiRequest(\"POST\", \"/api/register\", registerData);\n      if (!res.ok) {\n        const errorData = await res.json();\n        throw new Error(errorData.message || \"회원가입에 실패했습니다\");\n      }\n      return await res.json();\n    },\n    onSuccess: (user: User) => {\n      queryClient.setQueryData([\"/api/user\"], user);\n      toast({\n        title: \"회원가입 성공\",\n        description: \"회원가입이 완료되었습니다.\",\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"회원가입 실패\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // 로그아웃 뮤테이션\n  const logoutMutation = useMutation({\n    mutationFn: async () => {\n      const res = await apiRequest(\"POST\", \"/api/logout\");\n      if (!res.ok) {\n        const errorData = await res.json();\n        throw new Error(errorData.message || \"로그아웃에 실패했습니다\");\n      }\n    },\n    onSuccess: () => {\n      queryClient.setQueryData([\"/api/user\"], null);\n      toast({\n        title: \"로그아웃\",\n        description: \"로그아웃 되었습니다.\",\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"로그아웃 실패\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  return (\n    <AuthContext.Provider\n      value={{\n        user: user || null,\n        isLoading,\n        error,\n        loginMutation,\n        registerMutation,\n        logoutMutation,\n      }}\n    >\n      {children}\n    </AuthContext.Provider>\n  );\n}\n\n// 인증 훅\nexport function useAuth() {\n  const context = useContext(AuthContext);\n  if (!context) {\n    throw new Error(\"useAuth는 AuthProvider 내에서 사용해야 합니다\");\n  }\n  return context;\n}","path":null,"size_bytes":4620,"size_tokens":null},"client/src/components/admin/InlinePropertyForm.tsx":{"content":"import React, { useEffect, useState } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { z } from \"zod\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport {\n  Form,\n  FormControl,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from \"@/components/ui/form\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Property, insertPropertySchema } from \"@shared/schema\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { X } from \"lucide-react\";\n\n// 부동산 유형 목록\nconst propertyTypes = [\"토지\", \"주택\", \"아파트연립다세대\", \"원투룸\", \"상가공장창고펜션\"];\n\n// 읍면 리스트\nconst districts = [\n  \"강화읍\",\n  \"교동면\",\n  \"길상면\",\n  \"내가면\",\n  \"삼산면\",\n  \"서도면\",\n  \"선원면\",\n  \"송해면\",\n  \"양도면\",\n  \"양사면\",\n  \"하점면\",\n  \"화도면\",\n];\n\n// 거래 종류\nconst dealTypes = [\"매매\", \"전세\", \"월세\", \"완료\", \"보류중\"];\n\n// 세부 지역 정보\nconst detailedDistricts: { [key: string]: string[] } = {\n  강화읍: [\n    \"강화읍 갑곳리\",\n    \"강화읍 관청리\",\n    \"강화읍 국화리\",\n    \"강화읍 남산리\",\n    \"강화읍 대산리\",\n    \"강화읍 옥림리\",\n    \"강화읍 용정리\",\n    \"강화읍 월곶리\",\n  ],\n  교동면: [\n    \"교동면 고구리\",\n    \"교동면 대룡리\",\n    \"교동면 무학리\",\n    \"교동면 봉소리\",\n    \"교동면 삼선리\",\n    \"교동면 상용리\",\n    \"교동면 서한리\",\n    \"교동면 소룡리\",\n    \"교동면 읍내리\",\n    \"교동면 정운리\",\n    \"교동면 지석리\",\n    \"교동면 화개리\",\n  ],\n  길상면: [\n    \"길상면 길직리\",\n    \"길상면 동검리\",\n    \"길상면 마리\",\n    \"길상면 망월리\",\n    \"길상면 온수리\",\n    \"길상면 선두리\",\n    \"길상면 초지리\",\n  ],\n  내가면: [\n    \"내가면 고천리\",\n    \"내가면 오상리\",\n    \"내가면 외포리\",\n    \"내가면 지석리\",\n  ],\n  삼산면: [\n    \"삼산면 매음리\",\n    \"삼산면 석모리\",\n    \"삼산면 서검리\",\n    \"삼산면 석모리\",\n    \"삼산면 하리\",\n  ],\n  서도면: [\n    \"서도면 말도리\",\n    \"서도면 볼음도리\",\n    \"서도면 아차도리\",\n    \"서도면 주문도리\",\n  ],\n  선원면: [\n    \"선원면 금월리\",\n    \"선원면 연리\",\n    \"선원면 창리\",\n  ],\n  송해면: [\n    \"송해면 당산리\",\n    \"송해면 양오리\",\n    \"송해면 하도리\",\n    \"송해면 장정리\",\n    \"송해면 신당리\",\n    \"송해면 천산리\",\n    \"송해면 숭뢰리\",\n  ],\n  양도면: [\n    \"양도면 감정리\",\n    \"양도면 건평리\",\n    \"양도면 도장리\",\n    \"양도면 삼흥리\",\n    \"양도면 인산리\",\n    \"양도면 조산리\",\n    \"양도면 인일리\",\n    \"양도면 하일리\",\n  ],\n  양사면: [\n    \"양사면 교산리\",\n    \"양사면 덕하리\",\n    \"양사면 덕하리\",\n    \"양사면 북성리\",\n    \"양사면 상도리\",\n    \"양사면 송학리\",\n    \"양사면 신당리\",\n    \"양사면 인화리\",\n    \"양사면 철산리\",\n  ],\n  하점면: [\n    \"하점면 신봉리\",\n    \"하점면 신삼리\",\n    \"하점면 이강리\",\n    \"하점면 장정리\",\n    \"하점면 창후리\",\n  ],\n  화도면: [\n    \"화도면 내리\",\n    \"화도면 문산리\",\n    \"화도면 사기리\",\n    \"화도면 상방리\",\n    \"화도면 장화리\",\n    \"화도면 흥왕리\",\n  ],\n};\n\n// 속성 입력 값 스키마 - 모든 필수 필드를 선택적으로 만들고 문자열/숫자 유니온 타입 허용\nconst propertyFormSchema = z.object({\n  // 필수 필드들을 선택적으로 변경\n  title: z.string().min(1, \"제목을 입력해주세요\"),\n  description: z.string().min(1, \"설명을 입력해주세요\"),\n  type: z.string().min(1, \"부동산 유형을 선택해주세요\"),\n  price: z.union([z.string(), z.number()]).transform(val => val === \"\" ? \"0\" : String(val)),\n  address: z.string().min(1, \"주소를 입력해주세요\"),\n  district: z.string().min(1, \"지역을 선택해주세요\"),\n  size: z.union([z.string(), z.number()]).transform(val => val === \"\" ? \"0\" : String(val)),\n  agentId: z.number().default(1),\n  \n  // 선택적 필드들\n  bedrooms: z.number().default(0),\n  bathrooms: z.number().default(0),\n  featured: z.boolean().default(false),\n  dealType: z.array(z.string()).default([\"매매\"]),\n  imageUrl: z.string().optional(),\n  imageUrls: z.array(z.string()).optional(),\n  featuredImageIndex: z.number().optional(),\n  \n  // 위치 정보\n  buildingName: z.string().optional(),\n  unitNumber: z.string().optional(),\n  \n  // 면적 정보\n  supplyArea: z.union([z.string(), z.number(), z.null()]).optional(),\n  privateArea: z.union([z.string(), z.number(), z.null()]).optional(),\n  areaSize: z.string().optional(),\n  \n  // 건물 정보\n  floor: z.union([z.string(), z.number(), z.null()]).optional(),\n  totalFloors: z.union([z.string(), z.number(), z.null()]).optional(),\n  direction: z.string().optional(),\n  elevator: z.boolean().optional(),\n  parking: z.string().optional(),\n  heatingSystem: z.string().optional(),\n  approvalDate: z.string().optional(),\n  \n  // 토지 정보\n  landType: z.string().optional(),\n  zoneType: z.string().optional(),\n  \n  // 금액 정보\n  deposit: z.union([z.string(), z.number(), z.null()]).optional(),\n  monthlyRent: z.union([z.string(), z.number(), z.null()]).optional(),\n  maintenanceFee: z.union([z.string(), z.number(), z.null()]).optional(),\n  \n  // 연락처 정보\n  ownerName: z.string().optional(),\n  ownerPhone: z.string().optional(),\n  tenantName: z.string().optional(),\n  tenantPhone: z.string().optional(),\n  clientName: z.string().optional(),\n  clientPhone: z.string().optional(),\n  \n  // 추가 정보\n  specialNote: z.string().optional(),\n  coListing: z.boolean().optional(),\n  propertyDescription: z.string().optional(),\n  privateNote: z.string().optional(),\n});\n\ntype PropertyFormValues = z.infer<typeof propertyFormSchema>;\n\ninterface InlinePropertyFormProps {\n  onClose: () => void;\n  property?: Property | null;\n}\n\nexport function InlinePropertyForm({ onClose, property }: InlinePropertyFormProps) {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [selectedMainDistrict, setSelectedMainDistrict] = useState<string>(districts[0]);\n  const [detailedDistrictOptions, setDetailedDistrictOptions] = useState<string[]>(\n    detailedDistricts[districts[0]]\n  );\n\n  const defaultFormValues: PropertyFormValues = {\n    title: \"\",\n    description: \"\",\n    type: \"토지\",\n    price: \"0\",\n    district: \"강화읍 갑곳리\",\n    address: \"\",\n    size: \"0\",\n    agentId: 1,\n    bedrooms: 0,\n    bathrooms: 0,\n    featured: false,\n    dealType: [\"매매\"],\n    imageUrl: \"\",\n    imageUrls: [],\n    \n    // 추가 필드들\n    buildingName: \"\",\n    unitNumber: \"\",\n    supplyArea: \"\",\n    privateArea: \"\",\n    areaSize: \"\",\n    floor: \"\",\n    totalFloors: \"\",\n    direction: \"\",\n    elevator: false,\n    parking: \"\",\n    heatingSystem: \"\",\n    approvalDate: \"\",\n    landType: \"\",\n    zoneType: \"\",\n    deposit: \"\",\n    monthlyRent: \"\",\n    maintenanceFee: \"\",\n    ownerName: \"\",\n    ownerPhone: \"\",\n    tenantName: \"\",\n    tenantPhone: \"\",\n    clientName: \"\",\n    clientPhone: \"\",\n    specialNote: \"\",\n    coListing: false,\n    propertyDescription: \"\",\n    privateNote: \"\",\n  };\n\n  // 부동산 등록/수정 폼\n  const form = useForm<PropertyFormValues>({\n    resolver: zodResolver(propertyFormSchema),\n    defaultValues: defaultFormValues,\n  });\n\n  // 선택된 읍면에 따라 세부 지역 옵션 업데이트\n  useEffect(() => {\n    if (selectedMainDistrict && detailedDistricts[selectedMainDistrict]) {\n      setDetailedDistrictOptions(detailedDistricts[selectedMainDistrict]);\n      \n      // 첫 번째 세부 지역을 기본값으로 설정\n      if (detailedDistricts[selectedMainDistrict].length > 0) {\n        form.setValue(\"district\", detailedDistricts[selectedMainDistrict][0]);\n      }\n    }\n  }, [selectedMainDistrict, form]);\n\n  // 속성이 변경될 때 폼 업데이트\n  useEffect(() => {\n    if (property) {\n      // 현재 읍면 찾기\n      const mainDistrict = districts.find(d => \n        property.district.startsWith(d)\n      ) || districts[0];\n      \n      setSelectedMainDistrict(mainDistrict);\n      \n      // 폼 초기화\n      const formValues: Partial<PropertyFormValues> = {\n        title: property.title || \"\",\n        description: property.description || \"\",\n        type: property.type || \"토지\",\n        price: property.price ? property.price.toString() : \"\",\n        address: property.address || \"\",\n        district: property.district || \"강화읍 갑곳리\",\n        size: property.size ? property.size.toString() : \"\",\n        bedrooms: property.bedrooms || 0,\n        bathrooms: property.bathrooms || 0,\n        agentId: property.agentId || 1,\n        featured: !!property.featured,\n        buildingName: property.buildingName || \"\",\n        unitNumber: property.unitNumber || \"\",\n        supplyArea: property.supplyArea ? property.supplyArea.toString() : \"\",\n        privateArea: property.privateArea ? property.privateArea.toString() : \"\",\n        areaSize: property.areaSize || \"\",\n        floor: property.floor ? property.floor.toString() : \"\",\n        totalFloors: property.totalFloors ? property.totalFloors.toString() : \"\",\n        direction: property.direction || \"\",\n        elevator: !!property.elevator,\n        parking: property.parking || \"\",\n        heatingSystem: property.heatingSystem || \"\",\n        approvalDate: property.approvalDate || \"\",\n        dealType: Array.isArray(property.dealType) && property.dealType.length > 0 \n          ? property.dealType \n          : [\"매매\"],\n        deposit: property.deposit ? property.deposit.toString() : \"\",\n        monthlyRent: property.monthlyRent ? property.monthlyRent.toString() : \"\",\n        maintenanceFee: property.maintenanceFee ? property.maintenanceFee.toString() : \"\",\n        ownerName: property.ownerName || \"\",\n        ownerPhone: property.ownerPhone || \"\",\n        tenantName: property.tenantName || \"\",\n        tenantPhone: property.tenantPhone || \"\",\n        clientName: property.clientName || \"\",\n        clientPhone: property.clientPhone || \"\",\n        specialNote: property.specialNote || \"\",\n        coListing: !!property.coListing,\n        propertyDescription: property.propertyDescription || \"\",\n        privateNote: property.privateNote || \"\",\n      };\n      \n      form.reset(formValues);\n    } else {\n      form.reset(defaultFormValues);\n    }\n  }, [property, form]);\n\n  // 부동산 생성 뮤테이션\n  const createPropertyMutation = useMutation({\n    mutationFn: async (data: PropertyFormValues) => {\n      console.log('부동산 등록 요청 데이터:', data);\n      const res = await apiRequest(\"POST\", \"/api/properties\", data);\n      return await res.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/properties\"] });\n      toast({\n        title: \"부동산 등록 성공\",\n        description: \"새로운 부동산이 등록되었습니다.\",\n      });\n      onClose();\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"부동산 등록 실패\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // 부동산 수정 뮤테이션\n  const updatePropertyMutation = useMutation({\n    mutationFn: async ({ id, data }: { id: number; data: PropertyFormValues }) => {\n      console.log('부동산 수정 요청 데이터:', data);\n      const res = await apiRequest(\"PATCH\", `/api/properties/${id}`, data);\n      return await res.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/properties\"] });\n      toast({\n        title: \"부동산 수정 성공\",\n        description: \"부동산 정보가 수정되었습니다.\",\n      });\n      onClose();\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"부동산 수정 실패\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // 폼 제출 핸들러\n  const onSubmit = (data: PropertyFormValues) => {\n    // 숫자 필드 안전 처리 - 빈 문자열을 null로 변환하고 숫자는 문자열로 변환\n    const processedData = {\n      ...data,\n      // 필수 숫자 필드들은 문자열로 변환 (빈 문자열인 경우 \"0\"으로 설정)\n      price: data.price || \"0\",\n      size: data.size || \"0\",\n      \n      // 선택적 숫자 필드들은 빈 문자열인 경우 null로 처리\n      floor: data.floor === \"\" || data.floor === undefined ? null : String(data.floor),\n      totalFloors: data.totalFloors === \"\" || data.totalFloors === undefined ? null : String(data.totalFloors),\n      supplyArea: data.supplyArea === \"\" || data.supplyArea === undefined ? null : String(data.supplyArea),\n      privateArea: data.privateArea === \"\" || data.privateArea === undefined ? null : String(data.privateArea),\n      deposit: data.deposit === \"\" || data.deposit === undefined ? null : String(data.deposit),\n      monthlyRent: data.monthlyRent === \"\" || data.monthlyRent === undefined ? null : String(data.monthlyRent),\n      maintenanceFee: data.maintenanceFee === \"\" || data.maintenanceFee === undefined ? null : String(data.maintenanceFee),\n      \n      // 이미지 URL 처리\n      imageUrl: data.imageUrl || \"/attached_assets/Asset 3.png\", // 기본 이미지\n      imageUrls: data.imageUrls || [],\n      \n      // 기본값 설정\n      bedrooms: data.bedrooms || 0,\n      bathrooms: data.bathrooms || 0,\n      agentId: data.agentId || 1,\n      featured: data.featured || false,\n      dealType: data.dealType && data.dealType.length > 0 ? data.dealType : [\"매매\"],\n      elevator: data.elevator || false,\n      coListing: data.coListing || false,\n    };\n    \n    if (property) {\n      updatePropertyMutation.mutate({ id: property.id, data: processedData });\n    } else {\n      createPropertyMutation.mutate(processedData);\n    }\n  };\n\n  return (\n    <Card className=\"mt-6\">\n      <CardHeader className=\"flex flex-row items-center justify-between pb-2\">\n        <CardTitle>{property ? \"부동산 수정\" : \"새 부동산 등록\"}</CardTitle>\n        <Button \n          variant=\"ghost\" \n          size=\"icon\" \n          onClick={onClose} \n          className=\"rounded-full h-8 w-8 p-0\"\n        >\n          <X className=\"h-4 w-4\" />\n        </Button>\n      </CardHeader>\n      <CardContent>\n        <Form {...form}>\n          <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-6\">\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              {/* 기본 정보 */}\n              <FormField\n                control={form.control}\n                name=\"title\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>제목</FormLabel>\n                    <FormControl>\n                      <Input placeholder=\"부동산 제목\" {...field} />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"type\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>유형</FormLabel>\n                    <Select\n                      onValueChange={field.onChange}\n                      defaultValue={field.value}\n                      value={field.value}\n                    >\n                      <FormControl>\n                        <SelectTrigger>\n                          <SelectValue placeholder=\"부동산 유형 선택\" />\n                        </SelectTrigger>\n                      </FormControl>\n                      <SelectContent>\n                        {propertyTypes.map((type) => (\n                          <SelectItem key={type} value={type}>\n                            {type}\n                          </SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <div className=\"md:col-span-2\">\n                <FormField\n                  control={form.control}\n                  name=\"description\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>설명</FormLabel>\n                      <FormControl>\n                        <Textarea\n                          placeholder=\"부동산에 대한 간략한 설명\"\n                          rows={3}\n                          {...field}\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n              </div>\n\n              <FormField\n                control={form.control}\n                name=\"price\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>가격</FormLabel>\n                    <FormControl>\n                      <Input placeholder=\"가격 (원)\" {...field} />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"size\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>면적 (㎡)</FormLabel>\n                    <FormControl>\n                      <Input placeholder=\"면적 (㎡)\" {...field} />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              {/* 읍면동 선택 */}\n              <div>\n                <FormLabel>읍면</FormLabel>\n                <Select\n                  value={selectedMainDistrict}\n                  onValueChange={(value) => setSelectedMainDistrict(value)}\n                >\n                  <SelectTrigger>\n                    <SelectValue placeholder=\"지역 선택\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    {districts.map((district) => (\n                      <SelectItem key={district} value={district}>\n                        {district}\n                      </SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n              </div>\n\n              <FormField\n                control={form.control}\n                name=\"district\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>읍면동</FormLabel>\n                    <Select\n                      onValueChange={field.onChange}\n                      value={field.value}\n                    >\n                      <FormControl>\n                        <SelectTrigger>\n                          <SelectValue placeholder=\"상세 지역 선택\" />\n                        </SelectTrigger>\n                      </FormControl>\n                      <SelectContent>\n                        {detailedDistrictOptions.map((district) => (\n                          <SelectItem key={district} value={district}>\n                            {district}\n                          </SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"address\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>지번</FormLabel>\n                    <FormControl>\n                      <Input placeholder=\"지번 주소\" {...field} />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"floor\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>층수</FormLabel>\n                    <FormControl>\n                      <Input \n                        placeholder=\"층수\" \n                        value={field.value || \"\"}\n                        onChange={(e) => field.onChange(e.target.value)}\n                        onBlur={field.onBlur}\n                        name={field.name}\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"totalFloors\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>총층</FormLabel>\n                    <FormControl>\n                      <Input \n                        placeholder=\"총층\" \n                        value={field.value || \"\"}\n                        onChange={(e) => field.onChange(e.target.value)}\n                        onBlur={field.onBlur}\n                        name={field.name}\n                      />\n                    </FormControl>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"dealType\"\n                render={({ field }) => (\n                  <FormItem>\n                    <FormLabel>거래 종류</FormLabel>\n                    <div className=\"flex flex-wrap gap-2\">\n                      {dealTypes.map((type) => (\n                        <Button\n                          key={type}\n                          type=\"button\"\n                          variant={\n                            field.value && field.value.includes(type)\n                              ? \"default\"\n                              : \"outline\"\n                          }\n                          onClick={() => {\n                            const currentValue = field.value || [];\n                            const newValue = currentValue.includes(type)\n                              ? currentValue.filter((t) => t !== type)\n                              : [...currentValue, type];\n                            field.onChange(newValue.length ? newValue : [\"매매\"]);\n                          }}\n                        >\n                          {type}\n                        </Button>\n                      ))}\n                    </div>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n\n              <FormField\n                control={form.control}\n                name=\"featured\"\n                render={({ field }) => (\n                  <FormItem className=\"flex flex-row items-start space-x-3 space-y-0 py-4\">\n                    <FormControl>\n                      <Checkbox\n                        checked={field.value}\n                        onCheckedChange={field.onChange}\n                      />\n                    </FormControl>\n                    <div className=\"space-y-1 leading-none\">\n                      <FormLabel>추천 매물로 표시</FormLabel>\n                    </div>\n                    <FormMessage />\n                  </FormItem>\n                )}\n              />\n            </div>\n\n            <div className=\"flex justify-end gap-2\">\n              <Button type=\"button\" variant=\"outline\" onClick={onClose}>\n                취소\n              </Button>\n              <Button type=\"submit\" disabled={createPropertyMutation.isPending || updatePropertyMutation.isPending}>\n                {(createPropertyMutation.isPending || updatePropertyMutation.isPending) ? \"처리 중...\" : property ? \"수정\" : \"등록\"}\n              </Button>\n            </div>\n          </form>\n        </Form>\n      </CardContent>\n    </Card>\n  );\n}","path":null,"size_bytes":24463,"size_tokens":null},"client/src/pages/BasicAdminPage.jsx":{"content":"import React from \"react\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { Button } from \"@/components/ui/button\";\nimport { Loader2, Home, Plus, Trash2 } from \"lucide-react\";\n\n// 순수 함수형 컴포넌트, 최소한의 로직만 사용\nexport default function BasicAdminPage() {\n  const { user } = useAuth();\n  const [properties, setProperties] = React.useState([]);\n  const [news, setNews] = React.useState([]);\n  const [users, setUsers] = React.useState([]);\n  const [isLoading, setIsLoading] = React.useState(true);\n  const [activeTab, setActiveTab] = React.useState(\"properties\");\n\n  // 1회만 데이터 로드\n  React.useEffect(() => {\n    const loadAllData = async () => {\n      try {\n        setIsLoading(true);\n        \n        // 모든 데이터를 로드\n        const propertiesRes = await fetch(\"/api/properties\");\n        const newsRes = await fetch(\"/api/news\");\n        const usersRes = await fetch(\"/api/admin/users\");\n        \n        if (propertiesRes.ok) {\n          const data = await propertiesRes.json();\n          setProperties(data);\n        }\n        \n        if (newsRes.ok) {\n          const data = await newsRes.json();\n          setNews(data);\n        }\n        \n        if (usersRes.ok) {\n          const data = await usersRes.json();\n          setUsers(data);\n        }\n      } catch (error) {\n        console.error(\"데이터 로딩 오류:\", error);\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    \n    loadAllData();\n  }, []);\n  \n  // 삭제 함수 - 확인 다이얼로그 없이 바로 삭제\n  const handleDelete = async (id, type) => {\n    try {\n      let endpoint = \"\";\n      let stateUpdater = null;\n      \n      if (type === \"property\") {\n        endpoint = `/api/properties/${id}`;\n        stateUpdater = setProperties;\n      } else if (type === \"news\") {\n        endpoint = `/api/news/${id}`;\n        stateUpdater = setNews;\n      } else if (type === \"user\") {\n        endpoint = `/api/admin/users/${id}`;\n        stateUpdater = setUsers;\n      }\n      \n      const response = await fetch(endpoint, {\n        method: \"DELETE\"\n      });\n      \n      if (response.ok) {\n        // 클라이언트 측 상태만 업데이트하고 서버에 추가 요청 안함\n        stateUpdater(prevItems => prevItems.filter(item => item.id !== id));\n        alert(`${type} 삭제 성공`);\n      } else {\n        alert(`${type} 삭제 실패: ${response.statusText}`);\n      }\n    } catch (error) {\n      console.error(\"삭제 오류:\", error);\n      alert(`삭제 중 오류가 발생했습니다: ${error.message}`);\n    }\n  };\n  \n  // 로딩 중 표시\n  if (isLoading) {\n    return (\n      <div className=\"container mx-auto p-6 text-center\">\n        <h1 className=\"text-2xl font-bold mb-6\">관리자 페이지</h1>\n        <div className=\"flex justify-center\">\n          <Loader2 className=\"animate-spin h-8 w-8 text-primary\" />\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"container mx-auto p-6\">\n      <div className=\"flex justify-between items-center mb-8\">\n        <h1 className=\"text-3xl font-bold\">관리자 페이지 (기본 버전)</h1>\n        <div className=\"text-sm\">\n          <span className=\"font-bold\">{user?.username}</span>\n          {user?.role && <span className=\"ml-1 text-gray-500\">({user.role})</span>}\n        </div>\n      </div>\n      \n      <div className=\"bg-white shadow-sm rounded-lg p-6 mb-8\">\n        <div className=\"mb-4\">\n          <p className=\"text-gray-500 mb-4\">\n            이 페이지는 기본 기능만 제공합니다. 모든 API 요청은 한 번만 수행되며, \n            최소한의 React 기능만 사용합니다.\n          </p>\n          <div className=\"flex space-x-4\">\n            <Button\n              variant={activeTab === \"properties\" ? \"default\" : \"outline\"}\n              onClick={() => setActiveTab(\"properties\")}\n            >\n              부동산 ({properties.length})\n            </Button>\n            <Button\n              variant={activeTab === \"news\" ? \"default\" : \"outline\"}\n              onClick={() => setActiveTab(\"news\")}\n            >\n              뉴스 ({news.length})\n            </Button>\n            <Button\n              variant={activeTab === \"users\" ? \"default\" : \"outline\"}\n              onClick={() => setActiveTab(\"users\")}\n              disabled={user?.role !== \"admin\"}\n            >\n              사용자 ({users.length})\n            </Button>\n          </div>\n        </div>\n        \n        {activeTab === \"properties\" && (\n          <div>\n            <h2 className=\"text-xl font-bold mb-4\">부동산 목록</h2>\n            <div className=\"overflow-x-auto\">\n              <table className=\"min-w-full bg-white border border-gray-200\">\n                <thead className=\"bg-gray-50\">\n                  <tr>\n                    <th className=\"py-2 px-4 border-b text-left\">ID</th>\n                    <th className=\"py-2 px-4 border-b text-left\">제목</th>\n                    <th className=\"py-2 px-4 border-b text-left\">유형</th>\n                    <th className=\"py-2 px-4 border-b text-left\">지역</th>\n                    <th className=\"py-2 px-4 border-b text-left\">가격</th>\n                    <th className=\"py-2 px-4 border-b text-right\">관리</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {properties.length === 0 ? (\n                    <tr>\n                      <td colSpan=\"6\" className=\"py-4 text-center text-gray-500\">등록된 부동산이 없습니다</td>\n                    </tr>\n                  ) : (\n                    properties.map(property => (\n                      <tr key={property.id} className=\"border-b hover:bg-gray-50\">\n                        <td className=\"py-2 px-4\">{property.id}</td>\n                        <td className=\"py-2 px-4 max-w-[200px] truncate\">{property.title}</td>\n                        <td className=\"py-2 px-4\">{property.type}</td>\n                        <td className=\"py-2 px-4\">{property.district}</td>\n                        <td className=\"py-2 px-4\">{Number(property.price).toLocaleString()}원</td>\n                        <td className=\"py-2 px-4 text-right\">\n                          <Button \n                            variant=\"destructive\" \n                            size=\"sm\"\n                            onClick={() => handleDelete(property.id, \"property\")}\n                          >\n                            <Trash2 className=\"h-4 w-4\" />\n                          </Button>\n                        </td>\n                      </tr>\n                    ))\n                  )}\n                </tbody>\n              </table>\n            </div>\n          </div>\n        )}\n        \n        {activeTab === \"news\" && (\n          <div>\n            <h2 className=\"text-xl font-bold mb-4\">뉴스 목록</h2>\n            <div className=\"overflow-x-auto\">\n              <table className=\"min-w-full bg-white border border-gray-200\">\n                <thead className=\"bg-gray-50\">\n                  <tr>\n                    <th className=\"py-2 px-4 border-b text-left\">ID</th>\n                    <th className=\"py-2 px-4 border-b text-left\">제목</th>\n                    <th className=\"py-2 px-4 border-b text-left\">출처</th>\n                    <th className=\"py-2 px-4 border-b text-left\">날짜</th>\n                    <th className=\"py-2 px-4 border-b text-right\">관리</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {news.length === 0 ? (\n                    <tr>\n                      <td colSpan=\"5\" className=\"py-4 text-center text-gray-500\">등록된 뉴스가 없습니다</td>\n                    </tr>\n                  ) : (\n                    news.map(item => (\n                      <tr key={item.id} className=\"border-b hover:bg-gray-50\">\n                        <td className=\"py-2 px-4\">{item.id}</td>\n                        <td className=\"py-2 px-4 max-w-[300px] truncate\">{item.title}</td>\n                        <td className=\"py-2 px-4\">{item.source || \"네이버 뉴스\"}</td>\n                        <td className=\"py-2 px-4\">\n                          {item.createdAt ? new Date(item.createdAt).toLocaleDateString() : '-'}\n                        </td>\n                        <td className=\"py-2 px-4 text-right\">\n                          <Button \n                            variant=\"destructive\" \n                            size=\"sm\"\n                            onClick={() => handleDelete(item.id, \"news\")}\n                          >\n                            <Trash2 className=\"h-4 w-4\" />\n                          </Button>\n                        </td>\n                      </tr>\n                    ))\n                  )}\n                </tbody>\n              </table>\n            </div>\n          </div>\n        )}\n        \n        {activeTab === \"users\" && (\n          <div>\n            <h2 className=\"text-xl font-bold mb-4\">사용자 목록</h2>\n            <div className=\"overflow-x-auto\">\n              <table className=\"min-w-full bg-white border border-gray-200\">\n                <thead className=\"bg-gray-50\">\n                  <tr>\n                    <th className=\"py-2 px-4 border-b text-left\">ID</th>\n                    <th className=\"py-2 px-4 border-b text-left\">사용자명</th>\n                    <th className=\"py-2 px-4 border-b text-left\">이메일</th>\n                    <th className=\"py-2 px-4 border-b text-left\">권한</th>\n                    <th className=\"py-2 px-4 border-b text-right\">관리</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {users.length === 0 ? (\n                    <tr>\n                      <td colSpan=\"5\" className=\"py-4 text-center text-gray-500\">등록된 사용자가 없습니다</td>\n                    </tr>\n                  ) : (\n                    users.map(user => (\n                      <tr key={user.id} className=\"border-b hover:bg-gray-50\">\n                        <td className=\"py-2 px-4\">{user.id}</td>\n                        <td className=\"py-2 px-4\">{user.username}</td>\n                        <td className=\"py-2 px-4\">{user.email}</td>\n                        <td className=\"py-2 px-4\">{user.role}</td>\n                        <td className=\"py-2 px-4 text-right\">\n                          <Button \n                            variant=\"destructive\" \n                            size=\"sm\"\n                            disabled={user.role === \"admin\"}\n                            onClick={() => user.role !== \"admin\" && handleDelete(user.id, \"user\")}\n                          >\n                            {user.role === \"admin\" ? \"보호됨\" : <Trash2 className=\"h-4 w-4\" />}\n                          </Button>\n                        </td>\n                      </tr>\n                    ))\n                  )}\n                </tbody>\n              </table>\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}","path":null,"size_bytes":10989,"size_tokens":null},"client/src/components/auth/ProtectedRoute.tsx":{"content":"import { useAuth } from \"@/hooks/use-auth\";\nimport { Loader2 } from \"lucide-react\";\nimport { Redirect, Route } from \"wouter\";\nimport { useEffect, useState } from \"react\";\n\ninterface ProtectedRouteProps {\n  path: string;\n  component: React.ComponentType;\n  admin?: boolean;\n}\n\nexport function ProtectedRoute({ \n  path, \n  component: Component, \n  admin = false \n}: ProtectedRouteProps) {\n  const { user, isLoading } = useAuth();\n  const [shouldRedirect, setShouldRedirect] = useState<string | null>(null);\n  \n  // 사용자 인증 상태에 따라 리다이렉션 경로 결정\n  useEffect(() => {\n    if (!isLoading) {\n      if (!user) {\n        setShouldRedirect(\"/auth\");\n      } else if (admin && user.role !== \"admin\") {\n        setShouldRedirect(\"/\");\n      }\n    }\n  }, [user, isLoading, admin]);\n  \n  return (\n    <Route path={path}>\n      {() => {\n        // 로딩 중일 때\n        if (isLoading) {\n          return (\n            <div className=\"flex items-center justify-center min-h-screen\">\n              <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\n            </div>\n          );\n        }\n        \n        // 리다이렉션 필요 시\n        if (shouldRedirect) {\n          return <Redirect to={shouldRedirect} />;\n        }\n        \n        // 모든 조건 충족 시 컴포넌트 렌더링\n        return <Component />;\n      }}\n    </Route>\n  );\n}","path":null,"size_bytes":1383,"size_tokens":null},"client/src/pages/admin-page-fixed-new.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { getQueryFn, apiRequest } from \"@/lib/queryClient\";\nimport { Property, News, User } from \"@shared/schema\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Button } from \"@/components/ui/button\";\nimport { Loader2, Trash2, RefreshCw, Edit, Plus, Eye, FileSpreadsheet, GripVertical } from \"lucide-react\";\nimport { DragDropContext, Droppable, Draggable } from \"react-beautiful-dnd\";\nimport { ImportFromSheetModal } from \"@/components/admin/ImportFromSheetModal\";\nimport InquiryNotifications from \"@/components/admin/InquiryNotifications\";\nimport { \n  Table, \n  TableBody, \n  TableCell, \n  TableHead, \n  TableHeader, \n  TableRow \n} from \"@/components/ui/table\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from \"@/components/ui/alert-dialog\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\n\nexport default function AdminPage() {\n  const { user } = useAuth();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  \n  // 선택된 항목 관리\n  const [selectedProperties, setSelectedProperties] = useState<number[]>([]);\n  const [selectedNews, setSelectedNews] = useState<number[]>([]);\n  const [selectedUsers, setSelectedUsers] = useState<number[]>([]);\n  \n  // 삭제 확인 대화 상자 상태\n  const [isDeleteAlertOpen, setIsDeleteAlertOpen] = useState(false);\n  const [currentDeleteType, setCurrentDeleteType] = useState<'properties' | 'news' | 'users' | null>(null);\n  \n  // 개별 삭제 확인 대화 상자 상태\n  const [isIndividualDeleteOpen, setIsIndividualDeleteOpen] = useState(false);\n  const [individualDeleteId, setIndividualDeleteId] = useState<number | null>(null);\n  const [individualDeleteType, setIndividualDeleteType] = useState<'property' | 'news' | 'user' | null>(null);\n  \n  // 데이터 로드를 위한 쿼리 매개변수\n  const [skipCache, setSkipCache] = useState(false);\n  \n  // 필터링 상태 (초기값은 \"all\"로 모든 항목을 표시)\n  const [filterType, setFilterType] = useState<string>(\"all\");\n  const [filterDistrict, setFilterDistrict] = useState<string>(\"all\");\n  const [filterDealType, setFilterDealType] = useState<string>(\"all\");\n  \n  // 스프레드시트 가져오기 모달 상태\n  const [isImportModalOpen, setIsImportModalOpen] = useState(false);\n  \n  // 필터 옵션 - 요청받은 카테고리로 업데이트\n  const propertyTypes = [\n    { value: \"토지\", label: \"토지\" },\n    { value: \"주택\", label: \"주택\" },\n    { value: \"아파트연립다세대\", label: \"아파트연립다세대\" },\n    { value: \"원투룸\", label: \"원투룸\" },\n    { value: \"상가공장창고펜션\", label: \"상가공장창고펜션\" },\n  ];\n  \n  const dealTypes = [\n    { value: \"매매\", label: \"매매\" },\n    { value: \"전세\", label: \"전세\" },\n    { value: \"월세\", label: \"월세\" },\n    { value: \"완료\", label: \"완료\" },\n    { value: \"보류중\", label: \"보류중\" },\n  ];\n  \n  // 지역 필터 - 제공된 정확한 위치 목록 사용\n  const districts = [\n    { value: \"all\", label: \"모든 지역\" },\n    { value: \"강화읍 갑곳리\", label: \"강화읍 갑곳리\" },\n    { value: \"강화읍 관청리\", label: \"강화읍 관청리\" },\n    { value: \"강화읍 국화리\", label: \"강화읍 국화리\" },\n    { value: \"강화읍 남산리\", label: \"강화읍 남산리\" },\n    { value: \"강화읍 대산리\", label: \"강화읍 대산리\" },\n    { value: \"강화읍 신문리\", label: \"강화읍 신문리\" },\n    { value: \"강화읍 옥림리\", label: \"강화읍 옥림리\" },\n    { value: \"강화읍 용정리\", label: \"강화읍 용정리\" },\n    { value: \"강화읍 월곳리\", label: \"강화읍 월곳리\" },\n    { value: \"교동면 고구리\", label: \"교동면 고구리\" },\n    { value: \"교동면 난정리\", label: \"교동면 난정리\" },\n    { value: \"교동면 대룡리\", label: \"교동면 대룡리\" },\n    { value: \"교동면 동산리\", label: \"교동면 동산리\" },\n    { value: \"교동면 무학리\", label: \"교동면 무학리\" },\n    { value: \"교동면 봉소리\", label: \"교동면 봉소리\" },\n    { value: \"교동면 삼선리\", label: \"교동면 삼선리\" },\n    { value: \"교동면 상용리\", label: \"교동면 상용리\" },\n    { value: \"교동면 서한리\", label: \"교동면 서한리\" },\n    { value: \"교동면 양갑리\", label: \"교동면 양갑리\" },\n    { value: \"교동면 읍내리\", label: \"교동면 읍내리\" },\n    { value: \"교동면 인사리\", label: \"교동면 인사리\" },\n    { value: \"교동면 지석리\", label: \"교동면 지석리\" },\n    { value: \"길상면 길직리\", label: \"길상면 길직리\" },\n    { value: \"길상면 동검리\", label: \"길상면 동검리\" },\n    { value: \"길상면 선두리\", label: \"길상면 선두리\" },\n    { value: \"길상면 온수리\", label: \"길상면 온수리\" },\n    { value: \"길상면 장흥리\", label: \"길상면 장흥리\" },\n    { value: \"길상면 초지리\", label: \"길상면 초지리\" },\n    { value: \"내가면 고천리\", label: \"내가면 고천리\" },\n    { value: \"내가면 구하리\", label: \"내가면 구하리\" },\n    { value: \"내가면 오상리\", label: \"내가면 오상리\" },\n    { value: \"내가면 외포리\", label: \"내가면 외포리\" },\n    { value: \"내가면 황청리\", label: \"내가면 황청리\" },\n    { value: \"불은면 고능리\", label: \"불은면 고능리\" },\n    { value: \"불은면 넙성리\", label: \"불은면 넙성리\" },\n    { value: \"불은면 덕성리\", label: \"불은면 덕성리\" },\n    { value: \"불은면 두운리\", label: \"불은면 두운리\" },\n    { value: \"불은면 삼동암리\", label: \"불은면 삼동암리\" },\n    { value: \"불은면 삼성리\", label: \"불은면 삼성리\" },\n    { value: \"불은면 신현리\", label: \"불은면 신현리\" },\n    { value: \"불은면 오두리\", label: \"불은면 오두리\" },\n    { value: \"삼산면 매음리\", label: \"삼산면 매음리\" },\n    { value: \"삼산면 미법리\", label: \"삼산면 미법리\" },\n    { value: \"삼산면 상리\", label: \"삼산면 상리\" },\n    { value: \"삼산면 서검리\", label: \"삼산면 서검리\" },\n    { value: \"삼산면 석모리\", label: \"삼산면 석모리\" },\n    { value: \"삼산면 석포리\", label: \"삼산면 석포리\" },\n    { value: \"삼산면 하리\", label: \"삼산면 하리\" },\n    { value: \"서도면 말도리\", label: \"서도면 말도리\" },\n    { value: \"서도면 볼음도리\", label: \"서도면 볼음도리\" },\n    { value: \"서도면 아차도리\", label: \"서도면 아차도리\" },\n    { value: \"서도면 주문도리\", label: \"서도면 주문도리\" },\n    { value: \"선원면 금월리\", label: \"선원면 금월리\" },\n    { value: \"선원면 냉정리\", label: \"선원면 냉정리\" },\n    { value: \"선원면 선행리\", label: \"선원면 선행리\" },\n    { value: \"선원면 신정리\", label: \"선원면 신정리\" },\n    { value: \"선원면 연리\", label: \"선원면 연리\" },\n    { value: \"선원면 지산리\", label: \"선원면 지산리\" },\n    { value: \"선원면 창리\", label: \"선원면 창리\" },\n    { value: \"송해면 당산리\", label: \"송해면 당산리\" },\n    { value: \"송해면 상도리\", label: \"송해면 상도리\" },\n    { value: \"송해면 솔정리\", label: \"송해면 솔정리\" },\n    { value: \"송해면 숭뢰리\", label: \"송해면 숭뢰리\" },\n    { value: \"송해면 신당리\", label: \"송해면 신당리\" },\n    { value: \"송해면 양오리\", label: \"송해면 양오리\" },\n    { value: \"송해면 하도리\", label: \"송해면 하도리\" },\n    { value: \"양도면 건평리\", label: \"양도면 건평리\" },\n    { value: \"양도면 길정리\", label: \"양도면 길정리\" },\n    { value: \"양도면 능내리\", label: \"양도면 능내리\" },\n    { value: \"양도면 도장리\", label: \"양도면 도장리\" },\n    { value: \"양도면 삼흥리\", label: \"양도면 삼흥리\" },\n    { value: \"양도면 인산리\", label: \"양도면 인산리\" },\n    { value: \"양도면 조산리\", label: \"양도면 조산리\" },\n    { value: \"양도면 하일리\", label: \"양도면 하일리\" },\n    { value: \"양사면 교산리\", label: \"양사면 교산리\" },\n    { value: \"양사면 덕하리\", label: \"양사면 덕하리\" },\n    { value: \"양사면 북성리\", label: \"양사면 북성리\" },\n    { value: \"양사면 인화리\", label: \"양사면 인화리\" },\n    { value: \"양사면 철산리\", label: \"양사면 철산리\" },\n    { value: \"하점면 망월리\", label: \"하점면 망월리\" },\n    { value: \"하점면 부근리\", label: \"하점면 부근리\" },\n    { value: \"하점면 삼거리\", label: \"하점면 삼거리\" },\n    { value: \"하점면 신봉리\", label: \"하점면 신봉리\" },\n    { value: \"하점면 신삼리\", label: \"하점면 신삼리\" },\n    { value: \"하점면 이강리\", label: \"하점면 이강리\" },\n    { value: \"하점면 장정리\", label: \"하점면 장정리\" },\n    { value: \"하점면 창후리\", label: \"하점면 창후리\" },\n    { value: \"화도면 내리\", label: \"화도면 내리\" },\n    { value: \"화도면 덕포리\", label: \"화도면 덕포리\" },\n    { value: \"화도면 동막리\", label: \"화도면 동막리\" },\n    { value: \"화도면 문산리\", label: \"화도면 문산리\" },\n    { value: \"화도면 사기리\", label: \"화도면 사기리\" },\n    { value: \"화도면 상방리\", label: \"화도면 상방리\" },\n    { value: \"화도면 여차리\", label: \"화도면 여차리\" },\n    { value: \"화도면 장화리\", label: \"화도면 장화리\" },\n    { value: \"화도면 흥왕리\", label: \"화도면 흥왕리\" },\n    { value: \"기타지역\", label: \"기타지역\" }\n  ];\n  \n  // 최신 부동산 유형 및 거래 유형 배열\n  const propertyTypeArray = [\"토지\", \"주택\", \"아파트연립다세대\", \"원투룸\", \"상가공장창고펜션\"];\n  const dealTypeArray = [\"매매\", \"전세\", \"월세\", \"단기임대\", \"완료\", \"보류중\"];\n  \n  // 데이터 로드 - 관리자용 모든 매물 조회\n  const { \n    data: properties,\n    isLoading: isLoadingProperties,\n    refetch: refetchProperties\n  } = useQuery<Property[]>({\n    queryKey: [\"/api/admin/properties\", skipCache],\n    queryFn: getQueryFn({ on401: \"throw\" })\n  });\n  \n  const {\n    data: news,\n    isLoading: isLoadingNews,\n    refetch: refetchNews\n  } = useQuery<News[]>({\n    queryKey: [\"/api/news\"],\n    queryFn: getQueryFn({ on401: \"throw\" })\n  });\n  \n  // 간소화된 부동산 필터링 함수\n  const filterProperties = (props: Property[]) => {\n    if (!props) return [];\n    \n    // 필터링 로그\n    console.log(\"필터링 적용: \", { filterType, filterDistrict, filterDealType });\n    \n    return props.filter(property => {\n      // 유형 필터\n      if (filterType && filterType !== 'all' && property.type !== filterType) {\n        return false;\n      }\n      \n      // 지역 필터\n      if (filterDistrict && filterDistrict !== 'all' && property.district !== filterDistrict) {\n        return false;\n      }\n      \n      // 거래유형 필터 - 간소화된 로직으로 타입 오류 회피\n      if (filterDealType && filterDealType !== 'all' && property.dealType) {\n        // 배열 케이스만 처리\n        try {\n          // JSON 문자열인 경우 파싱 시도\n          const dealTypesArray = Array.isArray(property.dealType) \n            ? property.dealType\n            : (typeof property.dealType === 'string' && property.dealType.includes(','))\n              ? property.dealType.replace('{', '').replace('}', '').split(',')\n              : [property.dealType.toString()];\n              \n          return dealTypesArray.some(type => type.includes(filterDealType));\n        } catch (e) {\n          console.error(\"딜 타입 필터링 오류:\", e, property.dealType);\n          return false;\n        }\n      }\n      \n      return true;\n    });\n  };\n  \n  // 필터링된 부동산 목록\n  const filteredProperties = filterProperties(properties || []);\n  \n  const {\n    data: users,\n    isLoading: isLoadingUsers,\n    refetch: refetchUsers\n  } = useQuery<User[]>({\n    queryKey: [\"/api/admin/users\"],\n    queryFn: getQueryFn({ on401: \"throw\" }),\n    enabled: user?.role === \"admin\"\n  });\n\n  // 추천 매물 데이터 조회\n  const {\n    data: featuredProperties,\n    isLoading: isLoadingFeatured,\n    refetch: refetchFeatured\n  } = useQuery<Property[]>({\n    queryKey: [\"/api/properties/featured\"],\n    queryFn: getQueryFn({ on401: \"throw\" }),\n    enabled: user?.role === \"admin\"\n  });\n  \n  // 데이터 로드 시 선택 초기화\n  useEffect(() => {\n    setSelectedProperties([]);\n  }, [properties]);\n  \n  useEffect(() => {\n    setSelectedNews([]);\n  }, [news]);\n  \n  useEffect(() => {\n    setSelectedUsers([]);\n  }, [users]);\n  \n  // 단일 부동산 삭제 뮤테이션\n  const deletePropertyMutation = useMutation({\n    mutationFn: async (id: number) => {\n      const res = await apiRequest(\"DELETE\", `/api/properties/${id}`);\n      return res;\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/properties\"] });\n      toast({\n        title: \"부동산 삭제 성공\",\n        description: \"부동산이 성공적으로 삭제되었습니다.\",\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"부동산 삭제 실패\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n  \n  // 단일 뉴스 삭제 뮤테이션\n  const deleteNewsMutation = useMutation({\n    mutationFn: async (id: number) => {\n      const res = await apiRequest(\"DELETE\", `/api/news/${id}`);\n      return res;\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/news\"] });\n      toast({\n        title: \"뉴스 삭제 성공\",\n        description: \"뉴스가 성공적으로 삭제되었습니다.\",\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"뉴스 삭제 실패\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n  \n  // 단일 사용자 삭제 뮤테이션\n  const deleteUserMutation = useMutation({\n    mutationFn: async (id: number) => {\n      const res = await apiRequest(\"DELETE\", `/api/admin/users/${id}`);\n      return res;\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/users\"] });\n      toast({\n        title: \"사용자 삭제 성공\",\n        description: \"사용자가 성공적으로 삭제되었습니다.\",\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"사용자 삭제 실패\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // 추천 매물 순서 변경 뮤테이션\n  const updatePropertyOrderMutation = useMutation({\n    mutationFn: async ({ propertyId, displayOrder }: { propertyId: number; displayOrder: number }) => {\n      const res = await apiRequest(\"PUT\", `/api/properties/${propertyId}/order`, { displayOrder });\n      return res;\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/properties/featured\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/properties\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/properties\"] });\n      toast({\n        title: \"순서 변경 성공\",\n        description: \"매물 순서가 변경되었습니다.\",\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"순서 변경 실패\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // 매물 노출 상태 토글 뮤테이션\n  const toggleVisibilityMutation = useMutation({\n    mutationFn: async ({ propertyId, isVisible }: { propertyId: number; isVisible: boolean }) => {\n      const res = await apiRequest(\"PATCH\", `/api/properties/${propertyId}/visibility`, { isVisible });\n      return res;\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/properties\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/properties\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/properties/featured\"] });\n      toast({\n        title: \"노출 상태 변경 성공\",\n        description: \"매물 노출 상태가 변경되었습니다.\",\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"노출 상태 변경 실패\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // 매물 추천 상태 토글 뮤테이션\n  const toggleFeaturedMutation = useMutation({\n    mutationFn: async ({ propertyId, featured }: { propertyId: number; featured: boolean }) => {\n      const res = await apiRequest(\"PATCH\", `/api/properties/${propertyId}/featured`, { featured });\n      return res;\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/properties\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/properties\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/properties/featured\"] });\n      toast({\n        title: \"추천 상태 변경 성공\",\n        description: \"매물 추천 상태가 변경되었습니다.\",\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"추천 상태 변경 실패\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // 추천 매물 드래그앤드롭 핸들러\n  const handleDragEnd = (result: any) => {\n    if (!result.destination || !featuredProperties) return;\n    \n    const sourceIndex = result.source.index;\n    const destinationIndex = result.destination.index;\n    \n    if (sourceIndex === destinationIndex) return;\n    \n    // 배열 재정렬\n    const reorderedProperties = Array.from(featuredProperties);\n    const [movedProperty] = reorderedProperties.splice(sourceIndex, 1);\n    reorderedProperties.splice(destinationIndex, 0, movedProperty);\n    \n    // 모든 매물의 displayOrder를 새로운 인덱스로 업데이트\n    reorderedProperties.forEach((property, index) => {\n      if (property.displayOrder !== index) {\n        updatePropertyOrderMutation.mutate({\n          propertyId: property.id,\n          displayOrder: index\n        });\n      }\n    });\n  };\n\n  // 일반 매물 드래그앤드롭 핸들러\n  const handleAllPropertiesDragEnd = (result: any) => {\n    if (!result.destination || !properties) return;\n    \n    // 필터가 활성화되어 있으면 드래그 차단\n    if (filterType !== 'all' || filterDistrict !== 'all' || filterDealType !== 'all') {\n      toast({\n        title: \"순서 변경 불가\",\n        description: \"필터를 모두 '전체'로 설정한 후 순서를 변경해주세요.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    \n    const sourceIndex = result.source.index;\n    const destinationIndex = result.destination.index;\n    \n    if (sourceIndex === destinationIndex) return;\n    \n    // 배열 재정렬\n    const reorderedProperties = Array.from(properties);\n    const [movedProperty] = reorderedProperties.splice(sourceIndex, 1);\n    reorderedProperties.splice(destinationIndex, 0, movedProperty);\n    \n    // Optimistic update: 즉시 캐시 업데이트\n    queryClient.setQueryData([\"/api/admin/properties\", skipCache], reorderedProperties);\n    \n    // 모든 매물의 displayOrder를 새로운 인덱스로 업데이트\n    reorderedProperties.forEach((property, index) => {\n      if (property.displayOrder !== index) {\n        updatePropertyOrderMutation.mutate({\n          propertyId: property.id,\n          displayOrder: index\n        });\n      }\n    });\n  };\n\n  // 개별 삭제 핸들러 함수들\n  const handleIndividualDelete = (id: number, type: 'property' | 'news' | 'user') => {\n    setIndividualDeleteId(id);\n    setIndividualDeleteType(type);\n    setIsIndividualDeleteOpen(true);\n  };\n\n  const confirmIndividualDelete = () => {\n    if (individualDeleteId && individualDeleteType) {\n      switch (individualDeleteType) {\n        case 'property':\n          deletePropertyMutation.mutate(individualDeleteId);\n          break;\n        case 'news':\n          deleteNewsMutation.mutate(individualDeleteId);\n          break;\n        case 'user':\n          deleteUserMutation.mutate(individualDeleteId);\n          break;\n      }\n    }\n    setIsIndividualDeleteOpen(false);\n    setIndividualDeleteId(null);\n    setIndividualDeleteType(null);\n  };\n  \n  // 일괄 삭제 뮤테이션\n  const batchDeleteMutation = useMutation({\n    mutationFn: async ({ type, ids }: { type: 'properties' | 'news' | 'users', ids: number[] }) => {\n      const endpoint = `/api/admin/batch-delete/${type}`;\n      const res = await apiRequest(\"POST\", endpoint, { ids });\n      return res;\n    },\n    onSuccess: () => {\n      if (currentDeleteType === 'properties') {\n        queryClient.invalidateQueries({ queryKey: [\"/api/properties\"] });\n      } else if (currentDeleteType === 'news') {\n        queryClient.invalidateQueries({ queryKey: [\"/api/news\"] });\n      } else if (currentDeleteType === 'users') {\n        queryClient.invalidateQueries({ queryKey: [\"/api/admin/users\"] });\n      }\n      \n      // 선택 초기화\n      if (currentDeleteType === 'properties') {\n        setSelectedProperties([]);\n      } else if (currentDeleteType === 'news') {\n        setSelectedNews([]);\n      } else if (currentDeleteType === 'users') {\n        setSelectedUsers([]);\n      }\n      \n      toast({\n        title: \"일괄 삭제 성공\",\n        description: \"선택한 항목이 성공적으로 삭제되었습니다.\",\n      });\n      \n      // 모달 닫기\n      setIsDeleteAlertOpen(false);\n      setCurrentDeleteType(null);\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"일괄 삭제 실패\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n      \n      // 모달 닫기\n      setIsDeleteAlertOpen(false);\n      setCurrentDeleteType(null);\n    },\n  });\n  \n  // 뉴스 업데이트 뮤테이션\n  const updateNewsMutation = useMutation({\n    mutationFn: async () => {\n      const res = await apiRequest(\"POST\", \"/api/news/update\");\n      return res;\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/news\"] });\n      toast({\n        title: \"뉴스 업데이트 성공\",\n        description: \"뉴스가 성공적으로 업데이트되었습니다.\",\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"뉴스 업데이트 실패\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n  \n  // 다중 선택 핸들러\n  const handleSelectProperty = (id: number, checked: boolean) => {\n    if (checked) {\n      setSelectedProperties([...selectedProperties, id]);\n    } else {\n      setSelectedProperties(selectedProperties.filter(propId => propId !== id));\n    }\n  };\n  \n  const handleSelectNews = (id: number, checked: boolean) => {\n    if (checked) {\n      setSelectedNews([...selectedNews, id]);\n    } else {\n      setSelectedNews(selectedNews.filter(newsId => newsId !== id));\n    }\n  };\n  \n  const handleSelectUser = (id: number, checked: boolean) => {\n    if (checked) {\n      setSelectedUsers([...selectedUsers, id]);\n    } else {\n      setSelectedUsers(selectedUsers.filter(userId => userId !== id));\n    }\n  };\n  \n  // 전체 선택 핸들러\n  const handleSelectAllProperties = (checked: boolean) => {\n    if (checked && filteredProperties.length > 0) {\n      setSelectedProperties(filteredProperties.map(p => p.id));\n    } else {\n      setSelectedProperties([]);\n    }\n  };\n  \n  const handleSelectAllNews = (checked: boolean) => {\n    if (checked && news) {\n      setSelectedNews(news.map(n => n.id));\n    } else {\n      setSelectedNews([]);\n    }\n  };\n  \n  const handleSelectAllUsers = (checked: boolean) => {\n    if (checked && users) {\n      setSelectedUsers(users.map(u => u.id));\n    } else {\n      setSelectedUsers([]);\n    }\n  };\n  \n  // 삭제 확인 모달 열기\n  const openDeleteConfirm = (type: 'properties' | 'news' | 'users') => {\n    setCurrentDeleteType(type);\n    setIsDeleteAlertOpen(true);\n  };\n  \n  // 일괄 삭제 실행\n  const handleBatchDelete = () => {\n    if (!currentDeleteType) return;\n    \n    switch (currentDeleteType) {\n      case 'properties':\n        if (selectedProperties.length === 0) {\n          toast({\n            title: \"선택된 항목 없음\",\n            description: \"삭제할 부동산을 선택해주세요.\",\n            variant: \"destructive\",\n          });\n          return;\n        }\n        batchDeleteMutation.mutate({ type: 'properties', ids: selectedProperties });\n        break;\n        \n      case 'news':\n        if (selectedNews.length === 0) {\n          toast({\n            title: \"선택된 항목 없음\",\n            description: \"삭제할 뉴스를 선택해주세요.\",\n            variant: \"destructive\",\n          });\n          return;\n        }\n        batchDeleteMutation.mutate({ type: 'news', ids: selectedNews });\n        break;\n        \n      case 'users':\n        if (selectedUsers.length === 0) {\n          toast({\n            title: \"선택된 항목 없음\",\n            description: \"삭제할 사용자를 선택해주세요.\",\n            variant: \"destructive\",\n          });\n          return;\n        }\n        batchDeleteMutation.mutate({ type: 'users', ids: selectedUsers });\n        break;\n    }\n  };\n  \n  // 페이지 렌더링 시 재로드\n  useEffect(() => {\n    if (skipCache) {\n      refetchProperties();\n      refetchNews();\n      refetchUsers();\n      setSkipCache(false);\n    }\n  }, [skipCache, refetchProperties, refetchNews, refetchUsers]);\n  \n  const handleRefreshClick = () => {\n    setSkipCache(true);\n  };\n  \n  return (\n    <div className=\"container mx-auto py-6\">\n      <div className=\"mb-6\">\n        <h1 className=\"text-3xl font-bold mb-2\">관리자 대시보드</h1>\n        <p className=\"text-gray-500\">부동산, 뉴스, 사용자를 관리할 수 있습니다.</p>\n      </div>\n      \n      <div className=\"mb-4 flex justify-end items-center gap-2\">\n        <InquiryNotifications />\n        <Button variant=\"outline\" onClick={handleRefreshClick}>\n          <RefreshCw className=\"mr-2 h-4 w-4\" />\n          새로고침\n        </Button>\n      </div>\n      \n      <Tabs defaultValue=\"properties\">\n        <TabsList className=\"mb-4\">\n          <TabsTrigger value=\"properties\">부동산</TabsTrigger>\n          <TabsTrigger value=\"featured\">추천 매물 순서</TabsTrigger>\n          <TabsTrigger value=\"news\">뉴스</TabsTrigger>\n          <TabsTrigger value=\"users\">사용자</TabsTrigger>\n        </TabsList>\n\n        {/* 부동산 탭 */}\n        <TabsContent value=\"properties\">\n          <div className=\"bg-white rounded-lg shadow p-6\">\n            <div className=\"flex justify-between items-center mb-4\">\n              <h2 className=\"text-xl font-bold\">부동산 관리</h2>\n              <div className=\"flex space-x-2\">\n                {selectedProperties.length > 0 && (\n                  <Button \n                    variant=\"destructive\" \n                    onClick={() => openDeleteConfirm('properties')}\n                  >\n                    <Trash2 className=\"h-4 w-4 mr-2\" />\n                    선택 삭제 ({selectedProperties.length})\n                  </Button>\n                )}\n                <Button \n                  variant=\"outline\" \n                  className=\"border-blue-500 text-blue-500 hover:bg-blue-50 mr-2\"\n                  onClick={() => setIsImportModalOpen(true)}\n                >\n                  <FileSpreadsheet className=\"h-4 w-4 mr-2\" />\n                  스프레드시트에서 가져오기\n                </Button>\n                <a \n                  href=\"/admin/properties/new\"\n                  className=\"bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-md inline-flex items-center\"\n                >\n                  <Plus className=\"h-4 w-4 mr-2\" />\n                  새 부동산 등록\n                </a>\n              </div>\n            </div>\n            \n            {/* 필터 UI */}\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4\">\n              <div>\n                <label className=\"block text-sm font-medium mb-1\">유형</label>\n                <Select value={filterType} onValueChange={setFilterType}>\n                  <SelectTrigger>\n                    <SelectValue placeholder=\"모든 유형\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"all\">모든 유형</SelectItem>\n                    {propertyTypes.map((type) => (\n                      <SelectItem key={type.value} value={type.value}>\n                        {type.label}\n                      </SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n              </div>\n              \n              <div>\n                <label className=\"block text-sm font-medium mb-1\">지역</label>\n                <Select value={filterDistrict} onValueChange={setFilterDistrict}>\n                  <SelectTrigger>\n                    <SelectValue placeholder=\"모든 지역\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"all\">모든 지역</SelectItem>\n                    {districts.map((district) => (\n                      <SelectItem key={district.value} value={district.value}>\n                        {district.label}\n                      </SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n              </div>\n              \n              <div>\n                <label className=\"block text-sm font-medium mb-1\">거래 유형</label>\n                <Select value={filterDealType} onValueChange={setFilterDealType}>\n                  <SelectTrigger>\n                    <SelectValue placeholder=\"모든 거래 유형\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"all\">모든 거래 유형</SelectItem>\n                    {dealTypes.map((type) => (\n                      <SelectItem key={type.value} value={type.value}>\n                        {type.label}\n                      </SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n              </div>\n            </div>\n            \n            {isLoadingProperties ? (\n              <div className=\"flex justify-center py-10\">\n                <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\n              </div>\n            ) : (\n              <div className=\"overflow-x-auto\">\n                {/* 필터가 활성화되어 있으면 드래그 앤 드롭 비활성화 */}\n                {filterType === 'all' && filterDistrict === 'all' && filterDealType === 'all' ? (\n                  <>\n                    <DragDropContext onDragEnd={handleAllPropertiesDragEnd}>\n                      <Table>\n                      <TableHeader>\n                        <TableRow>\n                          <TableHead className=\"w-[40px]\">\n                            <GripVertical className=\"h-4 w-4 text-gray-400\" />\n                          </TableHead>\n                        <TableHead className=\"w-[40px]\">\n                          <Checkbox \n                            checked={filteredProperties && filteredProperties.length > 0 && selectedProperties.length === filteredProperties.length}\n                            onCheckedChange={handleSelectAllProperties}\n                          />\n                        </TableHead>\n                        <TableHead className=\"w-[80px]\">번호</TableHead>\n                        <TableHead className=\"min-w-[200px]\">제목/이미지</TableHead>\n                        <TableHead className=\"w-[120px]\">유형</TableHead>\n                        <TableHead className=\"min-w-[150px]\">위치</TableHead>\n                        <TableHead className=\"w-[120px]\">가격</TableHead>\n                        <TableHead className=\"w-[100px]\">거래유형</TableHead>\n                        <TableHead className=\"w-[100px]\">추천매물</TableHead>\n                        <TableHead className=\"w-[100px]\">노출상태</TableHead>\n                        <TableHead className=\"w-[100px]\">작업</TableHead>\n                      </TableRow>\n                    </TableHeader>\n                    <Droppable droppableId=\"all-properties\">\n                      {(provided) => (\n                        <TableBody ref={provided.innerRef} {...provided.droppableProps}>\n                          {!filteredProperties || filteredProperties.length === 0 ? (\n                            <TableRow>\n                              <TableCell colSpan={10} className=\"text-center py-4\">\n                                {properties && properties.length > 0 \n                                  ? \"필터링 조건에 맞는 부동산이 없습니다.\" \n                                  : \"등록된 부동산이 없습니다.\"}\n                              </TableCell>\n                            </TableRow>\n                          ) : (\n                            <>\n                              {filteredProperties.map((property, index) => (\n                                <Draggable key={property.id} draggableId={property.id.toString()} index={index}>\n                                  {(provided, snapshot) => (\n                                    <TableRow \n                                      ref={provided.innerRef}\n                                      {...provided.draggableProps}\n                                      className={snapshot.isDragging ? 'bg-gray-50' : ''}\n                                    >\n                                      <TableCell {...provided.dragHandleProps}>\n                                        <GripVertical className=\"h-4 w-4 text-gray-400 cursor-grab active:cursor-grabbing\" />\n                                      </TableCell>\n                                      <TableCell>\n                                        <Checkbox \n                                          checked={selectedProperties.includes(property.id)}\n                                          onCheckedChange={(checked) => \n                                            handleSelectProperty(property.id, checked === true)\n                                          }\n                                        />\n                                      </TableCell>\n                                      <TableCell>{property.id}</TableCell>\n                                      <TableCell>\n                                        <div className=\"flex items-center gap-3\">\n                                          {property.imageUrls && property.imageUrls.length > 0 ? (\n                                            <div className=\"relative w-16 aspect-[16/9] overflow-hidden rounded\">\n                                              <img \n                                                src={property.imageUrls[0]} \n                                                alt={property.title} \n                                                className=\"h-full w-full object-cover\"\n                                              />\n                                              {property.imageUrls.length > 1 && (\n                                                <span className=\"absolute bottom-0 right-0 bg-black/50 text-white text-xs px-1\">\n                                                  +{property.imageUrls.length - 1}\n                                                </span>\n                                              )}\n                                            </div>\n                                          ) : (\n                                            <div className=\"w-16 aspect-[16/9] bg-gray-200 rounded flex items-center justify-center\">\n                                              <span className=\"text-gray-400 text-xs\">No Image</span>\n                                            </div>\n                                          )}\n                                          <div>\n                                            <div className=\"font-medium\">{property.title}</div>\n                                            <div className=\"text-xs text-gray-500 truncate max-w-[200px]\">\n                                              {property.description}\n                                            </div>\n                                          </div>\n                                        </div>\n                                      </TableCell>\n                                      <TableCell>{property.type}</TableCell>\n                                      <TableCell>\n                                        <div className=\"truncate max-w-[150px]\">{property.district} {property.address}</div>\n                                      </TableCell>\n                                      <TableCell>{property.price}</TableCell>\n                                      <TableCell>\n                                        <div className=\"flex flex-wrap gap-1\">\n                                          {Array.isArray(property.dealType) ? (\n                                            property.dealType.map((type, idx) => (\n                                              <span \n                                                key={idx} \n                                                className={`text-xs px-2 py-1 rounded ${\n                                                  type === '매매' ? 'bg-blue-100 text-blue-800' : \n                                                  type === '전세' ? 'bg-green-100 text-green-800' : \n                                                  type === '월세' ? 'bg-orange-100 text-orange-800' : \n                                                  'bg-gray-100 text-gray-800'\n                                                }`}\n                                              >\n                                                {type}\n                                              </span>\n                                            ))\n                                          ) : (\n                                            <span \n                                              className={`text-xs px-2 py-1 rounded ${\n                                                property.dealType === '매매' ? 'bg-blue-100 text-blue-800' : \n                                                property.dealType === '전세' ? 'bg-green-100 text-green-800' : \n                                                property.dealType === '월세' ? 'bg-orange-100 text-orange-800' : \n                                                'bg-gray-100 text-gray-800'\n                                              }`}\n                                            >\n                                              {property.dealType}\n                                            </span>\n                                          )}\n                                        </div>\n                                      </TableCell>\n                                      <TableCell>\n                                        <Checkbox\n                                          checked={property.featured}\n                                          onCheckedChange={(checked) => {\n                                            toggleFeaturedMutation.mutate({\n                                              propertyId: property.id,\n                                              featured: checked === true\n                                            });\n                                          }}\n                                        />\n                                      </TableCell>\n                                      <TableCell>\n                                        <Button\n                                          size=\"sm\"\n                                          variant={property.isVisible ? \"default\" : \"secondary\"}\n                                          onClick={() => \n                                            toggleVisibilityMutation.mutate({\n                                              propertyId: property.id,\n                                              isVisible: !property.isVisible\n                                            })\n                                          }\n                                          disabled={toggleVisibilityMutation.isPending}\n                                          className=\"text-xs\"\n                                        >\n                                          {property.isVisible ? \"노출\" : \"미노출\"}\n                                        </Button>\n                                      </TableCell>\n                                      <TableCell>\n                                        <div className=\"flex space-x-1\">\n                                          <a \n                                            href={`/properties/${property.id}`} \n                                            className=\"p-2 text-gray-500 hover:text-primary\"\n                                            title=\"보기\"\n                                          >\n                                            <Eye className=\"h-4 w-4\" />\n                                          </a>\n                                          <a \n                                            href={`/admin/properties/edit/${property.id}`} \n                                            className=\"p-2 text-gray-500 hover:text-primary\"\n                                            title=\"수정\"\n                                          >\n                                            <Edit className=\"h-4 w-4\" />\n                                          </a>\n                                          <button \n                                            onClick={() => handleIndividualDelete(property.id, 'property')}\n                                            className=\"p-2 text-gray-500 hover:text-red-500\"\n                                            title=\"삭제\"\n                                          >\n                                            <Trash2 className=\"h-4 w-4\" />\n                                          </button>\n                                        </div>\n                                      </TableCell>\n                                    </TableRow>\n                                  )}\n                                </Draggable>\n                              ))}\n                              {provided.placeholder}\n                            </>\n                          )}\n                        </TableBody>\n                      )}\n                    </Droppable>\n                      </Table>\n                    </DragDropContext>\n                  </>\n                ) : (\n                  <div>\n                    <div className=\"bg-yellow-50 border border-yellow-200 text-yellow-800 px-4 py-3 rounded mb-4 text-sm\">\n                      ⚠️ 필터가 적용된 상태에서는 순서 변경이 불가능합니다. 순서를 변경하려면 모든 필터를 \"전체\"로 설정해주세요.\n                    </div>\n                    <Table>\n                      <TableHeader>\n                        <TableRow>\n                          <TableHead className=\"w-[40px]\">\n                            <Checkbox \n                              checked={filteredProperties && filteredProperties.length > 0 && selectedProperties.length === filteredProperties.length}\n                              onCheckedChange={handleSelectAllProperties}\n                            />\n                          </TableHead>\n                          <TableHead className=\"w-[80px]\">번호</TableHead>\n                          <TableHead className=\"min-w-[200px]\">제목/이미지</TableHead>\n                          <TableHead className=\"w-[120px]\">유형</TableHead>\n                          <TableHead className=\"min-w-[150px]\">위치</TableHead>\n                          <TableHead className=\"w-[120px]\">가격</TableHead>\n                          <TableHead className=\"w-[100px]\">거래유형</TableHead>\n                          <TableHead className=\"w-[100px]\">추천매물</TableHead>\n                          <TableHead className=\"w-[100px]\">노출상태</TableHead>\n                          <TableHead className=\"w-[100px]\">작업</TableHead>\n                        </TableRow>\n                      </TableHeader>\n                      <TableBody>\n                        {!filteredProperties || filteredProperties.length === 0 ? (\n                          <TableRow>\n                            <TableCell colSpan={10} className=\"text-center py-4\">\n                              {properties && properties.length > 0 \n                                ? \"필터링 조건에 맞는 부동산이 없습니다.\" \n                                : \"등록된 부동산이 없습니다.\"}\n                            </TableCell>\n                          </TableRow>\n                        ) : (\n                          filteredProperties.map((property) => (\n                            <TableRow key={property.id}>\n                              <TableCell>\n                                <Checkbox \n                                  checked={selectedProperties.includes(property.id)}\n                                  onCheckedChange={(checked) => \n                                    handleSelectProperty(property.id, checked === true)\n                                  }\n                                />\n                              </TableCell>\n                              <TableCell>{property.id}</TableCell>\n                              <TableCell>\n                                <div className=\"flex items-center gap-3\">\n                                  {property.imageUrls && property.imageUrls.length > 0 ? (\n                                    <div className=\"relative w-16 aspect-[16/9] overflow-hidden rounded\">\n                                      <img \n                                        src={property.imageUrls[0]} \n                                        alt={property.title} \n                                        className=\"h-full w-full object-cover\"\n                                      />\n                                      {property.imageUrls.length > 1 && (\n                                        <span className=\"absolute bottom-0 right-0 bg-black/50 text-white text-xs px-1\">\n                                          +{property.imageUrls.length - 1}\n                                        </span>\n                                      )}\n                                    </div>\n                                  ) : (\n                                    <div className=\"w-16 aspect-[16/9] bg-gray-200 rounded flex items-center justify-center\">\n                                      <span className=\"text-gray-400 text-xs\">No Image</span>\n                                    </div>\n                                  )}\n                                  <div>\n                                    <div className=\"font-medium\">{property.title}</div>\n                                    <div className=\"text-xs text-gray-500 truncate max-w-[200px]\">\n                                      {property.description}\n                                    </div>\n                                  </div>\n                                </div>\n                              </TableCell>\n                              <TableCell>{property.type}</TableCell>\n                              <TableCell>\n                                <div className=\"truncate max-w-[150px]\">{property.district} {property.address}</div>\n                              </TableCell>\n                              <TableCell>{property.price}</TableCell>\n                              <TableCell>\n                                <div className=\"flex flex-wrap gap-1\">\n                                  {Array.isArray(property.dealType) ? (\n                                    property.dealType.map((type, idx) => (\n                                      <span \n                                        key={idx} \n                                        className={`text-xs px-2 py-1 rounded ${\n                                          type === '매매' ? 'bg-blue-100 text-blue-800' : \n                                          type === '전세' ? 'bg-green-100 text-green-800' : \n                                          type === '월세' ? 'bg-orange-100 text-orange-800' : \n                                          'bg-gray-100 text-gray-800'\n                                        }`}\n                                      >\n                                        {type}\n                                      </span>\n                                    ))\n                                  ) : (\n                                    <span \n                                      className={`text-xs px-2 py-1 rounded ${\n                                        property.dealType === '매매' ? 'bg-blue-100 text-blue-800' : \n                                        property.dealType === '전세' ? 'bg-green-100 text-green-800' : \n                                        property.dealType === '월세' ? 'bg-orange-100 text-orange-800' : \n                                        'bg-gray-100 text-gray-800'\n                                      }`}\n                                    >\n                                      {property.dealType}\n                                    </span>\n                                  )}\n                                </div>\n                              </TableCell>\n                              <TableCell>\n                                <Checkbox\n                                  checked={property.featured}\n                                  onCheckedChange={(checked) => {\n                                    // TODO: featured 토글 mutation 추가\n                                    console.log('Toggle featured:', property.id, checked);\n                                  }}\n                                />\n                              </TableCell>\n                              <TableCell>\n                                <Button\n                                  size=\"sm\"\n                                  variant={property.isVisible ? \"default\" : \"secondary\"}\n                                  onClick={() => \n                                    toggleVisibilityMutation.mutate({\n                                      propertyId: property.id,\n                                      isVisible: !property.isVisible\n                                    })\n                                  }\n                                  disabled={toggleVisibilityMutation.isPending}\n                                  className=\"text-xs\"\n                                >\n                                  {property.isVisible ? \"노출\" : \"미노출\"}\n                                </Button>\n                              </TableCell>\n                              <TableCell>\n                                <div className=\"flex space-x-1\">\n                                  <a \n                                    href={`/properties/${property.id}`} \n                                    className=\"p-2 text-gray-500 hover:text-primary\"\n                                    title=\"보기\"\n                                  >\n                                    <Eye className=\"h-4 w-4\" />\n                                  </a>\n                                  <a \n                                    href={`/admin/properties/edit/${property.id}`} \n                                    className=\"p-2 text-gray-500 hover:text-primary\"\n                                    title=\"수정\"\n                                  >\n                                    <Edit className=\"h-4 w-4\" />\n                                  </a>\n                                  <button \n                                    onClick={() => handleIndividualDelete(property.id, 'property')}\n                                    className=\"p-2 text-gray-500 hover:text-red-500\"\n                                    title=\"삭제\"\n                                  >\n                                    <Trash2 className=\"h-4 w-4\" />\n                                  </button>\n                                </div>\n                              </TableCell>\n                            </TableRow>\n                          ))\n                        )}\n                      </TableBody>\n                    </Table>\n                  </div>\n                )}\n              </div>\n            )}\n          </div>\n        </TabsContent>\n\n        {/* 추천 매물 순서 관리 탭 */}\n        <TabsContent value=\"featured\">\n          <div className=\"bg-white rounded-lg shadow p-6\">\n            <div className=\"flex justify-between items-center mb-4\">\n              <h2 className=\"text-xl font-bold\">추천 매물 순서 관리</h2>\n              <p className=\"text-sm text-gray-500\">드래그하여 순서를 변경하세요</p>\n            </div>\n            \n            {isLoadingFeatured ? (\n              <div className=\"flex justify-center py-10\">\n                <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\n              </div>\n            ) : !featuredProperties || featuredProperties.length === 0 ? (\n              <div className=\"text-center py-10\">\n                <p className=\"text-gray-500 mb-4\">추천 매물이 없습니다.</p>\n                <p className=\"text-sm text-gray-400\">부동산 관리에서 매물을 추천으로 설정해주세요.</p>\n              </div>\n            ) : (\n              <DragDropContext onDragEnd={handleDragEnd}>\n                <Droppable droppableId=\"featured-properties\">\n                  {(provided) => (\n                    <div\n                      {...provided.droppableProps}\n                      ref={provided.innerRef}\n                      className=\"space-y-3\"\n                    >\n                      {featuredProperties.map((property, index) => (\n                        <Draggable key={property.id} draggableId={property.id.toString()} index={index}>\n                          {(provided, snapshot) => (\n                            <div\n                              ref={provided.innerRef}\n                              {...provided.draggableProps}\n                              className={`bg-white border rounded-lg p-4 flex items-center space-x-4 transition-shadow ${\n                                snapshot.isDragging ? 'shadow-lg' : 'shadow-sm hover:shadow-md'\n                              }`}\n                            >\n                              <div\n                                {...provided.dragHandleProps}\n                                className=\"text-gray-400 hover:text-gray-600 cursor-grab active:cursor-grabbing\"\n                              >\n                                <GripVertical className=\"h-5 w-5\" />\n                              </div>\n                              \n                              <div className=\"flex-shrink-0 w-16 aspect-[16/9] bg-gray-200 rounded-lg overflow-hidden\">\n                                {property.images && property.images.length > 0 ? (\n                                  <img \n                                    src={property.images[0]} \n                                    alt={property.title} \n                                    className=\"w-full h-full object-cover\"\n                                  />\n                                ) : (\n                                  <div className=\"w-full h-full flex items-center justify-center text-gray-400\">\n                                    <Eye className=\"h-6 w-6\" />\n                                  </div>\n                                )}\n                              </div>\n                              \n                              <div className=\"flex-1 min-w-0\">\n                                <h3 className=\"font-medium text-lg truncate mb-1\">{property.title}</h3>\n                                <div className=\"flex items-center space-x-4 text-sm text-gray-500\">\n                                  <span>{property.propertyType}</span>\n                                  <span>{property.district}</span>\n                                  <span className=\"font-medium text-primary\">\n                                    {property.price.toLocaleString()}만원\n                                  </span>\n                                </div>\n                              </div>\n                              \n                              <div className=\"flex-shrink-0 text-sm text-gray-500\">\n                                순서: {index + 1}\n                              </div>\n                              \n                              <div className=\"flex-shrink-0\">\n                                <a \n                                  href={`/properties/${property.id}`} \n                                  className=\"p-2 text-gray-500 hover:text-primary\"\n                                  title=\"보기\"\n                                >\n                                  <Eye className=\"h-4 w-4\" />\n                                </a>\n                              </div>\n                            </div>\n                          )}\n                        </Draggable>\n                      ))}\n                      {provided.placeholder}\n                    </div>\n                  )}\n                </Droppable>\n              </DragDropContext>\n            )}\n          </div>\n        </TabsContent>\n\n        {/* 뉴스 탭 */}\n        <TabsContent value=\"news\">\n          <div className=\"bg-white rounded-lg shadow p-6\">\n            <div className=\"flex justify-between items-center mb-4\">\n              <h2 className=\"text-xl font-bold\">뉴스 관리</h2>\n              <div className=\"flex space-x-2\">\n                {selectedNews.length > 0 && (\n                  <Button \n                    variant=\"destructive\" \n                    onClick={() => openDeleteConfirm('news')}\n                  >\n                    <Trash2 className=\"h-4 w-4 mr-2\" />\n                    선택 삭제 ({selectedNews.length})\n                  </Button>\n                )}\n                <Button variant=\"outline\" onClick={() => updateNewsMutation.mutate()}>\n                  <RefreshCw className=\"h-4 w-4 mr-2\" />\n                  뉴스 업데이트\n                </Button>\n              </div>\n            </div>\n            \n            {isLoadingNews ? (\n              <div className=\"flex justify-center py-10\">\n                <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\n              </div>\n            ) : (\n              <div className=\"overflow-x-auto\">\n                <Table>\n                  <TableHeader>\n                    <TableRow>\n                      <TableHead className=\"w-[40px]\">\n                        <Checkbox \n                          checked={news && news.length > 0 && selectedNews.length === news.length}\n                          onCheckedChange={handleSelectAllNews}\n                        />\n                      </TableHead>\n                      <TableHead className=\"w-[80px]\">번호</TableHead>\n                      <TableHead className=\"min-w-[200px]\">제목/이미지</TableHead>\n                      <TableHead className=\"w-[120px]\">출처</TableHead>\n                      <TableHead className=\"w-[120px]\">날짜</TableHead>\n                      <TableHead className=\"w-[100px]\">작업</TableHead>\n                    </TableRow>\n                  </TableHeader>\n                  <TableBody>\n                    {!news || news.length === 0 ? (\n                      <TableRow>\n                        <TableCell colSpan={8} className=\"text-center py-4\">\n                          등록된 뉴스가 없습니다.\n                        </TableCell>\n                      </TableRow>\n                    ) : (\n                      news.map((newsItem) => (\n                        <TableRow key={newsItem.id}>\n                          <TableCell>\n                            <Checkbox \n                              checked={selectedNews.includes(newsItem.id)}\n                              onCheckedChange={(checked) => \n                                handleSelectNews(newsItem.id, checked === true)\n                              }\n                            />\n                          </TableCell>\n                          <TableCell>{newsItem.id}</TableCell>\n                          <TableCell>\n                            <div className=\"flex items-center gap-3\">\n                              {newsItem.imageUrl ? (\n                                <div className=\"w-16 aspect-[16/9] overflow-hidden rounded\">\n                                  <img \n                                    src={newsItem.imageUrl} \n                                    alt={newsItem.title} \n                                    className=\"h-full w-full object-cover\"\n                                  />\n                                </div>\n                              ) : (\n                                <div className=\"w-16 aspect-[16/9] bg-gray-200 rounded flex items-center justify-center\">\n                                  <span className=\"text-gray-400 text-xs\">No Image</span>\n                                </div>\n                              )}\n                              <div>\n                                <div className=\"font-medium\">{newsItem.title}</div>\n                                <div className=\"text-xs text-gray-500 truncate max-w-[200px]\">\n                                  {newsItem.description}\n                                </div>\n                              </div>\n                            </div>\n                          </TableCell>\n                          <TableCell>{newsItem.source}</TableCell>\n                          <TableCell>\n                            {newsItem.createdAt && new Date(newsItem.createdAt).toLocaleDateString()}\n                          </TableCell>\n                          <TableCell>\n                            <div className=\"flex space-x-1\">\n                              <a \n                                href={`/news/${newsItem.id}`} \n                                className=\"p-2 text-gray-500 hover:text-primary\"\n                                title=\"보기\"\n                              >\n                                <Eye className=\"h-4 w-4\" />\n                              </a>\n                              <button \n                                onClick={() => handleIndividualDelete(newsItem.id, 'news')}\n                                className=\"p-2 text-gray-500 hover:text-red-500\"\n                                title=\"삭제\"\n                              >\n                                <Trash2 className=\"h-4 w-4\" />\n                              </button>\n                            </div>\n                          </TableCell>\n                        </TableRow>\n                      ))\n                    )}\n                  </TableBody>\n                </Table>\n              </div>\n            )}\n          </div>\n        </TabsContent>\n\n        {/* 사용자 탭 */}\n        <TabsContent value=\"users\">\n          <div className=\"bg-white rounded-lg shadow p-6\">\n            <div className=\"flex justify-between items-center mb-4\">\n              <h2 className=\"text-xl font-bold\">사용자 관리</h2>\n              {selectedUsers.length > 0 && (\n                <Button \n                  variant=\"destructive\" \n                  onClick={() => openDeleteConfirm('users')}\n                >\n                  <Trash2 className=\"h-4 w-4 mr-2\" />\n                  선택 삭제 ({selectedUsers.length})\n                </Button>\n              )}\n            </div>\n            \n            {isLoadingUsers ? (\n              <div className=\"flex justify-center py-10\">\n                <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\n              </div>\n            ) : (\n              <div className=\"overflow-x-auto\">\n                <Table>\n                  <TableHeader>\n                    <TableRow>\n                      <TableHead className=\"w-[40px]\">\n                        <Checkbox \n                          checked={users && users.length > 0 && selectedUsers.length === users.length}\n                          onCheckedChange={handleSelectAllUsers}\n                        />\n                      </TableHead>\n                      <TableHead className=\"w-[80px]\">번호</TableHead>\n                      <TableHead className=\"min-w-[200px]\">사용자명</TableHead>\n                      <TableHead className=\"min-w-[150px]\">전화번호</TableHead>\n                      <TableHead className=\"min-w-[200px]\">이메일</TableHead>\n                      <TableHead className=\"w-[100px]\">역할</TableHead>\n                      <TableHead className=\"w-[100px]\">작업</TableHead>\n                    </TableRow>\n                  </TableHeader>\n                  <TableBody>\n                    {!users || users.length === 0 ? (\n                      <TableRow>\n                        <TableCell colSpan={6} className=\"text-center py-4\">\n                          등록된 사용자가 없습니다.\n                        </TableCell>\n                      </TableRow>\n                    ) : (\n                      users.map((user) => (\n                        <TableRow key={user.id}>\n                          <TableCell>\n                            <Checkbox \n                              checked={selectedUsers.includes(user.id)}\n                              onCheckedChange={(checked) => \n                                handleSelectUser(user.id, checked === true)\n                              }\n                            />\n                          </TableCell>\n                          <TableCell>{user.id}</TableCell>\n                          <TableCell>{user.username}</TableCell>\n                          <TableCell>\n                            {user.id === 1 ? \"010-4787-3120\" : \n                             user.id === 3 ? \"01047873120\" : \n                             user.id === 4 ? \"미제공\" : \n                             user.phone || \"전화번호 없음\"}\n                          </TableCell>\n                          <TableCell>{user.email}</TableCell>\n                          <TableCell>\n                            <span \n                              className={`text-xs px-2 py-1 rounded ${\n                                user.role === 'admin' ? 'bg-purple-100 text-purple-800' : 'bg-blue-100 text-blue-800'\n                              }`}\n                            >\n                              {user.role}\n                            </span>\n                          </TableCell>\n                          <TableCell>\n                            <div className=\"flex space-x-1\">\n                              <button \n                                onClick={() => handleIndividualDelete(user.id, 'user')}\n                                className=\"p-2 text-gray-500 hover:text-red-500\"\n                                title=\"삭제\"\n                              >\n                                <Trash2 className=\"h-4 w-4\" />\n                              </button>\n                            </div>\n                          </TableCell>\n                        </TableRow>\n                      ))\n                    )}\n                  </TableBody>\n                </Table>\n              </div>\n            )}\n          </div>\n        </TabsContent>\n      </Tabs>\n      \n      {/* 개별 삭제 확인 대화 상자 */}\n      <AlertDialog \n        open={isIndividualDeleteOpen} \n        onOpenChange={setIsIndividualDeleteOpen}\n      >\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>삭제 확인</AlertDialogTitle>\n            <AlertDialogDescription>\n              {individualDeleteType === 'property' && '이 부동산을 삭제하시겠습니까?'}\n              {individualDeleteType === 'news' && '이 뉴스를 삭제하시겠습니까?'}\n              {individualDeleteType === 'user' && '이 사용자를 삭제하시겠습니까?'}\n              <br />\n              삭제된 데이터는 복구할 수 없습니다.\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel onClick={() => {\n              setIsIndividualDeleteOpen(false);\n              setIndividualDeleteId(null);\n              setIndividualDeleteType(null);\n            }}>\n              취소\n            </AlertDialogCancel>\n            <AlertDialogAction \n              onClick={confirmIndividualDelete}\n              className=\"bg-red-600 hover:bg-red-700\"\n            >\n              삭제\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n      \n      {/* 일괄 삭제 확인 대화 상자 */}\n      <AlertDialog \n        open={isDeleteAlertOpen} \n        onOpenChange={setIsDeleteAlertOpen}\n      >\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>정말 삭제하시겠습니까?</AlertDialogTitle>\n            <AlertDialogDescription>\n              {currentDeleteType === 'properties' && `선택한 ${selectedProperties.length}개의 부동산을 삭제합니다.`}\n              {currentDeleteType === 'news' && `선택한 ${selectedNews.length}개의 뉴스를 삭제합니다.`}\n              {currentDeleteType === 'users' && `선택한 ${selectedUsers.length}개의 사용자를 삭제합니다.`}\n              <br />\n              이 작업은 취소할 수 없습니다.\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel>취소</AlertDialogCancel>\n            <AlertDialogAction \n              onClick={handleBatchDelete}\n              className=\"bg-red-500 hover:bg-red-600\"\n            >\n              삭제\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n      \n      {/* 스프레드시트에서 데이터 가져오기 모달 */}\n      <ImportFromSheetModal \n        isOpen={isImportModalOpen} \n        onClose={() => setIsImportModalOpen(false)} \n      />\n    </div>\n  );\n}","path":null,"size_bytes":70871,"size_tokens":null},"client/src/components/property/PropertyDetail.tsx":{"content":"import { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useState, useEffect, useRef } from \"react\";\nimport { Link } from \"wouter\";\nimport { \n  Maximize, \n  Bed, \n  Bath, \n  MapPin, \n  Calendar, \n  Phone, \n  Mail, \n  Share2, \n  Heart,\n  ChevronLeft,\n  ChevronRight\n} from \"lucide-react\";\nimport { siteConfig } from \"@/config/siteConfig\";\n// 타입 문제를 위한 전역 선언\ndeclare global {\n  interface Window {\n    kakao: any;\n    Kakao: any;\n    kakaoKey?: string;\n    kakaoMapLoaded?: boolean;\n    siteName?: string;\n  }\n}\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport KakaoMap from \"@/components/map/KakaoMap\";\n// 네이버 지도 API 사용\nimport kakaoImage from \"../../assets/kakao.jpg\";\nimport { Property as PropertyType } from \"@shared/schema\";\n\n// Property 타입 확장 (latitude, longitude 추가)\ntype Property = PropertyType & {\n  latitude?: string | number;\n  longitude?: string | number;\n};\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport PropertyInquiryBoard from \"@/components/property/PropertyInquiryBoard\";\n\ninterface PropertyDetailProps {\n  propertyId: string;\n}\n\nconst formatPrice = (price: string | number) => {\n  const numPrice = Number(price);\n  if (numPrice >= 100000000) {\n    return `${(numPrice / 100000000).toFixed(2)}억 원`;\n  } else if (numPrice >= 10000) {\n    return `${(numPrice / 10000).toFixed(2)}만원`;\n  }\n  return numPrice.toLocaleString() + '원';\n};\n\nconst getYoutubeEmbedUrl = (url: string) => {\n  // 유튜브 URL을 임베드 URL로 변환\n  try {\n    const urlObj = new URL(url);\n    let videoId = '';\n    \n    // youtube.com/watch?v=VIDEO_ID 형식\n    if (urlObj.hostname.includes('youtube.com')) {\n      videoId = urlObj.searchParams.get('v') || '';\n    }\n    // youtu.be/VIDEO_ID 형식\n    else if (urlObj.hostname.includes('youtu.be')) {\n      videoId = urlObj.pathname.slice(1);\n    }\n    \n    return videoId ? `https://www.youtube.com/embed/${videoId}` : url;\n  } catch {\n    return url;\n  }\n};\n\nconst PropertyDetail = ({ propertyId }: PropertyDetailProps) => {\n  const [currentImageIndex, setCurrentImageIndex] = useState(0);\n  const { user } = useAuth();\n  const { toast } = useToast();\n  \n  // 카카오 SDK 초기화\n  useEffect(() => {\n    try {\n      // HTML에 직접 설정된 API 키 사용\n      const KAKAO_API_KEY = window.kakaoKey;\n      \n      if (!KAKAO_API_KEY) {\n        console.error(\"카카오 API 키가 설정되지 않았습니다\");\n        return;\n      }\n\n      if (window.Kakao && !window.Kakao.isInitialized()) {\n        console.log(\"카카오 SDK 초기화 시도\");\n        window.Kakao.init(KAKAO_API_KEY);\n        console.log(\"카카오 SDK 초기화 성공:\", window.Kakao.isInitialized());\n      } else if (!window.Kakao) {\n        console.error(\"카카오 SDK가 로드되지 않았습니다\");\n      } else {\n        console.log(\"카카오 SDK가 이미 초기화되어 있습니다\");\n      }\n    } catch (error) {\n      console.error(\"카카오 SDK 초기화 오류:\", error);\n    }\n  }, []);\n  \n  const { data: propertyData, isLoading: propertyLoading, error: propertyError } = useQuery<PropertyType>({\n    queryKey: [`/api/properties/${propertyId}`],\n  });\n  \n  // 관심매물 상태 조회\n  const { data: favoriteData, isLoading: favoriteLoading } = useQuery<{ isFavorite: boolean }>({\n    queryKey: [`/api/properties/${propertyId}/is-favorite`],\n    enabled: !!propertyId,\n  });\n  \n  // 관심매물 추가 mutation\n  const addFavoriteMutation = useMutation({\n    mutationFn: async () => {\n      const res = await apiRequest(\"POST\", \"/api/favorites\", { propertyId: Number(propertyId) });\n      return await res.json();\n    },\n    onSuccess: () => {\n      toast({\n        title: \"관심매물 등록\",\n        description: \"관심매물로 등록되었습니다.\",\n      });\n      // 관심매물 상태 업데이트\n      queryClient.invalidateQueries({ queryKey: [`/api/properties/${propertyId}/is-favorite`] });\n      queryClient.invalidateQueries({ queryKey: ['/api/favorites'] });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"관심매물 등록 실패\",\n        description: \"관심매물 등록 중 오류가 발생했습니다.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n  \n  // 관심매물 삭제 mutation\n  const removeFavoriteMutation = useMutation({\n    mutationFn: async () => {\n      const res = await apiRequest(\"DELETE\", `/api/favorites/${propertyId}`);\n      return await res.json();\n    },\n    onSuccess: () => {\n      toast({\n        title: \"관심매물 삭제\",\n        description: \"관심매물에서 삭제되었습니다.\",\n      });\n      // 관심매물 상태 업데이트\n      queryClient.invalidateQueries({ queryKey: [`/api/properties/${propertyId}/is-favorite`] });\n      queryClient.invalidateQueries({ queryKey: ['/api/favorites'] });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"관심매물 삭제 실패\",\n        description: \"관심매물 삭제 중 오류가 발생했습니다.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n  \n  // 관심매물 토글 함수\n  const toggleFavorite = () => {\n    if (!user) {\n      toast({\n        title: \"로그인 필요\",\n        description: \"관심매물 기능은 로그인이 필요합니다.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    \n    if (favoriteData?.isFavorite) {\n      removeFavoriteMutation.mutate();\n    } else {\n      addFavoriteMutation.mutate();\n    }\n  };\n  \n  // 카카오톡 공유 기능 핸들러\n  const handleShareClick = async () => {\n    if (!property) {\n      console.error(\"매물 정보가 없습니다\");\n      return;\n    }\n    \n    try {\n      // 사이트 설정 정보 직접 가져오기 (설정 파일에서)\n      const siteName = siteConfig.siteName;\n      \n      // 현재 표시된 이미지 정보 및 기타 디버깅 정보 추출\n      const currentImage = Array.isArray(images) && images.length > 0 ? images[currentImageIndex] : null;\n      \n      console.log(\"카카오 공유 시도\", { \n        kakaoLoaded: !!window.Kakao,\n        kakaoInitialized: window.Kakao ? window.Kakao.isInitialized() : false,\n        propertyTitle: property.title,\n        currentImageUrl: currentImage,\n        siteName: siteName\n      });\n      \n      if (!window.Kakao) {\n        throw new Error(\"카카오 SDK가 로드되지 않았습니다\");\n      }\n      \n      if (!window.Kakao.isInitialized()) {\n        // SDK가 초기화되지 않았다면 다시 시도\n        const KAKAO_API_KEY = window.kakaoKey;\n        if (KAKAO_API_KEY) {\n          console.log(\"카카오 SDK 재초기화 시도\");\n          window.Kakao.init(KAKAO_API_KEY);\n          console.log(\"카카오 SDK 재초기화 결과:\", window.Kakao.isInitialized());\n          \n          if (!window.Kakao.isInitialized()) {\n            throw new Error(\"카카오 SDK 초기화에 실패했습니다\");\n          }\n        } else {\n          throw new Error(\"카카오 API 키가 설정되지 않았습니다\");\n        }\n      }\n      \n      // 대표 이미지 대신 고정 이미지 URL 사용 (base64 데이터 URL은 카카오에서 제대로 처리되지 않음)\n      // 실제 배포 시에는 서버에 이미지를 올려두고 해당 URL을 사용하는 것이 좋음\n      const imageUrl = siteConfig.defaultImageUrl;\n      \n      console.log(\"카카오 공유 이미지 URL:\", imageUrl);\n      \n      // 현재 페이지 URL\n      const currentUrl = window.location.href;\n      console.log(\"현재 URL:\", currentUrl);\n      \n      // 하드코딩으로 이름 지정 (카카오 캐싱 문제 해결용)\n      const companyName = \"이가이버 부동산\";\n      \n      // 더 간단한 템플릿 사용\n      window.Kakao.Share.sendDefault({\n        objectType: 'feed',\n        content: {\n          title: `[이가이버 부동산] ${property.title}`,\n          description: `${property.district} ${property.type} - ${formatPrice(property.price)}`,\n          imageUrl: 'https://www.ganghwa.go.kr/images/kr/sub/sub0305_img01.jpg',\n          link: {\n            mobileWebUrl: currentUrl,\n            webUrl: currentUrl\n          }\n        },\n        buttons: [\n          {\n            title: '매물 확인하기',\n            link: {\n              mobileWebUrl: currentUrl,\n              webUrl: currentUrl\n            }\n          }\n        ]\n      });\n      \n      console.log(\"카카오 공유 요청 성공\", {\n        siteName: companyName,\n        title: `[이가이버 부동산] ${property.title}`,\n        imageUrl: 'https://www.ganghwa.go.kr/images/kr/sub/sub0305_img01.jpg'\n      });\n    } catch (error) {\n      console.error(\"카카오 공유 중 오류 발생:\", error);\n      \n      // 사용자에게 오류 내용 알림 (한번만 표시)\n      toast({\n        title: \"카카오 공유 실패\",\n        description: \"클립보드에 정보를 복사합니다\",\n        variant: \"destructive\",\n      });\n      \n      // 오류 발생 시 항상 클립보드 복사로 대체\n      try {\n        const shareText = `[${siteConfig.siteName}] ${property.title}\\n${property.district} 위치 - ${property.type} - ${formatPrice(property.price)}\\n${window.location.href}`;\n        \n        navigator.clipboard.writeText(shareText)\n          .then(() => {\n            toast({\n              title: \"클립보드에 복사되었습니다\",\n              description: \"카카오톡에 붙여넣어 공유하세요\",\n            });\n          });\n      } catch (clipboardError) {\n        console.error(\"클립보드 복사도 실패:\", clipboardError);\n        toast({\n          title: \"공유 중 오류가 발생했습니다\",\n          description: \"공유 URL: \" + window.location.href,\n          variant: \"destructive\",\n        });\n      }\n    }\n  };\n  \n  // Property 데이터를 확장된 타입으로 캐스팅\n  const property = propertyData as Property | undefined;\n  \n  // 부동산 등록시 첨부한 이미지들을 사용\n  const defaultImage = \"https://via.placeholder.com/800x500?text=매물+이미지+준비중\";\n  \n  // 지도 관련 코드는 KakaoMap 컴포넌트로 이동했습니다.\n  \n  // imageUrls 배열이 있으면 사용하고, 없으면 기존 imageUrl을 배열로 변환\n  // 이미지가 하나도 없는 경우 기본 이미지 사용\n  const images = property ? (\n    Array.isArray(property.imageUrls) && property.imageUrls.length > 0 \n      ? property.imageUrls \n      : (property.imageUrl ? [property.imageUrl] : [defaultImage])\n  ) : [defaultImage];\n  \n  // 이미지 로딩 후 대표 이미지를 먼저 표시\n  useEffect(() => {\n    // 대표 이미지 표시\n    if (property && \n        typeof property.featuredImageIndex === 'number' && \n        Array.isArray(property.imageUrls) && \n        property.imageUrls[property.featuredImageIndex]) {\n      setCurrentImageIndex(property.featuredImageIndex);\n    }\n\n    // 카카오 SDK 초기화\n    if (property && window.Kakao && window.Kakao.isInitialized()) {\n      console.log(\"카카오 SDK가 이미 초기화되어 있습니다\");\n    } else if (property && window.Kakao && !window.Kakao.isInitialized()) {\n      console.log(\"카카오 SDK 초기화 시도\");\n      const key = window.kakaoKey || import.meta.env.VITE_KAKAO_API_KEY;\n      if (key) {\n        window.Kakao.init(key);\n        console.log(\"카카오 SDK 초기화 성공:\", window.Kakao.isInitialized());\n      }\n    }\n\n    // 지도는 이제 KakaoMap 컴포넌트에서 처리합니다.\n  }, [property]);\n  \n  // 위치 좌표 관련 코드는 KakaoMap 컴포넌트로 이동했습니다.\n\n  const nextImage = () => {\n    setCurrentImageIndex((prev) => (prev + 1) % images.length);\n  };\n\n  const prevImage = () => {\n    setCurrentImageIndex((prev) => (prev - 1 + images.length) % images.length);\n  };\n  \n  if (propertyLoading) {\n    return (\n      <div className=\"container mx-auto px-4 py-12\">\n        <div className=\"mb-8\">\n          <Skeleton className=\"h-8 w-2/3 mb-2\" />\n          <Skeleton className=\"h-4 w-1/3\" />\n        </div>\n        \n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n          <div className=\"lg:col-span-2\">\n            <Skeleton className=\"h-[400px] w-full rounded-lg mb-4\" />\n            <div className=\"grid grid-cols-4 gap-2\">\n              {[...Array(4)].map((_, i) => (\n                <Skeleton key={i} className=\"h-20 w-full rounded-md\" />\n              ))}\n            </div>\n            \n            <div className=\"mt-8\">\n              <Skeleton className=\"h-6 w-1/4 mb-4\" />\n              <Skeleton className=\"h-4 w-full mb-2\" />\n              <Skeleton className=\"h-4 w-full mb-2\" />\n              <Skeleton className=\"h-4 w-2/3\" />\n              \n              <div className=\"mt-6\">\n                <Skeleton className=\"h-6 w-1/4 mb-4\" />\n                <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n                  {[...Array(4)].map((_, i) => (\n                    <Skeleton key={i} className=\"h-12 w-full rounded-md\" />\n                  ))}\n                </div>\n              </div>\n            </div>\n          </div>\n          \n          <div>\n            <Skeleton className=\"h-[400px] w-full rounded-lg\" />\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  if (propertyError || !property) {\n    return (\n      <div className=\"container mx-auto px-4 py-12\">\n        <div className=\"bg-red-50 p-6 rounded-lg text-red-600\">\n          <h2 className=\"text-2xl font-bold mb-2\">매물을 찾을 수 없습니다</h2>\n          <p>요청하신 매물 정보를 불러오는 데 실패했습니다. 다시 시도해주세요.</p>\n          <Link href=\"/properties\">\n            <Button className=\"mt-4\">매물 목록으로 돌아가기</Button>\n          </Link>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"container mx-auto px-4 py-12\">\n      <div className=\"mb-8\">\n        <h1 className=\"text-3xl font-bold mb-2\">{property.title}</h1>\n        <div className=\"flex flex-wrap items-center gap-2 mb-3\">\n          {/* 부동산 유형 뱃지 */}\n          <Badge \n            className={`text-sm font-medium ${\n              property.type === \"아파트\" || property.type === \"아파트연립다세대\" ? \"bg-blue-500\" : \n              property.type === \"주택\" ? \"bg-green-600\" : \n              property.type === \"오피스텔\" || property.type === \"원투룸\" ? \"bg-purple-600\" : \n              property.type === \"빌라\" ? \"bg-orange-600\" : \n              property.type === \"상가공장창고펜션\" ? \"bg-yellow-600\" :\n              property.type === \"토지\" ? \"bg-emerald-600\" : \"bg-primary\"\n            }`}\n          >\n            {property.type}\n          </Badge>\n          \n          {/* 거래 유형 뱃지들 */}\n          {property.dealType && Array.isArray(property.dealType) && property.dealType.map((type, index) => (\n            <Badge \n              key={index}\n              className={`text-sm font-medium ${\n                type === \"매매\" ? \"bg-red-600\" : \n                type === \"전세\" ? \"bg-amber-600\" : \n                type === \"월세\" ? \"bg-indigo-600\" :\n                type === \"완료\" ? \"bg-gray-600\" :\n                type === \"보류중\" ? \"bg-pink-600\" : \"bg-secondary\"\n              }`}\n            >\n              {type}\n            </Badge>\n          ))}\n        </div>\n        <p className=\"text-gray-medium flex items-center text-base\">\n          <MapPin className=\"w-5 h-5 mr-1.5 text-primary\" /> \n          {/* 주소에서 지번 정보를 제외 - 대략적인 위치만 표시 */}\n          {property.district}\n        </p>\n      </div>\n      \n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\n        <div className=\"lg:col-span-2\">\n          {/* Main image gallery */}\n          <div className=\"relative aspect-[16/9] overflow-hidden rounded-lg mb-4 bg-gray-100\">\n            {images.length > 1 && (\n              <button \n                onClick={prevImage}\n                className=\"absolute left-2 top-1/2 -translate-y-1/2 bg-white/80 rounded-full p-2 z-10 shadow-sm\"\n              >\n                <ChevronLeft className=\"w-5 h-5\" />\n              </button>\n            )}\n            <img \n              src={images[currentImageIndex]} \n              alt={property.title} \n              className=\"w-full h-full object-cover\"\n            />\n            {images.length > 1 && (\n              <button \n                onClick={nextImage}\n                className=\"absolute right-2 top-1/2 -translate-y-1/2 bg-white/80 rounded-full p-2 z-10 shadow-sm\"\n              >\n                <ChevronRight className=\"w-5 h-5\" />\n              </button>\n            )}\n          </div>\n          \n          {images.length > 1 && (\n            <div className=\"grid grid-cols-4 gap-2\">\n              {images.map((image, index) => (\n                <button\n                  key={index}\n                  className={`aspect-[16/9] overflow-hidden rounded-md bg-gray-100 ${currentImageIndex === index ? 'ring-2 ring-primary' : 'ring-1 ring-gray-200'}`}\n                  onClick={() => setCurrentImageIndex(index)}\n                >\n                  <img \n                    src={image} \n                    alt={`${property.title} 이미지 ${index + 1}`} \n                    className=\"w-full h-full object-cover\"\n                  />\n                </button>\n              ))}\n            </div>\n          )}\n          \n          {/* 불필요한 박스 제거 */}\n          \n          <div className=\"mt-8\">\n            {/* 매물 설명은 매물 정보 상단에 표시하므로 여기서는 제거 */}\n            \n            <h3 className=\"text-xl font-bold mb-4\">주요 특징</h3>\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6\">\n              <div className=\"bg-primary/5 border border-primary/20 p-4 rounded-lg flex flex-col items-center shadow-sm\">\n                <Maximize className=\"text-primary mb-2 h-6 w-6\" />\n                <span className=\"font-bold text-lg\">{property.size}m²</span>\n                <span className=\"text-sm text-gray-600\">총면적</span>\n              </div>\n              <div className=\"bg-primary/5 border border-primary/20 p-4 rounded-lg flex flex-col items-center shadow-sm\">\n                <Bed className=\"text-primary mb-2 h-6 w-6\" />\n                <span className=\"font-bold text-lg\">{property.bedrooms}개</span>\n                <span className=\"text-sm text-gray-600\">침실</span>\n              </div>\n              <div className=\"bg-primary/5 border border-primary/20 p-4 rounded-lg flex flex-col items-center shadow-sm\">\n                <Bath className=\"text-primary mb-2 h-6 w-6\" />\n                <span className=\"font-bold text-lg\">{property.bathrooms}개</span>\n                <span className=\"text-sm text-gray-600\">욕실</span>\n              </div>\n              <div className=\"bg-primary/5 border border-primary/20 p-4 rounded-lg flex flex-col items-center shadow-sm\">\n                <Calendar className=\"text-primary mb-2 h-6 w-6\" />\n                <span className=\"font-bold text-lg\">{property.direction || \"남향\"}</span>\n                <span className=\"text-sm text-gray-600\">방향</span>\n              </div>\n            </div>\n            \n            {/* 상세 부동산 정보 표 */}\n            <div className=\"mt-8 mb-6\">\n              <h3 className=\"text-xl font-bold mb-4\">상세 정보</h3>\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-4\">\n                {/* 기본 정보 */}\n                <div className=\"space-y-4\">\n                  {(property.buildingName || property.unitNumber || property.approvalDate || property.type) && (\n                    <div className=\"border-b pb-2\">\n                      <h4 className=\"font-semibold text-lg mb-3\">기본 정보</h4>\n                      <table className=\"w-full\">\n                        <tbody>\n                        {property.buildingName && (\n                          <tr className=\"border-b border-gray-100\">\n                            <td className=\"py-2 text-gray-600 w-1/3\">건물명</td>\n                            <td className=\"py-2 font-medium\">{property.buildingName}</td>\n                          </tr>\n                        )}\n                        {property.unitNumber && (\n                          <tr className=\"border-b border-gray-100\">\n                            <td className=\"py-2 text-gray-600\">동호수</td>\n                            <td className=\"py-2 font-medium\">{property.unitNumber}</td>\n                          </tr>\n                        )}\n                        {/* 주소는 개인정보 보호를 위해 상세페이지에서 표시하지 않음 */}\n                        {property.approvalDate && (\n                          <tr className=\"border-b border-gray-100\">\n                            <td className=\"py-2 text-gray-600\">사용승인</td>\n                            <td className=\"py-2 font-medium\">{property.approvalDate}</td>\n                          </tr>\n                        )}\n                        {property.type && (\n                          <tr className=\"border-b border-gray-100\">\n                            <td className=\"py-2 text-gray-600\">유형</td>\n                            <td className=\"py-2 font-medium\">{property.type}</td>\n                          </tr>\n                        )}\n                      </tbody>\n                    </table>\n                  </div>\n                  )}\n\n                  {/* 면적 정보 - 정보가 있는 경우에만 표시 */}\n                  {(property.size || property.supplyArea || property.privateArea || property.areaSize) && (\n                    <div className=\"border-b pb-2\">\n                      <h4 className=\"font-semibold text-lg mb-3\">면적 정보</h4>\n                      <table className=\"w-full\">\n                        <tbody>\n                        {/* 총면적 - 기본 정보의 면적필드 사용 */}\n                        {property.size && (\n                          <tr className=\"border-b border-gray-100\">\n                            <td className=\"py-2 text-gray-600 w-1/3\">총면적</td>\n                            <td className=\"py-2 font-medium\">\n                              {`${property.size}m² (약 ${(Number(property.size) * 0.3025).toFixed(2)}평)`}\n                            </td>\n                          </tr>\n                        )}\n                        \n                        {/* 공급면적 - 상세정보의 공급필드 사용 */}\n                        {property.supplyArea && (\n                          <tr className=\"border-b border-gray-100\">\n                            <td className=\"py-2 text-gray-600 w-1/3\">공급면적</td>\n                            <td className=\"py-2 font-medium\">\n                              {`${property.supplyArea}m² (약 ${(Number(property.supplyArea) * 0.3025).toFixed(2)}평)`}\n                            </td>\n                          </tr>\n                        )}\n                        \n                        {/* 전용면적 - 상세정보의 전용필드 사용 */}\n                        {property.privateArea && (\n                          <tr className=\"border-b border-gray-100\">\n                            <td className=\"py-2 text-gray-600\">전용면적</td>\n                            <td className=\"py-2 font-medium\">\n                              {`${property.privateArea}m² (약 ${(Number(property.privateArea) * 0.3025).toFixed(2)}평)`}\n                            </td>\n                          </tr>\n                        )}\n                        \n                        {/* 평형 정보는 관리자 페이지의 평형 필드값만 사용 */}\n                        {property.areaSize && (\n                          <tr className=\"border-b border-gray-100\">\n                            <td className=\"py-2 text-gray-600\">평형</td>\n                            <td className=\"py-2 font-medium\">\n                              {`${property.areaSize}평형`}\n                            </td>\n                          </tr>\n                        )}\n                      </tbody>\n                    </table>\n                  </div>\n                  )}\n                </div>\n\n                {/* 건물 정보 - 정보가 있는 경우에만 표시 */}\n                <div className=\"space-y-4\">\n                  {(property.floor || property.totalFloors || property.bedrooms || property.bathrooms || \n                    property.direction || property.elevator !== undefined || property.parking || \n                    property.heatingSystem) && (\n                    <div className=\"border-b pb-2\">\n                      <h4 className=\"font-semibold text-lg mb-3\">건물 정보</h4>\n                      <table className=\"w-full\">\n                        <tbody>\n                        {property.floor && (\n                          <tr className=\"border-b border-gray-100\">\n                            <td className=\"py-2 text-gray-600 w-1/3\">해당 층</td>\n                            <td className=\"py-2 font-medium\">{property.floor}층</td>\n                          </tr>\n                        )}\n                        {property.totalFloors && (\n                          <tr className=\"border-b border-gray-100\">\n                            <td className=\"py-2 text-gray-600\">총 층수</td>\n                            <td className=\"py-2 font-medium\">{property.totalFloors}층</td>\n                          </tr>\n                        )}\n                        {(property.bedrooms !== undefined && property.bathrooms !== undefined) && (\n                          <tr className=\"border-b border-gray-100\">\n                            <td className=\"py-2 text-gray-600\">방 / 욕실</td>\n                            <td className=\"py-2 font-medium\">방 {property.bedrooms}개 / 욕실 {property.bathrooms}개</td>\n                          </tr>\n                        )}\n                        {property.direction && (\n                          <tr className=\"border-b border-gray-100\">\n                            <td className=\"py-2 text-gray-600\">방향</td>\n                            <td className=\"py-2 font-medium\">{property.direction}</td>\n                          </tr>\n                        )}\n                        {property.elevator !== undefined && (\n                          <tr className=\"border-b border-gray-100\">\n                            <td className=\"py-2 text-gray-600\">승강기</td>\n                            <td className=\"py-2 font-medium\">{property.elevator ? \"있음\" : \"없음\"}</td>\n                          </tr>\n                        )}\n                        {property.parking && (\n                          <tr className=\"border-b border-gray-100\">\n                            <td className=\"py-2 text-gray-600\">주차</td>\n                            <td className=\"py-2 font-medium\">{property.parking}</td>\n                          </tr>\n                        )}\n                        {property.heatingSystem && (\n                          <tr className=\"border-b border-gray-100\">\n                            <td className=\"py-2 text-gray-600\">난방</td>\n                            <td className=\"py-2 font-medium\">{property.heatingSystem}</td>\n                          </tr>\n                        )}\n                      </tbody>\n                    </table>\n                  </div>\n                  )}\n\n                  {/* 가격 정보 - 정보가 있는 경우에만 표시 */}\n                  {(property.price || property.deposit || property.monthlyRent || property.maintenanceFee) && (\n                    <div className=\"border-b pb-2\">\n                      <h4 className=\"font-semibold text-lg mb-3\">가격 정보</h4>\n                      <table className=\"w-full\">\n                        <tbody>\n                        {property.price && (\n                          <tr className=\"border-b border-gray-100\">\n                            <td className=\"py-2 text-gray-600 w-1/3\">매매가</td>\n                            <td className=\"py-2 font-medium\">{formatPrice(property.price)}</td>\n                          </tr>\n                        )}\n                        {property.deposit && Number(property.deposit) > 0 && (\n                          <tr className=\"border-b border-gray-100\">\n                            <td className=\"py-2 text-gray-600\">보증금</td>\n                            <td className=\"py-2 font-medium\">{formatPrice(property.deposit)}</td>\n                          </tr>\n                        )}\n                        {property.monthlyRent && Number(property.monthlyRent) > 0 && (\n                          <tr className=\"border-b border-gray-100\">\n                            <td className=\"py-2 text-gray-600\">월세</td>\n                            <td className=\"py-2 font-medium\">{formatPrice(property.monthlyRent)}</td>\n                          </tr>\n                        )}\n                        {property.maintenanceFee && Number(property.maintenanceFee) > 0 && (\n                          <tr className=\"border-b border-gray-100\">\n                            <td className=\"py-2 text-gray-600\">관리비</td>\n                            <td className=\"py-2 font-medium\">{formatPrice(property.maintenanceFee)}</td>\n                          </tr>\n                        )}\n                      </tbody>\n                    </table>\n                  </div>\n                  )}\n                </div>\n              </div>\n              \n              {/* 매물 설명 섹션 */}\n              {property.description && (\n                <div className=\"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg\">\n                  <h4 className=\"font-semibold text-lg mb-2\">매물 설명</h4>\n                  <p className=\"text-gray-700 whitespace-pre-line\">{property.description}</p>\n                </div>\n              )}\n              \n              {/* 특이사항 섹션 */}\n              {property.specialNote && (\n                <div className=\"mb-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg\">\n                  <h4 className=\"font-semibold text-lg mb-2\">매물 특이사항</h4>\n                  <p className=\"text-gray-700 whitespace-pre-line\">{property.specialNote}</p>\n                </div>\n              )}\n              \n              {/* 매물 문의게시판 - 매물 특이사항 아래로 이동 */}\n              <div className=\"mt-6\">\n                <h3 className=\"text-xl font-bold mb-4\">이 매물 문의게시판</h3>\n                <PropertyInquiryBoard propertyId={Number(propertyId)} />\n              </div>\n              \n              {/* 유튜브 영상 섹션 */}\n              {property.youtubeUrl && (\n                <div className=\"mt-6\">\n                  <h3 className=\"text-xl font-bold mb-4\">매물 영상</h3>\n                  <div className=\"relative w-full\" style={{ paddingBottom: '56.25%' }}>\n                    <iframe\n                      className=\"absolute top-0 left-0 w-full h-full rounded-lg\"\n                      src={getYoutubeEmbedUrl(property.youtubeUrl)}\n                      title=\"매물 영상\"\n                      frameBorder=\"0\"\n                      allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\"\n                      allowFullScreen\n                    />\n                  </div>\n                </div>\n              )}\n              \n              {/* 매물 상세 설명 필드 복원 - 특이사항 위에 배치 */}\n            </div>\n          </div>\n        </div>\n        \n        <div>\n          <div className=\"bg-gray-50 rounded-lg p-6 border border-gray-200 mb-4\">\n            <h3 className=\"text-xl font-semibold mb-2\">위치 정보</h3>\n            <p className=\"text-gray-700\">\n              <MapPin className=\"inline-block w-4 h-4 mr-1 text-primary\" />\n              {property.district}\n            </p>\n          </div>\n          \n          {/* 위치 정보 표시 - 카카오 지도 사용 (KakaoMap 컴포넌트로 대체) */}\n          <div className=\"bg-gray-50 rounded-lg overflow-hidden h-64 mb-4\">\n            <div className=\"w-full h-full relative\">\n              {/* KakaoMap 컴포넌트 (단일 매물 모드) */}\n              {property && (\n                <KakaoMap \n                  singleProperty={property} \n                  zoom={3} \n                />\n              )}\n            </div>\n          </div>\n          \n          <div className=\"bg-gray-50 rounded-lg p-6 border border-gray-200\">\n            <h3 className=\"text-xl font-semibold mb-4\">거래 정보</h3>\n            <div className=\"space-y-4\">\n              <div>\n                <span className=\"text-gray-500 text-sm\">매물 가격</span>\n                <div className=\"text-2xl font-bold text-primary mt-1\">{formatPrice(property.price)}</div>\n              </div>\n              {property.dealType && Array.isArray(property.dealType) && property.dealType.includes(\"월세\") && property.monthlyRent && (\n                <div>\n                  <span className=\"text-gray-500 text-sm\">월세</span>\n                  <div className=\"text-xl font-bold mt-1\">{formatPrice(property.monthlyRent)}</div>\n                </div>\n              )}\n              {property.maintenanceFee && (\n                <div>\n                  <span className=\"text-gray-500 text-sm\">관리비</span>\n                  <div className=\"text-lg font-medium mt-1\">{formatPrice(property.maintenanceFee)}</div>\n                </div>\n              )}\n              \n              {property.deposit && (\n                <div>\n                  <span className=\"text-gray-500 text-sm\">보증금</span>\n                  <div className=\"text-lg font-medium mt-1\">{formatPrice(property.deposit)}</div>\n                </div>\n              )}\n              \n              <div className=\"pt-4 mt-4 border-t border-gray-200\">\n                {/* 카카오톡 문의 이미지 */}\n                <div className=\"w-full mb-2 cursor-pointer\">\n                  <img \n                    src={kakaoImage} \n                    alt=\"카카오톡으로 문의하기\" \n                    className=\"w-full h-auto rounded-lg border border-[#FEE500] hover:opacity-90 transition-opacity\"\n                    onClick={() => window.open(\"http://pf.kakao.com/_xaxbxlxfs/chat\", \"_blank\")}\n                  />\n                </div>\n                \n                <div className=\"flex flex-col space-y-2\">\n                  <Button \n                    variant={favoriteData?.isFavorite ? \"secondary\" : \"outline\"} \n                    className=\"w-full relative\"\n                    onClick={toggleFavorite}\n                    disabled={addFavoriteMutation.isPending || removeFavoriteMutation.isPending}\n                  >\n                    <Heart \n                      className={`w-4 h-4 mr-2 ${favoriteData?.isFavorite ? 'text-red-500 fill-red-500' : ''}`} \n                    />\n                    {favoriteData?.isFavorite ? '관심매물 등록됨' : '관심매물'}\n                  </Button>\n                  \n                  {/* 공유 버튼 */}\n                  <Button \n                    variant=\"outline\" \n                    className=\"w-full bg-yellow-50 hover:bg-yellow-100 text-yellow-900 border-yellow-300 relative pl-10\"\n                    onClick={() => handleShareClick()}\n                  >\n                    <div className=\"absolute left-2 top-1/2 transform -translate-y-1/2 w-6 h-6 flex items-center justify-center\">\n                      <svg width=\"22\" height=\"20\" viewBox=\"0 0 256 256\" xmlns=\"http://www.w3.org/2000/svg\">\n                        <path fill=\"#FFE812\" d=\"M128 36.108C57.655 36.108 0 80.783 0 135.993c0 34.742 23.34 65.333 58.572 83.97c-2.564 9.503-9.247 34.391-10.577 39.688c-1.652 6.531 2.407 6.451 5.063 4.693c2.097-1.387 33.289-22.525 46.723-31.673c9.141 1.323 18.638 2.022 28.22 2.022c70.345 0 128-44.675 128-99.885c0-55.21-57.655-99.885-128-99.885\"/>\n                        <path fill=\"#381F1F\" d=\"M70.318 146.234c-3.993 0-7.241-3.248-7.241-7.241V113.95c0-3.993 3.248-7.241 7.241-7.241c3.993 0 7.241 3.248 7.241 7.241v25.043c0 3.993-3.248 7.241-7.241 7.241zm33.507 0c-3.993 0-7.241-3.248-7.241-7.241V113.95c0-3.993 3.248-7.241 7.241-7.241c3.993 0 7.241 3.248 7.241 7.241v25.043c0 3.993-3.248 7.241-7.241 7.241zm33.507 0c-3.993 0-7.241-3.248-7.241-7.241V113.95c0-3.992 3.248-7.241 7.241-7.241c3.993 0 7.241 3.249 7.241 7.241v25.043c0 3.993-3.248 7.241-7.241 7.241zm33.508 0c-3.993 0-7.241-3.248-7.241-7.241V113.95c0-3.992 3.248-7.241 7.241-7.241c3.993 0 7.241 3.249 7.241 7.241v25.043c0 3.993-3.248 7.241-7.241 7.241z\"/>\n                      </svg>\n                    </div>\n                    친구에게 공유하기\n                  </Button>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default PropertyDetail;","path":null,"size_bytes":37253,"size_tokens":null},"client/src/components/ui/avatar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as AvatarPrimitive from \"@radix-ui/react-avatar\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Avatar = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatar.displayName = AvatarPrimitive.Root.displayName\n\nconst AvatarImage = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Image>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Image\n    ref={ref}\n    className={cn(\"aspect-square h-full w-full\", className)}\n    {...props}\n  />\n))\nAvatarImage.displayName = AvatarPrimitive.Image.displayName\n\nconst AvatarFallback = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Fallback>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Fallback\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName\n\nexport { Avatar, AvatarImage, AvatarFallback }\n","path":null,"size_bytes":1419,"size_tokens":null},"client/src/components/ui/scroll-area.tsx":{"content":"import * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}\n  >\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}\n  >\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n","path":null,"size_bytes":1642,"size_tokens":null},"client/src/components/ui/input.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n","path":null,"size_bytes":791,"size_tokens":null},"client/src/components/property/PropertyCard.tsx":{"content":"import { Link } from \"wouter\";\nimport { Heart, Maximize, Bed, Bath, Loader2 } from \"lucide-react\";\nimport { type Property } from \"@shared/schema\";\nimport { Card } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { cn } from \"@/lib/utils\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useAuth } from \"@/hooks/use-auth\";\n\ninterface PropertyCardProps {\n  property: Property;\n}\n\nconst formatPrice = (price: string | number) => {\n  const numPrice = Number(price);\n  if (numPrice >= 100000000) {\n    return `${(numPrice / 100000000).toFixed(2)}억 원`;\n  } else if (numPrice >= 10000) {\n    return `${(numPrice / 10000).toFixed(2)}만원`;\n  }\n  return numPrice.toLocaleString() + '원';\n};\n\nconst PropertyCard = ({ property }: PropertyCardProps) => {\n  const { toast } = useToast();\n  const { user } = useAuth();\n  const queryClient = useQueryClient();\n  \n  // 관심매물 상태 조회\n  const { data: favoriteData, isLoading: favoriteLoading } = useQuery<{ isFavorite: boolean }>({\n    queryKey: [`/api/properties/${property.id}/is-favorite`],\n    enabled: !!property.id && !!user, // 사용자가 로그인한 경우에만 쿼리 실행\n  });\n  \n  // 관심매물 추가 mutation\n  const addFavoriteMutation = useMutation({\n    mutationFn: async () => {\n      const res = await apiRequest(\"POST\", \"/api/favorites\", { propertyId: Number(property.id) });\n      return await res.json();\n    },\n    onSuccess: () => {\n      toast({\n        title: \"관심매물 등록\",\n        description: \"관심매물로 등록되었습니다.\",\n      });\n      // 관심매물 상태 업데이트\n      queryClient.invalidateQueries({ queryKey: [`/api/properties/${property.id}/is-favorite`] });\n      queryClient.invalidateQueries({ queryKey: ['/api/favorites'] });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"관심매물 등록 실패\",\n        description: \"관심매물 등록 중 오류가 발생했습니다.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n  \n  // 관심매물 삭제 mutation\n  const removeFavoriteMutation = useMutation({\n    mutationFn: async () => {\n      const res = await apiRequest(\"DELETE\", `/api/favorites/${property.id}`);\n      return await res.json();\n    },\n    onSuccess: () => {\n      toast({\n        title: \"관심매물 삭제\",\n        description: \"관심매물에서 삭제되었습니다.\",\n      });\n      // 관심매물 상태 업데이트\n      queryClient.invalidateQueries({ queryKey: [`/api/properties/${property.id}/is-favorite`] });\n      queryClient.invalidateQueries({ queryKey: ['/api/favorites'] });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"관심매물 삭제 실패\",\n        description: \"관심매물 삭제 중 오류가 발생했습니다.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n  \n  // 관심매물 토글 함수\n  const toggleFavorite = () => {\n    if (!user) {\n      toast({\n        title: \"로그인 필요\",\n        description: \"관심매물 기능은 로그인이 필요합니다.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    \n    if (favoriteData?.isFavorite) {\n      removeFavoriteMutation.mutate();\n    } else {\n      addFavoriteMutation.mutate();\n    }\n  };\n  \n  return (\n    <Card className=\"bg-white rounded-lg overflow-hidden shadow-md hover:shadow-lg transition group\">\n      <div className=\"relative aspect-[16/9] overflow-hidden\">\n        {/* 부동산 유형 표시 */}\n        <Badge \n          className={cn(\n            \"absolute top-3 left-3 z-10 font-medium text-sm\",\n            property.type === \"아파트\" || property.type === \"아파트연립다세대\" ? \"bg-blue-500\" : \n            property.type === \"주택\" ? \"bg-green-600\" : \n            property.type === \"오피스텔\" || property.type === \"원투룸\" ? \"bg-purple-600\" : \n            property.type === \"빌라\" ? \"bg-orange-600\" : \n            property.type === \"상가공장창고펜션\" ? \"bg-yellow-600\" :\n            property.type === \"토지\" ? \"bg-emerald-600\" : \"bg-primary\"\n          )}\n        >\n          {property.type}\n        </Badge>\n        \n        {/* 거래 유형 표시: 모든 거래유형 (매매/전세/월세 등) */}\n        <div className=\"absolute top-3 right-3 z-10 flex flex-wrap gap-1 justify-end\">\n          {property.dealType && Array.isArray(property.dealType) && property.dealType.map((type, index) => (\n            <Badge \n              key={index}\n              className={cn(\n                \"font-medium text-sm\",\n                type === \"매매\" ? \"bg-red-600\" : \n                type === \"전세\" ? \"bg-amber-600\" : \n                type === \"월세\" ? \"bg-indigo-600\" :\n                type === \"완료\" ? \"bg-gray-600\" :\n                type === \"보류중\" ? \"bg-pink-606\" : \"bg-secondary\"\n              )}\n            >\n              {type}\n            </Badge>\n          ))}\n        </div>\n        \n        <img \n          src={property.imageUrl} \n          alt={property.title} \n          className=\"w-full h-full object-cover group-hover:scale-105 transition duration-300\"\n        />\n      </div>\n      <div className=\"p-6\">\n        <Link href={`/properties/${property.id}`}>\n          <h3 className=\"text-xl font-bold mb-1 hover:text-primary transition-colors cursor-pointer line-clamp-1\">\n            {property.title}\n          </h3>\n        </Link>\n        <p className=\"flex items-center text-gray-500 text-sm mb-4\">\n          <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-4 w-4 mr-1\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n            <path d=\"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z\"></path>\n            <circle cx=\"12\" cy=\"10\" r=\"3\"></circle>\n          </svg>\n          {property.district}\n        </p>\n        <div className=\"flex items-center justify-between mb-4 p-2 bg-gray-50 rounded-md\">\n          <span className=\"flex items-center text-sm font-medium\">\n            <Maximize className=\"w-4 h-4 mr-1 text-primary\" /> \n            <span>\n              {property.size \n                ? `${property.size}m² (약 ${(Number(property.size) * 0.3025).toFixed(1)}평)` \n                : '정보 없음'}\n            </span>\n          </span>\n          <span className=\"flex items-center text-sm font-medium\">\n            <Bed className=\"w-4 h-4 mr-1 text-primary\" /> \n            <span>{property.bedrooms}개</span>\n          </span>\n          <span className=\"flex items-center text-sm font-medium\">\n            <Bath className=\"w-4 h-4 mr-1 text-primary\" /> \n            <span>{property.bathrooms}개</span>\n          </span>\n        </div>\n        <div className=\"flex justify-between items-center\">\n          <div>\n            <div className=\"flex flex-wrap items-center gap-2 mb-1\">\n              <Badge variant=\"outline\" className=\"text-xs font-medium px-2 py-0 border-primary text-primary\">\n                {property.type}\n              </Badge>\n              {property.dealType && Array.isArray(property.dealType) && property.dealType.map((type, index) => (\n                <Badge \n                  key={index}\n                  variant=\"outline\"\n                  className={cn(\n                    \"text-xs font-medium px-2 py-0\",\n                    type === \"매매\" ? \"border-red-500 text-red-500\" : \n                    type === \"전세\" ? \"border-amber-500 text-amber-500\" : \n                    type === \"월세\" ? \"border-indigo-500 text-indigo-500\" :\n                    type === \"완료\" ? \"border-gray-500 text-gray-500\" :\n                    type === \"보류중\" ? \"border-pink-500 text-pink-500\" :\n                    \"border-secondary text-secondary\"\n                  )}\n                >\n                  {type}\n                </Badge>\n              ))}\n            </div>\n            <span className=\"text-xl font-bold text-primary\">{formatPrice(property.price)}</span>\n          </div>\n          <button \n            className={cn(\n              \"flex items-center justify-center w-8 h-8 rounded-full transition-colors\",\n              favoriteLoading && \"opacity-50 cursor-not-allowed\",\n              favoriteData?.isFavorite\n                ? \"text-red-500 hover:text-red-600\"\n                : \"text-gray-400 hover:text-red-500\"\n            )}\n            onClick={toggleFavorite}\n            disabled={favoriteLoading || addFavoriteMutation.isPending || removeFavoriteMutation.isPending}\n            aria-label={favoriteData?.isFavorite ? \"관심매물 삭제\" : \"관심매물 추가\"}\n          >\n            {favoriteLoading || addFavoriteMutation.isPending || removeFavoriteMutation.isPending ? (\n              <Loader2 className=\"w-5 h-5 animate-spin\" />\n            ) : (\n              <Heart \n                className={cn(\n                  \"w-5 h-5\", \n                  favoriteData?.isFavorite && \"fill-current\"\n                )}\n              />\n            )}\n          </button>\n        </div>\n      </div>\n    </Card>\n  );\n};\n\nexport default PropertyCard;\n","path":null,"size_bytes":9161,"size_tokens":null},"client/src/components/ui/custom-modal.tsx":{"content":"import React, { useEffect, useState } from 'react';\n\ninterface ModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  children: React.ReactNode;\n  title?: string;\n}\n\nexport function CustomModal({ isOpen, onClose, children, title }: ModalProps) {\n  const [isMounted, setIsMounted] = useState(false);\n\n  useEffect(() => {\n    setIsMounted(true);\n    return () => setIsMounted(false);\n  }, []);\n\n  useEffect(() => {\n    // 모달이 열렸을 때 body에 스크롤 방지\n    if (isOpen) {\n      document.body.style.overflow = 'hidden';\n    } else {\n      document.body.style.overflow = 'auto';\n    }\n\n    // 컴포넌트 언마운트 시 원래대로 복원\n    return () => {\n      document.body.style.overflow = 'auto';\n    };\n  }, [isOpen]);\n\n  // ESC 키로 모달 닫기\n  useEffect(() => {\n    const handleEsc = (e: KeyboardEvent) => {\n      if (e.key === 'Escape' && isOpen) {\n        onClose();\n      }\n    };\n    window.addEventListener('keydown', handleEsc);\n    return () => window.removeEventListener('keydown', handleEsc);\n  }, [isOpen, onClose]);\n\n  // 백그라운드 클릭 시 모달 닫기\n  const handleBackdropClick = (e: React.MouseEvent<HTMLDivElement>) => {\n    if (e.target === e.currentTarget) {\n      onClose();\n    }\n  };\n\n  if (!isMounted || !isOpen) return null;\n\n  return (\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center\">\n      <div \n        className=\"absolute inset-0 bg-black bg-opacity-50\" \n        onClick={handleBackdropClick}\n      ></div>\n      <div className=\"relative z-10 bg-white rounded-lg shadow-lg max-w-3xl max-h-[90vh] overflow-auto\">\n        {title && (\n          <div className=\"p-4 border-b\">\n            <h2 className=\"text-xl font-semibold\">{title}</h2>\n          </div>\n        )}\n        <div className=\"p-4\">\n          {children}\n        </div>\n      </div>\n    </div>\n  );\n}","path":null,"size_bytes":1856,"size_tokens":null},"client/src/components/home/HomeMap.tsx":{"content":"import KakaoMap from '@/components/map/KakaoMap';\nimport { MapIcon } from 'lucide-react';\n\nconst HomeMap = () => {\n  return (\n    <div className=\"relative\">\n      {/* 지도 제목 */}\n      <div className=\"mb-3 flex items-center\">\n        <MapIcon className=\"h-5 w-5 mr-2 text-primary\" />\n        <h2 className=\"text-lg font-bold\">지도로 부동산찾기</h2>\n      </div>\n      \n      {/* 지도 높이 조절 */}\n      <div className=\"h-[50vh] w-full rounded-lg overflow-hidden\">\n        <KakaoMap />\n      </div>\n    </div>\n  );\n};\n\nexport default HomeMap;","path":null,"size_bytes":562,"size_tokens":null},"client/src/components/contact/ContactForm.tsx":{"content":"import { useState } from \"react\";\nimport { z } from \"zod\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { insertInquirySchema } from \"@shared/schema\";\nimport {\n  Form,\n  FormControl,\n  FormField,\n  FormItem,\n  FormLabel,\n  FormMessage,\n} from \"@/components/ui/form\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { Button } from \"@/components/ui/button\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { toast } from \"@/hooks/use-toast\";\n\ninterface ContactFormProps {\n  propertyId?: number;\n}\n\nconst formSchema = insertInquirySchema.extend({\n  agreeToTerms: z.boolean().refine(val => val === true, {\n    message: \"개인정보 수집 및 이용에 동의해야 합니다.\"\n  })\n});\n\ntype FormValues = z.infer<typeof formSchema>;\n\nconst ContactForm = ({ propertyId }: ContactFormProps) => {\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  \n  const form = useForm<FormValues>({\n    resolver: zodResolver(formSchema),\n    defaultValues: {\n      name: \"\",\n      email: \"\",\n      phone: \"\",\n      message: \"\",\n      inquiryType: \"매물 구매 문의\",\n      propertyId: propertyId,\n      agreeToTerms: false\n    },\n  });\n  \n  const mutation = useMutation({\n    mutationFn: (values: Omit<FormValues, \"agreeToTerms\">) => {\n      return apiRequest(\"POST\", \"/api/inquiries\", values);\n    },\n    onSuccess: async () => {\n      toast({\n        title: \"문의가 성공적으로 접수되었습니다\",\n        description: \"빠른 시일 내에 연락드리겠습니다.\",\n      });\n      form.reset();\n    },\n    onError: (error) => {\n      toast({\n        title: \"문의 접수 실패\",\n        description: \"문의 접수 중 오류가 발생했습니다. 다시 시도해주세요.\",\n        variant: \"destructive\",\n      });\n      console.error(\"Form submission error:\", error);\n    }\n  });\n  \n  const onSubmit = (data: FormValues) => {\n    setIsSubmitting(true);\n    \n    // Remove agreeToTerms as it's not part of the inquiry schema\n    const { agreeToTerms, ...inquiryData } = data;\n    \n    mutation.mutate(inquiryData);\n    setIsSubmitting(false);\n  };\n\n  return (\n    <Form {...form}>\n      <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n          <FormField\n            control={form.control}\n            name=\"name\"\n            render={({ field }) => (\n              <FormItem>\n                <FormLabel>이름 *</FormLabel>\n                <FormControl>\n                  <Input placeholder=\"이름을 입력하세요\" {...field} />\n                </FormControl>\n                <FormMessage />\n              </FormItem>\n            )}\n          />\n          \n          <FormField\n            control={form.control}\n            name=\"phone\"\n            render={({ field }) => (\n              <FormItem>\n                <FormLabel>연락처 *</FormLabel>\n                <FormControl>\n                  <Input placeholder=\"연락처를 입력하세요\" {...field} />\n                </FormControl>\n                <FormMessage />\n              </FormItem>\n            )}\n          />\n        </div>\n        \n        <FormField\n          control={form.control}\n          name=\"email\"\n          render={({ field }) => (\n            <FormItem>\n              <FormLabel>이메일 *</FormLabel>\n              <FormControl>\n                <Input placeholder=\"이메일을 입력하세요\" {...field} />\n              </FormControl>\n              <FormMessage />\n            </FormItem>\n          )}\n        />\n        \n        <FormField\n          control={form.control}\n          name=\"inquiryType\"\n          render={({ field }) => (\n            <FormItem>\n              <FormLabel>문의 유형</FormLabel>\n              <Select onValueChange={field.onChange} defaultValue={field.value}>\n                <FormControl>\n                  <SelectTrigger>\n                    <SelectValue placeholder=\"문의 유형을 선택하세요\" />\n                  </SelectTrigger>\n                </FormControl>\n                <SelectContent>\n                  <SelectItem value=\"매물 구매 문의\">매물 구매 문의</SelectItem>\n                  <SelectItem value=\"매물 판매 문의\">매물 판매 문의</SelectItem>\n                  <SelectItem value=\"임대 문의\">임대 문의</SelectItem>\n                  <SelectItem value=\"기타 문의\">기타 문의</SelectItem>\n                </SelectContent>\n              </Select>\n              <FormMessage />\n            </FormItem>\n          )}\n        />\n        \n        <FormField\n          control={form.control}\n          name=\"message\"\n          render={({ field }) => (\n            <FormItem>\n              <FormLabel>문의 내용 *</FormLabel>\n              <FormControl>\n                <Textarea \n                  placeholder=\"문의 내용을 자세히 입력해 주세요\" \n                  rows={5} \n                  {...field} \n                />\n              </FormControl>\n              <FormMessage />\n            </FormItem>\n          )}\n        />\n        \n        <FormField\n          control={form.control}\n          name=\"agreeToTerms\"\n          render={({ field }) => (\n            <FormItem className=\"flex flex-row items-start space-x-3 space-y-0\">\n              <FormControl>\n                <Checkbox\n                  checked={field.value}\n                  onCheckedChange={field.onChange}\n                />\n              </FormControl>\n              <div className=\"space-y-1 leading-none\">\n                <FormLabel>\n                  개인정보 수집 및 이용에 동의합니다. 수집된 정보는 문의 답변 목적으로만 사용됩니다.\n                </FormLabel>\n                <FormMessage />\n              </div>\n            </FormItem>\n          )}\n        />\n        \n        <Button \n          type=\"submit\" \n          className=\"w-full bg-primary hover:bg-secondary\"\n          disabled={isSubmitting}\n        >\n          {isSubmitting ? \"제출 중...\" : \"문의하기\"}\n        </Button>\n      </form>\n    </Form>\n  );\n};\n\nexport default ContactForm;\n","path":null,"size_bytes":6422,"size_tokens":null},"client/src/pages/admin-page.tsx":{"content":"import { useState } from \"react\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { getQueryFn, apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Property, User, News, insertPropertySchema } from \"@shared/schema\";\nimport { InlinePropertyForm } from \"@/components/admin/InlinePropertyForm\";\nimport * as z from \"zod\";\n\ntype PropertyFormValues = z.infer<typeof insertPropertySchema>;\n\nimport {\n  Table,\n  TableBody,\n  TableCaption,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from \"@/components/ui/table\";\nimport {\n  Card,\n  CardContent,\n  CardDescription,\n  CardHeader,\n  CardTitle,\n} from \"@/components/ui/card\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport {\n  Breadcrumb,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  BreadcrumbList,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n} from \"@/components/ui/breadcrumb\";\nimport { Loader2, Home, Plus, Trash2, Edit, Check } from \"lucide-react\";\n\n\n\n// 읍면 \nconst districts = [\n  \"강화읍\", \"교동면\", \"길상면\", \"내가면\", \"불은면\", \"삼산면\", \"서도면\", \"선원면\", \n  \"송해면\", \"양도면\", \"양사면\", \"하점면\", \"화도면\", \"강화외지역\"\n];\n\n// 읍면동 세부 카테고리\ninterface DetailedDistrictsType {\n  [key: string]: string[];\n}\n\nconst detailedDistricts: DetailedDistrictsType = {\n  \"강화읍\": [\"강화읍 갑곳리\", \"강화읍 관청리\", \"강화읍 국화리\", \"강화읍 남산리\", \"강화읍 대산리\", \"강화읍 신문리\", \"강화읍 옥림리\", \"강화읍 용정리\", \"강화읍 월곳리\"],\n  \"교동면\": [\"교동면 고구리\", \"교동면 난정리\", \"교동면 대룡리\", \"교동면 동산리\", \"교동면 무학리\", \"교동면 봉소리\", \"교동면 삼선리\", \"교동면 상용리\", \"교동면 서한리\", \"교동면 양갑리\", \"교동면 읍내리\", \"교동면 인사리\", \"교동면 지석리\"],\n  \"길상면\": [\"길상면 길직리\", \"길상면 동검리\", \"길상면 선두리\", \"길상면 온수리\", \"길상면 장흥리\", \"길상면 초지리\"],\n  \"내가면\": [\"내가면 고천리\", \"내가면 구하리\", \"내가면 오상리\", \"내가면 외포리\", \"내가면 황청리\"],\n  \"불은면\": [\"불은면 고능리\", \"불은면 넙성리\", \"불은면 덕성리\", \"불은면 두운리\", \"불은면 삼동암리\", \"불은면 삼성리\", \"불은면 신현리\", \"불은면 오두리\"],\n  \"삼산면\": [\"삼산면 매음리\", \"삼산면 미법리\", \"삼산면 상리\", \"삼산면 서검리\", \"삼산면 석모리\", \"삼산면 석포리\", \"삼산면 하리\"],\n  \"서도면\": [\"서도면 말도리\", \"서도면 볼음도리\", \"서도면 아차도리\", \"서도면 주문도리\"],\n  \"선원면\": [\"선원면 금월리\", \"선원면 냉정리\", \"선원면 선행리\", \"선원면 신정리\", \"선원면 연리\", \"선원면 지산리\", \"선원면 창리\"],\n  \"송해면\": [\"송해면 당산리\", \"송해면 상도리\", \"송해면 솔정리\", \"송해면 숭뢰리\", \"송해면 신당리\", \"송해면 양오리\", \"송해면 하도리\"],\n  \"양도면\": [\"양도면 건평리\", \"양도면 길정리\", \"양도면 능내리\", \"양도면 도장리\", \"양도면 삼흥리\", \"양도면 인산리\", \"양도면 조산리\", \"양도면 하일리\"],\n  \"양사면\": [\"양사면 교산리\", \"양사면 덕하리\", \"양사면 북성리\", \"양사면 인화리\", \"양사면 철산리\"],\n  \"하점면\": [\"하점면 망월리\", \"하점면 부근리\", \"하점면 삼거리\", \"하점면 신봉리\", \"하점면 신삼리\", \"하점면 이강리\", \"하점면 장정리\", \"하점면 창후리\"],\n  \"화도면\": [\"화도면 내리\", \"화도면 덕포리\", \"화도면 동막리\", \"화도면 문산리\", \"화도면 사기리\", \"화도면 상방리\", \"화도면 여차리\", \"화도면 장화리\", \"화도면 흥왕리\"],\n  \"강화외지역\": [\"기타지역\"]\n};\n\n\n\nexport default function AdminPage() {\n  const { user: currentUser } = useAuth();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [activeTab, setActiveTab] = useState(\"properties\");\n  const [openPropertyDialog, setOpenPropertyDialog] = useState(false);\n  const [editingProperty, setEditingProperty] = useState<Property | null>(null);\n  const [isDeleting, setIsDeleting] = useState<number | false>(false);\n  const [isDeletingUser, setIsDeletingUser] = useState<number | false>(false);\n  const [isDeletingNews, setIsDeletingNews] = useState<number | false>(false);\n  const [selectedMainDistrict, setSelectedMainDistrict] = useState(\"강화읍\");\n  const [detailedDistrictOptions, setDetailedDistrictOptions] = useState<string[]>(detailedDistricts[\"강화읍\"]);\n  \n\n\n  // 부동산 목록 조회\n  const {\n    data: properties,\n    isLoading: isLoadingProperties,\n    error: propertiesError,\n    refetch: refetchProperties,\n  } = useQuery<Property[]>({\n    queryKey: [\"/api/properties?skipCache=true\"],\n    queryFn: getQueryFn({ on401: \"throw\" }),\n  });\n\n  // 사용자 목록 조회 (관리자만)\n  const {\n    data: users,\n    isLoading: isLoadingUsers,\n    error: usersError,\n  } = useQuery<User[]>({\n    queryKey: [\"/api/admin/users\"],\n    queryFn: getQueryFn({ on401: \"throw\" }),\n    enabled: currentUser?.role === \"admin\",\n  });\n  \n  // 뉴스 목록 조회\n  const {\n    data: news,\n    isLoading: isLoadingNews,\n    error: newsError,\n  } = useQuery<News[]>({\n    queryKey: [\"/api/news\"],\n    queryFn: getQueryFn({ on401: \"throw\" }),\n  });\n\n  // 부동산 생성 뮤테이션\n  const createPropertyMutation = useMutation({\n    mutationFn: async (data: PropertyFormValues) => {\n      const res = await apiRequest(\"POST\", \"/api/properties\", data);\n      if (!res.ok) {\n        const errorData = await res.json();\n        throw new Error(errorData.message || \"부동산 등록에 실패했습니다\");\n      }\n      return await res.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/properties\"] });\n      toast({\n        title: \"부동산 등록 성공\",\n        description: \"새로운 부동산이 등록되었습니다.\",\n      });\n      setOpenPropertyDialog(false);\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"부동산 등록 실패\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // 부동산 수정 뮤테이션\n  const updatePropertyMutation = useMutation({\n    mutationFn: async ({\n      id,\n      data,\n    }: {\n      id: number;\n      data: PropertyFormValues;\n    }) => {\n      const res = await apiRequest(\"PATCH\", `/api/properties/${id}`, data);\n      if (!res.ok) {\n        const errorData = await res.json();\n        throw new Error(errorData.message || \"부동산 수정에 실패했습니다\");\n      }\n      return await res.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/properties\"] });\n      toast({\n        title: \"부동산 수정 성공\",\n        description: \"부동산 정보가 수정되었습니다.\",\n      });\n      setOpenPropertyDialog(false);\n      setEditingProperty(null);\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"부동산 수정 실패\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // 부동산 삭제 뮤테이션\n  const deletePropertyMutation = useMutation({\n    mutationFn: async (id: number) => {\n      setIsDeleting(id);\n      const res = await apiRequest(\"DELETE\", `/api/properties/${id}`);\n      if (!res.ok) {\n        const errorData = await res.json();\n        throw new Error(errorData.message || \"부동산 삭제에 실패했습니다\");\n      }\n      return await res.json();\n    },\n    onSuccess: () => {\n      // 먼저 모든 캐시 무효화\n      queryClient.invalidateQueries({ queryKey: [\"/api/properties\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/properties?skipCache=true\"] });\n      \n      // 그리고 즉시 최신 데이터 가져오기\n      setTimeout(() => {\n        refetchProperties();\n      }, 100); // 약간의 지연 시간으로 서버 측에서 캐시가 업데이트될 시간을 줌\n      \n      toast({\n        title: \"부동산 삭제 성공\",\n        description: \"부동산이 삭제되었습니다.\",\n      });\n      setIsDeleting(false);\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"부동산 삭제 실패\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n      setIsDeleting(false);\n    },\n  });\n  \n  // 사용자 삭제 뮤테이션\n  const deleteUserMutation = useMutation({\n    mutationFn: async (id: number) => {\n      setIsDeletingUser(id);\n      const res = await apiRequest(\"DELETE\", `/api/admin/users/${id}`);\n      if (!res.ok) {\n        const errorData = await res.json();\n        throw new Error(errorData.message || \"사용자 삭제에 실패했습니다\");\n      }\n      return await res.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/users\"] });\n      toast({\n        title: \"사용자 삭제 성공\",\n        description: \"사용자가 성공적으로 삭제되었습니다.\",\n      });\n      setIsDeletingUser(false);\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"사용자 삭제 실패\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n      setIsDeletingUser(false);\n    },\n  });\n\n  // 뉴스 삭제 뮤테이션\n  const deleteNewsMutation = useMutation({\n    mutationFn: async (id: number) => {\n      setIsDeletingNews(id);\n      const res = await apiRequest(\"DELETE\", `/api/news/${id}`);\n      if (!res.ok) {\n        const errorData = await res.json();\n        throw new Error(errorData.message || \"뉴스 삭제에 실패했습니다\");\n      }\n      return await res.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/news\"] });\n      toast({\n        title: \"뉴스 삭제 성공\",\n        description: \"뉴스가 성공적으로 삭제되었습니다.\",\n      });\n      setIsDeletingNews(false);\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"뉴스 삭제 실패\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n      setIsDeletingNews(false);\n    },\n  });\n\n  // 부동산 삭제 핸들러\n  const handleDeleteProperty = (id: number) => {\n    if (confirm(\"정말로 이 부동산을 삭제하시겠습니까?\")) {\n      deletePropertyMutation.mutate(id);\n    }\n  };\n\n  // 다이얼로그 닫기 핸들러\n  const handleCloseDialog = () => {\n    setOpenPropertyDialog(false);\n    setEditingProperty(null);\n  };\n\n  // 부동산 수정 열기\n  const handleEditProperty = (property: Property) => {\n    // 현재 선택된 부동산 저장\n    setEditingProperty(property);\n    // 다이얼로그 열기\n    setOpenPropertyDialog(true);\n  };\n\n  // 새 부동산 추가 핸들러\n  const handleAddProperty = () => {\n    setEditingProperty(null);\n    setOpenPropertyDialog(true);\n  };\n\n  // 로딩 상태 표시\n  if (isLoadingProperties) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\n      </div>\n    );\n  }\n\n  // 오류 상태 표시\n  if (propertiesError) {\n    return (\n      <div className=\"flex flex-col items-center justify-center min-h-screen\">\n        <p className=\"text-red-500 mb-4\">오류가 발생했습니다: {propertiesError.message}</p>\n        <Button variant=\"default\" onClick={() => window.location.reload()}>\n          다시 시도\n        </Button>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"container mx-auto py-6 space-y-6\">\n      <div className=\"flex justify-between items-center\">\n        <div>\n          <h1 className=\"text-3xl font-bold\">관리자 패널</h1>\n          <Breadcrumb className=\"mt-2\">\n            <BreadcrumbList>\n              <BreadcrumbItem>\n                <BreadcrumbLink href=\"/\">\n                  <Home className=\"h-4 w-4 mr-1\" />\n                  홈\n                </BreadcrumbLink>\n              </BreadcrumbItem>\n              <BreadcrumbSeparator />\n              <BreadcrumbItem>\n                <BreadcrumbPage>관리자 패널</BreadcrumbPage>\n              </BreadcrumbItem>\n            </BreadcrumbList>\n          </Breadcrumb>\n        </div>\n        <div className=\"flex items-center gap-4\">\n          <p className=\"text-muted-foreground\">\n            <span className=\"font-bold\">{currentUser?.username}</span> ({currentUser?.role})\n          </p>\n        </div>\n      </div>\n\n      <Tabs value={activeTab} onValueChange={setActiveTab}>\n        <TabsList className=\"grid w-full grid-cols-3\">\n          <TabsTrigger value=\"properties\">부동산 관리</TabsTrigger>\n          <TabsTrigger value=\"news\">뉴스 관리</TabsTrigger>\n          <TabsTrigger value=\"users\" disabled={currentUser?.role !== \"admin\"}>\n            사용자 관리\n          </TabsTrigger>\n        </TabsList>\n\n        {/* 부동산 관리 탭 */}\n        <TabsContent value=\"properties\">\n          <Card>\n            <CardHeader>\n              <div className=\"flex justify-between items-center\">\n                <div>\n                  <CardTitle>부동산 목록</CardTitle>\n                  <CardDescription>\n                    등록된 부동산 매물 목록을 관리합니다.\n                  </CardDescription>\n                </div>\n                <Button onClick={handleAddProperty}>\n                  <Plus className=\"h-4 w-4 mr-2\" />\n                  부동산 등록\n                </Button>\n              </div>\n            </CardHeader>\n            <CardContent>\n              <Table>\n                <TableCaption>총 {properties?.length || 0}개의 부동산 매물</TableCaption>\n                <TableHeader>\n                  <TableRow>\n                    <TableHead>ID</TableHead>\n                    <TableHead>제목</TableHead>\n                    <TableHead>유형</TableHead>\n                    <TableHead>지역</TableHead>\n                    <TableHead>가격</TableHead>\n                    <TableHead>정보</TableHead>\n                    <TableHead>특징</TableHead>\n                    <TableHead className=\"text-right\">관리</TableHead>\n                  </TableRow>\n                </TableHeader>\n                <TableBody>\n                  {properties?.map((property) => (\n                    <TableRow key={property.id}>\n                      <TableCell className=\"font-medium\">{property.id}</TableCell>\n                      <TableCell className=\"max-w-[200px] truncate\">{property.title}</TableCell>\n                      <TableCell>{property.type}</TableCell>\n                      <TableCell>{property.district}</TableCell>\n                      <TableCell>{parseInt(property.price).toLocaleString()}원</TableCell>\n                      <TableCell>{property.bedrooms}침실 {property.bathrooms}욕실 {property.size}㎡</TableCell>\n                      <TableCell>\n                        {property.featured && (\n                          <div className=\"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800\">\n                            <Check className=\"h-3 w-3 mr-1\" />\n                            추천\n                          </div>\n                        )}\n                      </TableCell>\n                      <TableCell className=\"text-right\">\n                        <div className=\"flex justify-end gap-2\">\n                          <Button\n                            variant=\"outline\"\n                            size=\"icon\"\n                            onClick={() => handleEditProperty(property)}\n                          >\n                            <Edit className=\"h-4 w-4\" />\n                          </Button>\n                          <Button\n                            variant=\"destructive\"\n                            size=\"icon\"\n                            onClick={() => handleDeleteProperty(property.id)}\n                            disabled={isDeleting === property.id}\n                          >\n                            {isDeleting === property.id ? (\n                              <Loader2 className=\"h-4 w-4 animate-spin\" />\n                            ) : (\n                              <Trash2 className=\"h-4 w-4\" />\n                            )}\n                          </Button>\n                        </div>\n                      </TableCell>\n                    </TableRow>\n                  ))}\n                </TableBody>\n              </Table>\n            </CardContent>\n          </Card>\n\n          {/* 속성 폼 - Dialog 없이 단순 인라인 폼으로 구현 */}\n          {openPropertyDialog && (\n            <div className=\"mt-6\">\n              <InlinePropertyForm \n                onClose={handleCloseDialog}\n                property={editingProperty} \n              />\n            </div>\n          )}\n        </TabsContent>\n\n        {/* 뉴스 관리 탭 */}\n        <TabsContent value=\"news\">\n          <Card>\n            <CardHeader>\n              <CardTitle>뉴스 목록</CardTitle>\n              <CardDescription>\n                등록된 뉴스 목록을 관리합니다.\n              </CardDescription>\n            </CardHeader>\n            <CardContent>\n              <Table>\n                <TableCaption>총 {news?.length || 0}개의 뉴스</TableCaption>\n                <TableHeader>\n                  <TableRow>\n                    <TableHead>ID</TableHead>\n                    <TableHead>제목</TableHead>\n                    <TableHead>날짜</TableHead>\n                    <TableHead>출처</TableHead>\n                    <TableHead className=\"text-right\">관리</TableHead>\n                  </TableRow>\n                </TableHeader>\n                <TableBody>\n                  {news?.map((item) => (\n                    <TableRow key={item.id}>\n                      <TableCell className=\"font-medium\">{item.id}</TableCell>\n                      <TableCell className=\"max-w-[300px] truncate\">{item.title}</TableCell>\n                      <TableCell>\n                        {item.createdAt ? new Date(item.createdAt).toLocaleDateString() : '-'}\n                      </TableCell>\n                      <TableCell>\n                        {item.source || \"네이버 뉴스\"}\n                      </TableCell>\n                      <TableCell className=\"text-right\">\n                        <Button\n                          variant=\"destructive\"\n                          size=\"icon\"\n                          onClick={() => {\n                            if (confirm(\"정말로 이 뉴스를 삭제하시겠습니까?\")) {\n                              deleteNewsMutation.mutate(item.id);\n                            }\n                          }}\n                          disabled={isDeletingNews === item.id}\n                        >\n                          {isDeletingNews === item.id ? (\n                            <Loader2 className=\"h-4 w-4 animate-spin\" />\n                          ) : (\n                            <Trash2 className=\"h-4 w-4\" />\n                          )}\n                        </Button>\n                      </TableCell>\n                    </TableRow>\n                  ))}\n                </TableBody>\n              </Table>\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        {/* 사용자 관리 탭 (관리자만) */}\n        <TabsContent value=\"users\">\n          <Card>\n            <CardHeader>\n              <CardTitle>사용자 목록</CardTitle>\n              <CardDescription>\n                등록된 사용자 목록을 관리합니다.\n              </CardDescription>\n            </CardHeader>\n            <CardContent>\n              {isLoadingUsers ? (\n                <div className=\"flex items-center justify-center py-10\">\n                  <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\n                </div>\n              ) : usersError ? (\n                <div className=\"text-center py-10\">\n                  <p className=\"text-red-500 mb-4\">오류가 발생했습니다: {usersError.message}</p>\n                </div>\n              ) : (\n                <Table>\n                  <TableCaption>총 {users?.length || 0}명의 사용자</TableCaption>\n                  <TableHeader>\n                    <TableRow>\n                      <TableHead>ID</TableHead>\n                      <TableHead>사용자명</TableHead>\n                      <TableHead>이메일</TableHead>\n                      <TableHead>권한</TableHead>\n                      <TableHead>가입일</TableHead>\n                      <TableHead className=\"text-right\">관리</TableHead>\n                    </TableRow>\n                  </TableHeader>\n                  <TableBody>\n                    {users?.map((user) => (\n                      <TableRow key={user.id}>\n                        <TableCell className=\"font-medium\">{user.id}</TableCell>\n                        <TableCell>{user.username}</TableCell>\n                        <TableCell>{user.email}</TableCell>\n                        <TableCell>{user.role}</TableCell>\n                        <TableCell>\n                          {/* createdAt은 현재 User 타입에 없으므로 표시하지 않음 */}\n                          -\n                        </TableCell>\n                        <TableCell className=\"text-right\">\n                          <Button\n                            variant=\"destructive\"\n                            size=\"icon\"\n                            onClick={() => {\n                              if (user.role === \"admin\") {\n                                toast({\n                                  title: \"관리자 계정을 삭제할 수 없습니다\",\n                                  variant: \"destructive\",\n                                });\n                                return;\n                              }\n                              if (\n                                confirm(\n                                  \"정말로 이 사용자를 삭제하시겠습니까? 이 작업은 되돌릴 수 없습니다.\"\n                                )\n                              ) {\n                                deleteUserMutation.mutate(user.id);\n                              }\n                            }}\n                            disabled={\n                              isDeletingUser === user.id || user.role === \"admin\"\n                            }\n                          >\n                            {isDeletingUser === user.id ? (\n                              <Loader2 className=\"h-4 w-4 animate-spin\" />\n                            ) : (\n                              <Trash2 className=\"h-4 w-4\" />\n                            )}\n                          </Button>\n                        </TableCell>\n                      </TableRow>\n                    ))}\n                  </TableBody>\n                </Table>\n              )}\n            </CardContent>\n          </Card>\n        </TabsContent>\n      </Tabs>\n    </div>\n  );\n}","path":null,"size_bytes":23442,"size_tokens":null},"client/src/components/ui/form.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport {\n  Controller,\n  FormProvider,\n  useFormContext,\n  type ControllerProps,\n  type FieldPath,\n  type FieldValues,\n} from \"react-hook-form\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\n\nconst Form = FormProvider\n\ntype FormFieldContextValue<\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n> = {\n  name: TName\n}\n\nconst FormFieldContext = React.createContext<FormFieldContextValue>(\n  {} as FormFieldContextValue\n)\n\nconst FormField = <\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n>({\n  ...props\n}: ControllerProps<TFieldValues, TName>) => {\n  return (\n    <FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>\n  )\n}\n\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext)\n  const itemContext = React.useContext(FormItemContext)\n  const { getFieldState, formState } = useFormContext()\n\n  const fieldState = getFieldState(fieldContext.name, formState)\n\n  if (!fieldContext) {\n    throw new Error(\"useFormField should be used within <FormField>\")\n  }\n\n  const { id } = itemContext\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  }\n}\n\ntype FormItemContextValue = {\n  id: string\n}\n\nconst FormItemContext = React.createContext<FormItemContextValue>(\n  {} as FormItemContextValue\n)\n\nconst FormItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const id = React.useId()\n\n  return (\n    <FormItemContext.Provider value={{ id }}>\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\n    </FormItemContext.Provider>\n  )\n})\nFormItem.displayName = \"FormItem\"\n\nconst FormLabel = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  const { error, formItemId } = useFormField()\n\n  return (\n    <Label\n      ref={ref}\n      className={cn(error && \"text-destructive\", className)}\n      htmlFor={formItemId}\n      {...props}\n    />\n  )\n})\nFormLabel.displayName = \"FormLabel\"\n\nconst FormControl = React.forwardRef<\n  React.ElementRef<typeof Slot>,\n  React.ComponentPropsWithoutRef<typeof Slot>\n>(({ ...props }, ref) => {\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\n\n  return (\n    <Slot\n      ref={ref}\n      id={formItemId}\n      aria-describedby={\n        !error\n          ? `${formDescriptionId}`\n          : `${formDescriptionId} ${formMessageId}`\n      }\n      aria-invalid={!!error}\n      {...props}\n    />\n  )\n})\nFormControl.displayName = \"FormControl\"\n\nconst FormDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => {\n  const { formDescriptionId } = useFormField()\n\n  return (\n    <p\n      ref={ref}\n      id={formDescriptionId}\n      className={cn(\"text-sm text-muted-foreground\", className)}\n      {...props}\n    />\n  )\n})\nFormDescription.displayName = \"FormDescription\"\n\nconst FormMessage = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, children, ...props }, ref) => {\n  const { error, formMessageId } = useFormField()\n  const body = error ? String(error?.message ?? \"\") : children\n\n  if (!body) {\n    return null\n  }\n\n  return (\n    <p\n      ref={ref}\n      id={formMessageId}\n      className={cn(\"text-sm font-medium text-destructive\", className)}\n      {...props}\n    >\n      {body}\n    </p>\n  )\n})\nFormMessage.displayName = \"FormMessage\"\n\nexport {\n  useFormField,\n  Form,\n  FormItem,\n  FormLabel,\n  FormControl,\n  FormDescription,\n  FormMessage,\n  FormField,\n}\n","path":null,"size_bytes":4120,"size_tokens":null},"client/src/hooks/use-toast.ts":{"content":"import * as React from \"react\"\n\nimport type {\n  ToastActionElement,\n  ToastProps,\n} from \"@/components/ui/toast\"\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType[\"ADD_TOAST\"]\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType[\"UPDATE_TOAST\"]\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType[\"DISMISS_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n  | {\n      type: ActionType[\"REMOVE_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      }\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      }\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, \"id\">\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id })\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  }\n}\n\nexport { useToast, toast }\n","path":null,"size_bytes":3895,"size_tokens":null},"client/src/pages/PropertiesPage.tsx":{"content":"import { useState, useEffect, useRef, useCallback } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { useLocation, useSearch } from \"wouter\";\nimport { Property } from \"@shared/schema\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport PropertyCard from \"@/components/property/PropertyCard\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { MapIcon, Mic, MicOff, Search, X } from \"lucide-react\";\nimport KakaoMap from \"@/components/map/KakaoMap\";\nimport { Input } from \"@/components/ui/input\";\nimport {\n  Form,\n  FormControl,\n  FormField,\n  FormItem,\n  FormLabel,\n} from \"@/components/ui/form\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { Button } from \"@/components/ui/button\";\n\nconst formSchema = z.object({\n  district: z.string(),\n  type: z.string(),\n  priceRange: z.string(),\n});\n\ntype FormValues = z.infer<typeof formSchema>;\n\n// Web Speech API 타입 선언\ninterface SpeechRecognitionEvent extends Event {\n  results: SpeechRecognitionResultList;\n  resultIndex: number;\n}\n\ninterface SpeechRecognitionResultList {\n  length: number;\n  item(index: number): SpeechRecognitionResult;\n  [index: number]: SpeechRecognitionResult;\n}\n\ninterface SpeechRecognitionResult {\n  isFinal: boolean;\n  length: number;\n  item(index: number): SpeechRecognitionAlternative;\n  [index: number]: SpeechRecognitionAlternative;\n}\n\ninterface SpeechRecognitionAlternative {\n  transcript: string;\n  confidence: number;\n}\n\ninterface SpeechRecognition extends EventTarget {\n  continuous: boolean;\n  interimResults: boolean;\n  lang: string;\n  onstart: ((this: SpeechRecognition, ev: Event) => void) | null;\n  onend: ((this: SpeechRecognition, ev: Event) => void) | null;\n  onresult: ((this: SpeechRecognition, ev: SpeechRecognitionEvent) => void) | null;\n  onerror: ((this: SpeechRecognition, ev: Event) => void) | null;\n  start(): void;\n  stop(): void;\n  abort(): void;\n}\n\ndeclare global {\n  interface Window {\n    SpeechRecognition: new () => SpeechRecognition;\n    webkitSpeechRecognition: new () => SpeechRecognition;\n  }\n}\n\nconst PropertiesPage = () => {\n  const [location, setLocation] = useLocation();\n  const search = useSearch();\n  \n  // useSearch 훅에서 초기값 파싱 (wouter의 반응형 쿼리 문자열 사용)\n  const initialParams = new URLSearchParams(search);\n  const initialDistrict = initialParams.get(\"district\") || \"all\";\n  const initialType = initialParams.get(\"type\") || \"all\";\n  const initialMinPrice = initialParams.get(\"minPrice\");\n  const initialMaxPrice = initialParams.get(\"maxPrice\");\n  const initialKeyword = initialParams.get(\"keyword\") || \"\";\n  \n  let initialPriceRange = \"all\";\n  if (initialMinPrice && initialMaxPrice) {\n    initialPriceRange = `${initialMinPrice}-${initialMaxPrice}`;\n  }\n\n  const [filterParams, setFilterParams] = useState({\n    district: initialDistrict,\n    type: initialType,\n    minPrice: initialMinPrice,\n    maxPrice: initialMaxPrice,\n    keyword: initialKeyword,\n  });\n  \n  // 음성검색 관련 상태\n  const [searchKeyword, setSearchKeyword] = useState(initialKeyword);\n  const [isListening, setIsListening] = useState(false);\n  const [speechSupported, setSpeechSupported] = useState(false);\n  const recognitionRef = useRef<SpeechRecognition | null>(null);\n  \n  // 음성인식 지원 여부 확인\n  useEffect(() => {\n    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;\n    if (SpeechRecognition) {\n      setSpeechSupported(true);\n      recognitionRef.current = new SpeechRecognition();\n      recognitionRef.current.continuous = false;\n      recognitionRef.current.interimResults = false;\n      recognitionRef.current.lang = 'ko-KR'; // 한국어 설정\n      \n      recognitionRef.current.onstart = () => {\n        setIsListening(true);\n      };\n      \n      recognitionRef.current.onend = () => {\n        setIsListening(false);\n      };\n      \n      recognitionRef.current.onresult = (event: SpeechRecognitionEvent) => {\n        const transcript = event.results[0][0].transcript;\n        setSearchKeyword(transcript);\n        // 음성인식 완료 후 자동 검색\n        handleVoiceSearch(transcript);\n      };\n      \n      recognitionRef.current.onerror = () => {\n        setIsListening(false);\n      };\n    }\n    \n    return () => {\n      if (recognitionRef.current) {\n        recognitionRef.current.abort();\n      }\n    };\n  }, []);\n  \n  // 음성인식 시작/중지\n  const toggleListening = useCallback(() => {\n    if (!recognitionRef.current) return;\n    \n    if (isListening) {\n      recognitionRef.current.stop();\n    } else {\n      recognitionRef.current.start();\n    }\n  }, [isListening]);\n  \n  // 음성검색 실행 (기존 필터 유지)\n  const handleVoiceSearch = useCallback((keyword: string) => {\n    if (!keyword.trim()) return;\n    \n    const newParams = new URLSearchParams();\n    newParams.append(\"keyword\", keyword.trim());\n    \n    // 기존 필터 값 유지\n    if (filterParams.district && filterParams.district !== \"all\") {\n      newParams.append(\"district\", filterParams.district);\n    }\n    if (filterParams.type && filterParams.type !== \"all\") {\n      newParams.append(\"type\", filterParams.type);\n    }\n    if (filterParams.minPrice && filterParams.maxPrice) {\n      newParams.append(\"minPrice\", filterParams.minPrice);\n      newParams.append(\"maxPrice\", filterParams.maxPrice);\n    }\n    \n    setLocation(`/properties?${newParams.toString()}`);\n  }, [setLocation, filterParams]);\n  \n  // form 객체가 초기화된 후에 handleKeywordSearch를 정의해야 하므로,\n  // form.getValues()를 사용하기 위한 간접 호출 패턴을 사용\n  const getFormValues = useRef<() => FormValues | null>(null);\n  \n  // 키워드 검색 실행 (현재 폼 필터 값 사용)\n  const handleKeywordSearch = useCallback(() => {\n    const newParams = new URLSearchParams();\n    \n    // 키워드가 있으면 추가\n    if (searchKeyword.trim()) {\n      newParams.append(\"keyword\", searchKeyword.trim());\n    }\n    \n    // 현재 폼 값을 직접 사용 (간접 호출)\n    const formValues = getFormValues.current?.();\n    if (formValues) {\n      if (formValues.district && formValues.district !== \"all\") {\n        newParams.append(\"district\", formValues.district);\n      }\n      if (formValues.type && formValues.type !== \"all\") {\n        newParams.append(\"type\", formValues.type);\n      }\n      if (formValues.priceRange && formValues.priceRange !== \"all\") {\n        const [minPrice, maxPrice] = formValues.priceRange.split(\"-\");\n        if (minPrice && maxPrice) {\n          newParams.append(\"minPrice\", minPrice);\n          newParams.append(\"maxPrice\", maxPrice);\n        }\n      }\n    }\n    \n    const newUrl = newParams.toString() ? `/properties?${newParams.toString()}` : '/properties';\n    setLocation(newUrl);\n  }, [searchKeyword, setLocation]);\n  \n  // 키워드 검색 초기화 (현재 폼 필터 값 유지)\n  const clearKeyword = useCallback(() => {\n    setSearchKeyword(\"\");\n    \n    const newParams = new URLSearchParams();\n    \n    // 현재 폼 값을 직접 사용\n    const formValues = getFormValues.current?.();\n    if (formValues) {\n      if (formValues.district && formValues.district !== \"all\") {\n        newParams.append(\"district\", formValues.district);\n      }\n      if (formValues.type && formValues.type !== \"all\") {\n        newParams.append(\"type\", formValues.type);\n      }\n      if (formValues.priceRange && formValues.priceRange !== \"all\") {\n        const [minPrice, maxPrice] = formValues.priceRange.split(\"-\");\n        if (minPrice && maxPrice) {\n          newParams.append(\"minPrice\", minPrice);\n          newParams.append(\"maxPrice\", maxPrice);\n        }\n      }\n    }\n    \n    const newUrl = newParams.toString() ? `/properties?${newParams.toString()}` : '/properties';\n    setLocation(newUrl);\n  }, [setLocation]);\n\n  const form = useForm<FormValues>({\n    resolver: zodResolver(formSchema),\n    defaultValues: {\n      district: initialDistrict,\n      type: initialType,\n      priceRange: initialPriceRange,\n    },\n  });\n  \n  // getFormValues ref 설정 (handleKeywordSearch에서 사용)\n  getFormValues.current = () => form.getValues();\n\n  // URL이 변경될 때 폼 값 업데이트\n  useEffect(() => {\n    // wouter의 useSearch 훅을 통해 쿼리 문자열 가져오기\n    const params = new URLSearchParams(search);\n    const district = params.get(\"district\") || \"all\";\n    const type = params.get(\"type\") || \"all\";\n    const minPrice = params.get(\"minPrice\");\n    const maxPrice = params.get(\"maxPrice\");\n    const keyword = params.get(\"keyword\") || \"\";\n    \n    let priceRange = \"all\";\n    if (minPrice && maxPrice) {\n      priceRange = `${minPrice}-${maxPrice}`;\n    }\n    \n    console.log(\"URL에서 파싱된 파라미터:\", { district, type, minPrice, maxPrice, priceRange, keyword });\n    \n    form.reset({\n      district,\n      type,\n      priceRange,\n    });\n    \n    setSearchKeyword(keyword);\n    \n    setFilterParams({\n      district,\n      type,\n      minPrice: minPrice,\n      maxPrice: maxPrice,\n      keyword: keyword,\n    });\n  }, [search]);\n\n  const { data: properties, isLoading, error } = useQuery<Property[]>({\n    queryKey: [\"/api/search\", filterParams.district, filterParams.type, filterParams.minPrice, filterParams.maxPrice, filterParams.keyword],\n    queryFn: async () => {\n      // 검색 파라미터 구성\n      const searchParams = new URLSearchParams();\n      \n      // 키워드 검색\n      if (filterParams.keyword && filterParams.keyword.trim() !== \"\") {\n        searchParams.append(\"keyword\", filterParams.keyword.trim());\n      }\n      \n      if (filterParams.district && filterParams.district !== \"all\") {\n        searchParams.append(\"district\", filterParams.district);\n      }\n      \n      if (filterParams.type && filterParams.type !== \"all\") {\n        searchParams.append(\"type\", filterParams.type);\n      }\n      \n      if (filterParams.minPrice && filterParams.maxPrice) {\n        searchParams.append(\"minPrice\", filterParams.minPrice);\n        searchParams.append(\"maxPrice\", filterParams.maxPrice);\n      }\n      \n      // URL 생성 및 요청\n      const url = `/api/search?${searchParams.toString()}`;\n      console.log(\"검색 요청 URL:\", url);\n      \n      const res = await fetch(url);\n      if (!res.ok) throw new Error(\"Failed to fetch properties\");\n      return res.json();\n    },\n  });\n\n  const onSubmit = (data: FormValues) => {\n    const newParams: Record<string, string | null> = {\n      district: data.district !== \"all\" ? data.district : null,\n      type: data.type !== \"all\" ? data.type : null,\n      minPrice: null,\n      maxPrice: null,\n    };\n\n    if (data.priceRange !== \"all\") {\n      const [min, max] = data.priceRange.split(\"-\");\n      newParams.minPrice = min;\n      newParams.maxPrice = max;\n    }\n\n    // URL 파라미터 생성 및 페이지 이동\n    const searchParams = new URLSearchParams();\n    if (newParams.district) searchParams.append(\"district\", newParams.district);\n    if (newParams.type) searchParams.append(\"type\", newParams.type);\n    if (newParams.minPrice && newParams.maxPrice) {\n      searchParams.append(\"minPrice\", newParams.minPrice);\n      searchParams.append(\"maxPrice\", newParams.maxPrice);\n    }\n\n    // wouter의 setLocation을 사용하여 URL 업데이트\n    const newUrl = searchParams.toString() ? `/properties?${searchParams.toString()}` : '/properties';\n    setLocation(newUrl);\n  };\n\n  return (\n    <div className=\"pt-16\"> {/* Offset for fixed header */}\n      <div className=\"bg-primary/10 py-12\">\n        <div className=\"container mx-auto px-4\">\n          <h1 className=\"text-3xl font-bold mb-6\">매물 검색</h1>\n          \n          {/* 음성검색 입력창 */}\n          <div className=\"bg-white p-4 rounded-lg shadow-md mb-4\">\n            <div className=\"flex items-center gap-2\">\n              <div className=\"relative flex-1\">\n                <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400\" />\n                <Input\n                  type=\"text\"\n                  placeholder=\"검색어를 입력하거나 마이크를 눌러 음성으로 검색하세요\"\n                  value={searchKeyword}\n                  onChange={(e) => setSearchKeyword(e.target.value)}\n                  onKeyDown={(e) => {\n                    if (e.key === 'Enter') {\n                      e.preventDefault();\n                      handleKeywordSearch();\n                    }\n                  }}\n                  className=\"pl-10 pr-10\"\n                  data-testid=\"input-voice-search\"\n                />\n                {searchKeyword && (\n                  <button\n                    type=\"button\"\n                    onClick={clearKeyword}\n                    className=\"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600\"\n                    data-testid=\"button-clear-search\"\n                  >\n                    <X className=\"h-4 w-4\" />\n                  </button>\n                )}\n              </div>\n              \n              {speechSupported && (\n                <Button\n                  type=\"button\"\n                  variant={isListening ? \"destructive\" : \"outline\"}\n                  size=\"icon\"\n                  onClick={toggleListening}\n                  className={`flex-shrink-0 ${isListening ? 'animate-pulse' : ''}`}\n                  title={isListening ? \"음성인식 중지\" : \"음성으로 검색\"}\n                  data-testid=\"button-voice-search\"\n                >\n                  {isListening ? (\n                    <MicOff className=\"h-5 w-5\" />\n                  ) : (\n                    <Mic className=\"h-5 w-5\" />\n                  )}\n                </Button>\n              )}\n              \n              <Button\n                type=\"button\"\n                onClick={handleKeywordSearch}\n                className=\"flex-shrink-0\"\n                data-testid=\"button-search\"\n              >\n                <Search className=\"h-4 w-4 mr-2\" />\n                검색\n              </Button>\n            </div>\n            \n            {isListening && (\n              <div className=\"mt-3 flex items-center gap-2 text-sm text-primary\">\n                <div className=\"w-2 h-2 bg-red-500 rounded-full animate-pulse\" />\n                <span>음성을 듣고 있습니다... 말씀해 주세요</span>\n              </div>\n            )}\n            \n            {searchKeyword && filterParams.keyword && (\n              <div className=\"mt-3 text-sm text-gray-600\">\n                <span className=\"font-medium\">\"{filterParams.keyword}\"</span> 검색 결과\n              </div>\n            )}\n          </div>\n          \n          {/* 카테고리 필터 숨김 - 음성검색만 사용 */}\n          <div className=\"hidden\">\n            <Form {...form}>\n              <form onSubmit={form.handleSubmit(onSubmit)} className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n                <FormField\n                  control={form.control}\n                  name=\"district\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>지역</FormLabel>\n                      <Select \n                        onValueChange={field.onChange} \n                        value={field.value}\n                      >\n                        <FormControl>\n                          <SelectTrigger className=\"w-full\">\n                            <SelectValue placeholder=\"지역 선택\" />\n                          </SelectTrigger>\n                        </FormControl>\n                        <SelectContent>\n                          <SelectItem value=\"all\">전체</SelectItem>\n                          {/* 강화읍 옵션 */}\n                          <SelectItem value=\"강화읍 갑곳리\">강화읍 갑곳리</SelectItem>\n                          <SelectItem value=\"강화읍 관청리\">강화읍 관청리</SelectItem>\n                          <SelectItem value=\"강화읍 국화리\">강화읍 국화리</SelectItem>\n                          <SelectItem value=\"강화읍 남산리\">강화읍 남산리</SelectItem>\n                          <SelectItem value=\"강화읍 대산리\">강화읍 대산리</SelectItem>\n                          <SelectItem value=\"강화읍 신문리\">강화읍 신문리</SelectItem>\n                          <SelectItem value=\"강화읍 옥림리\">강화읍 옥림리</SelectItem>\n                          <SelectItem value=\"강화읍 용정리\">강화읍 용정리</SelectItem>\n                          <SelectItem value=\"강화읍 월곳리\">강화읍 월곳리</SelectItem>\n\n                          {/* 교동면 옵션 */}\n                          <SelectItem value=\"교동면 고구리\">교동면 고구리</SelectItem>\n                          <SelectItem value=\"교동면 난정리\">교동면 난정리</SelectItem>\n                          <SelectItem value=\"교동면 대룡리\">교동면 대룡리</SelectItem>\n                          <SelectItem value=\"교동면 동산리\">교동면 동산리</SelectItem>\n                          <SelectItem value=\"교동면 무학리\">교동면 무학리</SelectItem>\n                          <SelectItem value=\"교동면 봉소리\">교동면 봉소리</SelectItem>\n                          <SelectItem value=\"교동면 삼선리\">교동면 삼선리</SelectItem>\n                          <SelectItem value=\"교동면 상용리\">교동면 상용리</SelectItem>\n                          <SelectItem value=\"교동면 서한리\">교동면 서한리</SelectItem>\n                          <SelectItem value=\"교동면 양갑리\">교동면 양갑리</SelectItem>\n                          <SelectItem value=\"교동면 읍내리\">교동면 읍내리</SelectItem>\n                          <SelectItem value=\"교동면 인사리\">교동면 인사리</SelectItem>\n                          <SelectItem value=\"교동면 지석리\">교동면 지석리</SelectItem>\n\n                          {/* 길상면 옵션 */}\n                          <SelectItem value=\"길상면 길직리\">길상면 길직리</SelectItem>\n                          <SelectItem value=\"길상면 동검리\">길상면 동검리</SelectItem>\n                          <SelectItem value=\"길상면 선두리\">길상면 선두리</SelectItem>\n                          <SelectItem value=\"길상면 온수리\">길상면 온수리</SelectItem>\n                          <SelectItem value=\"길상면 장흥리\">길상면 장흥리</SelectItem>\n                          <SelectItem value=\"길상면 초지리\">길상면 초지리</SelectItem>\n\n                          {/* 내가면 옵션 */}\n                          <SelectItem value=\"내가면 고천리\">내가면 고천리</SelectItem>\n                          <SelectItem value=\"내가면 구하리\">내가면 구하리</SelectItem>\n                          <SelectItem value=\"내가면 오상리\">내가면 오상리</SelectItem>\n                          <SelectItem value=\"내가면 외포리\">내가면 외포리</SelectItem>\n                          <SelectItem value=\"내가면 황청리\">내가면 황청리</SelectItem>\n\n                          {/* 불은면 옵션 */}\n                          <SelectItem value=\"불은면 고능리\">불은면 고능리</SelectItem>\n                          <SelectItem value=\"불은면 넙성리\">불은면 넙성리</SelectItem>\n                          <SelectItem value=\"불은면 덕성리\">불은면 덕성리</SelectItem>\n                          <SelectItem value=\"불은면 두운리\">불은면 두운리</SelectItem>\n                          <SelectItem value=\"불은면 삼동암리\">불은면 삼동암리</SelectItem>\n                          <SelectItem value=\"불은면 삼성리\">불은면 삼성리</SelectItem>\n                          <SelectItem value=\"불은면 신현리\">불은면 신현리</SelectItem>\n                          <SelectItem value=\"불은면 오두리\">불은면 오두리</SelectItem>\n\n                          {/* 삼산면 옵션 */}\n                          <SelectItem value=\"삼산면 매음리\">삼산면 매음리</SelectItem>\n                          <SelectItem value=\"삼산면 미법리\">삼산면 미법리</SelectItem>\n                          <SelectItem value=\"삼산면 상리\">삼산면 상리</SelectItem>\n                          <SelectItem value=\"삼산면 서검리\">삼산면 서검리</SelectItem>\n                          <SelectItem value=\"삼산면 석모리\">삼산면 석모리</SelectItem>\n                          <SelectItem value=\"삼산면 석포리\">삼산면 석포리</SelectItem>\n                          <SelectItem value=\"삼산면 하리\">삼산면 하리</SelectItem>\n\n                          {/* 서도면 옵션 */}\n                          <SelectItem value=\"서도면 말도리\">서도면 말도리</SelectItem>\n                          <SelectItem value=\"서도면 볼음도리\">서도면 볼음도리</SelectItem>\n                          <SelectItem value=\"서도면 아차도리\">서도면 아차도리</SelectItem>\n                          <SelectItem value=\"서도면 주문도리\">서도면 주문도리</SelectItem>\n\n                          {/* 선원면 옵션 */}\n                          <SelectItem value=\"선원면 금월리\">선원면 금월리</SelectItem>\n                          <SelectItem value=\"선원면 냉정리\">선원면 냉정리</SelectItem>\n                          <SelectItem value=\"선원면 선행리\">선원면 선행리</SelectItem>\n                          <SelectItem value=\"선원면 신정리\">선원면 신정리</SelectItem>\n                          <SelectItem value=\"선원면 연리\">선원면 연리</SelectItem>\n                          <SelectItem value=\"선원면 지산리\">선원면 지산리</SelectItem>\n                          <SelectItem value=\"선원면 창리\">선원면 창리</SelectItem>\n\n                          {/* 송해면 옵션 */}\n                          <SelectItem value=\"송해면 당산리\">송해면 당산리</SelectItem>\n                          <SelectItem value=\"송해면 상도리\">송해면 상도리</SelectItem>\n                          <SelectItem value=\"송해면 솔정리\">송해면 솔정리</SelectItem>\n                          <SelectItem value=\"송해면 숭뢰리\">송해면 숭뢰리</SelectItem>\n                          <SelectItem value=\"송해면 신당리\">송해면 신당리</SelectItem>\n                          <SelectItem value=\"송해면 양오리\">송해면 양오리</SelectItem>\n                          <SelectItem value=\"송해면 하도리\">송해면 하도리</SelectItem>\n\n                          {/* 양도면 옵션 */}\n                          <SelectItem value=\"양도면 건평리\">양도면 건평리</SelectItem>\n                          <SelectItem value=\"양도면 길정리\">양도면 길정리</SelectItem>\n                          <SelectItem value=\"양도면 능내리\">양도면 능내리</SelectItem>\n                          <SelectItem value=\"양도면 도장리\">양도면 도장리</SelectItem>\n                          <SelectItem value=\"양도면 삼흥리\">양도면 삼흥리</SelectItem>\n                          <SelectItem value=\"양도면 인산리\">양도면 인산리</SelectItem>\n                          <SelectItem value=\"양도면 조산리\">양도면 조산리</SelectItem>\n                          <SelectItem value=\"양도면 하일리\">양도면 하일리</SelectItem>\n\n                          {/* 양사면 옵션 */}\n                          <SelectItem value=\"양사면 교산리\">양사면 교산리</SelectItem>\n                          <SelectItem value=\"양사면 덕하리\">양사면 덕하리</SelectItem>\n                          <SelectItem value=\"양사면 북성리\">양사면 북성리</SelectItem>\n                          <SelectItem value=\"양사면 인화리\">양사면 인화리</SelectItem>\n                          <SelectItem value=\"양사면 철산리\">양사면 철산리</SelectItem>\n\n                          {/* 하점면 옵션 */}\n                          <SelectItem value=\"하점면 망월리\">하점면 망월리</SelectItem>\n                          <SelectItem value=\"하점면 부근리\">하점면 부근리</SelectItem>\n                          <SelectItem value=\"하점면 삼거리\">하점면 삼거리</SelectItem>\n                          <SelectItem value=\"하점면 신봉리\">하점면 신봉리</SelectItem>\n                          <SelectItem value=\"하점면 신삼리\">하점면 신삼리</SelectItem>\n                          <SelectItem value=\"하점면 이강리\">하점면 이강리</SelectItem>\n                          <SelectItem value=\"하점면 장정리\">하점면 장정리</SelectItem>\n                          <SelectItem value=\"하점면 창후리\">하점면 창후리</SelectItem>\n\n                          {/* 화도면 옵션 */}\n                          <SelectItem value=\"화도면 내리\">화도면 내리</SelectItem>\n                          <SelectItem value=\"화도면 덕포리\">화도면 덕포리</SelectItem>\n                          <SelectItem value=\"화도면 동막리\">화도면 동막리</SelectItem>\n                          <SelectItem value=\"화도면 문산리\">화도면 문산리</SelectItem>\n                          <SelectItem value=\"화도면 사기리\">화도면 사기리</SelectItem>\n                          <SelectItem value=\"화도면 상방리\">화도면 상방리</SelectItem>\n                          <SelectItem value=\"화도면 여차리\">화도면 여차리</SelectItem>\n                          <SelectItem value=\"화도면 장화리\">화도면 장화리</SelectItem>\n                          <SelectItem value=\"화도면 흥왕리\">화도면 흥왕리</SelectItem>\n                          \n                          {/* 기타 옵션 */}\n                          <SelectItem value=\"기타지역\">기타지역</SelectItem>\n                        </SelectContent>\n                      </Select>\n                    </FormItem>\n                  )}\n                />\n                \n                <FormField\n                  control={form.control}\n                  name=\"type\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>유형</FormLabel>\n                      <Select \n                        onValueChange={field.onChange} \n                        value={field.value}\n                      >\n                        <FormControl>\n                          <SelectTrigger className=\"w-full\">\n                            <SelectValue placeholder=\"유형 선택\" />\n                          </SelectTrigger>\n                        </FormControl>\n                        <SelectContent>\n                          <SelectItem value=\"all\">전체</SelectItem>\n                          <SelectItem value=\"토지\">토지</SelectItem>\n                          <SelectItem value=\"주택\">주택</SelectItem>\n                          <SelectItem value=\"아파트연립다세대\">아파트/연립/다세대</SelectItem>\n                          <SelectItem value=\"원투룸\">원룸/투룸</SelectItem>\n                          <SelectItem value=\"상가공장창고펜션\">상가/공장/창고/펜션</SelectItem>\n                        </SelectContent>\n                      </Select>\n                    </FormItem>\n                  )}\n                />\n                \n                <FormField\n                  control={form.control}\n                  name=\"priceRange\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>가격대</FormLabel>\n                      <Select \n                        onValueChange={field.onChange} \n                        value={field.value}\n                      >\n                        <FormControl>\n                          <SelectTrigger className=\"w-full\">\n                            <SelectValue placeholder=\"가격대 선택\" />\n                          </SelectTrigger>\n                        </FormControl>\n                        <SelectContent>\n                          <SelectItem value=\"all\">전체</SelectItem>\n                          <SelectItem value=\"0-100000000\">1억 이하</SelectItem>\n                          <SelectItem value=\"100000000-300000000\">1억~3억</SelectItem>\n                          <SelectItem value=\"300000000-500000000\">3억~5억</SelectItem>\n                          <SelectItem value=\"500000000-1000000000\">5억~10억</SelectItem>\n                          <SelectItem value=\"1000000000-9999999999\">10억 이상</SelectItem>\n                        </SelectContent>\n                      </Select>\n                    </FormItem>\n                  )}\n                />\n                \n                <div className=\"flex items-end\">\n                  <Button type=\"submit\" className=\"w-full bg-primary hover:bg-secondary text-white\">\n                    검색\n                  </Button>\n                </div>\n              </form>\n            </Form>\n          </div>\n        </div>\n      </div>\n      \n      <div className=\"container mx-auto px-4 py-8\">\n        {/* Map Section */}\n        <div className=\"mb-8\">\n          <div className=\"mb-3 flex items-center\">\n            <MapIcon className=\"h-5 w-5 mr-2 text-primary\" />\n            <h2 className=\"text-lg font-bold\">지도로 부동산찾기</h2>\n          </div>\n          <div className=\"h-[40vh] w-full rounded-lg overflow-hidden mb-6\">\n            <KakaoMap />\n          </div>\n        </div>\n        \n        {/* Properties Results */}\n        <div className=\"mb-6 flex justify-between items-center\">\n          <h2 className=\"text-2xl font-bold\">\n            {filterParams.district !== \"all\" && `${filterParams.district} `}\n            {filterParams.type !== \"all\" && `${filterParams.type} `}\n            매물\n          </h2>\n          {properties && (\n            <p className=\"text-gray-medium\">총 {properties.length}개의 매물</p>\n          )}\n        </div>\n        \n        {isLoading ? (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8\">\n            {[...Array(6)].map((_, index) => (\n              <Skeleton key={index} className=\"h-80 w-full\" />\n            ))}\n          </div>\n        ) : error ? (\n          <div className=\"bg-red-50 p-6 rounded-lg text-red-600\">\n            <h3 className=\"text-xl font-bold mb-2\">매물을 불러오는 중 오류가 발생했습니다</h3>\n            <p>잠시 후 다시 시도해주세요.</p>\n          </div>\n        ) : properties && properties.length > 0 ? (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8\">\n            {properties.map((property) => (\n              <PropertyCard key={property.id} property={property} />\n            ))}\n          </div>\n        ) : (\n          <div className=\"bg-gray-light p-8 rounded-lg text-center\">\n            <h3 className=\"text-xl font-bold mb-4\">검색 결과가 없습니다</h3>\n            <p className=\"text-gray-medium mb-6\">검색 조건을 변경하여 다시 시도해보세요.</p>\n            <Button onClick={() => {\n              form.reset({\n                district: \"all\",\n                type: \"all\",\n                priceRange: \"all\",\n              });\n              setSearchKeyword(\"\");\n              setFilterParams({\n                district: \"all\",\n                type: \"all\",\n                minPrice: null,\n                maxPrice: null,\n                keyword: \"\",\n              });\n              setLocation('/properties');\n            }}>\n              필터 초기화\n            </Button>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default PropertiesPage;\n","path":null,"size_bytes":31980,"size_tokens":null},"client/src/index.css":{"content":"@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n:root {\n      --background: 0 0% 100%;\n--foreground: 20 14.3% 4.1%;\n--muted: 60 4.8% 95.9%;\n--muted-foreground: 25 5.3% 44.7%;\n--popover: 0 0% 100%;\n--popover-foreground: 20 14.3% 4.1%;\n--card: 0 0% 100%;\n--card-foreground: 20 14.3% 4.1%;\n--border: 20 5.9% 90%;\n--input: 20 5.9% 90%;\n--primary: 207 90% 54%;\n--primary-foreground: 211 100% 99%;\n--secondary: 60 4.8% 95.9%;\n--secondary-foreground: 24 9.8% 10%;\n--accent: 60 4.8% 95.9%;\n--accent-foreground: 24 9.8% 10%;\n--destructive: 0 84.2% 60.2%;\n--destructive-foreground: 60 9.1% 97.8%;\n--ring: 20 14.3% 4.1%;\n--radius: 0.5rem;\n  }\n  .dark {\n      --background: 240 10% 3.9%;\n--foreground: 0 0% 98%;\n--muted: 240 3.7% 15.9%;\n--muted-foreground: 240 5% 64.9%;\n--popover: 240 10% 3.9%;\n--popover-foreground: 0 0% 98%;\n--card: 240 10% 3.9%;\n--card-foreground: 0 0% 98%;\n--border: 240 3.7% 15.9%;\n--input: 240 3.7% 15.9%;\n--primary: 207 90% 54%;\n--primary-foreground: 211 100% 99%;\n--secondary: 240 3.7% 15.9%;\n--secondary-foreground: 0 0% 98%;\n--accent: 240 3.7% 15.9%;\n--accent-foreground: 0 0% 98%;\n--destructive: 0 62.8% 30.6%;\n--destructive-foreground: 0 0% 98%;\n--ring: 240 4.9% 83.9%;\n--radius: 0.5rem;\n  }\n\n@layer base {\n  * {\n    @apply border-border;\n  }\n\n  body {\n    @apply font-sans antialiased bg-background text-foreground;\n  }\n}","path":null,"size_bytes":1352,"size_tokens":null},"client/src/components/admin/SimpleUserTable.jsx":{"content":"import { useState, useEffect } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Trash2, RefreshCw, Loader2 } from \"lucide-react\";\n\nexport default function SimpleUserTable({ onDeleteUser }) {\n  const [users, setUsers] = useState([]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  const loadUsers = async () => {\n    try {\n      setIsLoading(true);\n      const response = await fetch(\"/api/admin/users\", {\n        credentials: \"include\"\n      });\n      \n      if (!response.ok) {\n        throw new Error(`API 오류: ${response.status}`);\n      }\n      \n      const data = await response.json();\n      console.log(\"사용자 데이터 로드됨:\", data);\n      \n      // 하드코딩된 전화번호와 합치기\n      const enhancedData = data.map(user => {\n        // 각 사용자 ID에 맞는 전화번호 할당\n        let phone = \"전화번호 없음\";\n        if (user.id === 1) phone = \"010-4787-3120\";\n        else if (user.id === 3) phone = \"01047873120\";\n        else if (user.id === 4) phone = \"미제공\";\n        else if (user.phone) phone = user.phone;\n        \n        return {\n          ...user,\n          displayPhone: phone\n        };\n      });\n      \n      setUsers(enhancedData);\n    } catch (err) {\n      console.error(\"사용자 로드 오류:\", err);\n      setError(err.message);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  \n  // 첫 로드\n  useEffect(() => {\n    loadUsers();\n  }, []);\n  \n  if (isLoading) {\n    return (\n      <div className=\"flex justify-center items-center py-8\">\n        <Loader2 className=\"h-8 w-8 animate-spin mr-2\" />\n        <p>사용자 정보를 불러오는 중...</p>\n      </div>\n    );\n  }\n  \n  if (error) {\n    return (\n      <div className=\"p-4 text-red-600 bg-red-50 rounded-md\">\n        <p className=\"font-semibold\">오류가 발생했습니다:</p>\n        <p>{error}</p>\n        <Button onClick={loadUsers} className=\"mt-2\">다시 시도</Button>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-4\">\n      <div className=\"flex justify-between items-center\">\n        <h2 className=\"text-xl font-bold\">사용자 관리</h2>\n        <Button \n          variant=\"outline\" \n          size=\"sm\" \n          onClick={loadUsers}\n          className=\"flex items-center gap-1\"\n        >\n          <RefreshCw className=\"h-4 w-4\" /> 새로고침\n        </Button>\n      </div>\n      \n      <div className=\"overflow-x-auto rounded-md border\">\n        <table className=\"min-w-full divide-y divide-gray-200\">\n          <thead className=\"bg-gray-50\">\n            <tr>\n              <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">번호</th>\n              <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">사용자명</th>\n              <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">전화번호</th>\n              <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">이메일</th>\n              <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">권한</th>\n              <th className=\"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider\">작업</th>\n            </tr>\n          </thead>\n          <tbody className=\"bg-white divide-y divide-gray-200\">\n            {users.length === 0 ? (\n              <tr>\n                <td colSpan=\"6\" className=\"px-6 py-4 whitespace-nowrap text-center text-gray-500\">\n                  등록된 사용자가 없습니다.\n                </td>\n              </tr>\n            ) : (\n              users.map((user, idx) => (\n                <tr key={user.id} className={idx % 2 === 0 ? \"bg-white\" : \"bg-gray-50\"}>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">{user.id}</td>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900\">{user.username}</td>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">{user.displayPhone}</td>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">{user.email || '-'}</td>\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\n                    <span \n                      className={`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${\n                        user.role === 'admin' \n                          ? 'bg-purple-100 text-purple-800' \n                          : 'bg-blue-100 text-blue-800'\n                      }`}\n                    >\n                      {user.role === 'admin' ? '관리자' : '일반사용자'}\n                    </span>\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-right text-sm font-medium\">\n                    <Button \n                      variant=\"destructive\" \n                      size=\"sm\"\n                      disabled={user.id === 1}\n                      onClick={() => onDeleteUser && onDeleteUser(user.id, user.username)}\n                    >\n                      <Trash2 className=\"h-4 w-4\" />\n                    </Button>\n                  </td>\n                </tr>\n              ))\n            )}\n          </tbody>\n        </table>\n      </div>\n    </div>\n  );\n}","path":null,"size_bytes":5415,"size_tokens":null},"server/sample-data.ts":{"content":"// 실제 API가 정상 동작하지 않을 때 사용할 샘플 데이터\n\nexport interface RealEstateTransaction {\n  거래금액: string;\n  건축년도?: string;\n  년: string;\n  월: string;\n  일: string;\n  아파트?: string;\n  주택유형?: string;\n  토지거래구분?: string;\n  전용면적?: string;\n  법정동?: string;\n  지번?: string;\n  층?: string;\n  type: string;\n  address: string;\n}\n\n// 아파트 샘플 데이터\nexport const sampleApartmentTransactions: RealEstateTransaction[] = [\n  {\n    거래금액: '35000',\n    건축년도: '2015',\n    년: '2025',\n    월: '03',\n    일: '15',\n    아파트: '강화아파트',\n    전용면적: '84.5',\n    법정동: '강화읍',\n    지번: '123-45',\n    층: '5',\n    type: '아파트',\n    address: '인천 강화군 강화읍 123-45'\n  },\n  {\n    거래금액: '42000',\n    건축년도: '2018',\n    년: '2025',\n    월: '04',\n    일: '10',\n    아파트: '강화그린빌',\n    전용면적: '72.8',\n    법정동: '선원면',\n    지번: '456-78',\n    층: '3',\n    type: '아파트',\n    address: '인천 강화군 선원면 456-78'\n  },\n  {\n    거래금액: '28000',\n    건축년도: '2010',\n    년: '2025',\n    월: '05',\n    일: '05',\n    아파트: '푸른마을',\n    전용면적: '59.8',\n    법정동: '불은면',\n    지번: '789-10',\n    층: '7',\n    type: '아파트',\n    address: '인천 강화군 불은면 789-10'\n  },\n  {\n    거래금액: '23500',\n    건축년도: '2008',\n    년: '2025',\n    월: '04',\n    일: '22',\n    아파트: '해변베스트',\n    전용면적: '67.2',\n    법정동: '화도면',\n    지번: '234-56',\n    층: '4',\n    type: '아파트',\n    address: '인천 강화군 화도면 234-56'\n  }\n];\n\n// 단독/다가구 샘플 데이터\nexport const sampleHouseTransactions: RealEstateTransaction[] = [\n  {\n    거래금액: '48000',\n    건축년도: '2005',\n    년: '2025',\n    월: '04',\n    일: '18',\n    주택유형: '단독주택',\n    전용면적: '120.5',\n    법정동: '양도면',\n    지번: '345-67',\n    type: '단독다가구',\n    address: '인천 강화군 양도면 345-67'\n  },\n  {\n    거래금액: '55000',\n    건축년도: '2012',\n    년: '2025',\n    월: '03',\n    일: '25',\n    주택유형: '다가구',\n    전용면적: '95.3',\n    법정동: '길상면',\n    지번: '456-78',\n    type: '단독다가구',\n    address: '인천 강화군 길상면 456-78'\n  },\n  {\n    거래금액: '68000',\n    건축년도: '2018',\n    년: '2025',\n    월: '05',\n    일: '02',\n    주택유형: '전원주택',\n    전용면적: '158.7',\n    법정동: '내가면',\n    지번: '567-89',\n    type: '단독다가구',\n    address: '인천 강화군 내가면 567-89'\n  }\n];\n\n// 토지 샘플 데이터\nexport const sampleLandTransactions: RealEstateTransaction[] = [\n  {\n    거래금액: '15000',\n    년: '2025',\n    월: '03',\n    일: '10',\n    토지거래구분: '전',\n    법정동: '하점면',\n    지번: '678-90',\n    type: '토지',\n    address: '인천 강화군 하점면 678-90'\n  },\n  {\n    거래금액: '28000',\n    년: '2025',\n    월: '04',\n    일: '15',\n    토지거래구분: '대',\n    법정동: '송해면',\n    지번: '789-01',\n    type: '토지',\n    address: '인천 강화군 송해면 789-01'\n  },\n  {\n    거래금액: '32000',\n    년: '2025',\n    월: '05',\n    일: '07',\n    토지거래구분: '대',\n    법정동: '교동면',\n    지번: '890-12',\n    type: '토지',\n    address: '인천 강화군 교동면 890-12'\n  }\n];","path":null,"size_bytes":3517,"size_tokens":null},"client/src/App.tsx":{"content":"import { Switch, Route } from \"wouter\";\nimport { queryClient } from \"./lib/queryClient\";\nimport { QueryClientProvider } from \"@tanstack/react-query\";\nimport { Toaster } from \"@/components/ui/toaster\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport { ThemeProvider } from \"@/components/ui/theme-provider\";\nimport { AuthProvider } from \"@/hooks/use-auth\";\nimport NotFound from \"@/pages/not-found\";\nimport Header from \"@/components/layout/Header\";\nimport Footer from \"@/components/layout/Footer\";\nimport HomePage from \"@/pages/HomePage\";\nimport PropertiesPage from \"@/pages/PropertiesPage\";\nimport PropertyDetailPage from \"@/pages/PropertyDetailPage\";\n// Agent 관련 페이지 제거됨\nimport AboutPage from \"@/pages/AboutPage\";\nimport ContactPage from \"@/pages/ContactPage\";\nimport AuthPage from \"@/pages/auth-page\";\nimport AdminPage from \"@/pages/admin-page-fixed-new\";\nimport ProfilePage from \"@/pages/profile-page\";\nimport NewsPage from \"@/pages/NewsPage\";\nimport NewsDetailPage from \"@/pages/NewsDetailPage\";\nimport PropertyForm from \"@/pages/PropertyForm\";\nimport { SimpleProtectedRoute } from \"@/components/auth/SimpleProtectedRoute\";\n\nfunction AppRouter() {\n  return (\n    <Switch>\n      <Route path=\"/\" component={HomePage} />\n      <Route path=\"/properties\" component={PropertiesPage} />\n      <Route path=\"/properties/:id\" component={PropertyDetailPage} />\n      {/* Agent 관련 라우트 제거됨 */}\n      <Route path=\"/news\" component={NewsPage} />\n      <Route path=\"/news/:id\" component={NewsDetailPage} />\n      <Route path=\"/about\" component={AboutPage} />\n      <Route path=\"/contact\" component={ContactPage} />\n      <Route path=\"/auth\" component={AuthPage} />\n      <SimpleProtectedRoute path=\"/profile\" component={ProfilePage} />\n      <SimpleProtectedRoute path=\"/admin\" component={AdminPage} admin={true} />\n      <SimpleProtectedRoute path=\"/admin/properties/new\" component={PropertyForm} admin={true} />\n      <SimpleProtectedRoute path=\"/admin/properties/edit/:id\" component={PropertyForm} admin={true} />\n      <Route component={NotFound} />\n    </Switch>\n  );\n}\n\nfunction App() {\n  return (\n    <QueryClientProvider client={queryClient}>\n      <ThemeProvider defaultTheme=\"light\">\n        <AuthProvider>\n          <TooltipProvider>\n            <div className=\"flex flex-col min-h-screen\">\n              <Header />\n              <main className=\"flex-grow\">\n                <AppRouter />\n              </main>\n              <Footer />\n            </div>\n            <Toaster />\n          </TooltipProvider>\n        </AuthProvider>\n      </ThemeProvider>\n    </QueryClientProvider>\n  );\n}\n\nexport default App;\n","path":null,"size_bytes":2657,"size_tokens":null},"client/src/components/auth/SimpleProtectedRoute.jsx":{"content":"// 단순화된 보호 라우트 컴포넌트 - JSX 확장자 사용, 타입 제거\nimport { useAuth } from \"@/hooks/use-auth\";\nimport { Loader2 } from \"lucide-react\";\nimport { Route } from \"wouter\";\n\n// 간단한 HTML을 이용한 보호 컴포넌트\nexport function SimpleProtectedRoute({ path, component: Component, admin = false }) {\n  const { user, isLoading } = useAuth();\n  \n  // 보호된 컴포넌트를 간단한 래퍼로 감싸기\n  const ProtectedContent = () => {\n    // 로딩 중\n    if (isLoading) {\n      return (\n        <div className=\"flex items-center justify-center min-h-screen\">\n          <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\n        </div>\n      );\n    }\n    \n    // 인증되지 않은 경우\n    if (!user) {\n      // window 객체를 사용해 리다이렉트 (React 컴포넌트 렌더링 X)\n      window.location.href = \"/auth\";\n      return <div>인증 필요...</div>;\n    }\n    \n    // 관리자 권한 필요하지만 일반 사용자인 경우\n    if (admin && user.role !== \"admin\") {\n      // window 객체를 사용해 리다이렉트 (React 컴포넌트 렌더링 X)\n      window.location.href = \"/\";\n      return <div>권한 체크 중...</div>;\n    }\n    \n    // 권한 있음 - 컴포넌트 렌더링\n    return <Component />;\n  };\n  \n  return (\n    <Route path={path} component={ProtectedContent} />\n  );\n}","path":null,"size_bytes":1371,"size_tokens":null},"client/src/components/layout/Header.tsx":{"content":"import { useState } from \"react\";\nimport { Link, useLocation } from \"wouter\";\nimport { Building, LogIn, LogOut, User, Settings } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Sheet, SheetContent, SheetTrigger } from \"@/components/ui/sheet\";\nimport { useAuth } from \"@/hooks/use-auth\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\n\nconst Header = () => {\n  const [location, setLocation] = useLocation();\n  const { user, logoutMutation } = useAuth();\n  const [mobileMenuOpen, setMobileMenuOpen] = useState(false);\n  \n  const navItems = [\n    { name: \"홈\", path: \"/\" },\n    { name: \"매물\", path: \"/properties\" },\n    { name: \"부동산뉴스\", path: \"/news\" },\n    { name: \"실거래가(디스코)\", path: \"/about\" },\n    { name: \"문의\", path: \"/contact\" },\n  ];\n  \n  const handleLogout = () => {\n    logoutMutation.mutate();\n  };\n\n  return (\n    <header className=\"bg-white shadow-md fixed w-full z-50\">\n      <div className=\"container mx-auto px-4 py-3\">\n        <div className=\"flex justify-between items-center\">\n          <Link href=\"/\" className=\"flex items-center\">\n            <Building className=\"text-primary text-3xl mr-2\" />\n            <span className=\"text-2xl font-bold text-primary\">이가이버부동산</span>\n          </Link>\n          \n          {/* Desktop Navigation */}\n          <nav className=\"hidden md:flex space-x-8\">\n            {navItems.map((item) => (\n              <Link \n                key={item.path} \n                href={item.path}\n                className={`font-medium hover:text-primary transition-colors ${\n                  location === item.path ? \"text-primary\" : \"text-neutral-800\"\n                }`}\n              >\n                {item.name}\n              </Link>\n            ))}\n          </nav>\n          \n          {/* Auth Buttons (Desktop) */}\n          <div className=\"hidden md:flex items-center space-x-2\">\n            {user ? (\n              <DropdownMenu>\n                <DropdownMenuTrigger asChild>\n                  <Button variant=\"ghost\" className=\"flex items-center gap-2\">\n                    <User size={18} />\n                    <span className=\"font-medium\">{user.username}</span>\n                  </Button>\n                </DropdownMenuTrigger>\n                <DropdownMenuContent align=\"end\">\n                  <DropdownMenuLabel>내 계정</DropdownMenuLabel>\n                  <DropdownMenuItem onClick={() => setLocation(\"/profile\")}>\n                    <User className=\"mr-2 h-4 w-4\" />\n                    <span>내 프로필</span>\n                  </DropdownMenuItem>\n                  {user.role === \"admin\" && (\n                    <>\n                      <DropdownMenuSeparator />\n                      <DropdownMenuItem onClick={() => setLocation(\"/admin\")}>\n                        <Settings className=\"mr-2 h-4 w-4\" />\n                        <span>관리자 패널</span>\n                      </DropdownMenuItem>\n                    </>\n                  )}\n                  <DropdownMenuSeparator />\n                  <DropdownMenuItem onClick={handleLogout}>\n                    <LogOut className=\"mr-2 h-4 w-4\" />\n                    <span>로그아웃</span>\n                  </DropdownMenuItem>\n                </DropdownMenuContent>\n              </DropdownMenu>\n            ) : (\n              <Button variant=\"default\" onClick={() => setLocation(\"/auth\")}>\n                <LogIn className=\"mr-2 h-4 w-4\" />\n                로그인\n              </Button>\n            )}\n          </div>\n\n          {/* Mobile Navigation */}\n          <Sheet open={mobileMenuOpen} onOpenChange={setMobileMenuOpen}>\n            <SheetTrigger asChild>\n              <Button variant=\"outline\" className=\"md:hidden px-3 py-2 text-sm font-medium\">\n                전체보기\n              </Button>\n            </SheetTrigger>\n            <SheetContent>\n              <div className=\"flex flex-col space-y-4 mt-8\">\n                {navItems.map((item) => (\n                  <Link \n                    key={item.path} \n                    href={item.path}\n                    onClick={() => setMobileMenuOpen(false)}\n                    className={`text-lg font-medium hover:text-primary transition-colors ${\n                      location === item.path ? \"text-primary\" : \"text-neutral-800\"\n                    }`}\n                  >\n                    {item.name}\n                  </Link>\n                ))}\n                \n                {/* Auth Items (Mobile) */}\n                <div className=\"pt-4 border-t\">\n                  {user ? (\n                    <>\n                      <div className=\"flex items-center mb-4 text-primary font-medium\">\n                        <User size={18} className=\"mr-2\" />\n                        <span>{user.username}</span>\n                        {user.role === \"admin\" && (\n                          <span className=\"ml-2 px-2 py-0.5 bg-purple-100 text-purple-800 text-xs rounded-full\">\n                            관리자\n                          </span>\n                        )}\n                      </div>\n                      \n                      <Link \n                        href=\"/profile\" \n                        onClick={() => setMobileMenuOpen(false)}\n                        className=\"flex items-center py-2 text-lg font-medium text-neutral-800 hover:text-primary\"\n                      >\n                        <User className=\"mr-2 h-5 w-5\" />\n                        내 프로필\n                      </Link>\n                      \n                      {user.role === \"admin\" && (\n                        <Link \n                          href=\"/admin\" \n                          onClick={() => setMobileMenuOpen(false)}\n                          className=\"flex items-center py-2 text-lg font-medium text-neutral-800 hover:text-primary\"\n                        >\n                          <Settings className=\"mr-2 h-5 w-5\" />\n                          관리자 패널\n                        </Link>\n                      )}\n                      \n                      <button\n                        onClick={() => {\n                          handleLogout();\n                          setMobileMenuOpen(false);\n                        }}\n                        className=\"flex items-center py-2 text-lg font-medium text-neutral-800 hover:text-primary\"\n                      >\n                        <LogOut className=\"mr-2 h-5 w-5\" />\n                        로그아웃\n                      </button>\n                    </>\n                  ) : (\n                    <Link\n                      href=\"/auth\"\n                      onClick={() => setMobileMenuOpen(false)}\n                      className=\"flex items-center py-2 text-lg font-medium text-neutral-800 hover:text-primary\"\n                    >\n                      <LogIn className=\"mr-2 h-5 w-5\" />\n                      로그인 / 회원가입\n                    </Link>\n                  )}\n                </div>\n              </div>\n            </SheetContent>\n          </Sheet>\n        </div>\n      </div>\n    </header>\n  );\n};\n\nexport default Header;\n","path":null,"size_bytes":7275,"size_tokens":null},"client/src/components/ui/switch.tsx":{"content":"import * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      \"peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        \"pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0\"\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n","path":null,"size_bytes":1139,"size_tokens":null},"client/src/components/ui/accordion.tsx":{"content":"import * as React from \"react\"\nimport * as AccordionPrimitive from \"@radix-ui/react-accordion\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Accordion = AccordionPrimitive.Root\n\nconst AccordionItem = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <AccordionPrimitive.Item\n    ref={ref}\n    className={cn(\"border-b\", className)}\n    {...props}\n  />\n))\nAccordionItem.displayName = \"AccordionItem\"\n\nconst AccordionTrigger = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Header className=\"flex\">\n    <AccordionPrimitive.Trigger\n      ref={ref}\n      className={cn(\n        \"flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronDown className=\"h-4 w-4 shrink-0 transition-transform duration-200\" />\n    </AccordionPrimitive.Trigger>\n  </AccordionPrimitive.Header>\n))\nAccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName\n\nconst AccordionContent = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Content\n    ref={ref}\n    className=\"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down\"\n    {...props}\n  >\n    <div className={cn(\"pb-4 pt-0\", className)}>{children}</div>\n  </AccordionPrimitive.Content>\n))\n\nAccordionContent.displayName = AccordionPrimitive.Content.displayName\n\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent }\n","path":null,"size_bytes":1977,"size_tokens":null},"client/src/components/ui/slider.tsx":{"content":"import * as React from \"react\"\nimport * as SliderPrimitive from \"@radix-ui/react-slider\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Slider = React.forwardRef<\n  React.ElementRef<typeof SliderPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <SliderPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex w-full touch-none select-none items-center\",\n      className\n    )}\n    {...props}\n  >\n    <SliderPrimitive.Track className=\"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary\">\n      <SliderPrimitive.Range className=\"absolute h-full bg-primary\" />\n    </SliderPrimitive.Track>\n    <SliderPrimitive.Thumb className=\"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50\" />\n  </SliderPrimitive.Root>\n))\nSlider.displayName = SliderPrimitive.Root.displayName\n\nexport { Slider }\n","path":null,"size_bytes":1077,"size_tokens":null},"client/src/components/home/PropertySearch.tsx":{"content":"import { useState, useEffect, useRef, useCallback } from \"react\";\nimport { useLocation } from \"wouter\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Mic, MicOff, Search } from \"lucide-react\";\n\ninterface SpeechRecognitionEvent extends Event {\n  results: SpeechRecognitionResultList;\n  resultIndex: number;\n}\n\ninterface SpeechRecognitionResultList {\n  length: number;\n  item(index: number): SpeechRecognitionResult;\n  [index: number]: SpeechRecognitionResult;\n}\n\ninterface SpeechRecognitionResult {\n  isFinal: boolean;\n  length: number;\n  item(index: number): SpeechRecognitionAlternative;\n  [index: number]: SpeechRecognitionAlternative;\n}\n\ninterface SpeechRecognitionAlternative {\n  transcript: string;\n  confidence: number;\n}\n\ninterface SpeechRecognition extends EventTarget {\n  continuous: boolean;\n  interimResults: boolean;\n  lang: string;\n  onstart: ((this: SpeechRecognition, ev: Event) => void) | null;\n  onend: ((this: SpeechRecognition, ev: Event) => void) | null;\n  onresult: ((this: SpeechRecognition, ev: SpeechRecognitionEvent) => void) | null;\n  onerror: ((this: SpeechRecognition, ev: Event) => void) | null;\n  start(): void;\n  stop(): void;\n  abort(): void;\n}\n\ndeclare global {\n  interface Window {\n    SpeechRecognition: new () => SpeechRecognition;\n    webkitSpeechRecognition: new () => SpeechRecognition;\n  }\n}\n\nconst PropertySearch = () => {\n  const [, setLocation] = useLocation();\n  const [searchKeyword, setSearchKeyword] = useState(\"\");\n  const [isListening, setIsListening] = useState(false);\n  const [speechSupported, setSpeechSupported] = useState(false);\n  const recognitionRef = useRef<SpeechRecognition | null>(null);\n\n  useEffect(() => {\n    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;\n    if (SpeechRecognition) {\n      setSpeechSupported(true);\n      recognitionRef.current = new SpeechRecognition();\n      recognitionRef.current.continuous = false;\n      recognitionRef.current.interimResults = false;\n      recognitionRef.current.lang = 'ko-KR';\n      \n      recognitionRef.current.onstart = () => {\n        setIsListening(true);\n      };\n      \n      recognitionRef.current.onend = () => {\n        setIsListening(false);\n      };\n      \n      recognitionRef.current.onresult = (event: SpeechRecognitionEvent) => {\n        const transcript = event.results[0][0].transcript;\n        setSearchKeyword(transcript);\n        handleSearch(transcript);\n      };\n      \n      recognitionRef.current.onerror = () => {\n        setIsListening(false);\n      };\n    }\n    \n    return () => {\n      if (recognitionRef.current) {\n        recognitionRef.current.abort();\n      }\n    };\n  }, []);\n\n  const toggleListening = useCallback(() => {\n    if (!recognitionRef.current) return;\n    \n    if (isListening) {\n      recognitionRef.current.stop();\n    } else {\n      recognitionRef.current.start();\n    }\n  }, [isListening]);\n\n  const handleSearch = (keyword: string) => {\n    if (!keyword.trim()) return;\n    \n    const searchParams = new URLSearchParams();\n    searchParams.append(\"keyword\", keyword.trim());\n    \n    setLocation(`/properties?${searchParams.toString()}`);\n  };\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    handleSearch(searchKeyword);\n  };\n\n  return (\n    <div className=\"bg-white p-6\">\n      <h2 className=\"text-2xl font-bold mb-4\">매물 검색</h2>\n      \n      <form onSubmit={handleSubmit} className=\"space-y-4\">\n        <div className=\"relative\">\n          <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5\" />\n          <Input\n            type=\"text\"\n            placeholder=\"검색어를 입력하거나 마이크를 눌러 음성으로 검색하세요\"\n            value={searchKeyword}\n            onChange={(e) => setSearchKeyword(e.target.value)}\n            className=\"pl-10 pr-12\"\n            data-testid=\"input-search-keyword\"\n          />\n          {speechSupported && (\n            <Button\n              type=\"button\"\n              variant=\"ghost\"\n              size=\"sm\"\n              onClick={toggleListening}\n              aria-label={isListening ? \"음성인식 중지\" : \"음성으로 검색\"}\n              title={isListening ? \"음성인식 중지\" : \"음성으로 검색\"}\n              className={`absolute right-1 top-1/2 transform -translate-y-1/2 p-2 ${\n                isListening ? \"text-red-500 animate-pulse\" : \"text-gray-500 hover:text-primary\"\n              }`}\n              data-testid=\"button-voice-search\"\n            >\n              {isListening ? <MicOff className=\"h-5 w-5\" /> : <Mic className=\"h-5 w-5\" />}\n            </Button>\n          )}\n        </div>\n        \n        {isListening && (\n          <div className=\"text-center text-sm text-red-500 animate-pulse\">\n            🎤 듣고 있습니다... 말씀해주세요\n          </div>\n        )}\n        \n        <Button \n          type=\"submit\" \n          className=\"w-full bg-primary hover:bg-secondary text-white\"\n          data-testid=\"button-search\"\n        >\n          <Search className=\"mr-2 h-4 w-4\" />\n          검색\n        </Button>\n      </form>\n    </div>\n  );\n};\n\nexport default PropertySearch;\n","path":null,"size_bytes":5229,"size_tokens":null},"server/types.d.ts":{"content":"// passport-naver와 passport-kakao 모듈의 타입 정의\n\ndeclare module 'passport-naver' {\n  import passport from 'passport';\n  \n  export interface Profile {\n    id: string;\n    displayName: string;\n    emails?: { value: string }[];\n    _json: {\n      email?: string;\n      mobile?: string;\n      nickname?: string;\n      profile_image?: string;\n      age?: string;\n      gender?: string;\n      name?: string;\n    };\n  }\n  \n  export interface StrategyOptions {\n    clientID: string;\n    clientSecret: string;\n    callbackURL: string;\n  }\n  \n  export class Strategy {\n    constructor(\n      options: StrategyOptions,\n      verify: (\n        accessToken: string,\n        refreshToken: string,\n        profile: Profile,\n        done: (error: any, user?: any) => void\n      ) => void\n    );\n    name: string;\n    authenticate(req: any, options?: any): void;\n  }\n}\n\ndeclare module 'passport-kakao' {\n  import passport from 'passport';\n  \n  export interface Profile {\n    id: string;\n    username: string;\n    displayName: string;\n    _json: {\n      id: number;\n      properties: {\n        nickname: string;\n        profile_image?: string;\n        thumbnail_image?: string;\n      };\n      kakao_account?: {\n        email?: string;\n        profile?: {\n          nickname: string;\n          profile_image_url?: string;\n          thumbnail_image_url?: string;\n        };\n        email_needs_agreement?: boolean;\n        has_email?: boolean;\n        is_email_valid?: boolean;\n        is_email_verified?: boolean;\n      };\n    };\n  }\n  \n  export interface StrategyOptions {\n    clientID: string;\n    clientSecret?: string;\n    callbackURL: string;\n  }\n  \n  export class Strategy {\n    constructor(\n      options: StrategyOptions,\n      verify: (\n        accessToken: string,\n        refreshToken: string,\n        profile: Profile,\n        done: (error: any, user?: any) => void\n      ) => void\n    );\n    name: string;\n    authenticate(req: any, options?: any): void;\n  }\n}","path":null,"size_bytes":1966,"size_tokens":null},"server/db.ts":{"content":"import { Pool, neonConfig } from '@neondatabase/serverless';\nimport { drizzle } from 'drizzle-orm/neon-serverless';\nimport ws from 'ws';\nimport * as schema from '@shared/schema';\n\n// Neon은 WebSocket을 사용하므로 ws 패키지로 설정\nneonConfig.webSocketConstructor = ws;\n\nif (!process.env.DATABASE_URL) {\n  throw new Error('DATABASE_URL이 설정되지 않았습니다. 데이터베이스를 프로비저닝하는 것을 잊으셨나요?');\n}\n\nexport const pool = new Pool({ connectionString: process.env.DATABASE_URL });\nexport const db = drizzle(pool, { schema });","path":null,"size_bytes":576,"size_tokens":null},"client/src/components/admin/ImportFromSheetModal.tsx":{"content":"import { useState } from \"react\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Loader2 } from \"lucide-react\";\n\ninterface ImportFromSheetModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n}\n\nexport function ImportFromSheetModal({ isOpen, onClose }: ImportFromSheetModalProps) {\n  const { toast } = useToast();\n  const [spreadsheetId, setSpreadsheetId] = useState(\"\");\n  const [apiKey, setApiKey] = useState(\"\");\n  const [range, setRange] = useState(\"Sheet1!A2:Z\");\n\n  const importMutation = useMutation({\n    mutationFn: async (data: { spreadsheetId: string; apiKey: string; range: string }) => {\n      const res = await apiRequest(\"POST\", \"/api/admin/import-from-sheet\", data);\n      return await res.json();\n    },\n    onSuccess: (data) => {\n      if (data.success) {\n        toast({\n          title: \"데이터 가져오기 성공\",\n          description: `${data.count}개의 매물 데이터를 가져왔습니다.`,\n        });\n        \n        // 성공 후 캐시 무효화\n        queryClient.invalidateQueries({ queryKey: [\"/api/properties\"] });\n        queryClient.invalidateQueries({ queryKey: [\"/api/properties/featured\"] });\n        \n        // 모달 닫기\n        onClose();\n      } else {\n        toast({\n          title: \"데이터 가져오기 실패\",\n          description: data.error || \"알 수 없는 오류가 발생했습니다.\",\n          variant: \"destructive\",\n        });\n      }\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"데이터 가져오기 실패\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!spreadsheetId || !apiKey) {\n      toast({\n        title: \"필수 정보 누락\",\n        description: \"스프레드시트 ID와 API 키는 필수입니다.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    \n    importMutation.mutate({ spreadsheetId, apiKey, range });\n  };\n\n  return (\n    <Dialog open={isOpen} onOpenChange={(open) => !open && onClose()}>\n      <DialogContent className=\"sm:max-w-[500px]\">\n        <form onSubmit={handleSubmit}>\n          <DialogHeader>\n            <DialogTitle>구글 스프레드시트에서 데이터 가져오기</DialogTitle>\n            <DialogDescription>\n              구글 스프레드시트에서 부동산 매물 데이터를 직접 가져옵니다. 정보를 입력해주세요.\n            </DialogDescription>\n          </DialogHeader>\n          \n          <div className=\"grid gap-4 py-4\">\n            <div className=\"grid grid-cols-4 items-center gap-4\">\n              <Label htmlFor=\"spreadsheetId\" className=\"text-right\">\n                스프레드시트 ID\n              </Label>\n              <Input\n                id=\"spreadsheetId\"\n                value={spreadsheetId}\n                onChange={(e) => setSpreadsheetId(e.target.value)}\n                className=\"col-span-3\"\n                placeholder=\"1BxiMVs0XRA5nFMdKvBdBZjgmUUqptlbs74OgvE2upms\"\n              />\n            </div>\n            \n            <div className=\"grid grid-cols-4 items-center gap-4\">\n              <Label htmlFor=\"apiKey\" className=\"text-right\">\n                Google API 키\n              </Label>\n              <Input\n                id=\"apiKey\"\n                value={apiKey}\n                onChange={(e) => setApiKey(e.target.value)}\n                className=\"col-span-3\"\n                type=\"password\"\n                placeholder=\"AIzaSyD...\"\n              />\n            </div>\n            \n            <div className=\"grid grid-cols-4 items-center gap-4\">\n              <Label htmlFor=\"range\" className=\"text-right\">\n                데이터 범위\n              </Label>\n              <Input\n                id=\"range\"\n                value={range}\n                onChange={(e) => setRange(e.target.value)}\n                className=\"col-span-3\"\n                placeholder=\"Sheet1!A2:AN\"\n              />\n            </div>\n            \n            <div className=\"col-span-4\">\n              <DialogDescription className=\"text-xs\">\n                <p className=\"mt-2 font-semibold\">시트 포맷 안내:</p>\n                <p>A:제목, B:설명, C:유형, D:가격, E:주소, F:지역, G:면적, H:침실수, I:욕실수, J:층수, K:총층수, L:이미지URL, M:이미지URLs, N:추천매물</p>\n                <p>O:거래유형, P:건축년도, Q:보증금, R:월세, S:관리비, T:지목, U:용도지역, V:건물명, W:동호수, X:공급면적, Y:전용면적, Z:평형</p>\n                <p>AA:방향, AB:승강기(true/false), AC:주차대수, AD:난방방식, AE:사용승인일, AF:소유자, AG:소유자전화, AH:임차인, AI:임차인전화</p>\n                <p>AJ:의뢰인, AK:의뢰인전화, AL:특이사항, AM:공동중개(true/false), AN:비공개메모</p>\n                <p>\n                  유형은 다음 중 하나여야 합니다: 토지, 주택, 아파트연립다세대, 원투룸, 상가공장창고펜션\n                </p>\n              </DialogDescription>\n            </div>\n          </div>\n          \n          <DialogFooter>\n            <Button \n              type=\"button\" \n              variant=\"outline\" \n              onClick={onClose} \n              disabled={importMutation.isPending}\n            >\n              취소\n            </Button>\n            <Button \n              type=\"submit\"\n              disabled={importMutation.isPending || !spreadsheetId || !apiKey}\n            >\n              {importMutation.isPending ? (\n                <>\n                  <Loader2 className=\"mr-2 h-4 w-4 animate-spin\" />\n                  가져오는 중...\n                </>\n              ) : (\n                \"데이터 가져오기\"\n              )}\n            </Button>\n          </DialogFooter>\n        </form>\n      </DialogContent>\n    </Dialog>\n  );\n}","path":null,"size_bytes":6289,"size_tokens":null}},"version":2}